{"index": 7026, "cve_id": "CVE-2022-23599", "cwe_id": ["CWE-79", "CWE-601"], "cve_language": "Python", "cve_description": "Products.ATContentTypes are the core content types for Plone 2.1 - 4.3. Versions of Plone that are dependent on Products.ATContentTypes prior to version 3.0.6 are vulnerable to reflected cross site scripting and open redirect when an attacker can get a compromised version of the image_view_fullscreen page in a cache, for example in Varnish. The technique is known as cache poisoning. Any later visitor can get redirected when clicking on a link on this page. Usually only anonymous users are affected, but this depends on the user's cache settings. Version 3.0.6 of Products.ATContentTypes has been released with a fix. This version works on Plone 5.2, Python 2 only. As a workaround, make sure the image_view_fullscreen page is not stored in the cache. More information about the vulnerability and cvmitigation measures is available in the GitHub Security Advisory.", "cvss": "6.1", "publish_date": "January 28, 2022", "AV": "NETWORK", "AC": "NETWORK", "PR": "NONE", "UI": "REQUIRED", "S": "CHANGED", "C": "LOW", "I": "LOW", "A": "NONE", "commit_id": "fc793f88f35a15a68b52e4abed77af0da5fdbab8", "commit_message": "Security fix: prevent cache poisoning with the Referer header.\n\nSee [security advisory](https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh).", "commit_date": "2022-01-21T00:09:14Z", "project": "plone/products.atcontenttypes", "url": "https://api.github.com/repos/plone/Products.ATContentTypes/commits/fc793f88f35a15a68b52e4abed77af0da5fdbab8", "html_url": "https://github.com/plone/Products.ATContentTypes/commit/fc793f88f35a15a68b52e4abed77af0da5fdbab8", "windows_before": [{"commit_id": "b9f97cb7a73dae433d6ee4451cd93c9e954262d3", "commit_date": "Thu Oct 7 15:55:21 2021 +0200", "commit_message": "Back to development: 3.0.6", "files_name": ["setup.py"]}, {"commit_id": "e483d826a8fd9ef5e55bad0100c353b1ccc00832", "commit_date": "Thu Oct 7 15:54:55 2021 +0200", "commit_message": "Preparing release 3.0.5", "files_name": ["CHANGES.rst", "news/3330.bugfix", "setup.py"]}, {"commit_id": "e7dad5c50f90507ac53b228eeaf501c5cf343ed8", "commit_date": "Thu Oct 7 15:54:36 2021 +0200", "commit_message": "Added 'Python 2 only' to classifiers in setup.py.", "files_name": ["setup.py"]}, {"commit_id": "5fc1c35454aca70170129cbce8d3af5674cb5dd9", "commit_date": "Thu Oct 7 12:28:17 2021 +0200", "commit_message": "Merge pull request #67 from plone/prevent-installation-on-py3", "files_name": ["d1d32c8f0d50d0b4ca164a03a871036f50d2c360 - Tue Oct 5 20:29:23 2021 +0200 : Prevent installation on Python 3, as we know Archetypes does not work there.", "news/3330.bugfix", "setup.cfg", "setup.py"]}, {"commit_id": "b9ed9fed3affa8325b2ce2be7048a028865295af", "commit_date": "Mon Sep 28 10:04:17 2020 +0200", "commit_message": "Back to development: 3.0.5", "files_name": ["setup.py"]}, {"commit_id": "52b3a4a2b4ad223ce0893a976152a4bc8372f7b2", "commit_date": "Mon Sep 28 10:03:36 2020 +0200", "commit_message": "Preparing release 3.0.4", "files_name": ["CHANGES.rst", "news/24.bugfix", "setup.py"]}, {"commit_id": "0e022782985271f343da84afb87679b20b3606d6", "commit_date": "Fri Sep 11 09:48:44 2020 +0200", "commit_message": "Merge pull request #66 from plone/replace_test_in_templates", "files_name": ["57b9a10fc89b1af143699115c0210b22c1c2eb29 - Thu Sep 10 18:31:17 2020 +0200 : fix typo and add changelog", "Products/ATContentTypes/skins/ATContentTypes/atct_topic_pdf.pt", "news/24.bugfix"]}, {"commit_id": "8c68ace7375d5a2b4f318bbfafe0d04707c41f1b", "commit_date": "Thu Sep 10 16:48:02 2020 +0200", "commit_message": "Drop use of test() in templates since it is no longer available since Zope 4.5.1 (see https://community.plone.org/t/plone-5-2-1-5-2-2-page-template-issues/12793)", "files_name": ["Products/ATContentTypes/skins/ATContentTypes/atct_album_view.pt", "Products/ATContentTypes/skins/ATContentTypes/atct_manageTopicIndex.cpt", "Products/ATContentTypes/skins/ATContentTypes/atct_manageTopicMetadata.cpt", "Products/ATContentTypes/skins/ATContentTypes/atct_topic_pdf.pt", "Products/ATContentTypes/skins/ATContentTypes/atct_topic_subtopics.pt", "Products/ATContentTypes/skins/ATContentTypes/atct_topic_view.pt", "Products/ATContentTypes/skins/ATContentTypes/criterion_edit_form.cpt", "Products/ATContentTypes/skins/ATContentTypes/folder_full_view_item.pt", "Products/ATContentTypes/skins/ATContentTypes/folder_listing.pt", "Products/ATContentTypes/skins/ATContentTypes/folder_summary_view.pt", "Products/ATContentTypes/skins/ATContentTypes/folder_tabular_view.pt", "Products/ATContentTypes/skins/ATContentTypes/newsitem_view.pt", "Products/ATContentTypes/www/portal_factory_manage_types.zpt"]}, {"commit_id": "8f0a945ca20a0e5837601c0ad81cfb67720f13f2", "commit_date": "Mon Apr 20 23:29:46 2020 +0200", "commit_message": "Back to development: 3.0.4", "files_name": ["setup.py"]}, {"commit_id": "db71af802a59187efaf464e870186dcc58c92685", "commit_date": "Mon Apr 20 23:28:49 2020 +0200", "commit_message": "Preparing release 3.0.3", "files_name": ["CHANGES.rst", "news/644.bugfix", "setup.py"]}, {"commit_id": "f2d95b217068e0598a2dc46ef980f611e0c5f00f", "commit_date": "Wed Mar 25 23:34:09 2020 +0100", "commit_message": "Merge branch 'zope-4.2.1'", "files_name": ["8f7076eec690cd28265e24e42892650287abb150 - Sat Mar 21 03:23:51 2020 +0100 : Updated tests to work on Zope 4.2.1/4.2.", "Products/ATContentTypes/tests/http_access.txt", "news/644.bugfix"]}, {"commit_id": "cf45586b4224d181ced6be2ecbaedeba32589fab", "commit_date": "Wed Oct 9 21:46:12 2019 +0200", "commit_message": "Added development status 6 mature to classifiers.", "files_name": ["setup.py"]}, {"commit_id": "ff96700c17311244873fb227ccde466f55f36b1e", "commit_date": "Wed Jun 19 19:10:14 2019 -0400", "commit_message": "Back to development: 3.0.3", "files_name": ["setup.py"]}, {"commit_id": "70a031ff3c4ca80b617a06f73d3e1c8dce295ad9", "commit_date": "Wed Jun 19 19:08:06 2019 -0400", "commit_message": "Preparing release 3.0.2", "files_name": ["CHANGES.rst", "news/64.bugfix", "setup.py"]}, {"commit_id": "6cf1b5087ef0fbdd1b3dfba79ff08b037b607dd1", "commit_date": "Sat Jun 15 17:23:54 2019 +0200", "commit_message": "Merge pull request #64 from plone/fix_full_folder_view_p52", "files_name": ["f79e97a07ec65962d6c83075502dc2752fe99c3f - Thu Jun 13 12:44:49 2019 +0200 : add changenote", "news/64.bugfix"]}, {"commit_id": "30e5c76d792cf256d334e249e76b08dbd29b9170", "commit_date": "Wed May 22 20:16:22 2019 +0200", "commit_message": "Fix full_folder_view view in Plone 5.2", "files_name": ["Products/ATContentTypes/skins/ATContentTypes/folder_full_view_item.pt"]}, {"commit_id": "2e415f0b0c446134e1b150ee799427ca0e34b03c", "commit_date": "Tue May 21 21:28:13 2019 +0200", "commit_message": "Back to development: 3.0.2", "files_name": ["setup.py"]}, {"commit_id": "fa3ffab14db83aa2157c1df3e0dabf3524a76181", "commit_date": "Tue May 21 21:27:37 2019 +0200", "commit_message": "Preparing release 3.0.1", "files_name": ["CHANGES.rst", "news/63.bugfix", "setup.py"]}, {"commit_id": "489a63e6347087cf085c3b9b62eab7fac65a7afb", "commit_date": "Tue May 21 21:24:52 2019 +0200", "commit_message": "Fixed changelog: 3.0.0 was already released last year.", "files_name": ["CHANGES.rst", "news/50.bugfix", "news/51.bugfix", "news/53.bugfix", "news/56.bugfix", "news/58.feature", "news/60.bugfix"]}, {"commit_id": "da239c68f477cfe93b6b1e3e8d05f88fb3cd85bf", "commit_date": "Fri May 17 20:14:06 2019 +0200", "commit_message": "Merge pull request #63 from plone/fix_at_factory_with_zope4", "files_name": ["b60e301c113610bcc42f14042c8892552b88387d - Fri May 17 17:57:44 2019 +0200 : add changenote", "news/63.bugfix"]}, {"commit_id": "ec6e9979c021b8db06abc5e46dbc4c3f111749e4", "commit_date": "Fri May 17 17:41:11 2019 +0200", "commit_message": "Fix traversing in portal_factory with url-quoted type-name that contains %20 instead of spaces", "files_name": ["Products/ATContentTypes/tests/atctftestcase.py", "Products/ATContentTypes/tool/factory.py"]}, {"commit_id": "a903d5cafdff342be8e983f1cba5f49144b4e2d1", "commit_date": "Tue Oct 30 22:10:09 2018 -0400", "commit_message": "Back to development: 3.0.1", "files_name": ["setup.py"]}, {"commit_id": "4370c756b49b6f2ad15ef2479cf3089bdf1684f3", "commit_date": "Tue Oct 30 22:09:15 2018 -0400", "commit_message": "Preparing release 3.0.0", "files_name": ["setup.py"]}, {"commit_id": "6e28978bfb87aa99b35294a630d5e9d9c65724d8", "commit_date": "Mon Oct 22 21:22:54 2018 +0200", "commit_message": "Merge pull request #61 from plone/use-check-id-function", "files_name": ["086d90e712150569bd02090e62b57cd3b4d920a6 - Fri Oct 5 13:54:00 2018 +0200 : Use check_id function from CMFPlone.utils.", "Products/ATContentTypes/content/base.py", "news/60.bugfix"]}, {"commit_id": "011b9e2f59ba23bd8976763ef03e745086dd28f0", "commit_date": "Fri Oct 5 20:18:12 2018 +0200", "commit_message": "Merge pull request #59 from plone/58-is-expired", "files_name": ["1f7f19848504d4398c602c4d66b60c5f354c83a4 - Fri Oct 5 12:16:31 2018 +0200 : Added getObjSize.py skin script as it will be removed from CMFPlone. #58", "Products/ATContentTypes/skins/ATContentTypes/getObjSize.py", "news/58.feature"]}, {"commit_id": "0aacd98d41625211d721f86bedf14cb203c8ca09", "commit_date": "Thu Oct 4 14:54:18 2018 +0200", "commit_message": "Added isExpired.py skin script as it will be removed from CMFPlone.", "files_name": ["Products/ATContentTypes/skins/ATContentTypes/isExpired.py", "news/58.feature"]}, {"commit_id": "674d80c1854b31c1f2056020db852e190dcde63a", "commit_date": "Mon Oct 1 18:27:17 2018 +0200", "commit_message": "Initialized towncrier.", "files_name": [".gitattributes", "CHANGES.rst", "MANIFEST.in", "news/.gitkeep", "news/50.bugfix", "news/51.bugfix", "news/53.bugfix", "news/56.bugfix", "pyproject.toml", "setup.py"]}, {"commit_id": "11f6d63291b434095d24a1eeccade9791af61311", "commit_date": "Mon Oct 1 17:49:00 2018 +0200", "commit_message": "Removed unneeded exclude ez_setup.py from setup.py.", "files_name": ["setup.py"]}, {"commit_id": "1e3d962892db0c4e1a748c3c4584f6256bfdb2c8", "commit_date": "Thu Sep 27 17:18:37 2018 +0200", "commit_message": "Merge pull request #56 from plone/testlayer", "files_name": ["8002343df6c5818517207809377b6d4995ca0fa0 - Sat Sep 22 16:50:40 2018 +0200 : Switch to new TestCase using AT after PloneTestcase is now DX.", "CHANGES.rst", "Products/ATContentTypes/tests/atcttestcase.py", "Products/ATContentTypes/tests/testContentTypes.py", "Products/ATContentTypes/tests/test_atimage.py", "Products/ATContentTypes/tests/test_base_profile.py", "Products/ATContentTypes/tests/test_content_profile.py", "Products/ATContentTypes/tests/test_controlpanel.py", "Products/ATContentTypes/tests/test_doctests.py", "Products/ATContentTypes/tests/test_portal_factory.py"]}, {"commit_id": "f38aa971c4473c777a238714fc6a71c102c24dc9", "commit_date": "Fri Apr 27 01:12:34 2018 +0200", "commit_message": "Merge pull request #55 from plone/fix-tests-zope-40b4", "files_name": ["7658860e4e00347d76bb375385a4f0fff6c6a06b - Fri Apr 27 00:10:35 2018 +0200 : Fixed tests in combination with Zope 4.0b4.", "CHANGES.rst", "Products/ATContentTypes/tests/http_access.txt"]}, {"commit_id": "2e6a3490efcc495d3ec383d1fbc79679dc4b9c8a", "commit_date": "Wed Mar 14 16:00:07 2018 +0100", "commit_message": "Merge pull request #53 from plone/davisagli-tabular-view-master", "files_name": ["abdbe74dd5dcecd5f3210ce3697575d654383398 - Wed Mar 14 09:16:22 2018 -0400 : Handle no icon in folder_tabular_view", "CHANGES.rst", "Products/ATContentTypes/skins/ATContentTypes/folder_tabular_view.pt"]}, {"commit_id": "e1432bd188aa6dc8d16efd5da2de594aefbf74b8", "commit_date": "Tue Jan 30 00:37:44 2018 +0100", "commit_message": "Made license classifier same as license in setup.py", "files_name": ["setup.py"]}, {"commit_id": "06c80e8338f6e857a7426e8a7049cd357a2cf875", "commit_date": "Wed Oct 25 09:04:50 2017 +0200", "commit_message": "Fix doctests to adapt to changes in http-headers.", "files_name": ["CHANGES.rst", "Products/ATContentTypes/tests/browser_collection_views.txt", "Products/ATContentTypes/tests/http_access.txt"]}, {"commit_id": "34c30e521fd59871461f8917977127d2b892f3f9", "commit_date": "Sat Oct 21 15:10:56 2017 +0200", "commit_message": "bump version", "files_name": ["CHANGES.rst", "setup.py"]}, {"commit_id": "640d35291493710a6985069ef9390d8d29e82da5", "commit_date": "Sat Oct 21 14:54:58 2017 +0200", "commit_message": "Merge pull request #50 from plone/plonezope4", "files_name": ["a1df98c8e775001e08774807bddacd1ead53b9a0 - Mon Oct 16 17:55:56 2017 +0200 : Fix checkPermission call (it was acquired from portal_membership until CMF 2.3)", "CHANGES.rst", "Products/ATContentTypes/tests/test_portal_factory.py"]}, {"commit_id": "8846595dd65b59e1b3b862d85582ed0a4979f0b7", "commit_date": "Thu Sep 28 19:43:25 2017 +0200", "commit_message": "do not call views in tal", "files_name": ["Products/ATContentTypes/skins/ATContentTypes/folder_listing.pt"]}, {"commit_id": "d91d86781b5fcd28ab33dd842b9a80e3f9b11930", "commit_date": "Thu Feb 16 22:49:01 2017 -0800", "commit_message": "fix test", "files_name": ["Products/ATContentTypes/tests/http_access.txt"]}, {"commit_id": "8b1f63a05abe1ef8077aa487fd499ec2d7bad649", "commit_date": "Fri Oct 13 11:56:09 2017 +0200", "commit_message": "Merge pull request #51 from plone/verbose-gs-profiles", "files_name": ["97c73ca47bff62be3479026d5ff45e7396c8ef9a - Fri Oct 13 01:00:45 2017 +0200 : verbose gs profiles", "CHANGES.rst", "Products/ATContentTypes/profiles.zcml"]}, {"commit_id": "eca3f164a5458f802da754b0aa9a5b47f379f7ec", "commit_date": "Mon Jun 26 08:29:46 2017 -0400", "commit_message": "Back to development: 2.3.7", "files_name": ["CHANGES.rst", "setup.py"]}, {"commit_id": "ef5ea95c5201f448b00205623fca2bdc9e2565ed", "commit_date": "Mon Jun 26 08:29:25 2017 -0400", "commit_message": "Preparing release 2.3.6", "files_name": ["CHANGES.rst", "setup.py"]}, {"commit_id": "610255d4d05f4e7ffeef463102234f2e1c0d31cf", "commit_date": "Mon Jun 26 08:29:18 2017 -0400", "commit_message": "Cleaned up empty headers from changelog.", "files_name": ["CHANGES.rst"]}], "windows_after": [{"commit_id": "fb089a199667b49419dfb692b15b794b9205045f", "commit_date": "Fri Jan 28 14:55:30 2022 +0100", "commit_message": "Preparing release 3.0.6", "files_name": ["CHANGES.rst", "news/1.bugfix", "setup.py"]}, {"commit_id": "7851f0450f7e1d364585faa1d3b47cefa44097a4", "commit_date": "Fri Jan 28 14:55:56 2022 +0100", "commit_message": "Back to development: 3.0.7", "files_name": ["setup.py"]}, {"commit_id": "3436e32612b13855fb8c0063f794bd786b7f162d", "commit_date": "Tue Mar 15 13:51:45 2022 +0100", "commit_message": "Fix test", "files_name": ["Products/ATContentTypes/tests/test_atdocument.py"]}, {"commit_id": "9a4e80e3adaf5b6fe2e4218c412c3f30c4faf4bf", "commit_date": "Tue Mar 15 17:08:53 2022 +0100", "commit_message": "Merge pull request #68 from plone/do_not_autoclose_tags", "files_name": ["f0c602278c2185ca640216e36c596894b71a1866 - Wed Mar 16 17:37:19 2022 +0100 : Add news snippet.", "news/68.bugfix"]}, {"commit_id": "cf4ccbfd0e3062c378d539e68679e6972986a3ca", "commit_date": "Wed Mar 16 17:38:24 2022 +0100", "commit_message": "Preparing release 3.0.7", "files_name": ["CHANGES.rst", "news/68.bugfix", "setup.py"]}, {"commit_id": "9c59626073daa97162c2b1d33a39a043f386cd8e", "commit_date": "Wed Mar 16 17:39:26 2022 +0100", "commit_message": "Back to development: 3.0.8", "files_name": ["setup.py"]}], "parents": [{"commit_id_before": "b9f97cb7a73dae433d6ee4451cd93c9e954262d3", "url_before": "https://api.github.com/repos/plone/Products.ATContentTypes/commits/b9f97cb7a73dae433d6ee4451cd93c9e954262d3", "html_url_before": "https://github.com/plone/Products.ATContentTypes/commit/b9f97cb7a73dae433d6ee4451cd93c9e954262d3"}], "details": [{"raw_url": "https://github.com/plone/Products.ATContentTypes/raw/fc793f88f35a15a68b52e4abed77af0da5fdbab8/Products%2FATContentTypes%2Fskins%2FATContentTypes%2Fimage_view_fullscreen.pt", "code": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\"\n      xmlns:tal=\"http://xml.zope.org/namespaces/tal\"\n      xmlns:metal=\"http://xml.zope.org/namespaces/metal\"\n      xmlns:i18n=\"http://xml.zope.org/namespaces/i18n\"\n      lang=\"en\"\n      i18n:domain=\"plone\">\n\n<head>\n\n    <metal:block tal:define=\"dummy python:request.RESPONSE.setHeader('Content-Type', 'text/html;;charset=utf-8')\" />\n\n    <title tal:content=\"context/Title\">\n        Title\n    </title>\n\n    <style type=\"text/css\" media=\"screen\">\n    body {\n        background-color: white;\n        color: black;\n        font-family: \"Lucida Grande\", Verdana, Lucida, Helvetica, Arial, sans-serif;\n        font-size: 69%;\n    }\n\n    a {\n        display:block;\n        margin: 0.5em;\n        color: #436976;\n        text-decoration: underline;\n        line-height:1.5em;\n    }\n\n    img {\n        border: 0px;\n        padding: 5px;\n    }\n\n    #content-core {\n        text-align: center;\n    }\n\n    </style>\n\n</head>\n\n<body>\n\n<div id=\"content-core\">\n  <tal:block define=\"referer request/HTTP_REFERER;\n                     url_tool nocall:context/portal_url;\n                     referer python:referer if referer and url_tool.isURLInPortal(referer) else '';\">\n    <a href=\"\"\n       tal:attributes=\"href referer\"\n       tal:condition=\"referer\"\n       ><span i18n:translate=\"label_back_to_site\">Back to site</span><br /><tal:block replace=\"structure context/tag\" /></a>\n\n    <a href=\"\"\n       tal:attributes=\"href python:url_tool()\"\n       tal:condition=\"not: referer\"\n       ><span i18n:translate=\"label_home\">Home</span><br /><tal:block replace=\"structure context/tag\" /></a>\n      </tal:block>\n</div>\n\n</body>\n</html>\n\n", "code_before": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\"\n      xmlns:tal=\"http://xml.zope.org/namespaces/tal\"\n      xmlns:metal=\"http://xml.zope.org/namespaces/metal\"\n      xmlns:i18n=\"http://xml.zope.org/namespaces/i18n\"\n      lang=\"en\"\n      i18n:domain=\"plone\">\n\n<head>\n\n    <metal:block tal:define=\"dummy python:request.RESPONSE.setHeader('Content-Type', 'text/html;;charset=utf-8')\" />\n\n    <title tal:content=\"context/Title\">\n        Title\n    </title>\n\n    <style type=\"text/css\" media=\"screen\">\n    body {\n        background-color: white;\n        color: black;\n        font-family: \"Lucida Grande\", Verdana, Lucida, Helvetica, Arial, sans-serif;\n        font-size: 69%;\n    }\n\n    a {\n        display:block;\n        margin: 0.5em;\n        color: #436976;\n        text-decoration: underline;\n        line-height:1.5em;\n    }\n\n    img {\n        border: 0px;\n        padding: 5px;\n    }\n\n    #content-core {\n        text-align: center;\n    }\n\n    </style>\n\n</head>\n\n<body>\n\n<div id=\"content-core\">\n    <a href=\"\"\n       tal:attributes=\"href request/HTTP_REFERER\"\n       tal:condition=\"request/HTTP_REFERER\"\n       ><span i18n:translate=\"label_back_to_site\">Back to site</span><br /><tal:block replace=\"structure context/tag\" /></a>\n\n    <a href=\"\"\n       tal:attributes=\"href context/portal_url\"\n       tal:condition=\"not: request/HTTP_REFERER\"\n       ><span i18n:translate=\"label_home\">Home</span><br /><tal:block replace=\"structure context/tag\" /></a>\n</div>\n\n</body>\n</html>\n\n", "patch": "@@ -46,15 +46,19 @@\n <body>\n \n <div id=\"content-core\">\n+  <tal:block define=\"referer request/HTTP_REFERER;\n+                     url_tool nocall:context/portal_url;\n+                     referer python:referer if referer and url_tool.isURLInPortal(referer) else '';\">\n     <a href=\"\"\n-       tal:attributes=\"href request/HTTP_REFERER\"\n-       tal:condition=\"request/HTTP_REFERER\"\n+       tal:attributes=\"href referer\"\n+       tal:condition=\"referer\"\n        ><span i18n:translate=\"label_back_to_site\">Back to site</span><br /><tal:block replace=\"structure context/tag\" /></a>\n \n     <a href=\"\"\n-       tal:attributes=\"href context/portal_url\"\n-       tal:condition=\"not: request/HTTP_REFERER\"\n+       tal:attributes=\"href python:url_tool()\"\n+       tal:condition=\"not: referer\"\n        ><span i18n:translate=\"label_home\">Home</span><br /><tal:block replace=\"structure context/tag\" /></a>\n+      </tal:block>\n </div>\n \n </body>", "file_path": "files/2022_1/30", "file_language": "pt", "file_name": "Products/ATContentTypes/skins/ATContentTypes/image_view_fullscreen.pt", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/plone/Products.ATContentTypes/raw/fc793f88f35a15a68b52e4abed77af0da5fdbab8/news%2F1.bugfix", "code": "Security fix: prevent cache poisoning with the Referer header.\nSee `security advisory <https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh>`.\n[maurits]\n", "code_before": "", "patch": "@@ -0,0 +1,3 @@\n+Security fix: prevent cache poisoning with the Referer header.\n+See `security advisory <https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh>`.\n+[maurits]", "file_path": "files/2022_1/31", "file_language": "bugfix", "file_name": "news/1.bugfix", "outdated_file_modify": 1, "outdated_file_before": 0, "outdated_file_after": 1}], "outdated": 1, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
