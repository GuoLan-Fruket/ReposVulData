{"index": 12542, "cve_id": "CVE-2023-45158", "cwe_id": ["CWE-78"], "cve_language": "Python", "cve_description": "An OS command injection vulnerability exists in web2py 2.24.1 and earlier. When the product is configured to use notifySendHandler for logging (not the default configuration), a crafted web request may execute an arbitrary OS command on the web server using the product.", "cvss": "9.8", "publish_date": "October 16, 2023", "AV": "NETWORK", "AC": "NETWORK", "PR": "NONE", "UI": "NONE", "S": "UNCHANGED", "C": "HIGH", "I": "HIGH", "A": "HIGH", "commit_id": "936e2260b0c34c44e2f3674a893e96d2a7fad0a3", "commit_message": "fixed vulnerability JVN#80476432", "commit_date": "2023-10-04T04:38:57Z", "project": "web2py/web2py", "url": "https://api.github.com/repos/web2py/web2py/commits/936e2260b0c34c44e2f3674a893e96d2a7fad0a3", "html_url": "https://github.com/web2py/web2py/commit/936e2260b0c34c44e2f3674a893e96d2a7fad0a3", "windows_before": [{"commit_id": "38f44f7bd5d009f3905058d1c5f926b391aeccb9", "commit_date": "Tue Oct 3 21:33:28 2023 -0700", "commit_message": "Merge pull request #2469 from rostagnolisandro/patch-1", "files_name": ["292d2bfbac4b158727436d49bb9fcd9bc8fa1146 - Tue Oct 3 21:26:06 2023 -0700 : Merge pull request #2236 from dlage/patch-2", "4c0b9ad1c8eb040c347eb01171a38fd7dd9c19aa - Wed Jul 5 11:40:45 2023 +0100 : Merge pull request #2471 from korylprince/security-fix", "70dd3a950b3517a1e31741a2eebfa85874085686 - Tue Jul 4 16:46:09 2023 -0500 : sanitize CRLF in headers to prevent HTTP response splitting", "gluon/http.py"]}, {"commit_id": "28a3f3245d8f2c31773db08e3bd63b7f6b5aa0b6", "commit_date": "Thu Jun 22 10:40:39 2023 -0300", "commit_message": "resolves #2468", "files_name": ["gluon/scheduler.py"]}, {"commit_id": "b9a73402d81d3c7483decce4643c4fb29ea979f6", "commit_date": "Mon Jun 5 12:00:35 2023 +0100", "commit_message": "Fix password reset link staying active after password change", "files_name": ["gluon/tools.py"]}, {"commit_id": "7685d373474378e93132f8916145fb11f84cec71", "commit_date": "Wed Mar 22 21:39:42 2023 -0700", "commit_message": "version 2.24.1", "files_name": ["Makefile", "VERSION"]}, {"commit_id": "479fc3f7059b6188ec1aece0d0e00b8f372bac6d", "commit_date": "Wed Mar 22 21:37:28 2023 -0700", "commit_message": "Merge branch 'master' of github.com:web2py/web2py", "files_name": ["990b20b8bdb6c3efafee1a79c55eaccef4dc2a9d - Wed Mar 22 21:34:35 2023 -0700 : fixed application packaging, thank you Alan", "gluon/packages/dal"]}, {"commit_id": "b591d3205473f682b47e1b85fd1fab4ac58359aa", "commit_date": "Wed Mar 1 16:31:57 2023 +0000", "commit_message": "Merge pull request #2463 from mcemeren/master", "files_name": ["3e04a2b916b75e6ea9eb20de5e3abef2dcd08a8d - Wed Mar 1 16:17:09 2023 +0300 : hmac.new digestmod required fix", "gluon/contrib/websocket_messaging.py"]}, {"commit_id": "28edd442b5681a3bdb2a3d3f2b041212b3bd3675", "commit_date": "Tue Feb 28 19:28:35 2023 +0000", "commit_message": "Merge pull request #2462 from leonelcamara/fixes", "files_name": ["15d8beda7b8b1b5095dfeb4d79386afc26f67103 - Tue Feb 28 19:19:48 2023 +0000 : Fixes #2457", "applications/admin/controllers/default.py"]}, {"commit_id": "8d22cf71578249a15c63e1020b2194e6736346f3", "commit_date": "Tue Feb 28 18:34:33 2023 +0000", "commit_message": "Merge pull request #2459 from mcemeren/master", "files_name": ["3e88d669c8eafafd50d533c173320e303cd0b11d - Tue Feb 28 21:16:10 2023 +0300 : Additional compare tests added", "gluon/tests/test_utils.py"]}, {"commit_id": "f6050a0d43848f8b2a943aea91fd751ab6fe9f47", "commit_date": "Tue Feb 28 15:59:39 2023 +0000", "commit_message": "Merge pull request #2461 from manma83/fix-corrupt-cache-file", "files_name": ["4f4033e9744bcd3288014fa0626a585241ad4fa0 - Fri Feb 24 15:58:00 2023 -0800 : add test case", "gluon/tests/test_cache.py"]}, {"commit_id": "56b06f3170fe0cda3b37cd5baad7cd92a3cc556b", "commit_date": "Fri Feb 24 13:20:12 2023 -0800", "commit_message": "Fix hanging issue when cache file is corrupt", "files_name": ["gluon/cache.py"]}, {"commit_id": "f096a253a7f80b1006a3d41c948e6e940f0144eb", "commit_date": "Thu Feb 23 11:34:56 2023 +0300", "commit_message": "utils-compare fail safe", "files_name": ["gluon/utils.py"]}, {"commit_id": "7af5c2b5d6e4fa7f708ed2c7e36e721322ec52a6", "commit_date": "Mon Jan 30 23:08:59 2023 -0800", "commit_message": "version 2.23.1", "files_name": ["Makefile", "VERSION"]}, {"commit_id": "c720deb8dcdb3bd629fc3df5e3d488a4e41325a3", "commit_date": "Mon Jan 30 23:07:54 2023 -0800", "commit_message": "Merge pull request #2458 from pci-dev/fix_rewrite_internal_error", "files_name": ["f84cc643507b1495a44393836c08be6a5a85952c - Mon Jan 30 23:07:38 2023 -0800 : Merge pull request #2455 from leonelcamara/fixes", "aaaf65511fc4a2ae44e1f37959a60e7242ddc30c - Mon Jan 30 20:43:56 2023 +0100 : fix internal error in map_static() on self.args=None", "gluon/rewrite.py"]}, {"commit_id": "b24ace2eb5c267357f6ef6c4857ab651bbdb7af5", "commit_date": "Tue Jan 3 15:15:18 2023 +0000", "commit_message": "simplified and more corner cases", "files_name": ["gluon/tests/test_tools.py", "gluon/tools.py"]}, {"commit_id": "79ab90c46487e9c9814b4132c360224470d1c392", "commit_date": "Mon Jan 2 18:53:46 2023 -0800", "commit_message": "Merge pull request #2453 from leonelcamara/fixes", "files_name": ["478725fb03ae9a260fa32f91999aa709bf7f68d9 - Mon Jan 2 20:02:09 2023 +0000 : fixes corner cases", "gluon/tests/test_tools.py", "gluon/tools.py"]}, {"commit_id": "db4a07a4c8c0ff1c5d4d03fd06dd64d1163a666c", "commit_date": "Thu Dec 29 13:56:36 2022 +0000", "commit_message": "Merge pull request #2452 from leonelcamara/encodingpy2", "files_name": ["f29f1fa5d785f9b77791e007d298bba408398fb2 - Thu Dec 29 13:53:15 2022 +0000 : remove \\xa0 from german translations (just use space) Fixes #2451", "applications/welcome/languages/de.py"]}, {"commit_id": "f2403986712c4a1c8364a453634c590458de64d4", "commit_date": "Mon Dec 26 23:07:24 2022 -0800", "commit_message": "version 2.23.0", "files_name": ["Makefile", "VERSION", "gluon/packages/dal"]}, {"commit_id": "bf23642ae488b0cd1b6fc593cd3856d0a49eb9f4", "commit_date": "Fri Dec 23 16:18:38 2022 +0000", "commit_message": "Merge pull request #2450 from leonelcamara/fixes", "files_name": ["90e0d1881cffcc8a0abadbce28ddaa2fad24bcf3 - Fri Dec 23 14:08:19 2022 +0000 : prevent the admin from accessing files outside the applications folder", "applications/admin/controllers/default.py"]}, {"commit_id": "bd2c3efd15a577ec1c0fe89c5c5d753e565ffd4b", "commit_date": "Fri Dec 16 16:29:15 2022 +0000", "commit_message": "Fixes prevent_open_redirect dealing with a single slash after scheme instead of two", "files_name": ["gluon/tools.py"]}, {"commit_id": "926a8099a2ef6e02a58d0d56aa7e1aae4a1acfb9", "commit_date": "Tue Nov 8 16:51:36 2022 +0000", "commit_message": "Merge pull request #2448 from web2py/fix-migrations-with-weird-virtual-fields", "files_name": ["1621b70891357a78fc9f1ad088446a561bc6ae1d - Tue Nov 8 16:38:58 2022 +0000 : fix migrations with weird virtual fields", "scripts/migrator.py"]}, {"commit_id": "8a5feff83a0aabe61c8cee48a79d43d47beeccef", "commit_date": "Thu Nov 3 22:58:38 2022 -0700", "commit_message": "Merge pull request #2447 from jpsteil/patch-1", "files_name": ["39baf3317a6aeeb594287736a43cb1e26d7811ba - Thu Nov 3 22:58:23 2022 -0700 : Merge pull request #2445 from pci-dev/add_dkim_support_to_mails", "132705509b887fbcc93e08b72b2a77c99fd2a505 - Wed Oct 26 14:13:43 2022 -0500 : callable auth.settings.auth_two_factor_enabled", "gluon/tools.py"]}, {"commit_id": "95ccc41923f487e7140255cad9038fcdafcb0f1d", "commit_date": "Fri Jun 17 11:45:29 2022 +0200", "commit_message": "add dkim + list_unsubscribe to Mail.settings", "files_name": ["gluon/tools.py"]}, {"commit_id": "c1e00beb58288cf11bf2986858aedde5c2c12c51", "commit_date": "Fri Jun 17 11:44:21 2022 +0200", "commit_message": "add dkim + list_unsubscribe params to Mail.send()", "files_name": ["gluon/tools.py"]}, {"commit_id": "30fafceb5d1f3e420c963420514ac9ca8a895b9e", "commit_date": "Fri Jun 17 11:43:39 2022 +0200", "commit_message": "add dkim_sign() in gluon/tools.py", "files_name": ["gluon/tools.py"]}, {"commit_id": "b40b973264238792b759f6aae1651b35d17d74a6", "commit_date": "Sat Jun 4 11:11:51 2022 -0700", "commit_message": "v2.22.5", "files_name": ["Makefile", "VERSION", "gluon/tools.py"]}, {"commit_id": "a181b855a43cb8b479d276b082cfcde385768451", "commit_date": "Sat Jun 4 10:57:08 2022 -0700", "commit_message": "added validation of send attribute in admin", "files_name": ["applications/admin/controllers/default.py"]}, {"commit_id": "842994def40ca565aa954a13aa065d2da1090948", "commit_date": "Mon May 30 10:46:54 2022 -0700", "commit_message": "version 2.22.4 + pydal upgrade", "files_name": ["Makefile", "VERSION", "gluon/packages/dal"]}, {"commit_id": "26593a9ab4edca0b72b6a7703f6a27395e855334", "commit_date": "Mon May 30 10:21:22 2022 -0700", "commit_message": "removed old and unnecessary comment in readme, thanks boninj", "files_name": ["README.markdown"]}, {"commit_id": "748bc8aaae5c85c59066d6b5b2b87d85d4823449", "commit_date": "Mon May 30 10:19:19 2022 -0700", "commit_message": "Merge branch 'master' of github.com:web2py/web2py", "files_name": ["d9805606f88f00c0be56438247605cefde73e14e - Mon May 30 10:18:38 2022 -0700 : improved open redirect prevention", "gluon/digest.py", "gluon/form.py", "gluon/packages/dal", "gluon/tests/test_tools.py", "gluon/tools.py"]}, {"commit_id": "93297fed8a3a916b45d17f5c4d5d2b80aaf92788", "commit_date": "Mon Mar 21 00:21:21 2022 +0000", "commit_message": "Merge pull request #2437 from leonelcamara/master", "files_name": ["32cd7ee894d6acaa7fcff48376a5c0a62f7132ef - Sun Mar 20 23:45:50 2022 +0000 : Fix problem with gmail attachments", "gluon/tools.py"]}, {"commit_id": "00ae07a429b032f2ef3856f259aa0caaaa5767d7", "commit_date": "Fri Mar 18 17:04:20 2022 +0000", "commit_message": "Merge pull request #2436 from leonelcamara/master", "files_name": ["ac908f6795a5ee65e17aa1131a65a0bcb1de0b02 - Fri Mar 18 17:03:17 2022 +0000 : Merge pull request #1 from leonelcamara/leonelcamara-patch-1", "9feac8e52b745d17eda5ea138c15229a8545efa0 - Fri Mar 18 16:36:51 2022 +0000 : Fixes #2432", "gluon/html.py"]}, {"commit_id": "6d184b2535d8b0df9393d873582e0717f6984884", "commit_date": "Fri Feb 25 20:37:24 2022 +0000", "commit_message": "Merge pull request #2433 from timnyborg/patch-15", "files_name": ["4398a221c7ed446b5bd5c16d00e4490c9ce7f9fe - Fri Feb 25 20:12:57 2022 +0000 : use gluon._compat for easy py2 support", "gluon/contrib/simplejsonrpc.py"]}, {"commit_id": "65048b54a4a56a11d9ab87b019689d74429404b3", "commit_date": "Fri Feb 25 16:21:00 2022 +0000", "commit_message": "make simplejsonrpc compatible with python3.8+", "files_name": ["gluon/contrib/simplejsonrpc.py"]}, {"commit_id": "b14d799f1f38dd0ed3e79cf7f835d559a8818d9f", "commit_date": "Thu Feb 17 18:13:07 2022 +0000", "commit_message": "Merge pull request #2431 from web2py/leonelcamara-patch-2", "files_name": ["76d9b9f714af865fee772dabb564c87fb93d7717 - Thu Feb 17 18:06:23 2022 +0000 : Import reload from _compat so it works in py3", "applications/admin/controllers/default.py"]}, {"commit_id": "c820d25aa044dc528e864d3c285b844748bae6e9", "commit_date": "Wed Feb 16 21:32:10 2022 -0800", "commit_message": "Merge pull request #2430 from web2py/leonelcamara-patch-1", "files_name": ["66f043810600e7b5728eabb83d86ee19f19153d9 - Wed Feb 16 21:09:31 2022 +0000 : Fixes bug for filenames with = in the url", "gluon/rewrite.py"]}, {"commit_id": "9863a9386050f9b3ef3ff83ebbea2add3ec09386", "commit_date": "Tue Feb 15 07:08:12 2022 -0800", "commit_message": "version 2.22.3", "files_name": ["Makefile", "VERSION", "gluon/packages/dal"]}, {"commit_id": "95df12bc89b7154662038928e665008f4aca6adc", "commit_date": "Mon Feb 14 22:22:26 2022 -0800", "commit_message": "version 2.22.2", "files_name": ["Makefile", "VERSION", "gluon/packages/dal"]}, {"commit_id": "a7e6898074efa29ce14e12b2b6e50929dd261195", "commit_date": "Mon Feb 14 11:42:38 2022 +0000", "commit_message": "Merge pull request #2426 from leonelcamara/fix2425", "files_name": ["76516d01658eabd2e437bd36916e3c600f7b8a83 - Mon Feb 14 11:42:26 2022 +0000 : Merge pull request #2427 from leonelcamara/master", "f2a385f5aa86b4965ffdbbd47ccca2e369b57546 - Mon Feb 14 11:33:11 2022 +0000 : fix travis link", "README.markdown"]}, {"commit_id": "97a71ba592cfb6c9b420defe3ad8500fb46c8ba0", "commit_date": "Mon Feb 14 11:17:58 2022 +0000", "commit_message": "update pydal", "files_name": ["gluon/packages/dal"]}, {"commit_id": "dff6ad874f18ed85f814c341475dc6aafdbfa624", "commit_date": "Mon Feb 14 11:12:22 2022 +0000", "commit_message": "Fixes #2425", "files_name": ["applications/admin/controllers/default.py", "applications/admin/languages/pt.py"]}, {"commit_id": "70bd81412ec9ad2387f1386e402b37ce6b57b4ad", "commit_date": "Mon Feb 7 22:05:40 2022 -0800", "commit_message": "Merge pull request #2423 from leonelcamara/fix_travis", "files_name": ["0d120d719ed1e972db322c45ba2998b79da15b6c - Mon Feb 7 22:05:09 2022 -0800 : Merge pull request #2422 from leonelcamara/master", "4940dded1e956375496f2d3f4f31e34cc08b7d27 - Mon Feb 7 13:18:09 2022 +0000 : fix copyreg import for python2", "gluon/cache.py"]}, {"commit_id": "5ca54bd797e369296cc0598fea563d243330ddce", "commit_date": "Mon Feb 7 13:08:43 2022 +0000", "commit_message": "fix copyreg import for python2", "files_name": ["gluon/cache.py"]}, {"commit_id": "f8f1ca8379e697e835647735c581ae7ac7e5ba3d", "commit_date": "Mon Feb 7 12:16:18 2022 +0000", "commit_message": "minor: is should be ==", "files_name": ["gluon/tests/test_appadmin.py"]}, {"commit_id": "50e10d67798efe1e544600810a1f4da44f727370", "commit_date": "Mon Feb 7 12:15:00 2022 +0000", "commit_message": "temporary fix for pickling rows", "files_name": ["gluon/cache.py"]}, {"commit_id": "dbf731d11f5023f571a224b7bb3faceac691d63f", "commit_date": "Thu Feb 3 14:09:05 2022 +0000", "commit_message": "Fix reply_to broken when only a string, broken in 0e788d396509f931fc81e1f2a216ecae8089d0cf", "files_name": ["gluon/tools.py"]}, {"commit_id": "49ed5283bb060d5bda2abb9b6038443759fd67a6", "commit_date": "Thu Feb 3 11:10:34 2022 +0000", "commit_message": "update dal", "files_name": ["gluon/packages/dal"]}, {"commit_id": "613e0af162656b2e200223ce2d49b403504e5c6e", "commit_date": "Sat Jan 29 10:04:15 2022 -0800", "commit_message": "version 2.22.1", "files_name": ["Makefile", "VERSION"]}, {"commit_id": "50d5b0b1513a66a84ea231f7711adc995dfd90a1", "commit_date": "Sat Jan 29 10:01:57 2022 -0800", "commit_message": "new pydal and new yatl", "files_name": ["gluon/packages/dal", "gluon/packages/yatl"]}, {"commit_id": "34ae29a48f8fa6f8e5b31bd419734d45dbc8a9c6", "commit_date": "Sat Jan 29 09:59:53 2022 -0800", "commit_message": "Merge pull request #2419 from leonelcamara/patch-36", "files_name": ["0da1bf69da83a2d9d554b8ef9596397ab198a4c6 - Sat Jan 29 09:59:34 2022 -0800 : Merge pull request #2416 from pci-dev/master", "5a9646b8e0265463696d097d2ed042051a2989e1 - Sat Jan 29 09:59:14 2022 -0800 : Merge pull request #2412 from zidingz/patch-1", "db6d57a849b439fea10bdcfc808e742b6dfd0c63 - Tue Jan 11 14:48:32 2022 +0000 : Fix unique_key check w/ type bytes"]}], "windows_after": [{"commit_id": "07e4ab17115e92366c7734101f6e395a0fae7d2e", "commit_date": "Sun Oct 8 11:39:17 2023 -0700", "commit_message": "version 2.24.1", "files_name": ["Makefile", "VERSION"]}, {"commit_id": "e7868f57cc36e4c4a0206038a61cbf99b945f607", "commit_date": "Sun Oct 8 14:04:28 2023 -0700", "commit_message": "Fix scheduler breaking with unstable DB connections. Fixes #2465 #2466, thanks Leonel and Niphlod", "files_name": ["gluon/scheduler.py"]}, {"commit_id": "175b93a86a7ec2f63e3819bbe1227e004a339463", "commit_date": "Sun Oct 8 14:12:27 2023 -0700", "commit_message": "black + isort", "files_name": ["gluon/__init__.py", "gluon/admin.py", "gluon/authapi.py", "gluon/cache.py", "gluon/cfs.py", "gluon/compileapp.py", "gluon/console.py", "gluon/contenttype.py", "gluon/custom_import.py", "gluon/dal.py", "gluon/debug.py", "gluon/decoder.py", "gluon/digest.py", "gluon/fileutils.py", "gluon/form.py", "gluon/globals.py", "gluon/highlight.py", "gluon/html.py", "gluon/http.py", "gluon/import_all.py", "gluon/languages.py", "gluon/main.py", "gluon/messageboxhandler.py", "gluon/newcron.py", "gluon/recfile.py", "gluon/restricted.py", "gluon/rewrite.py", "gluon/rocket.py", "gluon/scheduler.py", "gluon/serializers.py", "gluon/settings.py", "gluon/shell.py", "gluon/sql.py", "gluon/sqlhtml.py", "gluon/storage.py", "gluon/streamer.py", "gluon/template.py", "gluon/tests/__init__.py", "gluon/tests/fix_path.py", "gluon/tests/test_appadmin.py", "gluon/tests/test_authapi.py", "gluon/tests/test_cache.py", "gluon/tests/test_compileapp.py", "gluon/tests/test_contenttype.py", "gluon/tests/test_contribs.py", "gluon/tests/test_cron.py", "gluon/tests/test_dal.py", "gluon/tests/test_fileutils.py", "gluon/tests/test_globals.py", "gluon/tests/test_html.py", "gluon/tests/test_http.py", "gluon/tests/test_languages.py", "gluon/tests/test_old_doctests.py", "gluon/tests/test_recfile.py", "gluon/tests/test_redis.py", "gluon/tests/test_router.py", "gluon/tests/test_routes.py", "gluon/tests/test_scheduler.py", "gluon/tests/test_serializers.py", "gluon/tests/test_sqlhtml.py", "gluon/tests/test_storage.py", "gluon/tests/test_tools.py", "gluon/tests/test_utils.py", "gluon/tests/test_web.py", "gluon/tools.py", "gluon/utf8.py", "gluon/utils.py", "gluon/validators.py", "gluon/widget.py", "gluon/xmlrpc.py"]}, {"commit_id": "04efe9be255030e0de86f3a1cc61c6f558168b5e", "commit_date": "Sun Oct 8 16:03:14 2023 -0700", "commit_message": "fixed absdir->abspath, thanks Leonel", "files_name": ["gluon/shell.py"]}, {"commit_id": "020c7bafba5ab7c6980c3fe2357237f6760f1a22", "commit_date": "Tue Oct 10 16:22:22 2023 +0900", "commit_message": "fix circular import", "files_name": ["gluon/__init__.py"]}, {"commit_id": "0b2afe2b8414bfe741834c32fba005fe2f12e160", "commit_date": "Tue Oct 10 10:12:33 2023 +0100", "commit_message": "Merge pull request #2476 from Piiman/master", "files_name": ["14fcb448bc06796bdc0aa2470df622b3402945c0 - Wed Oct 25 22:41:12 2023 -0700 : fixed invalid headers, thanks Carlos", "gluon/cache.py", "gluon/streamer.py"]}, {"commit_id": "1e5b150a5f92ba77c367b6f0d2ac146db22e5309", "commit_date": "Wed Oct 25 23:44:46 2023 -0700", "commit_message": "fixed headers serialization to strings", "files_name": ["gluon/http.py"]}, {"commit_id": "3d6499ff08196b2463d9f742abd3b2f19305e88e", "commit_date": "Sun Oct 29 14:02:09 2023 -0700", "commit_message": "version 2.26.1", "files_name": ["Makefile", "VERSION"]}, {"commit_id": "ad5cbbfdfacdcd3b4663e91a638de022d6e20477", "commit_date": "Mon Nov 6 00:17:20 2023 -0600", "commit_message": "fix regexen and classname", "files_name": ["applications/admin/controllers/default.py", "gluon/compileapp.py", "gluon/contrib/appconfig.py"]}, {"commit_id": "804d1901ecd8d872a0c9cb46c40b8774e275c726", "commit_date": "Wed Nov 8 21:41:27 2023 -0800", "commit_message": "Merge pull request #2479 from eevelweezel/python312", "files_name": ["8804ebea118250f2e7e33284b250f341222af420 - Wed Nov 15 22:23:31 2023 -0800 : removed broken twitter timeline", "applications/admin/views/default/site.html", "applications/admin/views/default/twitter.load"]}, {"commit_id": "8d7d029ffe7384ee56167bd0597106fe3bde85b5", "commit_date": "Wed Nov 15 23:27:16 2023 -0800", "commit_message": "version 2.27.1, added python3.11 support, linting, and formatting", "files_name": ["CHANGELOG", "Makefile", "VERSION", "gluon/__init__.py", "gluon/authapi.py", "gluon/compileapp.py", "gluon/console.py", "gluon/fileutils.py", "gluon/form.py", "gluon/globals.py", "gluon/highlight.py", "gluon/html.py", "gluon/main.py", "gluon/newcron.py", "gluon/rewrite.py", "gluon/rocket.py", "gluon/scheduler.py", "gluon/shell.py", "gluon/sqlhtml.py", "gluon/tests/test_cache.py", "gluon/tests/test_globals.py", "gluon/tests/test_html.py", "gluon/tests/test_old_doctests.py", "gluon/tests/test_scheduler.py", "gluon/tests/test_utils.py", "gluon/tools.py", "gluon/widget.py"]}, {"commit_id": "49bb23c4676ce7464d1b643e2cf76c5db227b7bc", "commit_date": "Sun Nov 19 19:50:24 2023 -0800", "commit_message": "fixed a caching issue on py2.7 and simplication of some utf8.py logic that prebably should be deprecated", "files_name": ["gluon/cache.py", "gluon/compileapp.py", "gluon/tests/__init__.py", "gluon/tests/temporary_directory.py", "gluon/tests/test_cache.py", "gluon/utf8.py"]}], "parents": [{"commit_id_before": "38f44f7bd5d009f3905058d1c5f926b391aeccb9", "url_before": "https://api.github.com/repos/web2py/web2py/commits/38f44f7bd5d009f3905058d1c5f926b391aeccb9", "html_url_before": "https://github.com/web2py/web2py/commit/38f44f7bd5d009f3905058d1c5f926b391aeccb9"}], "details": [{"raw_url": "https://github.com/web2py/web2py/raw/936e2260b0c34c44e2f3674a893e96d2a7fad0a3/gluon%2Fmessageboxhandler.py", "code": "import logging\nimport sys\nimport subprocess\n\ntry:\n    if sys.version_info[0] == 2:\n        import Tkinter as tkinter\n    else:\n        import tkinter\nexcept ImportError:\n    tkinter = None\n\n\nclass MessageBoxHandler(logging.Handler):\n    def __init__(self):\n        logging.Handler.__init__(self)\n\n    def emit(self, record):\n        if tkinter:\n            msg = self.format(record)\n            root = tkinter.Tk()\n            root.wm_title(\"web2py logger message\")\n            text = tkinter.Text()\n            text[\"height\"] = 12\n            text.insert(0.1, msg)\n            text.pack()\n            button = tkinter.Button(root, text=\"OK\", command=root.destroy)\n            button.pack()\n            root.mainloop()\n\n\nclass NotifySendHandler(logging.Handler):\n    def __init__(self):\n        logging.Handler.__init__(self)\n\n    def emit(self, record):\n        if tkinter:\n            msg = self.format(record)\n            subprocess.run([\"notify-send\", msg], check=False, timeout=2)\n", "code_before": "import logging\nimport os\nimport sys\n\ntry:\n    if sys.version_info[0] == 2:\n        import Tkinter as tkinter\n    else:\n        import tkinter\nexcept ImportError:\n    tkinter = None\n\n\nclass MessageBoxHandler(logging.Handler):\n    def __init__(self):\n        logging.Handler.__init__(self)\n\n    def emit(self, record):\n        if tkinter:\n            msg = self.format(record)\n            root = tkinter.Tk()\n            root.wm_title(\"web2py logger message\")\n            text = tkinter.Text()\n            text[\"height\"] = 12\n            text.insert(0.1, msg)\n            text.pack()\n            button = tkinter.Button(root, text=\"OK\", command=root.destroy)\n            button.pack()\n            root.mainloop()\n\n\nclass NotifySendHandler(logging.Handler):\n    def __init__(self):\n        logging.Handler.__init__(self)\n\n    def emit(self, record):\n        if tkinter:\n            msg = self.format(record)\n            os.system(\"notify-send '%s'\" % msg)\n", "patch": "@@ -1,6 +1,6 @@\n import logging\n-import os\n import sys\n+import subprocess\n \n try:\n     if sys.version_info[0] == 2:\n@@ -36,4 +36,4 @@ def __init__(self):\n     def emit(self, record):\n         if tkinter:\n             msg = self.format(record)\n-            os.system(\"notify-send '%s'\" % msg)\n+            subprocess.run([\"notify-send\", msg], check=False, timeout=2)", "file_path": "files/2023_10/826", "file_language": "py", "file_name": "gluon/messageboxhandler.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0, "llm_check": 1, "static_check": 1, "static": {"rats": [true, ["/data/rdhu/other/Static/tmp/2023_10_826.py:39: High: system\n            os.system(\"notify-send '%s'\" % msg)\nArgument 1 to this function call should be checked to ensure that it does not\ncome from an untrusted source without first verifying that it contains nothing\ndangerous."]], "semgrep": [false, []]}, "target": 1, "function_before": [{"function": "class MessageBoxHandler(logging.Handler):\n    def __init__(self):\n        logging.Handler.__init__(self)\n\n    def emit(self, record):\n        if tkinter:\n            msg = self.format(record)\n            root = tkinter.Tk()\n            root.wm_title(\"web2py logger message\")\n            text = tkinter.Text()\n            text[\"height\"] = 12\n            text.insert(0.1, msg)\n            text.pack()\n            button = tkinter.Button(root, text=\"OK\", command=root.destroy)\n            button.pack()\n            root.mainloop()", "target": 0}, {"function": "class NotifySendHandler(logging.Handler):\n    def __init__(self):\n        logging.Handler.__init__(self)\n\n    def emit(self, record):\n        if tkinter:\n            msg = self.format(record)\n            os.system(\"notify-send '%s'\" % msg)", "target": 1, "line": "@@  -36,4 +36,4  @@ def __init__(self):\n     def emit(self, record):\n         if tkinter:\n             msg = self.format(record)\n-            os.system(\"notify-send '%s'\" % msg)\n+            subprocess.run([\"notify-send\", msg], check=False, timeout=2)"}], "function_after": [{"function": "class MessageBoxHandler(logging.Handler):\n    def __init__(self):\n        logging.Handler.__init__(self)\n\n    def emit(self, record):\n        if tkinter:\n            msg = self.format(record)\n            root = tkinter.Tk()\n            root.wm_title(\"web2py logger message\")\n            text = tkinter.Text()\n            text[\"height\"] = 12\n            text.insert(0.1, msg)\n            text.pack()\n            button = tkinter.Button(root, text=\"OK\", command=root.destroy)\n            button.pack()\n            root.mainloop()", "target": 0}, {"function": "class NotifySendHandler(logging.Handler):\n    def __init__(self):\n        logging.Handler.__init__(self)\n\n    def emit(self, record):\n        if tkinter:\n            msg = self.format(record)\n            subprocess.run([\"notify-send\", msg], check=False, timeout=2)", "target": 0}]}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
