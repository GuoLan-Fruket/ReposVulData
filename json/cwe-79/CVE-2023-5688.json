{"index": 12510, "cve_id": "CVE-2023-5688", "cwe_id": ["CWE-79"], "cve_language": "Python", "cve_description": "Cross-site Scripting (XSS) - DOM in GitHub repository modoboa/modoboa prior to 2.2.2.", "cvss": "5.4", "publish_date": "October 20, 2023", "AV": "NETWORK", "AC": "NETWORK", "PR": "LOW", "UI": "REQUIRED", "S": "CHANGED", "C": "LOW", "I": "LOW", "A": "NONE", "commit_id": "d33d3cd2d11dbfebd8162c46e2c2a9873919a967", "commit_message": "Merge pull request #3095 from modoboa/fix/xss_profile_form\n\nFixed XSS vulnerability when displaying form error messages.", "commit_date": "2023-10-19T07:44:47Z", "project": "modoboa/modoboa", "url": "https://api.github.com/repos/modoboa/modoboa/commits/d33d3cd2d11dbfebd8162c46e2c2a9873919a967", "html_url": "https://github.com/modoboa/modoboa/commit/d33d3cd2d11dbfebd8162c46e2c2a9873919a967", "windows_before": [{"commit_id": "6f25ad8ffac4be925fca4cb1d189b59f204803de", "commit_date": "Wed Oct 18 17:31:24 2023 +0000", "commit_message": "Translate djangojs.po in es", "files_name": ["modoboa/locale/es/LC_MESSAGES/djangojs.po"]}, {"commit_id": "a9fff5d37de7c166ce8b098c5b8dccac45c04854", "commit_date": "Wed Oct 18 17:30:54 2023 +0000", "commit_message": "Translate djangojs.po in es", "files_name": ["modoboa/locale/es/LC_MESSAGES/djangojs.po"]}, {"commit_id": "9588d5280a5f8ce2c0f46c711b773cd9d196de46", "commit_date": "Wed Oct 18 17:30:20 2023 +0000", "commit_message": "Translate djangojs.po in es", "files_name": ["modoboa/locale/es/LC_MESSAGES/djangojs.po"]}, {"commit_id": "e13b529a13620b744cf4fdbe649bb9996afbfac4", "commit_date": "Wed Oct 18 17:29:19 2023 +0000", "commit_message": "Translate djangojs.po in es", "files_name": ["modoboa/locale/es/LC_MESSAGES/djangojs.po"]}, {"commit_id": "6b3911e36184cac5b3824fdbcafad9cab43c4199", "commit_date": "Wed Oct 18 17:29:02 2023 +0000", "commit_message": "Translate djangojs.po in es", "files_name": ["modoboa/locale/es/LC_MESSAGES/djangojs.po"]}, {"commit_id": "540b27a2319c41682155754dacd7625946f33359", "commit_date": "Wed Oct 18 12:16:25 2023 +0200", "commit_message": "Fixed regression.", "files_name": ["modoboa/static/js/twocols_nav.js"]}, {"commit_id": "9adc879c9db54c16c84edb30029e025ef4184efe", "commit_date": "Wed Oct 18 08:34:03 2023 +0000", "commit_message": "Bump @babel/traverse from 7.19.1 to 7.23.2 in /frontend", "files_name": ["frontend/yarn.lock"]}, {"commit_id": "1bf2932f666802df0911ca3a494ab7b2f09a8982", "commit_date": "Tue Oct 17 15:28:33 2023 +0200", "commit_message": "Merge pull request #3094 from modoboa/doc-update", "files_name": ["6fdb077ca51407162109c9ed0d97882d7c7138eb - Tue Oct 17 15:25:45 2023 +0200 : Fixed XSS vulnerability when displaying form error messages.", "modoboa/templates/common/generic_field.html"]}, {"commit_id": "23e4c25511c66c0548da001236f47e19e3f9e4d9", "commit_date": "Tue Oct 17 15:06:30 2023 +0200", "commit_message": "Merge pull request #3090 from modoboa/fix/csrf_issue_logout", "files_name": ["dc05a3b9a798e426a569c5d91f6e4bbf19b9a758 - Tue Oct 17 12:23:06 2023 +0200 : doc", "doc/installation.rst", "doc/upgrade.rst"]}, {"commit_id": "130e0bf0fa2621b1e6eefa024f3a527b0aba9059", "commit_date": "Mon Oct 16 09:10:59 2023 +0200", "commit_message": "Fixed typo", "files_name": ["modoboa/lib/templatetags/lib_tags.py"]}, {"commit_id": "2d33d34279566932b293d3407be6823fc1d7219f", "commit_date": "Fri Oct 13 16:43:51 2023 +0200", "commit_message": "Fixed CSRF vulnerability on logout view", "files_name": ["modoboa/core/templatetags/core_tags.py", "modoboa/core/views/auth.py", "modoboa/lib/templatetags/lib_tags.py", "modoboa/static/css/custom.css", "modoboa/templates/common/menulist.html", "modoboa/templates/nlayout.html"]}, {"commit_id": "da18e4370ff834721f97aefb63f40225a0b14131", "commit_date": "Mon Oct 9 14:20:32 2023 +0200", "commit_message": "Merge pull request #3077 from modoboa/translations_4a510eeff6e480919e943d31202948bd_zh_CN", "files_name": ["99cd996e8cdb2c4a7b5caa9c1cff6fecebb20c8b - Mon Oct 9 14:16:37 2023 +0200 : Merge pull request #3086 from modoboa/dependabot/pip/django-otp-1.2.4", "792dcc7ab933ac453e4a5fb71791909230038fb0 - Mon Oct 9 11:58:00 2023 +0000 : Bump django-otp from 1.2.3 to 1.2.4", "requirements.txt"]}, {"commit_id": "a430f33fca9eb5545d18d67388617f38eb217ab7", "commit_date": "Mon Oct 9 13:56:14 2023 +0200", "commit_message": "Merge pull request #3084 from modoboa/dependabot/pip/django-phonenumber-field-phonenumbers--7.2.0", "files_name": ["d1039b66288c4c95b8d0bdd37a9e04a7e15a4ccd - Mon Oct 9 11:34:57 2023 +0000 : Bump django-phonenumber-field[phonenumbers] from 7.1.0 to 7.2.0", "requirements.txt"]}, {"commit_id": "0101a4180de0b79fb6394ea831562e4221cfc499", "commit_date": "Mon Oct 9 13:33:27 2023 +0200", "commit_message": "Merge pull request #3080 from modoboa/dependabot/pip/django-reversion-5.0.6", "files_name": ["dd05dff371e4fb874eb55db7220978bb5b4fc727 - Mon Oct 9 13:33:08 2023 +0200 : Merge pull request #3075 from modoboa/dependabot/npm_and_yarn/frontend/get-func-name-2.0.2", "305b080259ab635855503db829b0ed2b5f368e34 - Fri Oct 6 15:20:20 2023 +0800 : to avoid CSRF error due to multiple click", "modoboa/templates/registration/login.html"]}, {"commit_id": "051dba771ad85d62e77332945555a6850790ff59", "commit_date": "Mon Oct 2 12:31:11 2023 +0000", "commit_message": "Bump django-reversion from 5.0.4 to 5.0.6", "files_name": ["requirements.txt"]}, {"commit_id": "ec551f98a0383ee6e899b99b04bfd3d3e8cd9b09", "commit_date": "Sat Sep 30 07:56:11 2023 +0000", "commit_message": "Translate djangojs.po in zh_CN", "files_name": ["modoboa/locale/zh_CN/LC_MESSAGES/djangojs.po"]}, {"commit_id": "46a524278211afc6d34c47a1a21b4e928a6ec63a", "commit_date": "Thu Sep 28 14:31:24 2023 +0200", "commit_message": "Merge pull request #3061 from modoboa/few-fixes", "files_name": ["9979a4f449e84ee8377c96000d7fa65361a63e10 - Thu Sep 28 13:35:54 2023 +0200 : Fixed wrong property name", "frontend/src/components/domains/DomainSummary.vue"]}, {"commit_id": "c29988ba594bb009a70381af6675e7a0fd4e7098", "commit_date": "Wed Sep 27 21:34:38 2023 +0000", "commit_message": "Bump get-func-name from 2.0.0 to 2.0.2 in /frontend", "files_name": ["frontend/yarn.lock"]}, {"commit_id": "fa2b1423dbdcd76d367a1be49c4d558d81acb39c", "commit_date": "Thu Sep 21 17:11:04 2023 +0200", "commit_message": "Merge pull request #3067 from modoboa/dependabot/pip/django-otp-1.2.3", "files_name": ["5009dca28b2546c43c733f5582641a90314d729a - Thu Sep 21 07:38:44 2023 +0000 : Bump django-otp from 1.2.2 to 1.2.3", "requirements.txt"]}, {"commit_id": "55c7eae4c667bb7c937f6f56d66c2da35b9b8d3a", "commit_date": "Thu Sep 21 09:38:09 2023 +0200", "commit_message": "Merge pull request #3065 from modoboa/dependabot/pip/testfixtures-7.2.0", "files_name": ["8c9c69c016ef6fa0c2aaeb4b3e35ee024178aca5 - Thu Sep 21 09:37:51 2023 +0200 : Merge pull request #3063 from modoboa/dependabot/pip/gevent-23.9.1", "ec8ca64ccd4ab731ff5c936cf6cabe6def7bd5db - Fri Sep 15 12:53:30 2023 +0000 : Bump testfixtures from 7.1.0 to 7.2.0", "test-requirements.txt"]}, {"commit_id": "776292ad980faccf6ca5841432709bb33bb3e20b", "commit_date": "Wed Sep 13 12:47:26 2023 +0000", "commit_message": "Bump gevent from 23.9.0.post1 to 23.9.1", "files_name": ["requirements.txt"]}, {"commit_id": "6c059710ced4eb524a5401fc8a6905d7972dc877", "commit_date": "Wed Sep 13 11:41:48 2023 +0200", "commit_message": "Updated test", "files_name": ["modoboa/admin/tests/test_domain.py"]}, {"commit_id": "2b6dae2844af94ff8715543ac48c4fe8b227f140", "commit_date": "Wed Sep 13 11:17:32 2023 +0200", "commit_message": "increased coverage", "files_name": ["modoboa/admin/api/v1/tests.py", "modoboa/admin/tests/test_domain.py"]}, {"commit_id": "82a06a1eff77582efe57f284c1391ca9d931ea6c", "commit_date": "Tue Sep 12 19:34:21 2023 +0200", "commit_message": "Fixed test, fixed review", "files_name": ["frontend/src/components/identities/AccountCreationForm.vue", "frontend/src/components/identities/AccountForm.vue", "frontend/src/components/identities/AccountRoleForm.vue", "modoboa/pdfcredentials/handlers.py", "modoboa/pdfcredentials/lib.py", "modoboa/pdfcredentials/tests/test_views.py"]}, {"commit_id": "bd055adc75e0fe511a19c1362b81024060e89ea7", "commit_date": "Mon Sep 11 18:11:11 2023 +0200", "commit_message": "Fixed dkim option not updating, general dkim management improvement", "files_name": ["frontend/src/components/domains/DNSDetail.vue", "frontend/src/components/domains/DomainDNSForm.vue", "modoboa/admin/api/v1/serializers.py", "modoboa/admin/api/v1/viewsets.py", "modoboa/admin/forms/domain.py", "modoboa/admin/management/commands/subcommands/_manage_dkim_keys.py", "modoboa/admin/signals.py"]}, {"commit_id": "c8331208ccd1f48c1155ec1c9395004739d02052", "commit_date": "Mon Sep 11 17:38:34 2023 +0200", "commit_message": "Fixed settings option not loading when reloading the page", "files_name": [".gitignore", "frontend/src/App.vue", "frontend/src/components/layout/Navbar.vue"]}, {"commit_id": "ed074c67537ecf180af1b5fadea435915ee36af1", "commit_date": "Wed Sep 6 10:23:46 2023 +0200", "commit_message": "Merge pull request #3059 from modoboa/dependabot/pip/gevent-23.9.0.post1", "files_name": ["ce0d26d99c1c5c3b0c718a5f63f6a034cce9106c - Mon Sep 4 12:44:18 2023 +0000 : Bump gevent from 23.7.0 to 23.9.0.post1", "requirements.txt"]}, {"commit_id": "6eb31677e87f7263a5c54d10894f2742c7939bb1", "commit_date": "Fri Sep 1 16:17:56 2023 +0200", "commit_message": "Better quota display when not restricted", "files_name": ["frontend/src/components/domains/DomainSummary.vue", "frontend/src/components/identities/AccountSummary.vue"]}, {"commit_id": "5b6a9d3ecc8071813d3c6c46da146faaba44ef7c", "commit_date": "Fri Sep 1 16:03:04 2023 +0200", "commit_message": "Improved Resources and role selection for accounts", "files_name": ["frontend/src/components/identities/AccountCreationForm.vue", "frontend/src/components/identities/AccountForm.vue", "frontend/src/components/identities/AccountRoleForm.vue"]}, {"commit_id": "6258f85a54062ad1be804c62d2af54f33d6d2ce9", "commit_date": "Fri Sep 1 13:31:49 2023 +0200", "commit_message": "Fixed message_limit issue on domains", "files_name": ["frontend/src/components/domains/DomainCreationForm.vue", "frontend/src/components/domains/DomainForm.vue", "frontend/src/components/domains/DomainLimitationsForm.vue"]}, {"commit_id": "1794ec9febf355df89313c3e1942d6f3c236b9e2", "commit_date": "Fri Sep 1 13:31:30 2023 +0200", "commit_message": "Fixed pdfcrendtials preventing login", "files_name": ["modoboa/pdfcredentials/handlers.py", "modoboa/pdfcredentials/lib.py", "pyproject.toml"]}, {"commit_id": "6e35130849fe4efdf61dc66b337c54318a1051d8", "commit_date": "Wed Aug 30 18:32:29 2023 +0200", "commit_message": "Merge pull request #3053 from modoboa/doc-2-2", "files_name": ["54e7d7e88892cdae2da85334ffeb83d67dd67cab - Wed Aug 30 11:01:29 2023 +0200 : updated doc", "doc/manual_installation/dovecot.rst", "doc/manual_installation/modoboa.rst", "doc/upgrade.rst"]}, {"commit_id": "df699aab0799ec1725b6b89be38e56285821c889", "commit_date": "Tue Aug 29 15:22:14 2023 +0200", "commit_message": "Merge pull request #3051 from modoboa/fix/superadmin_creation", "files_name": ["8e4cdd917c20b33222667d0647be7e083a0b0f0e - Tue Aug 29 14:40:23 2023 +0200 : Do not display mailbox related steps is superadmin", "frontend/src/components/identities/AccountCreationForm.vue"]}, {"commit_id": "a50c887c1865ce4aeb90eb01be432e8c9eb52bb7", "commit_date": "Tue Aug 29 13:35:07 2023 +0200", "commit_message": "Fixed issue with error display", "files_name": ["frontend/src/components/identities/AccountGeneralForm.vue"]}, {"commit_id": "daced402f9a01c5ab149bfbd3b8331820ac2e4cb", "commit_date": "Tue Aug 29 11:51:46 2023 +0200", "commit_message": "Fixed creation of superadmin with new UI", "files_name": ["frontend/src/components/identities/AccountCreationForm.vue", "frontend/src/components/identities/AccountGeneralForm.vue", "frontend/src/components/identities/AccountPasswordForm.vue", "frontend/src/mixins/importExport.js"]}, {"commit_id": "76989860d33aeb96b7bf4098c8ce3576dd0278bc", "commit_date": "Tue Aug 29 09:03:36 2023 +0200", "commit_message": "Merge pull request #3033 from modoboa/doc-impro", "files_name": ["08f9251eda011416bf84743f626c6b927239794a - Mon Aug 28 16:01:13 2023 +0200 : Fixed syntax issue", "doc/upgrade.rst"]}, {"commit_id": "2c4d32217a6e395afe272a3a3fdaaaa449f00da1", "commit_date": "Mon Aug 28 14:48:44 2023 +0200", "commit_message": "Modified theme for readthedoc", "files_name": ["doc/conf.py", "doc/requirements.txt"]}, {"commit_id": "244b03bf36868001f8f0303bf19d3a2662989010", "commit_date": "Fri Aug 4 21:39:54 2023 +0200", "commit_message": "Few fixes, updated with send-only", "files_name": ["doc/manual_installation/dovecot.rst", "doc/manual_installation/modoboa.rst", "doc/manual_installation/webserver.rst"]}, {"commit_id": "72dc443d3cfcc59190f1ad9957d9664ff671e85f", "commit_date": "Thu May 25 11:13:29 2023 +0200", "commit_message": "few changes", "files_name": ["doc/installation.rst", "doc/manual_installation/dovecot.rst", "doc/manual_installation/modoboa.rst", "doc/manual_installation/postfix.rst", "doc/manual_installation/webserver.rst"]}, {"commit_id": "e4df2b7eed114dfbdd81570dc9a700c9853cc0ef", "commit_date": "Mon Aug 28 14:26:35 2023 +0200", "commit_message": "Merge pull request #3039 from modoboa/improved-csv-import", "files_name": ["6f0fc470db50d5235fd1fcefeaebe2e599e68492 - Mon Aug 28 10:52:52 2023 +0200 : Few improvements", "modoboa/admin/api/v2/serializers.py", "modoboa/admin/models/alias.py"]}, {"commit_id": "15d6c8e83d3fcdb667c6a787e2a4d2ac815d5228", "commit_date": "Mon Aug 28 09:05:32 2023 +0200", "commit_message": "Merge pull request #3046 from modoboa/fix/internal_alias_mistake", "files_name": ["f4b473f9de6fd9a10d17ba789307970f13b76c8a - Sun Aug 27 12:13:01 2023 +0200 : Fixed alias, fixed urls.py", "modoboa/admin/api/v2/serializers.py", "modoboa/admin/models/alias.py", "modoboa/core/commands/templates/urls.py.tpl", "modoboa/core/extensions.py"]}, {"commit_id": "5905198cac71c6886d548a31bf2d9daa0e34c954", "commit_date": "Sun Aug 27 11:32:43 2023 +0200", "commit_message": "Refactoring", "files_name": ["frontend/src/mixins/importExport.js", "modoboa/admin/api/v2/serializers.py", "modoboa/admin/models/__init__.py", "modoboa/admin/models/alias.py"]}, {"commit_id": "365a97edccf5617d77124ffdfa4589b313d6c7cf", "commit_date": "Wed Aug 9 00:11:24 2023 +0200", "commit_message": "Improved test, removed unused block", "files_name": ["modoboa/admin/management/commands/subcommands/_import.py", "modoboa/admin/tests/test_data/import_aliases.csv"]}, {"commit_id": "900359988a246871c653d2051b32330d94877606", "commit_date": "Mon Aug 7 00:12:36 2023 +0200", "commit_message": "Added csv alias import test", "files_name": ["modoboa/admin/models/alias.py", "modoboa/admin/tests/test_data/import_aliases.csv"]}], "windows_after": [{"commit_id": "7cbe4b77722a353a73569b2ec53ca3db0a2776e4", "commit_date": "Fri Oct 20 15:10:46 2023 +0200", "commit_message": "Merge pull request #3099 from modoboa/dependabot/pip/testfixtures-7.2.2", "files_name": ["4c281b4ab586c93aea73052ff8cd15e6f3ec9273 - Thu Oct 26 14:48:21 2023 +0000 : Translate app.po in sv", "frontend/locale/sv/LC_MESSAGES/app.po"]}, {"commit_id": "f837bc44224a473799b7f1596f9fd60401667eba", "commit_date": "Thu Oct 26 14:49:23 2023 +0000", "commit_message": "Translate app.po in sv", "files_name": ["frontend/locale/sv/LC_MESSAGES/app.po"]}, {"commit_id": "cd85b5a725f8b20ec299d74cde98477488c8b418", "commit_date": "Fri Oct 27 08:57:36 2023 +0200", "commit_message": "Merge pull request #3109 from modoboa/translations_dd3efdd3873dc96e90015e1ebbcf2a08_sv", "files_name": ["b4a22c91154b8264b2ba491f210de2bcc3658d2f - Thu Nov 9 12:30:48 2023 +0000 : Bump django-otp from 1.2.4 to 1.3.0", "requirements.txt"]}, {"commit_id": "258c14ac8ba94fd15913ada8c9059429d1d28532", "commit_date": "Thu Nov 9 15:22:37 2023 +0100", "commit_message": "Merge pull request #3117 from modoboa/dependabot/pip/django-otp-1.3.0", "files_name": ["4e46cf2d3531996183aff4047dbabf8f956b6b1b - Thu Nov 9 14:24:09 2023 +0000 : Bump django-reversion from 5.0.6 to 5.0.8", "requirements.txt"]}, {"commit_id": "03d35d3ca3632eb26324064a03e408e0f088bae3", "commit_date": "Fri Nov 10 10:30:37 2023 +0100", "commit_message": "Merge pull request #3118 from modoboa/dependabot/pip/django-reversion-5.0.8", "files_name": ["9463e19c305d24dfa95b71196a3b1e8aa82615c2 - Fri Nov 10 09:31:05 2023 +0000 : Bump axios from 0.21.4 to 1.6.0 in /frontend", "frontend/package.json", "frontend/yarn.lock"]}, {"commit_id": "7db168e6e59a348e05d2e9b89101d08aaea07b08", "commit_date": "Fri Nov 10 11:52:57 2023 +0100", "commit_message": "Merge pull request #3119 from modoboa/dependabot/npm_and_yarn/frontend/axios-1.6.0", "files_name": ["769d148f80277374ca7067ef2f6ded0147cf7ae4 - Sat Nov 11 17:26:45 2023 +0000 : Translate django.po in sv", "modoboa/locale/sv/LC_MESSAGES/django.po"]}, {"commit_id": "7389d5fafcd404a3cea9e5f6cace398c5dd9086c", "commit_date": "Sat Nov 11 17:28:21 2023 +0000", "commit_message": "Translate django.po in sv", "files_name": ["modoboa/locale/sv/LC_MESSAGES/django.po"]}, {"commit_id": "292c31ebcb1059f36ec5a9c8b15ee2d717e8998c", "commit_date": "Fri Dec 1 09:10:58 2023 +0100", "commit_message": "Merge pull request #3120 from modoboa/translations_5d93982e9fd6dab991db4faf93ce9ded_sv", "files_name": []}], "parents": [{"commit_id_before": "1bf2932f666802df0911ca3a494ab7b2f09a8982", "url_before": "https://api.github.com/repos/modoboa/modoboa/commits/1bf2932f666802df0911ca3a494ab7b2f09a8982", "html_url_before": "https://github.com/modoboa/modoboa/commit/1bf2932f666802df0911ca3a494ab7b2f09a8982"}, {"commit_id_before": "540b27a2319c41682155754dacd7625946f33359", "url_before": "https://api.github.com/repos/modoboa/modoboa/commits/540b27a2319c41682155754dacd7625946f33359", "html_url_before": "https://github.com/modoboa/modoboa/commit/540b27a2319c41682155754dacd7625946f33359"}], "details": [{"raw_url": "https://github.com/modoboa/modoboa/raw/d33d3cd2d11dbfebd8162c46e2c2a9873919a967/modoboa%2Fstatic%2Fjs%2Ftwocols_nav.js", "code": "/**\n * Return an instance of TwocolsNav.\n *\n * @constructor\n */\n\n/* global Listing */\n\nvar TwocolsNav = function(options) {\n    Listing.call(this, options);\n};\n\nTwocolsNav.prototype = {\n    defaults: {\n        deflocation: null,\n        formid: \"#form\",\n        divid: \"#content\",\n        reload_exceptions: null\n    },\n\n    initialize: function(options) {\n        this.options = $.extend({}, this.defaults, options);\n        this.options.defcallback = $.proxy(this.default_cb, this);\n        Listing.prototype.initialize.call(this, this.options);\n        this.listen();\n        this.navobj.register_callback(\n            \"security\", $.proxy(this.security_callback, this));\n    },\n\n    listen: function() {\n        $(\"a.ajaxnav\").click($.proxy(this.load_section, this));\n        $(document).on(\"click\", \"#update\", $.proxy(function(e) {\n            var $form = $(e.target).closest(\"form\");\n            simple_ajax_form_post(e, {\n                formid: $form.attr(\"id\"),\n                modal: false,\n                reload_on_success: false,\n                success_cb: $.proxy(this.save_cb, this)\n            });\n        }, this));\n        var formId = 'parameters_form';\n        $(document).on('submit', '#' + formId, $.proxy(function(evt) {\n            simple_ajax_form_post(evt, {\n                formid: formId,\n                modal: false,\n                reload_on_success: false,\n                success_cb: $.proxy(this.save_cb, this),\n                error_cb: function(data) {\n                    window.scrollTo(0, 0);\n                    $('a[data-app=\"' + data.prefix + '\"]').tab('show');\n                }\n            });\n        }, this));\n    },\n\n    update_content: function(data) {\n        if (data.content) {\n            $('#' + this.options.divid).html(data.content);\n        }\n        this.update_listing(data, false);\n        if (data.onload_cb) {\n            eval(data.onload_cb + '()');\n        }\n        if (data.respmsg) {\n            $(\"body\").notify(\"error\", data.respmsg);\n        }\n        $('#' + this.options.divid + ' select').change($.proxy(this.select_change, this));\n        $('#' + this.options.divid + ' input[type=radio]').click($.proxy(this.radio_clicked, this));\n        $(\".help\").popover({\n            placement: 'bottom',\n            trigger: 'hover'\n        }).click(function(e) {e.preventDefault();});\n        $('#' + this.options.divid + ' select').change();\n        $('#' + this.options.divid + ' input[type=radio]:checked').click();\n    },\n\n    propagate_change: function($node) {\n        var $select = $node.find(\"select\");\n        var $radio = $node.find(\"input[type=radio]\");\n        if ($select.length) {\n            $select.change();\n        }\n        if ($radio.length) {\n            $radio.click();\n        }\n    },\n\n    toggle_field_visibility: function($field, $parent, value) {\n        if ($parent.attr(\"disabled\") === undefined &&\n            $field.attr(\"data-visibility-value\") === value) {\n            $field.attr(\"disabled\", null);\n            $field.show();\n            this.propagate_change($field);\n        } else {\n            $field.hide();\n            $field.attr(\"disabled\", \"disabled\");\n            this.propagate_change($field);\n        }\n    },\n\n    select_change: function(e) {\n        var instance = this;\n        var $target = $(e.target);\n        var $parent = $target.parents(\"div.form-group\");\n\n        $('div[data-visibility-field=\"' + $target.attr(\"id\") + '\"]').each(function(idx) {\n            instance.toggle_field_visibility($(this), $parent, $target.val());\n        });\n        $('h5[data-visibility-field=\"' + $target.attr(\"id\") + '\"]').each(function(idx) {\n            instance.toggle_field_visibility($(this), $parent, $target.val());\n        });\n    },\n\n    radio_clicked: function(e) {\n        var instance = this;\n        var $target = $(e.target);\n        var $parent = $target.parents(\"div.form-group\");\n        var realid = $target.attr(\"id\");\n\n        realid = realid.substr(0, realid.length - 2);\n        $('div[data-visibility-field=\"' + realid + '\"]').each(function(idx) {\n            instance.toggle_field_visibility($(this), $parent, $target.val());\n        });\n        $('h5[data-visibility-field=\"' + realid + '\"]').each(function(idx) {\n            instance.toggle_field_visibility($(this), $parent, $target.val());\n        });\n    },\n\n    save_cb: function(data) {\n        clean_form_errors(this.options.formid);\n        if (this.options.reload_exceptions) {\n            for (var i = 0; i < this.options.reload_exceptions.length; i++) {\n                if (this.navobj.getbaseurl() == this.options.reload_exceptions[i]) {\n                    window.location.reload();\n                    break;\n                }\n            }\n        }\n        $(\"body\").notify(\"success\", data, 2000);\n    },\n\n    load_section: function(e) {\n        var $link = get_target(e);\n        e.preventDefault();\n        this.navobj.parse_string($link.attr(\"href\"), true).update();\n    },\n\n    /**\n     * Select an entry in the left menu based on current url.\n     */\n    select_left_menu: function() {\n        $(\"a.ajaxnav\").parent().removeClass(\"active\");\n        $(\"a[name=\" + this.navobj.getbaseurl() + \"]\").parent().addClass(\"active\");\n    },\n\n    default_cb: function(data) {\n        this.select_left_menu();\n        this.update_content(data);\n    },\n\n    /**\n     * Navigation callback: security.\n     */\n    security_callback: function (data) {\n        this.select_left_menu();\n        this.update_content(data);\n        $('#start-tfa-setup').click(this.startTFASetup);\n        $('#finalize-tfa-setup').click(this.finalizeTFASetup);\n    },\n\n    startTFASetup: function (evt) {\n        evt.preventDefault();\n        $.ajax({\n            url: window.root_url + '/api/v1/account/tfa/setup/',\n            type: 'post',\n            contentType: 'application/json'\n        }).done(function (resp) {\n            window.location.reload();\n        });\n    },\n\n    finalizeTFASetup: function (evt) {\n        evt.preventDefault();\n        var data = {\n            pin_code: $('#pin-code').val()\n        };\n        $.ajax({\n            url: window.root_url + '/api/v1/account/tfa/setup/check/',\n            type: 'post',\n            global: false,\n            data: JSON.stringify(data),\n            contentType: 'application/json'\n        }).done(function (resp) {\n            window.location.reload();\n        }).fail(function (jqxhr) {\n            var errors = JSON.parse(jqxhr.responseText);\n            display_field_error($('#pin-code'), errors.pin_code.join(' '));\n        });\n    }\n};\n\nTwocolsNav.prototype = $.extend({}, Listing.prototype, TwocolsNav.prototype);\n", "code_before": "/**\n * Return an instance of TwocolsNav.\n *\n * @constructor\n */\n\n/* global Listing */\n\nvar TwocolsNav = function(options) {\n    Listing.call(this, options);\n};\n\nTwocolsNav.prototype = {\n    defaults: {\n        deflocation: null,\n        formid: \"#form\",\n        divid: \"#content\",\n        reload_exceptions: null\n    },\n\n    initialize: function(options) {\n        this.options = $.extend({}, this.defaults, options);\n        this.options.defcallback = $.proxy(this.default_cb, this);\n        Listing.prototype.initialize.call(this, this.options);\n        this.listen();\n        this.navobj.register_callback(\n            \"security\", $.proxy(this.security_callback, this));\n    },\n\n    listen: function() {\n        $(\"a.ajaxnav\").click($.proxy(this.load_section, this));\n        $(document).on(\"click\", \"#update\", $.proxy(function(e) {\n            var $form = $(e.target).closest(\"form\");\n            simple_ajax_form_post(e, {\n                formid: $form.attr(\"id\"),\n                modal: false,\n                reload_on_success: false,\n                success_cb: $.proxy(this.save_cb, this)\n            });\n        }, this));\n        var formId = 'parameters_form';\n        $(document).on('submit', '#' + formId, $.proxy(function(evt) {\n            simple_ajax_form_post(evt, {\n                formid: formId,\n                modal: false,\n                reload_on_success: false,\n                success_cb: $.proxy(this.save_cb, this),\n                error_cb: function(data) {\n                    window.scrollTo(0, 0);\n                    $('a[data-app=\"' + data.prefix + '\"]').tab('show');\n                }\n            });\n        }, this));\n    },\n\n    update_content: function(data) {\n        if (data.content) {\n            $('#' + this.options.divid).html(data.content);\n        }\n        this.update_listing(data, false);\n        if (data.onload_cb) {\n            eval(data.onload_cb + '()');\n        }\n        if (data.respmsg) {\n            $(\"body\").notify(\"error\", data.respmsg);\n        }\n        $('#' + this.options.divid + ' select').change($.proxy(this.select_change, this));\n        $('#' + this.options.divid + ' input[type=radio]').click($.proxy(this.radio_clicked, this));\n        $(\".help\").popover({\n            placement: 'bottom',\n            trigger: 'hover'\n        }).click(function(e) {e.preventDefault();});\n        $('#' + this.options.divid + ' select').change();\n        $('#' + this.options.divid + ' input[type=radio]:checked').click();\n    },\n\n    propagate_change: function($node) {\n        var $select = $node.find(\"select\");\n        var $radio = $node.find(\"input[type=radio]\");\n        if ($select.length) {\n            $select.change();\n        }\n        if ($radio.length) {\n            $radio.click();\n        }\n    },\n\n    toggle_field_visibility: function($field, $parent, value) {\n        if ($parent.attr(\"disabled\") === undefined &&\n            $field.attr(\"data-visibility-value\") === value) {\n            $field.attr(\"disabled\", null);\n            $field.show();\n            this.propagate_change($field);\n        } else {\n            $field.hide();\n            $field.attr(\"disabled\", \"disabled\");\n            this.propagate_change($field);\n        }\n    },\n\n    select_change: function(e) {\n        var instance = this;\n        var $target = $(e.target);\n        var $parent = $target.parents(\"div.form-group\");\n\n        $('div[data-visibility-field=\"' + $target.attr(\"id\") + '\"]').each(function(idx) {\n            instance.toggle_field_visibility($(this), $parent, $target.val());\n        });\n        $('h5[data-visibility-field=\"' + $target.attr(\"id\") + '\"]').each(function(idx) {\n            instance.toggle_field_visibility($(this), $parent, $target.val());\n        });\n    },\n\n    radio_clicked: function(e) {\n        var instance = this;\n        var $target = $(e.target);\n        var $parent = $target.parents(\"div.form-group\");\n        var realid = $target.attr(\"id\");\n\n        realid = realid.substr(0, realid.length - 2);\n        $('div[data-visibility-field=\"' + realid + '\"]').each(function(idx) {\n            instance.toggle_field_visibility($(this), $parent, $target.val());\n        });\n        $('h5[data-visibility-field=\"' + realid + '\"]').each(function(idx) {\n            instance.toggle_field_visibility($(this), $parent, $target.val());\n        });\n    },\n\n    save_cb: function(data) {\n        clean_form_errors(this.options.formid);\n        if (this.options.reload_exceptions) {\n            for (var i = 0; i < this.options.reload_exceptions.length; i++) {\n                if (this.navobj.getbaseurl() == this.options.reload_exceptions[i]) {\n                    window.location.reload();\n                    break;\n                }\n            }\n        }\n        $(\"body\").notify(\"success\", data, 2000);\n    },\n\n    load_section: function(e) {\n        var $link = get_target(e);\n        e.preventDefault();\n        this.navobj.parse_string($link.attr(\"href\"), true).update();\n    },\n\n    /**\n     * Select an entry in the left menu based on current url.\n     */\n    select_left_menu: function() {\n        $(\"a.ajaxnav\").parent().removeClass(\"active\");\n        $(\"a[name=\" + this.navobj.getbaseurl() + \"]\").parent().addClass(\"active\");\n    },\n\n    default_cb: function(data) {\n        this.select_left_menu();\n        this.update_content(data);\n    },\n\n    /**\n     * Navigation callback: security.\n     */\n    security_callback: function (data) {\n        this.select_left_menu();\n        this.update_content(data);\n        $('#start-tfa-setup').click(this.startTFASetup);\n        $('#finalize-tfa-setup').click(this.finalizeTFASetup);\n    },\n\n    startTFASetup: function (evt) {\n        evt.preventDefault();\n        $.ajax({\n            url: window.root_url + '/api/v1/account/tfa/setup/',\n            type: 'post',\n            contentType: 'application/json'\n        }).done(function (resp) {\n            window.location.reload();\n        });\n    },\n\n    finalizeTFASetup: function (evt) {\n        evt.preventDefault();\n        var data = {\n            pin_code: $('#pin-code').val()\n        };\n        $.ajax({\n            url: window.root_url + '/api/v1/account/tfa/setup/check/',\n            type: 'post',\n            global: false,\n            data: JSON.stringify(data),\n            contentType: 'application/json'\n        }).done(function (resp) {\n            window.location.reload();\n        }).fail(function (jqxhr) {\n            var errors = JSON.parse(jqxhr.responseText);\n            display_field_error($('#pin-code'), errors.pin_code.join(' '));\n        });\n    }\n};\n\nTwocolsNav.prototype = $.extend({}, Listing.prototype, TwocolsNav.prototype);\n", "patch": "@@ -30,7 +30,7 @@ TwocolsNav.prototype = {\n     listen: function() {\n         $(\"a.ajaxnav\").click($.proxy(this.load_section, this));\n         $(document).on(\"click\", \"#update\", $.proxy(function(e) {\n-            var $form = $(\"form\").first();\n+            var $form = $(e.target).closest(\"form\");\n             simple_ajax_form_post(e, {\n                 formid: $form.attr(\"id\"),\n                 modal: false,", "file_path": "files/2023_10/651", "file_language": "js", "file_name": "modoboa/static/js/twocols_nav.js", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/modoboa/modoboa/raw/d33d3cd2d11dbfebd8162c46e2c2a9873919a967/modoboa%2Ftemplates%2Fcommon%2Fgeneric_field.html", "code": "{% load i18n core_tags form_tags %}\n<div class=\"form-group\n    {% if field.errors %}has-error{% endif %}\n    {{ extra_classes }}\"{% visirule field %}\n    {% if hidden %}style=\"display: none\"{% endif %}\n>\n\n  {% if field.label %}\n  <label class=\"control-label {{ label_width }}\" for=\"id_{{ field.html_name }}\">{{ field.label }}\n    {% if help_display_mode == \"tooltip\" and field.help_text %}\n    <a href=\"#\" class=\"help\" data-original-title=\"{% trans 'Help:' %} {{ field.label }}\" data-content=\"{{ field.help_text }}\" rel=\"popover\" tabindex=\"-1\">?</a>\n    {% endif %}\n  </label>\n  {% endif %}\n\n  <div class=\"{% render_field_width field %}\">\n    {% if appended_text %}\n    <div class=\"input-group\">\n      {% endif %}\n      {{ field }}\n      {% if appended_text %}\n      <span class=\"input-group-addon\">{{ appended_text }}</span>\n    </div>\n    {% endif %}\n    {% if help_display_mode == \"inline\" and field.help_text %}\n    <span class=\"help-block pull-right\">{{ field.help_text }}</span>\n    {% endif %}\n    {% if inline_message %}\n    <span class=\"text-info\">{{ inline_message }}</span>\n    {% endif %}\n    {% if field.errors %}\n    <p class=\"help-block\">\n      {% for error in field.errors %}\n      {{ error }}\n      {% endfor %}\n    </p>\n    {% endif %}\n  </div>\n\n  {% if activator %}\n  <div class=\"checkbox {{ activator_size }}\">\n    <label for=\"id_{{ field.name }}_act\">\n      <input type=\"checkbox\" class=\"activator\" id=\"id_{{ field.name }}_act\" name=\"{{ field.name }}_act\"\n             {% if activator_value %}checked='checked'\n             {% else %}\n             {% if deactivate_if_empty and field.value == None %}\n             checked='checked'\n             {% endif %}\n             {% endif %}/>\n      {{ activator_label }}\n    </label>\n  </div>\n  {% endif %}\n\n  {% block extra_controls %}\n  {% endblock %}\n\n</div>\n", "code_before": "{% load i18n core_tags form_tags %}\n<div class=\"form-group\n    {% if field.errors %}has-error{% endif %}\n    {{ extra_classes }}\"{% visirule field %}\n    {% if hidden %}style=\"display: none\"{% endif %}\n>\n\n  {% if field.label %}\n  <label class=\"control-label {{ label_width }}\" for=\"id_{{ field.html_name }}\">{{ field.label }}\n    {% if help_display_mode == \"tooltip\" and field.help_text %}\n    <a href=\"#\" class=\"help\" data-original-title=\"{% trans 'Help:' %} {{ field.label }}\" data-content=\"{{ field.help_text }}\" rel=\"popover\" tabindex=\"-1\">?</a>\n    {% endif %}\n  </label>\n  {% endif %}\n\n  <div class=\"{% render_field_width field %}\">\n    {% if appended_text %}\n    <div class=\"input-group\">\n      {% endif %}\n      {{ field }}\n      {% if appended_text %}\n      <span class=\"input-group-addon\">{{ appended_text }}</span>\n    </div>\n    {% endif %}\n    {% if help_display_mode == \"inline\" and field.help_text %}\n    <span class=\"help-block pull-right\">{{ field.help_text }}</span>\n    {% endif %}\n    {% if inline_message %}\n    <span class=\"text-info\">{{ inline_message }}</span>\n    {% endif %}\n    {% if field.errors %}\n    <p class=\"help-block\">\n      {% for error in field.errors %}\n      {{ error }}\n      {% endfor %}\n    </p>\n    {% endif %}\n  </div>\n\n  {% if activator %}\n  <div class=\"checkbox {{ activator_size }}\">\n    <label for=\"id_{{ field.name }}_act\">\n      <input type=\"checkbox\" class=\"activator\" id=\"id_{{ field.name }}_act\" name=\"{{ field.name }}_act\"\n             {% if activator_value %}checked='checked'\n             {% else %}\n             {% if deactivate_if_empty and field.value == None %}\n             checked='checked'\n             {% endif %}\n             {% endif %}/>\n      {{ activator_label }}\n    </label>\n  </div>\n  {% endif %}\n\n  {% block extra_controls %}\n  {% endblock %}\n\n</div>\n", "patch": "@@ -12,7 +12,7 @@\n     {% endif %}\n   </label>\n   {% endif %}\n-  \n+\n   <div class=\"{% render_field_width field %}\">\n     {% if appended_text %}\n     <div class=\"input-group\">\n@@ -31,7 +31,7 @@\n     {% if field.errors %}\n     <p class=\"help-block\">\n       {% for error in field.errors %}\n-      {{ error|safe }}\n+      {{ error }}\n       {% endfor %}\n     </p>\n     {% endif %}", "file_path": "files/2023_10/652", "file_language": "html", "file_name": "modoboa/templates/common/generic_field.html", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
