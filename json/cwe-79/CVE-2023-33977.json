{"index": 11771, "cve_id": "CVE-2023-33977", "cwe_id": ["CWE-79"], "cve_language": "Python", "cve_description": "Kiwi TCMS is an open source test management system for both manual and automated testing. Kiwi TCMS allows users to upload attachments to test plans, test cases, etc. Earlier versions of Kiwi TCMS had introduced upload validators in order to prevent potentially dangerous files from being uploaded and Content-Security-Policy definition to prevent cross-site-scripting attacks. The upload validation checks were not 100% robust which left the possibility to circumvent them and upload a potentially dangerous file which allows execution of arbitrary JavaScript in the browser. Additionally we've discovered that Nginx's `proxy_pass` directive will strip some headers negating protections built into Kiwi TCMS when served behind a reverse proxy. This issue has been addressed in version 12.4. Users are advised to upgrade. Users unable to upgrade who are serving Kiwi TCMS behind a reverse proxy should make sure that additional header values are still passed to the client browser. If they aren't redefining them inside the proxy configuration.", "cvss": "5.4", "publish_date": "June 6, 2023", "AV": "NETWORK", "AC": "NETWORK", "PR": "LOW", "UI": "REQUIRED", "S": "CHANGED", "C": "LOW", "I": "LOW", "A": "NONE", "commit_id": "d789f4b51025de4f8c747c037d02e1b0da80b034", "commit_message": "Improve upload validation to check for dangerous attributes", "commit_date": "2023-06-05T22:01:55Z", "project": "kiwitcms/kiwi", "url": "https://api.github.com/repos/kiwitcms/Kiwi/commits/d789f4b51025de4f8c747c037d02e1b0da80b034", "html_url": "https://github.com/kiwitcms/Kiwi/commit/d789f4b51025de4f8c747c037d02e1b0da80b034", "windows_before": [{"commit_id": "13f4b7a6ca6b9a90b3672a8aa82cc86de74ca01d", "commit_date": "Tue May 30 19:31:05 2023 +0300", "commit_message": "Changelog for v12.4", "files_name": ["CHANGELOG.rst", "tcms/__init__.py"]}, {"commit_id": "700e9f9b702228176b53c4262c6347229bab1858", "commit_date": "Tue May 30 19:04:05 2023 +0300", "commit_message": "Use bleach_allowlist.generally_xss_unsafe", "files_name": ["tcms/kiwi_attachments/tests/test_validators.py", "tcms/kiwi_attachments/validators.py", "tcms/locale/en/LC_MESSAGES/django.po", "tests/ui/data/inline_javascript.svg", "tests/ui/data/inline_javascript_mixed_case.svg"]}, {"commit_id": "ce5b83ef9745f90e24b34a08147e898a52d4c0f3", "commit_date": "Mon Jun 5 18:21:34 2023 +0200", "commit_message": "Update django from 4.2.1 to 4.2.2", "files_name": ["requirements/base.txt"]}, {"commit_id": "efeda640da13e06251cacad6db30ed2df09cea97", "commit_date": "Mon Jun 5 04:01:50 2023 +0000", "commit_message": "Bump eslint from 8.41.0 to 8.42.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "a99e383553d262df69c6b0d902500d26539a5648", "commit_date": "Mon Jun 5 04:01:44 2023 +0000", "commit_message": "Bump webpack-cli from 5.1.1 to 5.1.3 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "eaae3180085ea60c3185cf022fb7090878f51268", "commit_date": "Sun Jun 4 23:43:10 2023 +0300", "commit_message": "Update translation strings", "files_name": ["tcms/locale/bg_BG/LC_MESSAGES/django.po", "tcms/locale/bn_BD/LC_MESSAGES/django.po", "tcms/locale/ca_ES/LC_MESSAGES/django.po", "tcms/locale/cs_CZ/LC_MESSAGES/django.po", "tcms/locale/de_DE/LC_MESSAGES/django.po", "tcms/locale/el_GR/LC_MESSAGES/django.po", "tcms/locale/eo_UY/LC_MESSAGES/django.po", "tcms/locale/es_ES/LC_MESSAGES/django.po", "tcms/locale/fr_FR/LC_MESSAGES/django.po", "tcms/locale/he_IL/LC_MESSAGES/django.po", "tcms/locale/hi_IN/LC_MESSAGES/django.po", "tcms/locale/hu_HU/LC_MESSAGES/django.po", "tcms/locale/id_ID/LC_MESSAGES/django.po", "tcms/locale/it_IT/LC_MESSAGES/django.po", "tcms/locale/ja_JP/LC_MESSAGES/django.po", "tcms/locale/ko_KR/LC_MESSAGES/django.po", "tcms/locale/mk_MK/LC_MESSAGES/django.po", "tcms/locale/mr_IN/LC_MESSAGES/django.po", "tcms/locale/pl_PL/LC_MESSAGES/django.po", "tcms/locale/pt_BR/LC_MESSAGES/django.po", "tcms/locale/ro_RO/LC_MESSAGES/django.po", "tcms/locale/ru_RU/LC_MESSAGES/django.po", "tcms/locale/sk_SK/LC_MESSAGES/django.po", "tcms/locale/sl_SI/LC_MESSAGES/django.po", "tcms/locale/sq_AL/LC_MESSAGES/django.po", "tcms/locale/sw_KE/LC_MESSAGES/django.po", "tcms/locale/ta_IN/LC_MESSAGES/django.po", "tcms/locale/te_IN/LC_MESSAGES/django.po", "tcms/locale/tr_TR/LC_MESSAGES/django.po", "tcms/locale/vi_VN/LC_MESSAGES/django.po", "tcms/locale/zh_CN/LC_MESSAGES/django.po", "tcms/locale/zh_TW/LC_MESSAGES/django.po"]}, {"commit_id": "891a94f62ce3f7db6f8c15afa5bab65d1d13ef19", "commit_date": "Sun Jun 4 22:17:24 2023 +0300", "commit_message": "Disable checkcov warning for example help chart", "files_name": ["helm/values.yaml"]}, {"commit_id": "4fc91ef9b4174edfdbab318c6b56296c7fdd4c87", "commit_date": "Sun Jun 4 22:13:25 2023 +0300", "commit_message": "Add HEALTHCHECK command for Docker container", "files_name": ["Dockerfile", "tests/test_docker.sh"]}, {"commit_id": "a0d6787f7a125d175a812fa0d9d6ce0b2c5d0d09", "commit_date": "Sun Jun 4 14:14:40 2023 +0300", "commit_message": "Update translation strings", "files_name": ["tcms/locale/en/LC_MESSAGES/django.po"]}, {"commit_id": "abacc16208368947a399c0ed685d3aa9b9f7cc76", "commit_date": "Sun Jun 4 14:10:07 2023 +0300", "commit_message": "Improve messaging for Issue Tracker Configuration health check", "files_name": ["tcms/testcases/admin.py"]}, {"commit_id": "db7a6640c511d36a855b9dba0e96b53cf1cfb5f3", "commit_date": "Sun Jun 4 13:05:42 2023 +0300", "commit_message": "Allow searching by TestRun summary in Telemetry pages. Fixes #3190", "files_name": ["tcms/telemetry/static/telemetry/js/index.js", "tcms/telemetry/static/telemetry/js/testing/breakdown.js", "tcms/telemetry/static/telemetry/js/testing/execution-dashboard.js", "tcms/telemetry/static/telemetry/js/testing/execution-trends.js", "tcms/telemetry/static/telemetry/js/testing/status-matrix.js", "tcms/telemetry/static/telemetry/js/testing/test-case-health.js", "tcms/telemetry/templates/telemetry/include/filters.html"]}, {"commit_id": "ac3d6d0d2162edba3d82aa3ac87a0f94a771edad", "commit_date": "Thu Jun 1 04:00:31 2023 +0000", "commit_message": "Bump webpack from 5.84.1 to 5.85.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "5ecb1a0a18382c055e6acb49abb9bbca6ce97fd3", "commit_date": "Thu Jun 1 12:18:20 2023 +0200", "commit_message": "Update jira from 3.5.0 to 3.5.1", "files_name": ["requirements/base.txt"]}, {"commit_id": "2e6b99bc9cee34639963170603642d2c86149104", "commit_date": "Wed May 31 03:59:53 2023 +0000", "commit_message": "Bump eslint-plugin-n from 15.7.0 to 16.0.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "904a9e19972e4e72cfaea6c106d371a3cf6803a5", "commit_date": "Wed May 31 23:24:14 2023 +0300", "commit_message": "Add missing format string in translation", "files_name": ["tcms/locale/ru_RU/LC_MESSAGES/django.po"]}, {"commit_id": "965aeb068cb63f9c218ff20b97f1b43fcd21b725", "commit_date": "Wed May 31 19:46:20 2023 +0000", "commit_message": "[pre-commit.ci] auto fixes from pre-commit.com hooks", "files_name": ["tcms/locale/sl_SI/LC_MESSAGES/django.po"]}, {"commit_id": "f09c638cffa12b6fd82859dfbde9ec6017d40933", "commit_date": "Wed May 31 22:46:14 2023 +0300", "commit_message": "New translations django.po (Slovenian)", "files_name": ["tcms/locale/sl_SI/LC_MESSAGES/django.po"]}, {"commit_id": "9e91dc1bf4e22fa73273e075a87dfd0adb336120", "commit_date": "Tue May 30 14:51:44 2023 +0300", "commit_message": "Update translation strings", "files_name": ["tcms/locale/bg_BG/LC_MESSAGES/django.po", "tcms/locale/bn_BD/LC_MESSAGES/django.po", "tcms/locale/ca_ES/LC_MESSAGES/django.po", "tcms/locale/cs_CZ/LC_MESSAGES/django.po", "tcms/locale/de_DE/LC_MESSAGES/django.po", "tcms/locale/el_GR/LC_MESSAGES/django.po", "tcms/locale/eo_UY/LC_MESSAGES/django.po", "tcms/locale/es_ES/LC_MESSAGES/django.po", "tcms/locale/fr_FR/LC_MESSAGES/django.po", "tcms/locale/he_IL/LC_MESSAGES/django.po", "tcms/locale/hi_IN/LC_MESSAGES/django.po", "tcms/locale/hu_HU/LC_MESSAGES/django.po", "tcms/locale/id_ID/LC_MESSAGES/django.po", "tcms/locale/it_IT/LC_MESSAGES/django.po", "tcms/locale/ja_JP/LC_MESSAGES/django.po", "tcms/locale/ko_KR/LC_MESSAGES/django.po", "tcms/locale/mk_MK/LC_MESSAGES/django.po", "tcms/locale/mr_IN/LC_MESSAGES/django.po", "tcms/locale/pl_PL/LC_MESSAGES/django.po", "tcms/locale/pt_BR/LC_MESSAGES/django.po", "tcms/locale/ro_RO/LC_MESSAGES/django.po", "tcms/locale/ru_RU/LC_MESSAGES/django.po", "tcms/locale/sk_SK/LC_MESSAGES/django.po", "tcms/locale/sl_SI/LC_MESSAGES/django.po", "tcms/locale/sq_AL/LC_MESSAGES/django.po", "tcms/locale/sw_KE/LC_MESSAGES/django.po", "tcms/locale/ta_IN/LC_MESSAGES/django.po", "tcms/locale/te_IN/LC_MESSAGES/django.po", "tcms/locale/tr_TR/LC_MESSAGES/django.po", "tcms/locale/vi_VN/LC_MESSAGES/django.po", "tcms/locale/zh_CN/LC_MESSAGES/django.po", "tcms/locale/zh_TW/LC_MESSAGES/django.po"]}, {"commit_id": "bdc99e313a20fe94ba5a7be65341a86ad5b681d5", "commit_date": "Tue May 30 12:49:39 2023 +0300", "commit_message": "Update GitLab test data initialization", "files_name": ["tests/gitlab_ee/initialize-data"]}, {"commit_id": "93517c3eaaf704e03b99f784fbacda4af7da012c", "commit_date": "Thu May 25 23:34:09 2023 +0300", "commit_message": "Update translation strings", "files_name": ["tcms/locale/en/LC_MESSAGES/django.po"]}, {"commit_id": "d9e2b8695b38d0421c217aa10ac73f21a3913438", "commit_date": "Thu May 25 23:33:04 2023 +0300", "commit_message": "Make it more clear when email notifications trigger. Closes #3212", "files_name": ["tcms/testcases/templates/testcases/mutable.html", "tcms/testplans/templates/testplans/mutable.html"]}, {"commit_id": "1d431604cbb6188831fcff1db40304c42eb69b15", "commit_date": "Fri May 26 03:59:20 2023 +0000", "commit_message": "Bump webpack from 5.84.0 to 5.84.1 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "fad12ec27a8972c8e1fc74be3af8024b6faa7876", "commit_date": "Tue May 30 03:59:49 2023 +0000", "commit_message": "Bump eslint-config-standard from 17.0.0 to 17.1.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "bf546800d6c67485f0e5d09705f829e5defdb839", "commit_date": "Mon May 22 04:02:15 2023 +0000", "commit_message": "Bump eslint from 8.40.0 to 8.41.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "17b50bcf6532fffd8de70a8da35b408e3d54fdc8", "commit_date": "Thu May 25 03:58:54 2023 +0000", "commit_message": "Bump webpack from 5.83.1 to 5.84.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "5d784a67698bf0fbfb74776f60c6a49cd32892a0", "commit_date": "Sat May 20 19:26:22 2023 +0300", "commit_message": "Changelog for v12.3", "files_name": ["CHANGELOG.rst", "tcms/__init__.py"]}, {"commit_id": "afc320f97b13a4c16e904cef54890edcc53db802", "commit_date": "Sat May 20 00:10:20 2023 +0300", "commit_message": "Force Content-Type for all uploaded files when served by Kiwi TCMS", "files_name": ["etc/nginx.conf", "tcms/core/middleware.py", "tests/test_http.sh", "tests/ui/data/html_with_external_script.html", "tests/ui/data/redirect.js", "tests/ui/test_inline_javascript.robot"]}, {"commit_id": "e7833d68b9e391dc825139a249c608ab05c573c0", "commit_date": "Fri May 19 23:25:12 2023 +0300", "commit_message": "Implement better scanning for embedded <script> tags in uploaded files", "files_name": ["tcms/kiwi_attachments/tests/test_validators.py", "tcms/kiwi_attachments/validators.py", "tests/ui/data/inline_javascript_mixed_case.svg"]}, {"commit_id": "2806217c66901bf694f0e32cf709ec179b2b8704", "commit_date": "Fri May 19 21:52:15 2023 +0300", "commit_message": "Pylint disable too-many-ancestors for inherited forms", "files_name": ["tcms/kiwi_auth/forms.py", "tcms/rpc/api/forms/management.py", "tcms/rpc/api/forms/testplan.py"]}, {"commit_id": "9607a56629f9511f3dad954b975171be3df1810f", "commit_date": "Thu May 4 12:19:11 2023 +0300", "commit_message": "Update django from 4.1.9 to 4.2.1", "files_name": ["requirements/base.txt"]}, {"commit_id": "a2719e23a4e892cbebe57bfd77b9c12e0ab99b0a", "commit_date": "Thu May 18 03:59:23 2023 +0000", "commit_message": "Bump webpack from 5.82.0 to 5.83.1 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "c95d61846ac4334c65c86938f8969a342f4a5cc9", "commit_date": "Tue May 9 19:31:11 2023 +0300", "commit_message": "Update pygithub from 1.58.1 to 1.58.2", "files_name": ["requirements/base.txt"]}, {"commit_id": "ad07feed07d73fea8d0e236ee735395479998a98", "commit_date": "Wed May 10 03:59:16 2023 +0000", "commit_message": "Bump webpack-cli from 5.1.0 to 5.1.1 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "360c96ad99ba699199b667739f53ba69b68c6fb6", "commit_date": "Wed May 10 16:08:45 2023 +0300", "commit_message": "Enable nginx:1.22 module stream for RHEL", "files_name": []}], "windows_after": [{"commit_id": "700e9f9b702228176b53c4262c6347229bab1858", "commit_date": "Tue May 30 19:04:05 2023 +0300", "commit_message": "Use bleach_allowlist.generally_xss_unsafe", "files_name": ["tcms/kiwi_attachments/tests/test_validators.py", "tcms/kiwi_attachments/validators.py", "tcms/locale/en/LC_MESSAGES/django.po", "tests/ui/data/inline_javascript.svg", "tests/ui/data/inline_javascript_mixed_case.svg"]}, {"commit_id": "13f4b7a6ca6b9a90b3672a8aa82cc86de74ca01d", "commit_date": "Tue May 30 19:31:05 2023 +0300", "commit_message": "Changelog for v12.4", "files_name": ["CHANGELOG.rst", "tcms/__init__.py"]}, {"commit_id": "fd7c4f8dbebf78ae2fb5d73d553ab126b845a924", "commit_date": "Tue Jun 6 02:09:57 2023 +0300", "commit_message": "Update translation strings", "files_name": ["tcms/locale/bg_BG/LC_MESSAGES/django.po", "tcms/locale/bn_BD/LC_MESSAGES/django.po", "tcms/locale/ca_ES/LC_MESSAGES/django.po", "tcms/locale/cs_CZ/LC_MESSAGES/django.po", "tcms/locale/de_DE/LC_MESSAGES/django.po", "tcms/locale/el_GR/LC_MESSAGES/django.po", "tcms/locale/eo_UY/LC_MESSAGES/django.po", "tcms/locale/es_ES/LC_MESSAGES/django.po", "tcms/locale/fr_FR/LC_MESSAGES/django.po", "tcms/locale/he_IL/LC_MESSAGES/django.po", "tcms/locale/hi_IN/LC_MESSAGES/django.po", "tcms/locale/hu_HU/LC_MESSAGES/django.po", "tcms/locale/id_ID/LC_MESSAGES/django.po", "tcms/locale/it_IT/LC_MESSAGES/django.po", "tcms/locale/ja_JP/LC_MESSAGES/django.po", "tcms/locale/ko_KR/LC_MESSAGES/django.po", "tcms/locale/mk_MK/LC_MESSAGES/django.po", "tcms/locale/mr_IN/LC_MESSAGES/django.po", "tcms/locale/pl_PL/LC_MESSAGES/django.po", "tcms/locale/pt_BR/LC_MESSAGES/django.po", "tcms/locale/ro_RO/LC_MESSAGES/django.po", "tcms/locale/ru_RU/LC_MESSAGES/django.po", "tcms/locale/sk_SK/LC_MESSAGES/django.po", "tcms/locale/sl_SI/LC_MESSAGES/django.po", "tcms/locale/sq_AL/LC_MESSAGES/django.po", "tcms/locale/sw_KE/LC_MESSAGES/django.po", "tcms/locale/ta_IN/LC_MESSAGES/django.po", "tcms/locale/te_IN/LC_MESSAGES/django.po", "tcms/locale/tr_TR/LC_MESSAGES/django.po", "tcms/locale/vi_VN/LC_MESSAGES/django.po", "tcms/locale/zh_CN/LC_MESSAGES/django.po", "tcms/locale/zh_TW/LC_MESSAGES/django.po"]}, {"commit_id": "f2a21e47253f03059ddaab462434aeb8bbc53afa", "commit_date": "Tue Jun 6 03:57:26 2023 +0000", "commit_message": "Bump django-extensions from 3.2.1 to 3.2.3", "files_name": ["requirements/base.txt"]}, {"commit_id": "7be7b86685d4d36889e467f62503518ebcfa8f72", "commit_date": "Tue Jun 6 03:59:25 2023 +0000", "commit_message": "Bump webpack from 5.85.0 to 5.85.1 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "0a179f7f882013614ff6c8f8f353104c08f07a9e", "commit_date": "Tue Jun 6 22:40:17 2023 +0300", "commit_message": "Small update to HEALTHCHECK command", "files_name": ["Dockerfile"]}, {"commit_id": "61e8c0bf90a77a2fbc22d90761eec74e6640f59e", "commit_date": "Fri Jun 16 14:56:19 2023 +0300", "commit_message": "New translations django.po (Russian)", "files_name": ["tcms/locale/ru_RU/LC_MESSAGES/django.po"]}, {"commit_id": "54848b0be6fac8213aeb93181614189ebf9dab09", "commit_date": "Fri Jun 16 11:56:26 2023 +0000", "commit_message": "[pre-commit.ci] auto fixes from pre-commit.com hooks", "files_name": ["tcms/locale/ru_RU/LC_MESSAGES/django.po"]}, {"commit_id": "b4de8e1a0efe047dfece988ac90240120fa630e5", "commit_date": "Tue Jun 20 11:15:58 2023 +0300", "commit_message": "Pin selenium to 4.9.1 b/c of failures with 4.10.0", "files_name": ["requirements/devel.txt"]}, {"commit_id": "5339ce5617428dd5b5ef777e6e77f6438e6a00c7", "commit_date": "Tue Jun 20 12:12:24 2023 +0300", "commit_message": "Replace mysql -> mariadb native commands", "files_name": ["tests/test_docker.sh"]}, {"commit_id": "aaf8ff87623848510bd7e1eb18b69697840ba108", "commit_date": "Mon Jun 19 04:11:39 2023 +0000", "commit_message": "Bump eslint from 8.42.0 to 8.43.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "ee484d37a682d87c583314318c1c83a4dd68540f", "commit_date": "Thu Jun 15 03:58:56 2023 +0000", "commit_message": "Bump webpack from 5.85.1 to 5.87.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "4efd07fa805037dc552c10d8a6d57b8f3f02faa8", "commit_date": "Tue Jun 20 10:24:44 2023 +0000", "commit_message": "Bump webpack-cli from 5.1.3 to 5.1.4 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "8aa7d2587151e5ce6a49a8f378674e79b9708775", "commit_date": "Fri Jun 9 12:15:46 2023 +0200", "commit_message": "Update python-gitlab from 3.14.0 to 3.15.0", "files_name": ["requirements/base.txt"]}, {"commit_id": "6be2b660a80ac55dd57fb9070a29e3abf5b3a6cd", "commit_date": "Tue Jun 13 10:55:05 2023 +0200", "commit_message": "Update django-colorfield from 0.8.0 to 0.9.0", "files_name": ["requirements/base.txt"]}, {"commit_id": "7b6e23d063b032f587ac14eba93cab9fed7b3433", "commit_date": "Mon Jun 19 10:51:38 2023 +0200", "commit_message": "Update django-tree-queries from 0.14.0 to 0.15.0", "files_name": ["requirements/base.txt"]}, {"commit_id": "dd85ad678074111afe347ac05c7bc018b68758ce", "commit_date": "Thu Jun 22 03:59:40 2023 +0000", "commit_message": "Bump webpack from 5.87.0 to 5.88.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "4b8a051ec2208265e11ed5c928a7f18fd03e23e0", "commit_date": "Mon Jun 26 18:17:05 2023 +0300", "commit_message": "Assert on the number of Content-Type headers for attachments", "files_name": ["tests/test_http.sh"]}, {"commit_id": "ffb00450be52fe11a82a2507632c2328cae4ec9d", "commit_date": "Mon Jun 26 19:07:36 2023 +0300", "commit_message": "Better enforcing of mime type for uploads", "files_name": ["etc/nginx.conf"]}, {"commit_id": "8c47b153435f43c8c28edd67379c094ecb781199", "commit_date": "Tue Jun 27 19:30:17 2023 +0300", "commit_message": "Add configuration for testing with reverse proxy", "files_name": ["docker-compose.yml", "tests/nginx-proxy/ca.crt", "tests/nginx-proxy/dhparams.pem", "tests/nginx-proxy/localhost.crt", "tests/nginx-proxy/localhost.key", "tests/nginx-proxy/nginx.conf"]}, {"commit_id": "e5471c848a60c39b9677ca8e33dfa99429f804ba", "commit_date": "Tue Jun 27 20:44:07 2023 +0300", "commit_message": "Assert that Nginx proxy doesn't strip response headers", "files_name": ["tests/test_http.sh"]}, {"commit_id": "938f97e7b59ae57f8fd287d611844f1f2597f4d7", "commit_date": "Tue Jun 27 22:35:58 2023 +0300", "commit_message": "Update how we seed GitLab API token used for testing", "files_name": ["tests/gitlab_ee/25_api_personal_access_token.rb", "tests/gitlab_ee/docker-compose.yml"]}, {"commit_id": "4279fd4c21524bf272df5270e0a0c58e2214962d", "commit_date": "Mon Jun 26 04:01:19 2023 +0000", "commit_message": "Bump eslint-plugin-n from 16.0.0 to 16.0.1 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "6fd047411b9645cd248dcc1d43da71189ebaea9a", "commit_date": "Thu Jun 29 03:27:10 2023 +0000", "commit_message": "Bump webpack from 5.88.0 to 5.88.1 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "107ce99098db8923274ad2101edde5075f5af2c3", "commit_date": "Thu Jun 29 15:53:20 2023 +0300", "commit_message": "Update jira from 3.5.1 to 3.5.2", "files_name": ["requirements/base.txt"]}, {"commit_id": "ed35974b2304c3311e5e6e0e8d0abac20de9bb79", "commit_date": "Tue Jul 4 03:23:24 2023 +0000", "commit_message": "Bump django-simple-captcha from 0.5.17 to 0.5.18", "files_name": ["requirements/tarballs.txt"]}, {"commit_id": "617d1301113eb590ed0e8b83a9ab92346effdfd4", "commit_date": "Mon Jul 3 03:23:22 2023 +0000", "commit_message": "Bump eslint from 8.43.0 to 8.44.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "4489df5f7ec00f320c443d9a09c769faac95fa14", "commit_date": "Tue Jul 4 07:24:34 2023 +0000", "commit_message": "Bump django from 4.2.2 to 4.2.3", "files_name": ["requirements/base.txt"]}, {"commit_id": "4f3821a9c584aa6a1c1e59caad8e7a7a98111f0a", "commit_date": "Fri Jun 30 14:44:15 2023 +0300", "commit_message": "When searching for HTML attributes don't match the trailing =", "files_name": ["tcms/kiwi_attachments/validators.py"]}, {"commit_id": "1ae51fcafc36bd3b1c7f01d4eec886d9a7fa3b07", "commit_date": "Fri Jun 30 14:59:39 2023 +0300", "commit_message": "Extend the list of file upload validators", "files_name": ["tcms/kiwi_attachments/validators.py"]}, {"commit_id": "195ea53eaaf360c19227c864cc0fe58910032c3c", "commit_date": "Fri Jun 30 15:30:05 2023 +0300", "commit_message": "Sanitize test plan name in tree_view_html()", "files_name": ["tcms/testplans/models.py"]}, {"commit_id": "3b90528d8a548c4c421eae9a5fcc7fe16c2ab308", "commit_date": "Tue Jul 4 12:59:30 2023 +0300", "commit_message": "Changelog for v12.5", "files_name": ["CHANGELOG.rst", "tcms/__init__.py"]}, {"commit_id": "a6b2ae98032528becc535cb4db61a4d76f08f609", "commit_date": "Thu Jun 22 09:14:49 2023 +0200", "commit_message": "Update mysqlclient from 2.1.1 to 2.2.0", "files_name": ["requirements/mariadb.txt"]}, {"commit_id": "4e1066473f2b960759cfefbebb257f42d2946fb6", "commit_date": "Tue Jul 4 10:30:48 2023 +0300", "commit_message": "Provide /usr/lib64/pkgconfig/mariadb.pc inside buildroot", "files_name": ["Dockerfile.buildroot", "requirements/mariadb.pc"]}, {"commit_id": "d7401dc14ffe27c9cf8425709214cd0b2725a8a9", "commit_date": "Wed Jul 5 22:28:20 2023 +0300", "commit_message": "Add warning for django-ses in docs", "files_name": ["docs/source/configuration.rst"]}, {"commit_id": "093377587da8e74dd88e3307da0a713d91d43f79", "commit_date": "Wed Jul 5 23:18:55 2023 +0300", "commit_message": "Add a button to delete URLs from test executions. Fixes #2936", "files_name": ["tcms/testruns/static/testruns/js/get.js", "tcms/testruns/templates/testruns/get.html"]}, {"commit_id": "bd9b97e99b82ccf2bf00c77ce84a2ff63e7be539", "commit_date": "Fri Jul 14 23:12:16 2023 +0300", "commit_message": "New translations django.po (Russian)", "files_name": ["tcms/locale/ru_RU/LC_MESSAGES/django.po"]}, {"commit_id": "4f3ee2b2e124e7f9c91088d2c8364753005122a4", "commit_date": "Mon Jul 17 03:19:16 2023 +0000", "commit_message": "Bump eslint from 8.44.0 to 8.45.0 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "0bcba53d438190ea27ce99c3af951bb33e88bd35", "commit_date": "Mon Jul 17 22:09:44 2023 +0300", "commit_message": "Hide all expanded child rows in TestPlan Search page. Fixes #3245", "files_name": ["tcms/testplans/static/testplans/js/search.js"]}, {"commit_id": "46b702d8033bf2f959d03d16c6b1c5d32bd81999", "commit_date": "Fri Jul 14 02:10:46 2023 +0300", "commit_message": "[Tag] Fix jinja2 variable", "files_name": ["tcms/testcases/templates/testcases/search.html", "tcms/testplans/templates/testplans/search.html", "tcms/testruns/templates/testruns/search.html"]}, {"commit_id": "ec3da57257832f1dac7eb7c4e85e360459be9ce3", "commit_date": "Fri Jul 14 02:11:08 2023 +0300", "commit_message": "[TestPlan] Fix wrong query param", "files_name": ["tcms/core/templates/dashboard.html", "tcms/templates/navbar.html"]}, {"commit_id": "ae5c8e0431cf80fa766d3cb054fa105894d4d3a0", "commit_date": "Tue Jul 18 03:05:15 2023 +0000", "commit_message": "Bump webpack from 5.88.1 to 5.88.2 in /tcms", "files_name": ["tcms/package-lock.json", "tcms/package.json"]}, {"commit_id": "1b4291df4f8efc6afdd6fd02eeacd3e42d8e05c4", "commit_date": "Tue Jul 11 21:20:32 2023 +0300", "commit_message": "[DataTable] Detach click to prevent multiplication", "files_name": ["tcms/static/js/tags.js", "tcms/testcases/static/testcases/js/get.js"]}, {"commit_id": "a208c8c978ea35ae6d0710d89c5d6cd108e0deb6", "commit_date": "Sat Jul 8 13:53:27 2023 +0300", "commit_message": "Update allpairspy from 2.5.0 to 2.5.1", "files_name": ["requirements/base.txt"]}, {"commit_id": "e177a6b0b963b78738187235226736fc40bde415", "commit_date": "Fri Jul 28 11:11:10 2023 +0300", "commit_message": "Update docs for JIRA", "files_name": ["tcms/issuetracker/types.py"]}, {"commit_id": "3570fc0710cfdfe986c5d14170e2fcb48dde4e0a", "commit_date": "Fri Jul 28 11:15:44 2023 +0300", "commit_message": "Don't fail Bug Tracker configuration-check if we didn't use OpenGraph", "files_name": []}], "parents": [{"commit_id_before": "ce5b83ef9745f90e24b34a08147e898a52d4c0f3", "url_before": "https://api.github.com/repos/kiwitcms/Kiwi/commits/ce5b83ef9745f90e24b34a08147e898a52d4c0f3", "html_url_before": "https://github.com/kiwitcms/Kiwi/commit/ce5b83ef9745f90e24b34a08147e898a52d4c0f3"}], "details": [{"raw_url": "https://github.com/kiwitcms/Kiwi/raw/d789f4b51025de4f8c747c037d02e1b0da80b034/tcms%2Fkiwi_attachments%2Ftests%2Ftest_validators.py", "code": "# -*- coding: utf-8 -*-\n# pylint: disable=attribute-defined-outside-init, invalid-name, objects-update-used\n\nimport base64\nfrom xmlrpc.client import Fault\n\nfrom django.utils.translation import gettext_lazy as _\nfrom parameterized import parameterized\n\nfrom tcms.rpc.tests.utils import APITestCase\n\n\nclass TestValidators(APITestCase):\n    @parameterized.expand(\n        [\n            \"inline_javascript.svg\",\n            \"inline_javascript_mixed_case.svg\",\n        ]\n    )\n    def test_uploading_svg_with_inline_script_should_fail(self, file_name):\n        with open(f\"tests/ui/data/{file_name}\", \"rb\") as svg_file:\n            b64 = base64.b64encode(svg_file.read()).decode()\n\n            message = str(_(\"File contains forbidden <script> tag\"))\n            with self.assertRaisesRegex(Fault, message):\n                self.rpc_client.User.add_attachment(\"inline_javascript.svg\", b64)\n\n    @parameterized.expand(\n        [\n            \"svg_with_onload_attribute.svg\",\n        ]\n    )\n    def test_uploading_svg_with_forbidden_attributes_should_fail(self, file_name):\n        with open(f\"tests/ui/data/{file_name}\", \"rb\") as svg_file:\n            b64 = base64.b64encode(svg_file.read()).decode()\n\n            message = str(_(\"File contains forbidden attribute:\"))\n            with self.assertRaisesRegex(Fault, message):\n                self.rpc_client.User.add_attachment(\"image.svg\", b64)\n\n    def test_uploading_filename_ending_in_dot_exe_should_fail(self):\n        message = str(_(\"Uploading executable files is forbidden\"))\n        with self.assertRaisesRegex(Fault, message):\n            self.rpc_client.User.add_attachment(\"hello.exe\", \"a2l3aXRjbXM=\")\n\n    def test_uploading_real_exe_file_should_fail(self):\n        with open(\"tests/ui/data/reactos_csrss.exe\", \"rb\") as exe_file:\n            b64 = base64.b64encode(exe_file.read()).decode()\n\n            message = str(_(\"Uploading executable files is forbidden\"))\n            with self.assertRaisesRegex(Fault, message):\n                self.rpc_client.User.add_attachment(\"csrss.exe_from_reactos\", b64)\n", "code_before": "# -*- coding: utf-8 -*-\n# pylint: disable=attribute-defined-outside-init, invalid-name, objects-update-used\n\nimport base64\nfrom xmlrpc.client import Fault\n\nfrom django.utils.translation import gettext_lazy as _\nfrom parameterized import parameterized\n\nfrom tcms.rpc.tests.utils import APITestCase\n\n\nclass TestValidators(APITestCase):\n    @parameterized.expand(\n        [\n            \"inline_javascript.svg\",\n            \"inline_javascript_mixed_case.svg\",\n        ]\n    )\n    def test_uploading_svg_with_inline_script_should_fail(self, file_name):\n        with open(f\"tests/ui/data/{file_name}\", \"rb\") as svg_file:\n            b64 = base64.b64encode(svg_file.read()).decode()\n\n            message = str(_(\"File contains forbidden <script> tag\"))\n            with self.assertRaisesRegex(Fault, message):\n                self.rpc_client.User.add_attachment(\"inline_javascript.svg\", b64)\n\n    def test_uploading_filename_ending_in_dot_exe_should_fail(self):\n        message = str(_(\"Uploading executable files is forbidden\"))\n        with self.assertRaisesRegex(Fault, message):\n            self.rpc_client.User.add_attachment(\"hello.exe\", \"a2l3aXRjbXM=\")\n\n    def test_uploading_real_exe_file_should_fail(self):\n        with open(\"tests/ui/data/reactos_csrss.exe\", \"rb\") as exe_file:\n            b64 = base64.b64encode(exe_file.read()).decode()\n\n            message = str(_(\"Uploading executable files is forbidden\"))\n            with self.assertRaisesRegex(Fault, message):\n                self.rpc_client.User.add_attachment(\"csrss.exe_from_reactos\", b64)\n", "patch": "@@ -25,6 +25,19 @@ def test_uploading_svg_with_inline_script_should_fail(self, file_name):\n             with self.assertRaisesRegex(Fault, message):\n                 self.rpc_client.User.add_attachment(\"inline_javascript.svg\", b64)\n \n+    @parameterized.expand(\n+        [\n+            \"svg_with_onload_attribute.svg\",\n+        ]\n+    )\n+    def test_uploading_svg_with_forbidden_attributes_should_fail(self, file_name):\n+        with open(f\"tests/ui/data/{file_name}\", \"rb\") as svg_file:\n+            b64 = base64.b64encode(svg_file.read()).decode()\n+\n+            message = str(_(\"File contains forbidden attribute:\"))\n+            with self.assertRaisesRegex(Fault, message):\n+                self.rpc_client.User.add_attachment(\"image.svg\", b64)\n+\n     def test_uploading_filename_ending_in_dot_exe_should_fail(self):\n         message = str(_(\"Uploading executable files is forbidden\"))\n         with self.assertRaisesRegex(Fault, message):", "file_path": "files/2023_6/751", "file_language": "py", "file_name": "tcms/kiwi_attachments/tests/test_validators.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 1, "llm_check": 1, "static_check": 0, "static": {"rats": [false, []], "semgrep": [false, []]}, "target": -1, "function_before": [], "function_after": []}, {"raw_url": "https://github.com/kiwitcms/Kiwi/raw/d789f4b51025de4f8c747c037d02e1b0da80b034/tcms%2Fkiwi_attachments%2Fvalidators.py", "code": "from django.forms import ValidationError\nfrom django.utils.translation import gettext_lazy as _\n\n\ndef deny_uploads_containing_script_tag(uploaded_file):\n    for chunk in uploaded_file.chunks(2048):\n        if chunk.lower().find(b\"<script\") > -1:\n            raise ValidationError(_(\"File contains forbidden <script> tag\"))\n\n        if chunk.lower().find(b\"onload=\") > -1:\n            raise ValidationError(_(\"File contains forbidden attribute:\") + \"onload\")\n\n\ndef deny_uploads_ending_in_dot_exe(uploaded_file):\n    message = _(\"Uploading executable files is forbidden\")\n\n    if uploaded_file.name.find(\".exe\") > -1:\n        raise ValidationError(message)\n\n    if uploaded_file.content_type in [\n        \"application/vnd.microsoft.portable-executable\",\n        \"application/x-dosexec\",\n        \"application/x-ms-dos-executable\",\n        \"application/x-msdownload\",\n    ]:\n        raise ValidationError(message)\n", "code_before": "from django.forms import ValidationError\nfrom django.utils.translation import gettext_lazy as _\n\n\ndef deny_uploads_containing_script_tag(uploaded_file):\n    for chunk in uploaded_file.chunks(2048):\n        if chunk.lower().find(b\"<script\") > -1:\n            raise ValidationError(_(\"File contains forbidden <script> tag\"))\n\n\ndef deny_uploads_ending_in_dot_exe(uploaded_file):\n    message = _(\"Uploading executable files is forbidden\")\n\n    if uploaded_file.name.find(\".exe\") > -1:\n        raise ValidationError(message)\n\n    if uploaded_file.content_type in [\n        \"application/vnd.microsoft.portable-executable\",\n        \"application/x-dosexec\",\n        \"application/x-ms-dos-executable\",\n        \"application/x-msdownload\",\n    ]:\n        raise ValidationError(message)\n", "patch": "@@ -7,6 +7,9 @@ def deny_uploads_containing_script_tag(uploaded_file):\n         if chunk.lower().find(b\"<script\") > -1:\n             raise ValidationError(_(\"File contains forbidden <script> tag\"))\n \n+        if chunk.lower().find(b\"onload=\") > -1:\n+            raise ValidationError(_(\"File contains forbidden attribute:\") + \"onload\")\n+\n \n def deny_uploads_ending_in_dot_exe(uploaded_file):\n     message = _(\"Uploading executable files is forbidden\")", "file_path": "files/2023_6/752", "file_language": "py", "file_name": "tcms/kiwi_attachments/validators.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 1, "llm_check": 0, "static_check": 0, "static": {"rats": [false, []], "semgrep": [false, []]}, "target": 0, "function_before": [{"function": "def deny_uploads_containing_script_tag(uploaded_file):\n    for chunk in uploaded_file.chunks(2048):\n        if chunk.lower().find(b\"<script\") > -1:\n            raise ValidationError(_(\"File contains forbidden <script> tag\"))", "target": 0}, {"function": "def deny_uploads_ending_in_dot_exe(uploaded_file):\n    message = _(\"Uploading executable files is forbidden\")\n\n    if uploaded_file.name.find(\".exe\") > -1:\n        raise ValidationError(message)\n\n    if uploaded_file.content_type in [\n        \"application/vnd.microsoft.portable-executable\",\n        \"application/x-dosexec\",\n        \"application/x-ms-dos-executable\",\n        \"application/x-msdownload\",\n    ]:\n        raise ValidationError(message)", "target": 0}], "function_after": [{"function": "def deny_uploads_containing_script_tag(uploaded_file):\n    for chunk in uploaded_file.chunks(2048):\n        if chunk.lower().find(b\"<script\") > -1:\n            raise ValidationError(_(\"File contains forbidden <script> tag\"))\n\n        if chunk.lower().find(b\"onload=\") > -1:\n            raise ValidationError(_(\"File contains forbidden attribute:\") + \"onload\")", "target": 0}, {"function": "def deny_uploads_ending_in_dot_exe(uploaded_file):\n    message = _(\"Uploading executable files is forbidden\")\n\n    if uploaded_file.name.find(\".exe\") > -1:\n        raise ValidationError(message)\n\n    if uploaded_file.content_type in [\n        \"application/vnd.microsoft.portable-executable\",\n        \"application/x-dosexec\",\n        \"application/x-ms-dos-executable\",\n        \"application/x-msdownload\",\n    ]:\n        raise ValidationError(message)", "target": 0}]}, {"raw_url": "https://github.com/kiwitcms/Kiwi/raw/d789f4b51025de4f8c747c037d02e1b0da80b034/tests%2Fui%2Fdata%2Fsvg_with_onload_attribute.svg", "code": "<svg xmlns=\"http://www.w3.org/2000/svg\" onload=\"alert(document.domain)\"><defs><font id=\"x\"><font-face font-family=\"y\"/></font></defs></svg>\n", "code_before": "", "patch": "@@ -0,0 +1 @@\n+<svg xmlns=\"http://www.w3.org/2000/svg\" onload=\"alert(document.domain)\"><defs><font id=\"x\"><font-face font-family=\"y\"/></font></defs></svg>", "file_path": "files/2023_6/753", "file_language": "svg", "file_name": "tests/ui/data/svg_with_onload_attribute.svg", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
