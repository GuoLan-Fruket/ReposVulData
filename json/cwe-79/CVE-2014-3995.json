{"index": 623, "cve_id": "CVE-2014-3995", "cwe_id": ["CWE-79"], "cve_language": "Python", "cve_description": "Cross-site scripting (XSS) vulnerability in gravatars/templatetags/gravatars.py in Djblets before 0.7.30 and 0.8.x before 0.8.3 for Django allows remote attackers to inject arbitrary web script or HTML via a user display name.", "cvss": "3.7", "publish_date": "June 16, 2014", "AV": "NETWORK", "AC": "NETWORK", "PR": "NONE", "UI": "NONE", "S": "UNCHANGED", "C": "NONE", "I": "LOW", "A": "NONE", "commit_id": "77ac64642ad530bf69e390c51fc6fdcb8914c8e7", "commit_message": "Fix a XSS vulnerability in the gravatar template tag.\n\nThe generated gravatar HTML wasn't handling escaping of the display name\nof the user, allowing an attacker to choose a name that would close out\nthe <img> tag and inject a <script> tag.\n\nBy switching to Django's format_html(), we can guarantee safe escaping\nof content.", "commit_date": "2014-06-06T19:54:10Z", "project": "djblets/djblets", "url": "https://api.github.com/repos/djblets/djblets/commits/77ac64642ad530bf69e390c51fc6fdcb8914c8e7", "html_url": "https://github.com/djblets/djblets/commit/77ac64642ad530bf69e390c51fc6fdcb8914c8e7", "windows_before": [{"commit_id": "77a68c03cd619a0996f3f37337b8c39ca6643d6e", "commit_date": "Fri Jun 6 01:28:03 2014 -0700", "commit_message": "Fix a XSS vulnerability with bad input to json_dumps.", "files_name": ["djblets/util/templatetags/djblets_js.py", "djblets/util/templatetags/tests.py"]}, {"commit_id": "05d6a9bcf01c98ade4b36d9723d15ad046e4320c", "commit_date": "Fri Jun 6 12:45:12 2014 -0700", "commit_message": "Release Djblets 0.7.30.", "files_name": ["NEWS", "djblets/__init__.py"]}, {"commit_id": "749b2d22a318f3b815fd4a3513e1983b5a2346e3", "commit_date": "Fri Jun 6 12:49:57 2014 -0700", "commit_message": "Fix running the webapi unit tests on Python 2.5.", "files_name": ["djblets/webapi/tests.py"]}, {"commit_id": "7afc593b9e94f2c5bb1690f257f5f31790ad43f0", "commit_date": "Fri Jun 6 01:43:12 2014 -0700", "commit_message": "Fix a XSS vulnerability in the gravatar template tag.", "files_name": ["djblets/gravatars/templatetags/gravatars.py", "djblets/gravatars/templatetags/tests.py"]}, {"commit_id": "d3e428a6f7bc4c04d100b06e663c071fdc1717d9", "commit_date": "Fri Jun 6 01:28:03 2014 -0700", "commit_message": "Fix a XSS vulnerability with bad input to json_dumps.", "files_name": ["djblets/util/templatetags/djblets_js.py", "djblets/util/templatetags/tests.py"]}, {"commit_id": "708d1b36c682d234ebce5ca719664ad496f1200b", "commit_date": "Wed Jun 4 14:56:28 2014 -0700", "commit_message": "Fix reloading of logging settings.", "files_name": ["djblets/log/__init__.py"]}, {"commit_id": "69acbdd652fb7a64a014e9589c99e502a1d19910", "commit_date": "Mon Jun 2 11:57:12 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["122ce659f2ea73e50bac23cb5e4af4edce96cbff - Mon Jun 2 11:56:51 2014 -0700 : Merge tag 'release-0.8.2' into release-0.8.x", "57ee1a02107347e84989db30bd46b0d17a3903f2 - Mon Jun 2 11:55:27 2014 -0700 : Release Djblets 0.8.2.", "NEWS", "djblets/__init__.py"]}, {"commit_id": "6ebd886ebbeee3be36806c19d560bc074740957d", "commit_date": "Mon Jun 2 11:53:34 2014 -0700", "commit_message": "Include .less files in builds.", "files_name": ["MANIFEST.in"]}, {"commit_id": "23897af74d33c4bd97927ad7ebefc4150761aa0a", "commit_date": "Sun Jun 1 00:09:07 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["3dad68113e3bf8a1bd4c9acbb5ebecd07890a683 - Fri May 30 03:25:39 2014 -0700 : Cache object lookups in WebAPIResource.get_object.", "djblets/webapi/resources.py"]}, {"commit_id": "b059f6ff14d4658c6831b53af1985c810af9a189", "commit_date": "Fri May 30 03:06:16 2014 -0700", "commit_message": "Speed up unit tests for projects that use extensions.", "files_name": ["djblets/extensions/manager.py", "djblets/extensions/middleware.py"]}, {"commit_id": "8008ae382150a5f79b639808c2416235dbbcd9b0", "commit_date": "Thu May 29 16:29:29 2014 -0700", "commit_message": "Split djblets.webapi.core into smaller modules.", "files_name": ["djblets/webapi/auth.py", "djblets/webapi/core.py", "djblets/webapi/decorators.py", "djblets/webapi/encoders.py", "djblets/webapi/resources.py", "djblets/webapi/responses.py"]}, {"commit_id": "928ed7754ba4b16f946509f7ff1a3de5664054f7", "commit_date": "Thu May 29 02:26:16 2014 -0700", "commit_message": "Add support for custom paginated responses in API resources.", "files_name": ["djblets/webapi/core.py", "djblets/webapi/resources.py"]}, {"commit_id": "b43a44a54b61aaa36a8bb8dcf820a1f975bd84d3", "commit_date": "Mon May 26 17:17:40 2014 -0700", "commit_message": "Add a LocalDataQuerySet for using generic data in WebAPIResource.", "files_name": ["djblets/db/query.py", "djblets/db/tests.py", "djblets/webapi/resources.py"]}, {"commit_id": "59fe35693a17f6908a7eae1e5cc1471dcc02b6a4", "commit_date": "Mon May 26 18:03:15 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["912b6ab7e445e954df80aa4027c2b84b562e6315 - Mon May 26 18:03:07 2014 -0700 : Bump to 0.8.2 dev.", "djblets/__init__.py"]}, {"commit_id": "f9586e9c1c673ec30d1e1c9419263ed11c5abef6", "commit_date": "Mon May 26 17:41:44 2014 -0700", "commit_message": "Release Djblets 0.8.1.", "files_name": ["AUTHORS", "NEWS", "djblets/__init__.py"]}, {"commit_id": "4d758e91faf103c8ad69f63f24808374a01bcd3d", "commit_date": "Mon May 26 17:44:34 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["c7db8c795522183ae334742e46457be78c445bc9 - Mon May 26 17:44:02 2014 -0700 : Set a TRACKING_BRANCH for release-0.8.x in .reviewboardrc.", ".reviewboardrc"]}, {"commit_id": "9589d291f50e4ef1313610f58a42ec41f605c1d9", "commit_date": "Sun May 25 18:51:59 2014 -0700", "commit_message": "Use setuptools instead of distutils for extension packaging.", "files_name": ["djblets/extensions/packaging.py"]}, {"commit_id": "84c5784763aceaea396717a0a4f4c35b162c4550", "commit_date": "Mon May 26 13:17:10 2014 -0700", "commit_message": "Remove the unused fcntl import.", "files_name": ["djblets/extensions/manager.py"]}, {"commit_id": "e8b857e987eeca5545a293cc56b2fcec2d82b522", "commit_date": "Sun May 25 16:02:39 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["db2f6cecbdfb29773750b5755ee5b4561f798baa - Sun May 25 16:01:02 2014 -0700 : Replace fcntl locking with django.core.files.locks", "djblets/extensions/manager.py"]}, {"commit_id": "060d4ee2d103c1e703da839377a592da311032d3", "commit_date": "Fri May 23 17:11:54 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["cb370c6c509724c9e1bdabfc348b0b5430df7f6d - Thu May 22 16:18:05 2014 -0700 : Attempt to handle threading-related issues with extension reloading.", "djblets/extensions/manager.py", "djblets/extensions/middleware.py", "djblets/extensions/tests.py"]}, {"commit_id": "0a2c337cbffac3dd1dad45d319069a521c3e20a4", "commit_date": "Thu May 22 16:28:04 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["d5250cd21fa626a2e22585b4732a0f7641cefb1c - Thu May 22 16:27:15 2014 -0700 : Set the BRANCH in .reviewboardrc for release-0.8.x.", ".reviewboardrc"]}, {"commit_id": "323058a7bcc3e73dfd91cb3f44028b537f0661e3", "commit_date": "Thu May 22 01:21:08 2014 -0700", "commit_message": "Trivial fix for box title styling in config forms.", "files_name": ["djblets/configforms/templates/configforms/config_page.html"]}, {"commit_id": "891d5665d57e1f230104f159201b1d1bf88db273", "commit_date": "Wed May 21 01:15:08 2014 -0700", "commit_message": "Bullet-proof some extension and URL uninitialization code.", "files_name": ["djblets/extensions/manager.py", "djblets/urls/resolvers.py"]}, {"commit_id": "787bdb8528207858588164ded2d474cfdadc8cdb", "commit_date": "Tue May 20 18:24:45 2014 -0700", "commit_message": "Bump to 0.8 alpha 1 dev.", "files_name": ["djblets/__init__.py"]}, {"commit_id": "da531b9b0ca57fd91545f1b6408b7b48e51e9836", "commit_date": "Tue May 20 13:33:49 2014 -0700", "commit_message": "Fix modalBox click handler to respect disabled state", "files_name": ["djblets/static/djblets/js/jquery.gravy.modalBox.js"]}, {"commit_id": "500480a6234f5e8351e8230b7ee1d781344dad95", "commit_date": "Mon May 19 17:03:18 2014 -0700", "commit_message": "Release Djblets 0.8.", "files_name": ["NEWS", "djblets/__init__.py"]}, {"commit_id": "82772cbf3237ebd49ef29be3018a94666ac05f72", "commit_date": "Thu May 15 00:24:41 2014 -0700", "commit_message": "Bump django dependency to 1.6.5", "files_name": ["djblets/__init__.py"]}, {"commit_id": "5f3973e0b0c07367cad9fc0c5335d12e5c62ee68", "commit_date": "Thu May 15 00:23:53 2014 -0700", "commit_message": "Merge branch 'release-0.7.x'", "files_name": ["a41baea996ce3c088788b00d87fa49de6ad1c7a5 - Wed May 14 16:42:09 2014 -0700 : Bump required version of django to 1.7.13", "djblets/__init__.py"]}, {"commit_id": "cfc934a28bd7a4a4da3037908e35c10c39476410", "commit_date": "Mon May 12 16:33:36 2014 -0700", "commit_message": "Fix populating extension settings forms from defaults.", "files_name": ["djblets/extensions/settings.py"]}, {"commit_id": "4f7d8997d537467d39654d79d5f39a87dbb5dbd7", "commit_date": "Thu May 8 18:06:17 2014 -0700", "commit_message": "Bump to 0.8 RC 3 dev.", "files_name": ["djblets/__init__.py"]}, {"commit_id": "f509fefd2a088aa7c09c6cb89b49d88844806cd3", "commit_date": "Thu May 8 02:12:48 2014 -0700", "commit_message": "Release Djblets 0.8 RC 2.", "files_name": ["AUTHORS", "NEWS", "djblets/__init__.py"]}, {"commit_id": "20cf8e27299a022999aa9f1af265e0487ee45ae6", "commit_date": "Tue May 6 15:33:59 2014 -0700", "commit_message": "Add the ability to remove source media files when building extensions.", "files_name": ["djblets/extensions/packaging.py"]}, {"commit_id": "ee7546f47aed1b96727f9d6ad810c4d8eb19538b", "commit_date": "Fri May 2 00:18:07 2014 -0700", "commit_message": "Fix context leaks when using Context.update().", "files_name": ["djblets/datagrid/grids.py", "djblets/extensions/hooks.py"]}, {"commit_id": "6ddc5ed8fdb9d9f421fa05915ce6ce74482724cb", "commit_date": "Fri May 2 15:12:24 2014 -0700", "commit_message": "Merge branch 'release-0.7.x'", "files_name": ["8508d95680ffcfefe0665421ef0cdaf81c1429a6 - Fri May 2 15:09:57 2014 -0700 : Support building media with parallel-installed Django", "contrib/internal/build-media.py", "djblets/__init__.py", "setup.py"]}, {"commit_id": "d0de634c548177756d5d6d18e6e6df907d4dd7d7", "commit_date": "Thu May 1 13:36:05 2014 -0700", "commit_message": "Fix leaking data between TemplateHooks and add sandboxing.", "files_name": ["djblets/extensions/hooks.py", "djblets/extensions/templatetags/djblets_extensions.py", "djblets/extensions/tests.py"]}, {"commit_id": "74bcc4cc160fc4297129a4deb205c8f4706d9e1b", "commit_date": "Tue Apr 29 14:11:44 2014 -0700", "commit_message": "Use more explicit CSS class names for boxes in configforms.", "files_name": ["djblets/configforms/templates/configforms/config.html", "djblets/configforms/templates/configforms/config_page.html", "djblets/static/djblets/css/config-forms.less"]}, {"commit_id": "af59e80aa8046989aae7bbc40e60e8976ee2b49f", "commit_date": "Tue Apr 29 14:54:44 2014 -0700", "commit_message": "Merge branch 'release-0.7.x'", "files_name": ["6f677e8e392eca413cbaffbde1fee3c55d09f9a3 - Wed Apr 23 13:39:26 2014 -0700 : Always encode GET parameters back to bytes before calling urllib.quote()", "djblets/webapi/core.py", "djblets/webapi/tests.py"]}, {"commit_id": "67f5cd2bc5b1f742eb807eb0a993e22b1a903dd8", "commit_date": "Fri Apr 25 15:55:33 2014 -0700", "commit_message": "Update locale files for Djblets.", "files_name": ["djblets/locale/en/LC_MESSAGES/django.po", "djblets/locale/en/LC_MESSAGES/djangojs.po", "djblets/locale/it_IT/LC_MESSAGES/django.po", "djblets/locale/it_IT/LC_MESSAGES/djangojs.po", "djblets/locale/ko_KR/LC_MESSAGES/django.po", "djblets/locale/ko_KR/LC_MESSAGES/djangojs.po", "djblets/locale/zh_TW/LC_MESSAGES/django.po", "djblets/locale/zh_TW/LC_MESSAGES/djangojs.po", "djblets/settings.py"]}, {"commit_id": "6008fcaa17612bc69bfdf0b540d3a4c65e6d37c4", "commit_date": "Tue Apr 22 17:01:27 2014 -0700", "commit_message": "Use jasmine.suites for all Djblets JavaScript unit tests.", "files_name": ["djblets/static/djblets/js/configForms/models/tests/listItemModelTests.js", "djblets/static/djblets/js/configForms/views/tests/listItemViewTests.js", "djblets/static/djblets/js/configForms/views/tests/listViewTests.js"]}, {"commit_id": "4d940cabe9c5e0f16aaa1e3f2cb26e519bade5e5", "commit_date": "Wed Apr 16 18:58:31 2014 -0700", "commit_message": "Fix some rendering-related problems with ListView and ListItemView.", "files_name": ["djblets/static/djblets/js/configForms/views/listItemView.js", "djblets/static/djblets/js/configForms/views/listView.js"]}, {"commit_id": "0c35441c538336ba31a16a9ed6e1c51796f13701", "commit_date": "Tue Apr 22 17:22:52 2014 -0700", "commit_message": "Fixed get_url_params_except function to work with not ascii contain query", "files_name": ["djblets/util/http.py"]}, {"commit_id": "fc1adf88fa82f2a5912347b4caecbc3c15bf269b", "commit_date": "Wed Apr 16 16:16:00 2014 -0700", "commit_message": "Add TableView and TableItemView to configForms.", "files_name": ["djblets/settings.py", "djblets/static/djblets/js/configForms/views/tableItemView.js", "djblets/static/djblets/js/configForms/views/tableView.js"]}, {"commit_id": "125db831cd971af3348ecc19e40df17543fcc6f0", "commit_date": "Fri Apr 11 02:20:11 2014 -0700", "commit_message": "Add Djblets JS unit test bundles and fix configForms icons and tests.", "files_name": ["djblets/settings.py", "djblets/static/djblets/js/configForms/views/listItemView.js", "djblets/static/djblets/js/configForms/views/tests/listItemViewTests.js"]}, {"commit_id": "18ba43d0dfa6207ec64761d7467ebd651943246c", "commit_date": "Thu Apr 10 03:09:27 2014 -0700", "commit_message": "Add some presentation improvements for configforms.", "files_name": ["djblets/static/djblets/css/config-forms.less", "djblets/static/djblets/js/configForms/views/listItemView.js"]}, {"commit_id": "729497967fec810af3c029210ab7050d3147fa11", "commit_date": "Thu Apr 10 02:55:28 2014 -0700", "commit_message": "Serialize with the correct resource using get_serializer_for_object.", "files_name": ["djblets/webapi/core.py", "djblets/webapi/encoders.py", "djblets/webapi/resources.py"]}, {"commit_id": "94bb540753f60c3f9c37c97bdd4774c40ce197a6", "commit_date": "Thu Apr 10 02:09:00 2014 -0700", "commit_message": "Provide nicer access to siteconfig settings in templates.", "files_name": ["djblets/siteconfig/admin.py"]}], "windows_after": [{"commit_id": "16299c1cf37b3630559fcf9edc5228f94ff591bb", "commit_date": "Fri Jun 6 12:55:30 2014 -0700", "commit_message": "Merge branch 'release-0.7.x' into dev-0.8.3", "files_name": ["1ad45eaffc69add8b2179f3f0b506cf996f56a8b - Fri Jun 6 12:57:26 2014 -0700 : Release Djblets 0.8.3.", "djblets/__init__.py"]}, {"commit_id": "bf2c1545791ffb4d80f064b7791dfd0649284c54", "commit_date": "Fri Jun 6 12:58:44 2014 -0700", "commit_message": "Merge branch 'dev-0.8.3' into release-0.8.x", "files_name": ["fe1b3c059541642b209489137af0a1346eacbe46 - Fri Jun 6 12:58:53 2014 -0700 : Merge branch 'release-0.8.x'", "50000d0bbb983fa8c097b588d06b64df8df483bd - Sat Jun 7 22:13:38 2014 -0700 : Update the 0.7.30 release notes with the CVEs.", "NEWS"]}, {"commit_id": "28c5e029acae462001cf87752ce00aee64fd8cf0", "commit_date": "Sat Jun 7 22:14:27 2014 -0700", "commit_message": "Merge branch 'release-0.7.x' into release-0.8.x", "files_name": ["e2c79117efd925636acd871a5f473512602243cf - Sat Jun 7 22:14:45 2014 -0700 : Update the 0.8.3 release notes with the CVEs.", "NEWS"]}, {"commit_id": "8a80da2a1bc5db97ec7da70587d2a2c0475f85c7", "commit_date": "Sat Jun 7 22:14:56 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["0ef3dc000f84ca744b8c3e4a876b85dc357329b4 - Sun Jun 8 21:15:30 2014 -0700 : Allow passing request in to SiteSettingsForms.", "djblets/siteconfig/forms.py", "djblets/siteconfig/views.py"]}, {"commit_id": "84c7a46da2388d5a8ac1671ceb7d5a5feebf85cc", "commit_date": "Mon Jun 9 12:59:21 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["46369325ac7e775464a44423ba4d18de8af3dd1b - Tue Jun 10 13:02:07 2014 -0700 : Fix saving extension settings.", "djblets/extensions/tests.py", "djblets/siteconfig/forms.py", "djblets/siteconfig/views.py"]}, {"commit_id": "21a5d5dc84a61b85804a5d253a863f2e1bcf4160", "commit_date": "Tue Jun 10 15:38:49 2014 -0700", "commit_message": "Fix the extension 'enabled' state in the API after enabling/disabling.", "files_name": ["djblets/extensions/resources.py"]}, {"commit_id": "a09ff16a2e4f51ef250acda88401ecef2505e438", "commit_date": "Tue Jun 10 15:44:37 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["1c92d3501669bad776675a8b1aa3d074f8c1cb10 - Thu Jun 12 17:19:36 2014 -0700 : Fix issue with links in description/testing done.", "djblets/static/djblets/js/jquery.gravy.inlineEditor.js"]}, {"commit_id": "3bf0e29baa504685fa6f6ece2d01214b8bf88ce0", "commit_date": "Sat Jun 7 01:14:35 2014 -0700", "commit_message": "Add release notes for Djblets 0.8.4.", "files_name": ["AUTHORS", "NEWS"]}, {"commit_id": "64c703fd60977b13b37ed2c8fcd6137eb81f52cd", "commit_date": "Thu Jun 12 17:45:44 2014 -0700", "commit_message": "Release Djblets 0.8.4.", "files_name": ["djblets/__init__.py"]}, {"commit_id": "efaac6432d4ef32112661b2fc542e0eb26664574", "commit_date": "Thu Jun 12 17:47:18 2014 -0700", "commit_message": "Bump to 0.8.5 dev.", "files_name": ["djblets/__init__.py"]}, {"commit_id": "d946dc7810a78868e6f2f26ad3e60d240bc9e462", "commit_date": "Thu Jun 12 17:47:27 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["66ee7a60cda811b1b3dbae89e5a7146decb3ecdb - Fri Jun 13 14:37:01 2014 -0700 : Fix the calculation of the previous index in a paginated resource list.", "AUTHORS", "djblets/webapi/responses.py"]}, {"commit_id": "91ee66f0682a19b18d352643b89d765274d8fd67", "commit_date": "Fri Jun 13 14:39:23 2014 -0700", "commit_message": "Release Djblets 0.8.5.", "files_name": ["NEWS", "djblets/__init__.py"]}, {"commit_id": "cbdf9beaf5b707c40379f7afe87b82a01386f033", "commit_date": "Fri Jun 13 14:40:11 2014 -0700", "commit_message": "Bump to 0.8.5 dev.", "files_name": ["djblets/__init__.py"]}, {"commit_id": "3c546cb069e373f5f1c61310a4b2242d334ccc67", "commit_date": "Fri Jun 13 14:40:19 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["8f01310e9c318d3f9c72eac1dc066e5d8db9411f - Sat Jun 14 15:03:39 2014 -0700 : Improve style customization of the configforms templates.", "djblets/configforms/templates/configforms/config.html", "djblets/configforms/templates/configforms/config_page.html", "djblets/configforms/templates/configforms/config_page_form.html", "djblets/configforms/views.py", "djblets/util/templatetags/djblets_forms.py"]}, {"commit_id": "2246feb2395b4b88d47ecef5e3e8f19f36d545ca", "commit_date": "Sun Jun 15 00:08:51 2014 -0700", "commit_message": "Fix config forms item action and spinner styles in Firefox.", "files_name": ["djblets/static/djblets/css/config-forms.less", "djblets/static/djblets/js/configForms/views/listItemView.js", "djblets/static/djblets/js/configForms/views/tests/listItemViewTests.js"]}, {"commit_id": "7bbc648a805a17d04102d20a4b7e42515002ebe2", "commit_date": "Mon Jun 16 16:57:36 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["c79ff441bd88d686e22390c62f35d15252e8a096 - Tue Jun 17 00:07:37 2014 -0700 : Avoid deleting previous PYTHONPATH", "setup.py"]}, {"commit_id": "40114295ead9045d93e3f5ec93c9f8ab35b0aadb", "commit_date": "Tue Jun 17 00:10:15 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["839e413f9739f002f8c1930a17e0ea1e87514df8 - Tue Jun 17 00:37:36 2014 -0700 : Fix a couple style issues in config-forms.less.", "djblets/static/djblets/css/config-forms.less"]}, {"commit_id": "a08faf65f03d75f8e8abf18533fd3298a159ee41", "commit_date": "Tue Jun 17 02:19:22 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["5dcd34e56c77fbc519b5a92ff8275f8c557d736b - Thu Jun 19 01:41:40 2014 -0700 : Make middle or control-clicking on dashboard cells work properly.", "djblets/datagrid/templates/datagrid/cell.html", "djblets/static/djblets/js/datagrid.js"]}, {"commit_id": "a53cfe54cbb3c84300ba5d3c3b17cac9c998bdaf", "commit_date": "Thu Jun 19 14:05:55 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["c729e3c49967e070662df4a2debadc4a84c5f4b9 - Sat Jun 28 16:53:35 2014 -0700 : Don't break when trying to check if TemplateHooks apply on 404s.", "djblets/extensions/hooks.py"]}, {"commit_id": "ecdbe8337f6cd1020461310cd762c8185b560e4f", "commit_date": "Thu Jul 3 12:49:47 2014 -0700", "commit_message": "Fix various issues with configforms table views.", "files_name": ["djblets/settings.py", "djblets/static/djblets/js/configForms/views/listItemView.js", "djblets/static/djblets/js/configForms/views/listView.js", "djblets/static/djblets/js/configForms/views/tableItemView.js", "djblets/static/djblets/js/configForms/views/tableView.js", "djblets/static/djblets/js/configForms/views/tests/listItemViewTests.js", "djblets/static/djblets/js/configForms/views/tests/tableItemViewTests.js", "djblets/static/djblets/js/configForms/views/tests/tableViewTests.js"]}, {"commit_id": "189edb783a7df220d331f6a58046699bd3a5963d", "commit_date": "Thu Jul 3 18:45:15 2014 -0700", "commit_message": "Fix issues enabling extensions containing copy/pasted settings.", "files_name": ["djblets/extensions/manager.py", "djblets/extensions/tests.py"]}, {"commit_id": "377bdf81fce4ef6c2e4bc6e890d5c0dc2b9aa6c2", "commit_date": "Sat Jul 5 01:32:54 2014 -0700", "commit_message": "Clean up some PyFlakes warnings in Djblets.", "files_name": ["djblets/extensions/packaging.py", "djblets/extensions/tests.py"]}, {"commit_id": "f38476fde617e117f105124586a6e020cf6007b6", "commit_date": "Fri Jul 4 01:50:52 2014 -0700", "commit_message": "Clean up all Djblets JavaScript warnings and errors from jshint.", "files_name": ["djblets/static/djblets/js/datagrid.js", "djblets/static/djblets/js/extensions/models/extensionManagerModel.js", "djblets/static/djblets/js/extensions/views/extensionManagerView.js", "djblets/static/djblets/js/jquery.gravy.autosize.js", "djblets/static/djblets/js/jquery.gravy.funcQueue.js", "djblets/static/djblets/js/jquery.gravy.hacks.js", "djblets/static/djblets/js/jquery.gravy.inlineEditor.js", "djblets/static/djblets/js/jquery.gravy.modalBox.js", "djblets/static/djblets/js/jquery.gravy.retina.js", "djblets/static/djblets/js/jquery.gravy.util.js"]}, {"commit_id": "fd08e057eee62c9f1a429816a737c3dc6b2a1902", "commit_date": "Sun Jul 6 20:48:59 2014 -0700", "commit_message": "Fixed log initialization on Windows.", "files_name": ["djblets/log/__init__.py"]}, {"commit_id": "1d49a0c3f6b39707eea250fe013de096e33fa52b", "commit_date": "Sat Jul 5 20:55:58 2014 -0700", "commit_message": "Merge branch 'release-0.8.x'", "files_name": ["e20f0742c40fc4e6915145b81a9b6204face5ef5 - Mon Jul 7 13:57:02 2014 -0700 : Merge branch 'release-0.8.x'", "5348e890236c548a8f89c59992a523c95a855b9f - Mon Jul 7 03:24:08 2014 -0700 : Add new template loaders for conditional caching and namespaced apps.", "djblets/template/__init__.py", "djblets/template/loaders/__init__.py", "djblets/template/loaders/conditional_cached.py", "djblets/template/loaders/namespaced_app_dirs.py"]}, {"commit_id": "f21a21ded110b62646ad436f0934c5860d34280a", "commit_date": "Sat Jul 5 14:49:31 2014 -0700", "commit_message": "Move the Djblets release notes into ReST files.", "files_name": [".gitignore", "NEWS", "contrib/internal/release.py", "docs/releasenotes/0.5-alpha-2.rst", "docs/releasenotes/0.5-alpha-3.rst", "docs/releasenotes/0.5-beta-1.rst", "docs/releasenotes/0.5-rc-1.rst", "docs/releasenotes/0.5-rc-2.rst", "docs/releasenotes/0.5.1.rst", "docs/releasenotes/0.5.2.rst", "docs/releasenotes/0.5.3.rst", "docs/releasenotes/0.5.4.rst", "docs/releasenotes/0.5.5.rst", "docs/releasenotes/0.5.6.rst", "docs/releasenotes/0.5.7.rst", "docs/releasenotes/0.5.8.rst", "docs/releasenotes/0.5.9.rst", "docs/releasenotes/0.5.rst", "docs/releasenotes/0.6.1.rst", "docs/releasenotes/0.6.10.rst", "docs/releasenotes/0.6.11.rst", "docs/releasenotes/0.6.12.rst", "docs/releasenotes/0.6.13.rst", "docs/releasenotes/0.6.14.rst", "docs/releasenotes/0.6.15.rst", "docs/releasenotes/0.6.16.rst", "docs/releasenotes/0.6.17.rst", "docs/releasenotes/0.6.18.rst", "docs/releasenotes/0.6.19.rst", "docs/releasenotes/0.6.2.rst", "docs/releasenotes/0.6.20.rst", "docs/releasenotes/0.6.21.rst", "docs/releasenotes/0.6.22.rst", "docs/releasenotes/0.6.23.rst", "docs/releasenotes/0.6.24.rst", "docs/releasenotes/0.6.25.rst", "docs/releasenotes/0.6.26.rst", "docs/releasenotes/0.6.27.rst", "docs/releasenotes/0.6.28.rst", "docs/releasenotes/0.6.29.rst", "docs/releasenotes/0.6.3.rst", "docs/releasenotes/0.6.30.rst", "docs/releasenotes/0.6.31.rst", "docs/releasenotes/0.6.4.rst", "docs/releasenotes/0.6.5.rst", "docs/releasenotes/0.6.6.rst", "docs/releasenotes/0.6.7.rst", "docs/releasenotes/0.6.8.rst", "docs/releasenotes/0.6.9.rst", "docs/releasenotes/0.6.rst", "docs/releasenotes/0.7.1.rst", "docs/releasenotes/0.7.10.rst", "docs/releasenotes/0.7.11.rst", "docs/releasenotes/0.7.12.rst", "docs/releasenotes/0.7.13.rst", "docs/releasenotes/0.7.14.rst", "docs/releasenotes/0.7.15.rst", "docs/releasenotes/0.7.16.rst", "docs/releasenotes/0.7.17.rst", "docs/releasenotes/0.7.18.rst", "docs/releasenotes/0.7.19.rst", "docs/releasenotes/0.7.2.rst", "docs/releasenotes/0.7.20.rst", "docs/releasenotes/0.7.21.rst", "docs/releasenotes/0.7.22.rst", "docs/releasenotes/0.7.23.rst", "docs/releasenotes/0.7.24.rst", "docs/releasenotes/0.7.25.rst", "docs/releasenotes/0.7.26.rst", "docs/releasenotes/0.7.27.rst", "docs/releasenotes/0.7.28.rst"]}], "parents": [{"commit_id_before": "77a68c03cd619a0996f3f37337b8c39ca6643d6e", "url_before": "https://api.github.com/repos/djblets/djblets/commits/77a68c03cd619a0996f3f37337b8c39ca6643d6e", "html_url_before": "https://github.com/djblets/djblets/commit/77a68c03cd619a0996f3f37337b8c39ca6643d6e"}], "details": [{"raw_url": "https://github.com/djblets/djblets/raw/77ac64642ad530bf69e390c51fc6fdcb8914c8e7/djblets%2Fgravatars%2Ftemplatetags%2Fgravatars.py", "code": "#\n# gravatars.py -- Decorational template tags\n#\n# Copyright (c) 2008-2009  Christian Hammond\n#\n# Permission is hereby granted, free of charge, to any person obtaining\n# a copy of this software and associated documentation files (the\n# \"Software\"), to deal in the Software without restriction, including\n# without limitation the rights to use, copy, modify, merge, publish,\n# distribute, sublicense, and/or sell copies of the Software, and to\n# permit persons to whom the Software is furnished to do so, subject to\n# the following conditions:\n#\n# The above copyright notice and this permission notice shall be included\n# in all copies or substantial portions of the Software.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n# EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n# IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n# CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n# TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n# SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfrom __future__ import unicode_literals\n\nfrom django import template\nfrom django.utils.html import format_html\n\nfrom djblets.gravatars import (get_gravatar_url,\n                               get_gravatar_url_for_email)\nfrom djblets.util.decorators import basictag\n\n\nregister = template.Library()\n\n\n@register.tag\n@basictag(takes_context=True)\ndef gravatar(context, user, size=None):\n    \"\"\"\n    Outputs the HTML for displaying a user's gravatar.\n\n    This can take an optional size of the image (defaults to 80 if not\n    specified).\n\n    This is also influenced by the following settings:\n\n        GRAVATAR_SIZE    - Default size for gravatars\n        GRAVATAR_RATING  - Maximum allowed rating (g, pg, r, x)\n        GRAVATAR_DEFAULT - Default image set to show if the user hasn't\n                           specified a gravatar (identicon, monsterid, wavatar)\n\n    See http://www.gravatar.com/ for more information.\n    \"\"\"\n    url = get_gravatar_url(context['request'], user, size)\n\n    if url:\n        return format_html(\n            '<img src=\"{0}\" width=\"{1}\" height=\"{1}\" alt=\"{2}\" '\n            'class=\"gravatar\"/>',\n            url, size, user.get_full_name() or user.username)\n    else:\n        return ''\n\n\n@register.tag\n@basictag(takes_context=True)\ndef gravatar_url(context, email, size=None):\n    \"\"\"\n    Outputs the URL for a gravatar for the given email address.\n\n    This can take an optional size of the image (defaults to 80 if not\n    specified).\n\n    This is also influenced by the following settings:\n\n        GRAVATAR_SIZE    - Default size for gravatars\n        GRAVATAR_RATING  - Maximum allowed rating (g, pg, r, x)\n        GRAVATAR_DEFAULT - Default image set to show if the user hasn't\n                           specified a gravatar (identicon, monsterid, wavatar)\n\n    See http://www.gravatar.com/ for more information.\n    \"\"\"\n    return get_gravatar_url_for_email(context['request'], email, size)\n", "code_before": "#\n# gravatars.py -- Decorational template tags\n#\n# Copyright (c) 2008-2009  Christian Hammond\n#\n# Permission is hereby granted, free of charge, to any person obtaining\n# a copy of this software and associated documentation files (the\n# \"Software\"), to deal in the Software without restriction, including\n# without limitation the rights to use, copy, modify, merge, publish,\n# distribute, sublicense, and/or sell copies of the Software, and to\n# permit persons to whom the Software is furnished to do so, subject to\n# the following conditions:\n#\n# The above copyright notice and this permission notice shall be included\n# in all copies or substantial portions of the Software.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n# EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n# IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n# CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n# TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n# SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfrom __future__ import unicode_literals\n\nfrom django import template\n\nfrom djblets.gravatars import (get_gravatar_url,\n                               get_gravatar_url_for_email)\nfrom djblets.util.decorators import basictag\n\n\nregister = template.Library()\n\n\n@register.tag\n@basictag(takes_context=True)\ndef gravatar(context, user, size=None):\n    \"\"\"\n    Outputs the HTML for displaying a user's gravatar.\n\n    This can take an optional size of the image (defaults to 80 if not\n    specified).\n\n    This is also influenced by the following settings:\n\n        GRAVATAR_SIZE    - Default size for gravatars\n        GRAVATAR_RATING  - Maximum allowed rating (g, pg, r, x)\n        GRAVATAR_DEFAULT - Default image set to show if the user hasn't\n                           specified a gravatar (identicon, monsterid, wavatar)\n\n    See http://www.gravatar.com/ for more information.\n    \"\"\"\n    url = get_gravatar_url(context['request'], user, size)\n\n    if url:\n        return ('<img src=\"%s\" width=\"%s\" height=\"%s\" alt=\"%s\" '\n                '     class=\"gravatar\"/>' %\n                (url, size, size, user.get_full_name() or user.username))\n    else:\n        return ''\n\n\n@register.tag\n@basictag(takes_context=True)\ndef gravatar_url(context, email, size=None):\n    \"\"\"\n    Outputs the URL for a gravatar for the given email address.\n\n    This can take an optional size of the image (defaults to 80 if not\n    specified).\n\n    This is also influenced by the following settings:\n\n        GRAVATAR_SIZE    - Default size for gravatars\n        GRAVATAR_RATING  - Maximum allowed rating (g, pg, r, x)\n        GRAVATAR_DEFAULT - Default image set to show if the user hasn't\n                           specified a gravatar (identicon, monsterid, wavatar)\n\n    See http://www.gravatar.com/ for more information.\n    \"\"\"\n    return get_gravatar_url_for_email(context['request'], email, size)\n", "patch": "@@ -25,6 +25,7 @@\n from __future__ import unicode_literals\n \n from django import template\n+from django.utils.html import format_html\n \n from djblets.gravatars import (get_gravatar_url,\n                                get_gravatar_url_for_email)\n@@ -55,9 +56,10 @@ def gravatar(context, user, size=None):\n     url = get_gravatar_url(context['request'], user, size)\n \n     if url:\n-        return ('<img src=\"%s\" width=\"%s\" height=\"%s\" alt=\"%s\" '\n-                '     class=\"gravatar\"/>' %\n-                (url, size, size, user.get_full_name() or user.username))\n+        return format_html(\n+            '<img src=\"{0}\" width=\"{1}\" height=\"{1}\" alt=\"{2}\" '\n+            'class=\"gravatar\"/>',\n+            url, size, user.get_full_name() or user.username)\n     else:\n         return ''\n ", "file_path": "files/2014_6/27", "file_language": "py", "file_name": "djblets/gravatars/templatetags/gravatars.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0, "llm_check": 1, "static_check": 0, "static": {"rats": [false, []], "semgrep": [false, []]}, "target": -1, "function_before": [], "function_after": []}, {"raw_url": "https://github.com/djblets/djblets/raw/77ac64642ad530bf69e390c51fc6fdcb8914c8e7/djblets%2Fgravatars%2Ftemplatetags%2Ftests.py", "code": "from __future__ import unicode_literals\n\nfrom django.contrib.auth.models import User\nfrom django.template import Token, TOKEN_TEXT\n\nfrom djblets.testing.testcases import TagTest\nfrom djblets.gravatars.templatetags.gravatars import gravatar\n\n\nclass DummyRequest(object):\n    def is_secure(self):\n        return False\n\n\nclass TagTests(TagTest):\n    \"\"\"Unit tests for gravatars template tags.\"\"\"\n    def test_gravatar_xss(self):\n        \"\"\"Testing {% gravatar %} doesn't allow XSS injection\"\"\"\n        user = User(username='test',\n                    first_name='\"><script>alert(1);</script><\"',\n                    email='test@example.com')\n\n        node = gravatar(self.parser, Token(TOKEN_TEXT, 'gravatar user 32'))\n        context = {\n            'request': DummyRequest(),\n            'user': user,\n        }\n\n        self.assertEqual(\n            node.render(context),\n            '<img src=\"http://www.gravatar.com/avatar/'\n            '55502f40dc8b7c769880b10874abc9d0?s=32\" width=\"32\" height=\"32\" '\n            'alt=\"&quot;&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;&quot;\" '\n            'class=\"gravatar\"/>')\n", "code_before": "", "patch": "@@ -0,0 +1,34 @@\n+from __future__ import unicode_literals\n+\n+from django.contrib.auth.models import User\n+from django.template import Token, TOKEN_TEXT\n+\n+from djblets.testing.testcases import TagTest\n+from djblets.gravatars.templatetags.gravatars import gravatar\n+\n+\n+class DummyRequest(object):\n+    def is_secure(self):\n+        return False\n+\n+\n+class TagTests(TagTest):\n+    \"\"\"Unit tests for gravatars template tags.\"\"\"\n+    def test_gravatar_xss(self):\n+        \"\"\"Testing {% gravatar %} doesn't allow XSS injection\"\"\"\n+        user = User(username='test',\n+                    first_name='\"><script>alert(1);</script><\"',\n+                    email='test@example.com')\n+\n+        node = gravatar(self.parser, Token(TOKEN_TEXT, 'gravatar user 32'))\n+        context = {\n+            'request': DummyRequest(),\n+            'user': user,\n+        }\n+\n+        self.assertEqual(\n+            node.render(context),\n+            '<img src=\"http://www.gravatar.com/avatar/'\n+            '55502f40dc8b7c769880b10874abc9d0?s=32\" width=\"32\" height=\"32\" '\n+            'alt=\"&quot;&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;&quot;\" '\n+            'class=\"gravatar\"/>')", "file_path": "files/2014_6/28", "file_language": "py", "file_name": "djblets/gravatars/templatetags/tests.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0, "llm_check": 1, "static_check": 0, "static": {"rats": [false, []], "semgrep": [false, []]}, "target": -1, "function_before": [], "function_after": []}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
