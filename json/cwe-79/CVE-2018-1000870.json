{"index": 9423, "cve_id": "CVE-2018-1000870", "cwe_id": ["CWE-79"], "cve_language": "Python", "cve_description": "PHPipam version 1.3.2 and earlier contains a CWE-79 vulnerability in /app/admin/users/print-user.php that can result in Execute code in the victims browser. This attack appear to be exploitable via Attacker change theme parameter in user settings. Admin(Victim) views user in admin-panel and gets exploited.. This vulnerability appears to have been fixed in 1.4.", "cvss": "5.4", "publish_date": "October 3, 2022", "AV": "NETWORK", "AC": "NETWORK", "PR": "LOW", "UI": "REQUIRED", "S": "CHANGED", "C": "LOW", "I": "LOW", "A": "NONE", "commit_id": "552fbb0fc7ecb84bda4a131b4f290a3de9980040", "commit_message": "Bugfix: XSS in print-user.php, CSRF in user-edit.php. Fixes #2326", "commit_date": "2018-12-01T21:02:56Z", "project": "phpipam/phpipam", "url": "https://api.github.com/repos/phpipam/phpipam/commits/552fbb0fc7ecb84bda4a131b4f290a3de9980040", "html_url": "https://github.com/phpipam/phpipam/commit/552fbb0fc7ecb84bda4a131b4f290a3de9980040", "windows_before": [{"commit_id": "ee5ef63fb5774f12ed580a8b3e6e05d3e61dfcdc", "commit_date": "Fri Nov 30 19:01:07 2018 +0000", "commit_message": "Bugfix: XSS in phpipamredirect cookie. Fixes #2338", "files_name": ["app/login/2fa/2fa_form.php", "app/login/index.php", "app/login/login_form.php", "app/saml2/index.php", "misc/CHANGELOG"]}, {"commit_id": "b06ecfec16c98fdce095323d3adf4aeb3ddc1d9e", "commit_date": "Wed Nov 28 08:28:25 2018 +0100", "commit_message": "Merge branch 'master' of https://github.com/phpipam/phpipam", "files_name": ["8446a6d44b65fb2827b3c83943e2d522d3830ab0 - Wed Nov 28 08:28:16 2018 +0100 : Removed status icon if address is marked ans not pongable", "app/subnets/addresses/print-address-table.php"]}, {"commit_id": "33826351f9bb6dbcccc315e68a743fe7747f5906", "commit_date": "Tue Nov 20 13:19:08 2018 +0000", "commit_message": "Bugfix: compat php72, fixes #2149", "files_name": ["functions/scripts/pingCheck.php"]}, {"commit_id": "1e0ba42b33474b90ae2eaed115c7a18a0bad84ba", "commit_date": "Tue Nov 20 09:35:15 2018 +0100", "commit_message": "Fix api https check for reverse proxies", "files_name": ["api/index.php", "functions/classes/class.Common.php"]}, {"commit_id": "3ac0cc94202644b011f6d27426be6a06e01537c2", "commit_date": "Wed Nov 14 15:23:22 2018 +0100", "commit_message": "Fixed #2224 #2279", "files_name": ["app/subnets/addresses/print-address-table.php"]}, {"commit_id": "c3a2dc67833f1c6099a28efff02916c04c18557b", "commit_date": "Wed Nov 14 15:20:12 2018 +0100", "commit_message": "Fixed brackets", "files_name": ["functions/classes/class.Addresses.php"]}, {"commit_id": "199432ca5609fac86119b0e782003ecce03f0aaa", "commit_date": "Wed Nov 14 15:00:11 2018 +0100", "commit_message": "Merge branch 'master' of https://github.com/phpipam/phpipam", "files_name": ["5046019693ab4779c072ddb36455612de4bcf063 - Wed Nov 14 14:59:22 2018 +0100 : Fixed #2274", "functions/classes/class.Addresses.php", "functions/classes/class.Subnets.php"]}, {"commit_id": "559431f46af33c0d3d9759c164f0622ffb9f1de4", "commit_date": "Tue Nov 13 13:16:28 2018 +0100", "commit_message": "Merge pull request #2297 from xPucTu4/master", "files_name": ["f882cb9491a87e9c29bd23e755c54193bc7b9efe - Tue Nov 13 10:50:35 2018 +0100 : Updated changelog", "misc/CHANGELOG"]}, {"commit_id": "2a205697f5885542241703ab9fb64dc9e86f6444", "commit_date": "Tue Nov 13 10:47:29 2018 +0100", "commit_message": "Merge branch 'master' of https://github.com/phpipam/phpipam", "files_name": ["70c8d025d282e944f21fb5b9a2a1f0360e927f92 - Tue Nov 13 10:47:20 2018 +0100 : Fixed #2006", "app/admin/authentication-methods/edit-result.php", "functions/classes/class.Admin.php", "functions/version.php", "index.php"]}, {"commit_id": "d2b5047e5f01d51dcdddf988e28f5db1e082c09e", "commit_date": "Mon Nov 12 21:55:23 2018 +0000", "commit_message": "Bugfix: Sections with \".\" are excluded when performing an export. Fixes #2260", "files_name": ["app/admin/import-export/export-ipaddr-field-select.php", "app/admin/import-export/export-ipaddr.php", "app/admin/import-export/export-subnets-field-select.php", "app/admin/import-export/export-subnets.php"]}, {"commit_id": "dca7c6f0418936d03092f717c62d885225bc5022", "commit_date": "Mon Nov 12 21:19:54 2018 +0000", "commit_message": "Bugfix: compat php72", "files_name": ["functions/classes/class.Subnets.php"]}, {"commit_id": "a91718618e5501976fcb02c4ad3c380179445b66", "commit_date": "Fri Nov 9 15:18:26 2018 +0100", "commit_message": "Added API SSL with APP token security option", "files_name": ["api/controllers/User.php", "api/index.php", "app/admin/api/edit-result.php", "app/admin/api/edit.php", "app/admin/api/index.php", "config.dist.php", "db/SCHEMA.sql", "functions/upgrade_queries.php", "functions/version.php", "misc/CHANGELOG"]}, {"commit_id": "5d6bf5d108062c168cebec61eb4ebff135951c71", "commit_date": "Fri Nov 9 13:21:06 2018 +0100", "commit_message": "Marge fixes", "files_name": ["3dc9b1534238d3bdafb257ab25713f486b4644aa - Fri Nov 9 13:17:56 2018 +0100 : Added customers to search results", "app/sections/user-menu.php", "app/tools/customers/all-customers.php", "app/tools/search/index.php", "app/tools/search/search-results-export.php", "app/tools/search/search-results.php", "app/tools/search/search_results/search-results_customers.php", "functions/classes/class.Tools.php", "functions/version.php", "js/magic.js"]}, {"commit_id": "5c550bb093a41063421a225ccd1420d12443d2aa", "commit_date": "Fri Nov 9 11:03:07 2018 +0100", "commit_message": "Merge pull request #2270 from bmonkey35/fr-translation", "files_name": ["26a0090ede7e96082ee5dc63a06eadcb74128132 - Fri Nov 9 11:00:22 2018 +0100 : Merge pull request #2226 from aromeyer/samlv2-x509cert", "b85197c0ae0faecf404704f51b25b76e7ef5d452 - Fri Nov 9 10:58:18 2018 +0100 : Duplicates - nitial", "app/tools/duplicates/index.php"]}, {"commit_id": "46cd7c43ff2856fd7efdfe8a939a6145fb02fe56", "commit_date": "Fri Nov 9 10:57:09 2018 +0100", "commit_message": "PSTN updated with new actions menus", "files_name": ["app/sections/all-sections.php", "app/tools/pstn-prefixes/single-prefix-numbers.php", "app/tools/pstn-prefixes/single-prefix-slaves-list.php", "app/tools/pstn-prefixes/single-prefix.php", "functions/classes/class.Tools.php"]}, {"commit_id": "2655e4d7e525fae9250ac64c3dec5539c4517803", "commit_date": "Wed Nov 7 22:24:44 2018 +0000", "commit_message": "Add api-crypt checks for required mcrypt/openssl modules", "files_name": ["api/index.php"]}, {"commit_id": "29457c1c8f185334b48d74a9339abff2c50304d4", "commit_date": "Wed Nov 7 22:10:22 2018 +0000", "commit_message": "Merge branch 'aswincoolsaet-patch-1'", "files_name": ["29e3f757093c2a1edfb446d9993cc855fe6ee06b - Wed Nov 7 22:09:21 2018 +0000 : Merge branch 'patch-1' of https://github.com/aswincoolsaet/phpipam into aswincoolsaet-patch-1", "a3565ef0fa096d0387e45c21aa4ae13a1134cff2 - Wed Nov 7 21:57:55 2018 +0000 : Bugfix: Wrong unit of the snmp timeout. Fixes #2299", "functions/classes/class.SNMP.php"]}, {"commit_id": "afd0d333d4a38a55dbf20a5e4cf2bf7c722f7dc6", "commit_date": "Tue Nov 6 13:57:36 2018 +0100", "commit_message": "New actions scheme for NAT module", "files_name": ["app/subnets/addresses/address-details/address-details-nat.php", "app/subnets/subnet-details/subnet-nat.php", "app/tools/devices/device-details/device-nat.php", "app/tools/nat/index.php", "functions/classes/class.Tools.php"]}, {"commit_id": "fae963bd3027f59ab623ef993321a3c69d27add7", "commit_date": "Tue Nov 6 08:38:28 2018 +0100", "commit_message": "Bugfixes", "files_name": ["app/tools/customers/customer/objects/circuits.php", "app/tools/tools-menu.php", "functions/classes/class.Tools.php"]}, {"commit_id": "67b69b3d2e844804bc4effc7f15ab10b1ae10f3a", "commit_date": "Mon Nov 5 19:20:46 2018 +0100", "commit_message": "upgrade db version from 11 to 12", "files_name": ["db/SCHEMA.sql"]}, {"commit_id": "5ae8525095a686162ea4828c8a4aa00f2a141996", "commit_date": "Mon Nov 5 18:34:16 2018 +0100", "commit_message": "Fixed upgrade_queries", "files_name": ["functions/upgrade_queries.php"]}, {"commit_id": "64d6b65168d27baed49b3d2f62b6382a0d471f22", "commit_date": "Mon Nov 5 17:21:04 2018 +0100", "commit_message": "new file for sql update", "files_name": ["db/UPDATE.sql", "functions/upgrade_queries.php"]}, {"commit_id": "587df07e4af0cc77ee63af5db3b599beffd4db58", "commit_date": "Mon Nov 5 17:09:23 2018 +0100", "commit_message": "sync with master and correct conflicts", "files_name": ["80bf559a9b5d8bd74a76b916221950dabf676fae - Mon Nov 5 14:13:46 2018 +0200 : Closes #1401", "functions/classes/class.Addresses.php"]}, {"commit_id": "d518f82da521940eb06b8dde866795a00a02f725", "commit_date": "Mon Nov 5 09:56:56 2018 +0900", "commit_message": "fix japanese translation file path", "files_name": ["functions/locale/ja_JP.UTF-8/LC_MESSAGES/phpipam.mo", "functions/locale/ja_JP.UTF-8/LC_MESSAGES/phpipam.po"]}, {"commit_id": "f0f2aff4972e0bcc516ad054f4c39c82d2ca886e", "commit_date": "Sun Nov 4 12:32:50 2018 +0100", "commit_message": "Update User.php", "files_name": ["api/controllers/User.php"]}, {"commit_id": "52d6c99fcc3ae7d5b951ad13d403daac7f514932", "commit_date": "Sun Nov 4 12:21:25 2018 +0100", "commit_message": "explained in issue 2292", "files_name": ["api/index.php"]}, {"commit_id": "755e9048473dd1e439a83e78d2df34d3a77d8fd1", "commit_date": "Mon Oct 29 09:59:05 2018 +0900", "commit_message": "Add Japanese translation.", "files_name": ["functions/locale/ja_JP.UTF-8/phpipam.mo", "functions/locale/ja_JP.UTF-8/phpipam.po"]}, {"commit_id": "e2c75933b607ebb2dc0a5b269987f498cf01e6a8", "commit_date": "Tue Oct 23 20:00:10 2018 +0100", "commit_message": "Bugfix: Logo not accessible even with manual upload. Fixes #2265", "files_name": ["app/admin/settings/logo/import-verify.php"]}, {"commit_id": "361fb931f58bcbed59359c2659c649a57812c1fa", "commit_date": "Tue Oct 23 14:40:50 2018 +0200", "commit_message": "mini fix", "files_name": ["functions/locale/fr_FR.UTF-8/LC_MESSAGES/phpipam.mo", "functions/locale/fr_FR.UTF-8/LC_MESSAGES/phpipam.po"]}, {"commit_id": "4ca5880ed58f0d38eec1f9f2a499ab3dae9c37da", "commit_date": "Tue Oct 23 14:37:41 2018 +0200", "commit_message": "few corrections of french translations errors", "files_name": ["functions/locale/fr_FR.UTF-8/LC_MESSAGES/phpipam.mo", "functions/locale/fr_FR.UTF-8/LC_MESSAGES/phpipam.po"]}, {"commit_id": "ec5a9f324335b33abd3e28582b90087d382acb08", "commit_date": "Mon Oct 22 13:09:57 2018 +0200", "commit_message": "Added compress action for custom er objects", "files_name": ["app/tools/customers/all-customers.php", "app/tools/customers/customer/details.php", "app/tools/customers/customer/objects/circuits.php", "app/tools/customers/customer/objects/ipaddresses.php", "app/tools/customers/customer/objects/racks.php", "app/tools/customers/customer/objects/subnets.php", "functions/classes/class.Common.php", "functions/version.php", "js/magic.js"]}, {"commit_id": "413b74ce748904d34179dd8d9494ff43131bf000", "commit_date": "Mon Oct 22 12:46:09 2018 +0200", "commit_message": "Added compress action to vrfs", "files_name": ["app/admin/admin-menu-config.php", "app/admin/admin-menu.php", "app/admin/vrf/edit-result.php", "app/admin/vrf/edit.php", "app/admin/vrf/index.php", "app/admin/vrf/vrf-scan-execute.php", "app/admin/vrf/vrf-scan-result.php", "app/admin/vrf/vrf-scan.php", "app/admin/vrfs/index.php", "app/sections/menu/menu-administration.php", "app/tools/customers/customer/objects/vrf.php", "app/tools/search/search_results/search-results_vrfs.php", "app/tools/tools-menu-config.php", "app/tools/vrf/all_vrf.php", "app/tools/vrf/vrf-details.php", "app/vrf/vrf-details.php", "functions/version.php", "js/magic.js"]}, {"commit_id": "9f5fc117278a54b6f25e61369359d72af43885b4", "commit_date": "Mon Oct 22 12:14:58 2018 +0200", "commit_message": "Added compress actions to vlans", "files_name": ["app/admin/vlans/edit-result.php", "app/admin/vlans/edit.php", "app/tools/customers/customer/objects/vlans.php", "app/tools/search/search_results/search-results_vlans.php", "app/tools/vlan/domain-vlans-all.php", "app/tools/vlan/domain-vlans.php", "app/tools/vlan/domains.php", "app/tools/vlan/vlan-details.php", "app/vlan/vlan-details.php", "js/magic.js"]}, {"commit_id": "12b7a46441838828c073e71d4aac239a266afb78", "commit_date": "Mon Oct 22 09:43:10 2018 +0200", "commit_message": "Added compress actions to locations", "files_name": ["app/admin/locations/edit.php", "app/tools/locations/all-locations-list.php"]}], "windows_after": [{"commit_id": "1d96a5d6eaabfc0a43f5209a7fed674bb2e390de", "commit_date": "Mon Dec 3 21:25:36 2018 +0000", "commit_message": "Bugfix: Add CSRF check to user-menu widgets. #2326", "files_name": ["app/tools/user-menu/user-widgets-set.php", "app/tools/user-menu/widgets.php"]}, {"commit_id": "4554be402196037ed8c34d375fc65f37ba161ae2", "commit_date": "Mon Dec 3 22:34:27 2018 +0000", "commit_message": "Bugfix: compat php72", "files_name": ["app/admin/nat/item-add-submit.php"]}, {"commit_id": "856b10ca85a24c04ed8651f4e13f867ec78a353d", "commit_date": "Tue Dec 4 19:48:37 2018 +0000", "commit_message": "Bugfix: Possible SQL injection in nat/item-add-submit.php. Fixes #2344", "files_name": ["app/admin/nat/item-add-submit.php", "misc/CHANGELOG"]}, {"commit_id": "208095f3737bd10af81be8f554c795f161910f61", "commit_date": "Fri Dec 7 09:59:51 2018 +0100", "commit_message": "Fixed file inclusion for editi auth methods", "files_name": ["app/admin/authentication-methods/edit.php"]}, {"commit_id": "6becaa661b6cb8761bd6d39188dd01810994ad1b", "commit_date": "Fri Dec 7 10:00:33 2018 +0100", "commit_message": "Merge branch 'master' of https://github.com/phpipam/phpipam", "files_name": ["785348e3713ed160aba9a48ee18f576356ada8e5 - Fri Dec 7 10:20:39 2018 +0100 : Fixed file inclusion for dhcp", "app/admin/dhcp/index.php", "misc/CHANGELOG"]}, {"commit_id": "ec91a6c495662e9f065336e1c6f0a84517de3a74", "commit_date": "Fri Dec 7 10:30:24 2018 +0100", "commit_message": "Small check for vlan scan", "files_name": ["app/admin/vlans/vlans-scan-execute.php"]}, {"commit_id": "8b0a14383cb0b1c4389f50a76ec6c87c96ca16f9", "commit_date": "Fri Dec 7 11:43:58 2018 +0100", "commit_message": "fetch circuit comment from DB", "files_name": ["functions/classes/class.Tools.php"]}, {"commit_id": "e6a694c4b51a9d5fe1c3c8af6d32594071c88c05", "commit_date": "Fri Dec 7 18:56:08 2018 +0000", "commit_message": "Merge pull request #2354 from Pectojin/add_circuit_comment", "files_name": ["986877241a970226001e342057fc2cf2a860ebde - Sat Dec 8 11:51:07 2018 +0000 : Refactor: Use subnet-scan-execute-* & subnet-scan-result-* filenames", "app/subnets/scan/subnet-scan-execute-scan-icmp.php", "app/subnets/scan/subnet-scan-execute-scan-telnet.php", "app/subnets/scan/subnet-scan-execute-snmp-arp.php", "app/subnets/scan/subnet-scan-execute-snmp-mac.php", "app/subnets/scan/subnet-scan-execute-snmp-route-all.php", "app/subnets/scan/subnet-scan-execute-snmp-route.php", "app/subnets/scan/subnet-scan-execute-update-icmp.php", "app/subnets/scan/subnet-scan-execute-update-snmp-arp.php", "app/subnets/scan/subnet-scan-execute.php", "app/subnets/scan/subnet-scan-result-scan-icmp.php", "app/subnets/scan/subnet-scan-result-scan-telnet.php", "app/subnets/scan/subnet-scan-result-snmp-arp.php", "app/subnets/scan/subnet-scan-result-snmp-mac.php", "app/subnets/scan/subnet-scan-result-snmp-route-all.php", "functions/version.php", "js/magic.js"]}, {"commit_id": "89feb5a9fea4bb35ce2e719dd53f769332176211", "commit_date": "Sat Dec 8 12:46:03 2018 +0000", "commit_message": "Refactor: Add wrapper subnet-scan-result.php and ensure included files are not directly invoked.", "files_name": ["app/subnets/scan/subnet-scan-result-scan-icmp.php", "app/subnets/scan/subnet-scan-result-scan-telnet.php", "app/subnets/scan/subnet-scan-result-snmp-arp.php", "app/subnets/scan/subnet-scan-result-snmp-mac.php", "app/subnets/scan/subnet-scan-result-snmp-route-all.php", "app/subnets/scan/subnet-scan-result.php", "functions/version.php", "js/magic.js"]}, {"commit_id": "fd37bd8fb2b9c306079db505e0e3fe79a096c31c", "commit_date": "Sat Dec 8 13:35:39 2018 +0000", "commit_message": "Bugfix: XSS in subnet-scan-telnet.php, CSRF in subnet-scan-execute.php. Fixes #2327", "files_name": ["app/subnets/scan/subnet-scan-execute-scan-icmp.php", "app/subnets/scan/subnet-scan-execute-scan-telnet.php", "app/subnets/scan/subnet-scan-execute-snmp-arp.php", "app/subnets/scan/subnet-scan-execute-snmp-mac.php", "app/subnets/scan/subnet-scan-execute-update-icmp.php", "app/subnets/scan/subnet-scan-execute-update-snmp-arp.php", "app/subnets/scan/subnet-scan-execute.php", "app/subnets/scan/subnet-scan-result.php", "app/subnets/scan/subnet-scan.php", "functions/version.php", "js/magic.js", "misc/CHANGELOG"]}, {"commit_id": "9a002dc2e3d9f9351e5889bee1b5a5291f7844c4", "commit_date": "Sat Dec 8 16:30:16 2018 +0000", "commit_message": "Merge branch 'master' of https://github.com/auchri/phpipam into auchri-master", "files_name": ["c41b52592eeee3591e84eb275038548fdad1ad6a - Sat Dec 8 16:30:40 2018 +0000 : Merge branch 'auchri-master'", "7fee7edfd8ff0074103eeef9e6d731c66df147bd - Sat Dec 8 17:36:39 2018 +0000 : Cleanup isHttps", "api/index.php", "functions/classes/class.Common.php"]}, {"commit_id": "c3f09e2db23abb04aae2e0f253caca12d4212212", "commit_date": "Sun Dec 9 18:25:56 2018 +0000", "commit_message": "Bugfix: compat php72", "files_name": ["app/subnets/scan/subnet-scan-execute-update-icmp.php", "functions/classes/class.Addresses.php"]}, {"commit_id": "690a10b97239414e68891e1c8925a79343d8ac31", "commit_date": "Sun Dec 9 18:42:53 2018 +0000", "commit_message": "Bugfix: Fix SNMP scans.", "files_name": ["app/subnets/scan/subnet-scan-execute-scan-snmp-arp.php", "app/subnets/scan/subnet-scan-execute-snmp-route-all.php", "app/subnets/scan/subnet-scan-execute.php", "app/subnets/scan/subnet-scan-result-scan-snmp-arp.php", "app/subnets/scan/subnet-scan-result.php", "app/subnets/scan/subnet-scan.php", "functions/version.php", "js/magic.js"]}, {"commit_id": "bbbde31d18a897cdf8e840d61c76fd5806515ad1", "commit_date": "Sun Dec 9 19:09:23 2018 +0000", "commit_message": "Bugfix: Fix php file inclusion checks.", "files_name": ["app/subnets/scan/subnet-scan-check-included.php", "app/subnets/scan/subnet-scan-execute-scan-icmp.php", "app/subnets/scan/subnet-scan-execute-scan-snmp-arp.php", "app/subnets/scan/subnet-scan-execute-scan-telnet.php", "app/subnets/scan/subnet-scan-execute-snmp-mac.php", "app/subnets/scan/subnet-scan-execute-snmp-route-all.php", "app/subnets/scan/subnet-scan-execute-snmp-route.php", "app/subnets/scan/subnet-scan-execute-update-icmp.php", "app/subnets/scan/subnet-scan-execute-update-snmp-arp.php", "app/subnets/scan/subnet-scan-execute.php", "app/subnets/scan/subnet-scan-result-scan-icmp.php", "app/subnets/scan/subnet-scan-result-scan-snmp-arp.php", "app/subnets/scan/subnet-scan-result-snmp-mac.php", "app/subnets/scan/subnet-scan-result-snmp-route-all.php", "app/subnets/scan/subnet-scan-result.php"]}, {"commit_id": "8374ad4b639cf5f4d9fe06329943409d4a30041a", "commit_date": "Sun Dec 9 20:49:20 2018 +0000", "commit_message": "Bugfix: compat php72", "files_name": ["functions/classes/class.Subnets.php"]}, {"commit_id": "f47da2469c48c1b1e8eb0740faaa3898b9344a36", "commit_date": "Mon Dec 10 11:11:17 2018 +0000", "commit_message": "Bugfix: Convert device `snmp_timeout` values to milliseconds. Enforce a max 10s snmp_timeout.", "files_name": ["app/admin/devices/edit-snmp-test.php", "app/admin/devices/edit-snmp.php", "db/SCHEMA.sql", "functions/classes/class.SNMP.php", "functions/upgrade_queries.php"]}, {"commit_id": "d6d6f3fc7bcf625f1bf0b36be8fa29ba6f8bb4a5", "commit_date": "Tue Dec 11 20:19:25 2018 +0000", "commit_message": "Reduce number of SNMP retries to 3 from default (5).", "files_name": ["functions/classes/class.SNMP.php"]}, {"commit_id": "f13b86962cdff67df3433aef80effedbf39de0d8", "commit_date": "Tue Dec 11 20:41:37 2018 +0000", "commit_message": "Add option to create CSRF cookie if not exists, returns current cookie or generates new.", "files_name": ["functions/classes/class.Crypto.php"]}, {"commit_id": "5092a9609b33d3d0c801b17b3e5bdb0202d5c725", "commit_date": "Tue Dec 11 20:49:03 2018 +0000", "commit_message": "Bugfix: Route all subnet SNMP scanning via subnet\\snmp-scan-execute.php and validate CSRF cookies.", "files_name": ["app/admin/subnets/edit.php", "app/folder/folder-details.php", "app/subnets/scan/subnet-scan-execute-scan-telnet.php", "app/subnets/scan/subnet-scan-execute-snmp-route-all.php", "app/subnets/scan/subnet-scan-execute-snmp-route.php", "app/subnets/scan/subnet-scan-execute.php", "app/subnets/scan/subnet-scan.php", "app/subnets/subnets-menu.php", "functions/version.php", "js/magic.js"]}, {"commit_id": "d07f3548245be2ebbf18a5484d8ce14792a661bd", "commit_date": "Tue Dec 11 21:33:19 2018 +0000", "commit_message": "Cleanup functions/classes/class.SNMP", "files_name": ["functions/classes/class.SNMP.php"]}, {"commit_id": "8d1e95f210f893381d338f47915f9dae5fbcc495", "commit_date": "Wed Dec 12 17:15:04 2018 +0000", "commit_message": "Fix z-index of dropdown-menus (default:1000). The last item can be hidden under the footer (z-index = 93).", "files_name": ["app/subnets/addresses/address-details/address-details-nat.php", "app/subnets/subnet-details/subnet-nat.php", "app/tools/devices/all-devices-filter.php", "app/tools/devices/device-details/device-nat.php", "functions/classes/class.Common.php"]}, {"commit_id": "2da5875ae64b3d1f026fa1b78b22c04d686d7f2c", "commit_date": "Wed Dec 12 21:19:10 2018 +0000", "commit_message": "Refactor class.SNMP.php Convert to numeric OID values before polling.", "files_name": ["functions/classes/class.SNMP.php"]}, {"commit_id": "75e851c9888c7586c56d13830efa060e10586dcf", "commit_date": "Wed Dec 12 21:22:24 2018 +0000", "commit_message": "Add CSRF checks to SNMP vlans scan.", "files_name": ["app/admin/vlans/vlans-scan-execute.php", "app/admin/vlans/vlans-scan-result.php", "app/admin/vlans/vlans-scan.php"]}, {"commit_id": "5f39d065c502f399bfc62c92829e21303f6e58c7", "commit_date": "Thu Dec 13 18:38:09 2018 +0000", "commit_message": "Bugfix: Invalid CSRF cookie when adding subnet. Fixes #2361", "files_name": ["app/admin/subnets/edit.php"]}, {"commit_id": "6f0dd746a4c4c97c82b1dd106641b14f5a8e463b", "commit_date": "Thu Dec 13 20:32:46 2018 +0000", "commit_message": "Bugfix: Set LAST_POSSIBLE upgrade version to 1.19. Bugfix: Fix upgrade_queries.php SQL syntax for version 1.2.0. Bugfix: Add warning for max_execution_time < 600 during database upgrades.", "files_name": ["app/upgrade/index.php", "functions/upgrade_queries.php", "functions/version.php"]}, {"commit_id": "cd88ea02da9a30b15bbf918ec2a540dbe9a10129", "commit_date": "Thu Dec 13 21:41:41 2018 +0000", "commit_message": "Bugfix: Fix masterSubnetId index definition", "files_name": ["db/SCHEMA.sql", "functions/upgrade_queries.php"]}, {"commit_id": "6188f636e43d1ff9b9bc644925acf13eb49d5947", "commit_date": "Sat Dec 15 14:48:48 2018 +0000", "commit_message": "Bugfix: Fix Subnet details - Filter button missing when compressed range is used. Fixes #2353", "files_name": ["app/subnets/addresses/print-address-table.php", "misc/CHANGELOG"]}, {"commit_id": "1e175c63c9390c480964d2cd629eea4a28b1dfe8", "commit_date": "Sun Dec 16 20:14:53 2018 +0000", "commit_message": "Request: PSTN device dropdown not sorted. Fixes #2364", "files_name": ["app/tools/pstn-prefixes/edit-number.php", "app/tools/pstn-prefixes/edit.php"]}, {"commit_id": "2e182dd832dfdd9b7a66072dca5c3ebcd670b05a", "commit_date": "Tue Dec 18 17:40:15 2018 +0000", "commit_message": "Bugfix: Performance fix for linked addresses. Fixes #2324", "files_name": ["db/SCHEMA.sql", "functions/upgrade_queries.php"]}, {"commit_id": "b118c07de91b72467a7bdd312d1ef9f7f8086af8", "commit_date": "Tue Dec 18 17:47:03 2018 +0000", "commit_message": "Bugfix: Drop redundant MySQL indexes", "files_name": ["db/SCHEMA.sql", "functions/upgrade_queries.php"]}, {"commit_id": "b8976b34640e21a9f12a56ef225b1700d7d653d2", "commit_date": "Tue Dec 18 20:30:37 2018 +0000", "commit_message": "Bugfix: Sort linked addresses by ip_addr.", "files_name": ["app/subnets/addresses/address-details/address-details-linked.php", "app/subnets/addresses/print-address-table.php", "functions/classes/class.Addresses.php"]}, {"commit_id": "509103cd2040cf7824fa808897c0dbdaaba19d7f", "commit_date": "Tue Dec 18 21:00:42 2018 +0000", "commit_message": "Bugfix: Remove multiple ((( brackets ))) when listing linked addresses", "files_name": ["app/subnets/addresses/address-details/address-details-linked.php"]}, {"commit_id": "9223bb108a31b54136cfd3f46f7f01b6d61f8b36", "commit_date": "Tue Dec 18 21:17:34 2018 +0000", "commit_message": "Bugfix: Clone objects in/out of cache for data integrity.", "files_name": ["functions/classes/class.Common.php"]}], "parents": [{"commit_id_before": "ee5ef63fb5774f12ed580a8b3e6e05d3e61dfcdc", "url_before": "https://api.github.com/repos/phpipam/phpipam/commits/ee5ef63fb5774f12ed580a8b3e6e05d3e61dfcdc", "html_url_before": "https://github.com/phpipam/phpipam/commit/ee5ef63fb5774f12ed580a8b3e6e05d3e61dfcdc"}], "details": [{"raw_url": "https://github.com/phpipam/phpipam/raw/552fbb0fc7ecb84bda4a131b4f290a3de9980040/app%2Fadmin%2Fusers%2Fprint-user.php", "code": "<?php\n\n/**\n * Script to edit / add / delete users\n *************************************************/\n\n# verify that user is logged in\n$User->check_user_session();\n\n# fetch user details\n$user \t\t  = $Admin->fetch_object(\"users\", \"id\", $_GET['subnetId']);\n\n# invalid?\nif($user===false)\t\t{ $Result->show(\"danger\", _(\"Invalid ID\"), true); }\n\n# fetch user lang\n$language \t  = $Admin->fetch_object(\"lang\", \"l_id\", $user->lang);\n# check users auth method\n$auth_details = $Admin->fetch_object(\"usersAuthMethod\", \"id\", $user->authMethod);\n# fetch custom fields\n$custom_fields = $Tools->fetch_custom_fields('users');\n?>\n\n<!-- display existing users -->\n<h4><?php print _('User details'); ?></h4>\n<hr><br>\n\n<!-- Add new -->\n<a class='btn btn-sm btn-default' href=\"<?php print create_link(\"administration\",\"users\"); ?>\" style=\"margin-bottom:10px;\"><i class='fa fa-angle-left'></i> <?php print _('All users'); ?></a>\n\n<!-- table -->\n<table id=\"userPrint\" class=\"table table-hover table-auto table-condensed table-noborder\">\n\n<tr>\n\t<td><?php print _('Real Name'); ?></td>\n\t<td><strong><?php print $user->real_name; ?></strong></td>\n</tr>\n<tr>\n\t<td><?php print _('Username'); ?></td>\n\t<td><?php print $user->username; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('E-mail'); ?></td>\n\t<td><?php print $user->email; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Language'); ?></td>\n\t<td><?php print $language->l_name; ?></td>\n</tr>\n<tr>\n\t<td></td>\n\t<td>\n\t<div class='btn-group'>\n\t\t<button class='btn btn-xs btn-default open_popup' data-script='app/admin/users/edit.php' data-class='700' data-action='edit' data-id='<?php print $user->id; ?>'><i class='fa fa-pencil'></i></button>\n\t\t<button class='btn btn-xs btn-default open_popup' data-script='app/admin/users/edit.php' data-class='700' data-action='delete' data-id='<?php print $user->id; ?>'><i class='fa fa-times'></i></button>\n\t</div>\n\t</td>\n</tr>\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Module permissions'); ?></h4><hr></td>\n</tr>\n\n<tr>\n\t<td colspan=\"2\">\n\t\t<?php\n\t\t$user = (array) $user;\n\t\tinclude(\"print_module_permissions.php\");\n\t\t$user = (object) $user;\n\t\t?>\n\t</td>\n</tr>\n\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Authentication settings'); ?></h4><hr></td>\n</tr>\n\n<tr>\n\t<td><?php print _('Role'); ?></td>\n\t<td><?php print $user->role; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Authentication'); ?></td>\n\t<td>\n\t<?php\n\tif($auth_details===false) \t{ print \"<span class='text-muted'>No auth method</span>\"; }\n\telse \t\t\t\t\t \t{ print $auth_details->type.\" <span class='text-muted'>(\".$auth_details->description.\")</span>\"; }\n\t?>\n\t</td>\n</tr>\n<tr>\n\t<td><?php print _('Last login'); ?></td>\n\t<td><?php print strlen($user->lastLogin)>0 ? $user->lastLogin : \"<span class='text-muted'>\"._(\"Never\").\"</span>\"; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Last activity'); ?></td>\n\t<td><?php print strlen($user->lastActivity)>0 ? $user->lastActivity : \"<span class='text-muted'>\"._(\"Never\").\"</span>\"; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Groups'); ?></td>\n\t<td>\n\t<?php\n\tif($user->role == \"Administrator\") {\n\tprint _('All groups');\n\t}\n\telse {\n\t\t$groups = json_decode($user->groups, true);\n\t\t$gr = $Admin->groups_parse($groups);\n\t\tif(sizeof($gr)>0) {\n\t\t\tforeach($gr as $group) {\n\t\t\t\tprint $group['g_name'].\"<br>\";\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tprint \"<span class='text-muted'>No groups</span>\";\n\t\t}\n\t}\n\t?>\n\t</td>\n</tr>\n<tr>\n\t<td><?php print _('Password change required'); ?></td>\n\t<td><?php print $user->passChange; ?></td>\n</tr>\n\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Display settings'); ?></h4><hr></td>\n</tr>\n<tr>\n\t<td><?php print _('Theme'); ?></td>\n\t<td><?php print $user->theme==\"\" ? _(\"Default\") : escape_input($user->theme) ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Compress override'); ?></td>\n\t<td><?php print $user->compressOverride==1 ? _(\"Yes\") : _(\"No\") ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Hide free range'); ?></td>\n\t<td><?php print $user->hideFreeRange==1 ? _(\"Yes\") : _(\"No\") ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Menu type'); ?></td>\n\t<td><?php print $user->menuType; ?></td>\n</tr>\n\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Mail settings'); ?></h4><hr></td>\n</tr>\n<tr>\n\t<td><?php print _('Mail notifications'); ?></td>\n\t<td><?php print $user->role == \"Administrator\" ? _($user->mailNotify) : _(\"No\"); ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Changelog notifications'); ?></td>\n\t<td><?php print $user->role == \"Administrator\" ? _($user->mailChangelog) : _(\"No\"); ?></td>\n</tr>\n\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Custom fields'); ?></h4><hr></td>\n</tr>\n\n<?php\n# custom subnet fields\nif(sizeof($custom_fields) > 0) {\n\tforeach($custom_fields as $key=>$field) {\n\t\t$user->{$key} = str_replace(\"\\n\", \"<br>\",$user->{$key});\n\t\tprint \"<tr>\";\n\t\tprint \"\t<td>$key</td>\";\n\t\tprint \"\t<td>\";\n\t\t//no length\n\t\tif(strlen($user->{$key})==0) {\n\t\t\tprint \"/\";\n\t\t}\n\t\t//booleans\n\t\telseif($field['type']==\"tinyint(1)\")\t{\n\t\t\tif($user->{$key} == \"0\")\t\t{ print _(\"No\"); }\n\t\t\telseif($user->{$key} == \"1\")\t{ print _(\"Yes\"); }\n\t\t}\n\t\telse {\n\t\t\tprint $user->{$key};\n\t\t}\n\t\tprint \"\t</td>\";\n\t\tprint \"</tr>\";\n\t\t}\n}\nelse {\n\tprint \"<tr>\";\n\tprint \"\t<td colspan='2'>\";\n\t$Result->show (\"muted\", _(\"No custom fields\"), false);\n\tprint \"\t</td>\";\n\tprint \"</tr>\";\n}\n?>\n\n\n</table>", "code_before": "<?php\n\n/**\n * Script to edit / add / delete users\n *************************************************/\n\n# verify that user is logged in\n$User->check_user_session();\n\n# fetch user details\n$user \t\t  = $Admin->fetch_object(\"users\", \"id\", $_GET['subnetId']);\n\n# invalid?\nif($user===false)\t\t{ $Result->show(\"danger\", _(\"Invalid ID\"), true); }\n\n# fetch user lang\n$language \t  = $Admin->fetch_object(\"lang\", \"l_id\", $user->lang);\n# check users auth method\n$auth_details = $Admin->fetch_object(\"usersAuthMethod\", \"id\", $user->authMethod);\n# fetch custom fields\n$custom_fields = $Tools->fetch_custom_fields('users');\n?>\n\n<!-- display existing users -->\n<h4><?php print _('User details'); ?></h4>\n<hr><br>\n\n<!-- Add new -->\n<a class='btn btn-sm btn-default' href=\"<?php print create_link(\"administration\",\"users\"); ?>\" style=\"margin-bottom:10px;\"><i class='fa fa-angle-left'></i> <?php print _('All users'); ?></a>\n\n<!-- table -->\n<table id=\"userPrint\" class=\"table table-hover table-auto table-condensed table-noborder\">\n\n<tr>\n\t<td><?php print _('Real Name'); ?></td>\n\t<td><strong><?php print $user->real_name; ?></strong></td>\n</tr>\n<tr>\n\t<td><?php print _('Username'); ?></td>\n\t<td><?php print $user->username; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('E-mail'); ?></td>\n\t<td><?php print $user->email; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Language'); ?></td>\n\t<td><?php print $language->l_name; ?></td>\n</tr>\n<tr>\n\t<td></td>\n\t<td>\n\t<div class='btn-group'>\n\t\t<button class='btn btn-xs btn-default open_popup' data-script='app/admin/users/edit.php' data-class='700' data-action='edit' data-id='<?php print $user->id; ?>'><i class='fa fa-pencil'></i></button>\n\t\t<button class='btn btn-xs btn-default open_popup' data-script='app/admin/users/edit.php' data-class='700' data-action='delete' data-id='<?php print $user->id; ?>'><i class='fa fa-times'></i></button>\n\t</div>\n\t</td>\n</tr>\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Module permissions'); ?></h4><hr></td>\n</tr>\n\n<tr>\n\t<td colspan=\"2\">\n\t\t<?php\n\t\t$user = (array) $user;\n\t\tinclude(\"print_module_permissions.php\");\n\t\t$user = (object) $user;\n\t\t?>\n\t</td>\n</tr>\n\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Authentication settings'); ?></h4><hr></td>\n</tr>\n\n<tr>\n\t<td><?php print _('Role'); ?></td>\n\t<td><?php print $user->role; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Authentication'); ?></td>\n\t<td>\n\t<?php\n\tif($auth_details===false) \t{ print \"<span class='text-muted'>No auth method</span>\"; }\n\telse \t\t\t\t\t \t{ print $auth_details->type.\" <span class='text-muted'>(\".$auth_details->description.\")</span>\"; }\n\t?>\n\t</td>\n</tr>\n<tr>\n\t<td><?php print _('Last login'); ?></td>\n\t<td><?php print strlen($user->lastLogin)>0 ? $user->lastLogin : \"<span class='text-muted'>\"._(\"Never\").\"</span>\"; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Last activity'); ?></td>\n\t<td><?php print strlen($user->lastActivity)>0 ? $user->lastActivity : \"<span class='text-muted'>\"._(\"Never\").\"</span>\"; ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Groups'); ?></td>\n\t<td>\n\t<?php\n\tif($user->role == \"Administrator\") {\n\tprint _('All groups');\n\t}\n\telse {\n\t\t$groups = json_decode($user->groups, true);\n\t\t$gr = $Admin->groups_parse($groups);\n\t\tif(sizeof($gr)>0) {\n\t\t\tforeach($gr as $group) {\n\t\t\t\tprint $group['g_name'].\"<br>\";\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tprint \"<span class='text-muted'>No groups</span>\";\n\t\t}\n\t}\n\t?>\n\t</td>\n</tr>\n<tr>\n\t<td><?php print _('Password change required'); ?></td>\n\t<td><?php print $user->passChange; ?></td>\n</tr>\n\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Display settings'); ?></h4><hr></td>\n</tr>\n<tr>\n\t<td><?php print _('Theme'); ?></td>\n\t<td><?php print $user->theme==\"\" ? _(\"Default\") : $user->theme ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Compress override'); ?></td>\n\t<td><?php print $user->compressOverride==1 ? _(\"Yes\") : _(\"No\") ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Hide free range'); ?></td>\n\t<td><?php print $user->hideFreeRange==1 ? _(\"Yes\") : _(\"No\") ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Menu type'); ?></td>\n\t<td><?php print $user->menuType; ?></td>\n</tr>\n\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Mail settings'); ?></h4><hr></td>\n</tr>\n<tr>\n\t<td><?php print _('Mail notifications'); ?></td>\n\t<td><?php print $user->role == \"Administrator\" ? _($user->mailNotify) : _(\"No\"); ?></td>\n</tr>\n<tr>\n\t<td><?php print _('Changelog notifications'); ?></td>\n\t<td><?php print $user->role == \"Administrator\" ? _($user->mailChangelog) : _(\"No\"); ?></td>\n</tr>\n\n\n\n<tr>\n\t<td colspan=\"2\"><h4><?php print _('Custom fields'); ?></h4><hr></td>\n</tr>\n\n<?php\n# custom subnet fields\nif(sizeof($custom_fields) > 0) {\n\tforeach($custom_fields as $key=>$field) {\n\t\t$user->{$key} = str_replace(\"\\n\", \"<br>\",$user->{$key});\n\t\tprint \"<tr>\";\n\t\tprint \"\t<td>$key</td>\";\n\t\tprint \"\t<td>\";\n\t\t//no length\n\t\tif(strlen($user->{$key})==0) {\n\t\t\tprint \"/\";\n\t\t}\n\t\t//booleans\n\t\telseif($field['type']==\"tinyint(1)\")\t{\n\t\t\tif($user->{$key} == \"0\")\t\t{ print _(\"No\"); }\n\t\t\telseif($user->{$key} == \"1\")\t{ print _(\"Yes\"); }\n\t\t}\n\t\telse {\n\t\t\tprint $user->{$key};\n\t\t}\n\t\tprint \"\t</td>\";\n\t\tprint \"</tr>\";\n\t\t}\n}\nelse {\n\tprint \"<tr>\";\n\tprint \"\t<td colspan='2'>\";\n\t$Result->show (\"muted\", _(\"No custom fields\"), false);\n\tprint \"\t</td>\";\n\tprint \"</tr>\";\n}\n?>\n\n\n</table>", "patch": "@@ -133,7 +133,7 @@\n </tr>\n <tr>\n \t<td><?php print _('Theme'); ?></td>\n-\t<td><?php print $user->theme==\"\" ? _(\"Default\") : $user->theme ?></td>\n+\t<td><?php print $user->theme==\"\" ? _(\"Default\") : escape_input($user->theme) ?></td>\n </tr>\n <tr>\n \t<td><?php print _('Compress override'); ?></td>", "file_path": "files/2022_10/1633", "file_language": "php", "file_name": "app/admin/users/print-user.php", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/phpipam/phpipam/raw/552fbb0fc7ecb84bda4a131b4f290a3de9980040/app%2Ftools%2Fuser-menu%2F2fa.php", "code": "<?php if (array_key_exists(\"2fa\", $subpages)) { ?>\n\n<?php\n# verify that user is logged in\n$User->check_user_session();\n\n# init class\nrequire_once (dirname(__FILE__).\"/../../../functions/GoogleAuthenticator/PHPGangsta/GoogleAuthenticator.php\");\n$ga = new PHPGangsta_GoogleAuthenticator();\n\n# secret\nif (is_null($User->user->{'2fa_secret'}) && $User->user->{'2fa'}==\"1\") {\n\t// create secret\n\t$User->user->{'2fa_secret'} = $ga->createSecret($User->settings->{'2fa_length'});\n\t// admin class\n\t$Admin = new Admin ($Database, false);\n\t// update user\n\tif($Admin->object_modify (\"users\", \"edit\", \"id\", [\"id\"=>$User->user->id, \"2fa_secret\"=>$User->user->{'2fa_secret'}])===false) {\n\t\t$Result->show(\"danger\", _(\"Failed to activate 2fa for user\"), true, true, false, false, true );\n\t}\n}\n\n// get QR code\n$username = strtolower($User->user->username).\"@\".$User->settings->{'2fa_name'};\n?>\n\n<h4><?php print _('Two-factor authentication'); ?></h4>\n<hr>\n<span class=\"info2\"><?php print _(\"Here you can change settings for two-factor authentication and get your 2fa secret.\"); ?></span>\n<br><br>\n\n<form name=\"2fa_user\" id=\"2fa_user\">\n<table id=\"userModSelf\" class=\"table table-condensed\">\n<tr>\n\t<td class=\"title\"><?php print _('2fa status'); ?></td>\n\t<?php if ($User->settings->{'2fa_userchange'}==\"1\") { ?>\n\t<td>\n\t\t<input type=\"checkbox\" value=\"1\" class=\"input-switch\" name=\"2fa\" <?php if($User->user->{'2fa'} == 1) print 'checked'; ?>>\n\t</td>\n\t<td>\n\t\t<input type=\"submit\" class=\"btn btn-default btn-success btn-sm submit_popup\" data-script=\"app/tools/user-menu/2fa_save.php\" data-result_div=\"userModSelf2faResult\" data-form='2fa_user' value=\"<?php print _(\"Save\"); ?>\">\n\t</td>\n\t<?php } else { ?>\n\t<td>\n\t\t<?php\n\t\tprint $User->user->{'2fa'} == 1 ? _(\"Enabled\") : _(\"Disabled\");\n\t\t?>\n\t</td>\n\t<?php }  ?>\n</tr>\n</table>\n<input type=\"hidden\" name=\"csrf_cookie\" value=\"<?php print $csrf; ?>\">\n</form>\n\n<!-- result -->\n<div id=\"userModSelf2faResult\" style=\"margin-bottom:90px;display:none\"></div>\n\n\n<hr>\n<br><br>\n<?php\n\nif($User->user->{'2fa_secret'}!=null) {\n\t$html   = [];\n\t$html[] = '<div class=\"loginForm row\" style=\"width:400px;\">';\n\t$html[] = '\t\t'._('Details for your Google Authenticator are below. Please write down your details, otherwise you will not be able to login to phpipam').\".\";\n\t$html[] = '\t\t<div style=\"border: 2px dashed red;margin:20px;padding: 10px\" class=\"text-center row\">';\n\t$html[] = '\t\t\t<div class=\"col-xs-12\" style=\"padding:5px 10px 3px 20px;\"><strong>'._('Account').': <span style=\"color:red; font-size: 16px\">'.$username.'</span></strong></div>';\n\t$html[] = '\t\t\t<div class=\"col-xs-12\" style=\"padding:0px 10px 3px 20px;\"><strong>'._('Secret').' : <span style=\"color:red; font-size: 16px\">'.$User->user->{'2fa_secret'}.'</span></strong></div>';\n\t$html[] = '\t\t</div>';\n\t$html[] = '\t\t<div class=\"text-center\">';\n\t$html[] = '\t\t<hr>'._('You can also scan followign QR code with Google Authenticator application').':<br><br>';\n\t$html[] = '\t\t\t<div id=\"qrcode\" style=\"width:200px;margin:auto;\"></div>';\n\t$html[] = '\t\t</div><br>';\n\t$html[] = '</div>';\n\n\tprint implode(\"\\n\", $html);\n}\n?>\n\n\n<?php\n}\nelse {\n\t$Result->show (\"warning\", _(\"Two-factor authentication\").\" \"._(\"disabled\"), false);\n}\n?>\n\n\n<script type=\"text/javascript\" src=\"functions/qrcodejs/qrcode.min.js\"></script>\n<script type=\"text/javascript\">\n$(document).ready(function() {\n\t/* bootstrap switch */\n\tvar switch_options = {\n\t    onColor: 'default',\n\t    offColor: 'default',\n\t    size: \"mini\"\n\t};\n\t$(\".input-switch\").bootstrapSwitch(switch_options);\n});\n\n// show QR code\nvar qrcode = new QRCode(document.getElementById(\"qrcode\"), {\n\ttext: \"otpauth://totp/<?php print $username.\"?secret=\".$User->user->{'2fa_secret'}; ?>\",\n\twidth: 200,\n\theight: 200,\n\tcolorDark : \"#000000\",\n\tcolorLight : \"#ffffff\",\n\tcorrectLevel : QRCode.CorrectLevel.H\n});\n</script>", "code_before": "<?php if (array_key_exists(\"2fa\", $subpages)) { ?>\n\n<?php\n# verify that user is logged in\n$User->check_user_session();\n\n# init class\nrequire_once (dirname(__FILE__).\"/../../../functions/GoogleAuthenticator/PHPGangsta/GoogleAuthenticator.php\");\n$ga = new PHPGangsta_GoogleAuthenticator();\n\n# secret\nif (is_null($User->user->{'2fa_secret'}) && $User->user->{'2fa'}==\"1\") {\n\t// create secret\n\t$User->user->{'2fa_secret'} = $ga->createSecret($User->settings->{'2fa_length'});\n\t// admin class\n\t$Admin = new Admin ($Database, false);\n\t// update user\n\tif($Admin->object_modify (\"users\", \"edit\", \"id\", [\"id\"=>$User->user->id, \"2fa_secret\"=>$User->user->{'2fa_secret'}])===false) {\n\t\t$Result->show(\"danger\", _(\"Failed to activate 2fa for user\"), true, true, false, false, true );\n\t}\n}\n\n// get QR code\n$username = strtolower($User->user->username).\"@\".$User->settings->{'2fa_name'};\n?>\n\n<h4><?php print _('Two-factor authentication'); ?></h4>\n<hr>\n<span class=\"info2\"><?php print _(\"Here you can change settings for two-factor authentication and get your 2fa secret.\"); ?></span>\n<br><br>\n\n<form name=\"2fa_user\" id=\"2fa_user\">\n<table id=\"userModSelf\" class=\"table table-condensed\">\n<tr>\n\t<td class=\"title\"><?php print _('2fa status'); ?></td>\n\t<?php if ($User->settings->{'2fa_userchange'}==\"1\") { ?>\n\t<td>\n\t\t<input type=\"checkbox\" value=\"1\" class=\"input-switch\" name=\"2fa\" <?php if($User->user->{'2fa'} == 1) print 'checked'; ?>>\n\t</td>\n\t<td>\n\t\t<input type=\"submit\" class=\"btn btn-default btn-success btn-sm submit_popup\" data-script=\"app/tools/user-menu/2fa_save.php\" data-result_div=\"userModSelf2faResult\" data-form='2fa_user' value=\"<?php print _(\"Save\"); ?>\">\n\t</td>\n\t<?php } else { ?>\n\t<td>\n\t\t<?php\n\t\tprint $User->user->{'2fa'} == 1 ? _(\"Enabled\") : _(\"Disabled\");\n\t\t?>\n\t</td>\n\t<?php }  ?>\n</tr>\n</table>\n</form>\n\n<!-- result -->\n<div id=\"userModSelf2faResult\" style=\"margin-bottom:90px;display:none\"></div>\n\n\n<hr>\n<br><br>\n<?php\n\nif($User->user->{'2fa_secret'}!=null) {\n\t$html   = [];\n\t$html[] = '<div class=\"loginForm row\" style=\"width:400px;\">';\n\t$html[] = '\t\t'._('Details for your Google Authenticator are below. Please write down your details, otherwise you will not be able to login to phpipam').\".\";\n\t$html[] = '\t\t<div style=\"border: 2px dashed red;margin:20px;padding: 10px\" class=\"text-center row\">';\n\t$html[] = '\t\t\t<div class=\"col-xs-12\" style=\"padding:5px 10px 3px 20px;\"><strong>'._('Account').': <span style=\"color:red; font-size: 16px\">'.$username.'</span></strong></div>';\n\t$html[] = '\t\t\t<div class=\"col-xs-12\" style=\"padding:0px 10px 3px 20px;\"><strong>'._('Secret').' : <span style=\"color:red; font-size: 16px\">'.$User->user->{'2fa_secret'}.'</span></strong></div>';\n\t$html[] = '\t\t</div>';\n\t$html[] = '\t\t<div class=\"text-center\">';\n\t$html[] = '\t\t<hr>'._('You can also scan followign QR code with Google Authenticator application').':<br><br>';\n\t$html[] = '\t\t\t<div id=\"qrcode\" style=\"width:200px;margin:auto;\"></div>';\n\t$html[] = '\t\t</div><br>';\n\t$html[] = '</div>';\n\n\tprint implode(\"\\n\", $html);\n}\n?>\n\n\n<?php\n}\nelse {\n\t$Result->show (\"warning\", _(\"Two-factor authentication\").\" \"._(\"disabled\"), false);\n}\n?>\n\n\n<script type=\"text/javascript\" src=\"functions/qrcodejs/qrcode.min.js\"></script>\n<script type=\"text/javascript\">\n$(document).ready(function() {\n\t/* bootstrap switch */\n\tvar switch_options = {\n\t    onColor: 'default',\n\t    offColor: 'default',\n\t    size: \"mini\"\n\t};\n\t$(\".input-switch\").bootstrapSwitch(switch_options);\n});\n\n// show QR code\nvar qrcode = new QRCode(document.getElementById(\"qrcode\"), {\n\ttext: \"otpauth://totp/<?php print $username.\"?secret=\".$User->user->{'2fa_secret'}; ?>\",\n\twidth: 200,\n\theight: 200,\n\tcolorDark : \"#000000\",\n\tcolorLight : \"#ffffff\",\n\tcorrectLevel : QRCode.CorrectLevel.H\n});\n</script>", "patch": "@@ -49,6 +49,7 @@\n \t<?php }  ?>\n </tr>\n </table>\n+<input type=\"hidden\" name=\"csrf_cookie\" value=\"<?php print $csrf; ?>\">\n </form>\n \n <!-- result -->", "file_path": "files/2022_10/1634", "file_language": "php", "file_name": "app/tools/user-menu/2fa.php", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/phpipam/phpipam/raw/552fbb0fc7ecb84bda4a131b4f290a3de9980040/app%2Ftools%2Fuser-menu%2F2fa_save.php", "code": "<?php\n\n/**\n *\n * User selfMod check end execute\n *\n */\n\n# include required scripts\nrequire_once( dirname(__FILE__) . '/../../../functions/functions.php' );\nrequire_once (dirname(__FILE__) . \"/../../../functions/GoogleAuthenticator/PHPGangsta/GoogleAuthenticator.php\");\n\n# initialize required objects\n$Database       = new Database_PDO;\n$Result         = new Result;\n$User           = new User ($Database);\n$Admin          = new Admin ($Database, false);\n$ga \t\t\t= new PHPGangsta_GoogleAuthenticator();\n\n# verify that user is logged in\n$User->check_user_session();\n\n# validate csrf cookie\n$User->Crypto->csrf_cookie (\"validate\", \"user-menu\", $_POST['csrf_cookie']) === false ? $Result->show(\"danger\", _(\"Invalid CSRF cookie\"), true) : \"\";\n\n# change ?\nif(@$_POST['2fa']==\"1\" && $User->user->{'2fa'}==\"1\") {\n\t$Result->show(\"info\", _(\"No change\"), true);\n}\n\n# can user change ?\nif ($User->settings->{'2fa_userchange'}!=\"1\") {\n\t$Result->show(\"danger\", _(\"You are not allowed to change 2fa settings. Please contact system administrator.\"), true);\n}\n\n# init values\n$values       = [];\n$values['id'] = $User->user->id;\n\n# 2fa and 2fa_secret\nif(@$_POST['2fa']==\"1\") {\n\t$values['2fa'] = \"1\";\n\t# create\n\t$values['2fa_secret'] = $ga->createSecret($User->settings->{'2fa_length'});\n}\n# remove 2fa\nelse {\n\t$values['2fa'] = \"0\";\n\t$values['2fa_secret'] = NULL;\t// remove old 2fa secret\n}\n\n\n# update\nif(!$Admin->object_modify(\"users\", \"edit\", \"id\", $values)) \t{ $Result->show(\"danger alert-absolute\",  _(\"2fa update error\"), true); }\nelse \t\t\t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"success alert-absolute\", _(\"2fa update success\"), true); }", "code_before": "<?php\n\n/**\n *\n * User selfMod check end execute\n *\n */\n\n# include required scripts\nrequire_once( dirname(__FILE__) . '/../../../functions/functions.php' );\nrequire_once (dirname(__FILE__) . \"/../../../functions/GoogleAuthenticator/PHPGangsta/GoogleAuthenticator.php\");\n\n# initialize required objects\n$Database       = new Database_PDO;\n$Result         = new Result;\n$User           = new User ($Database);\n$Admin          = new Admin ($Database, false);\n$ga \t\t\t= new PHPGangsta_GoogleAuthenticator();\n\n# verify that user is logged in\n$User->check_user_session();\n\n# change ?\nif(@$_POST['2fa']==\"1\" && $User->user->{'2fa'}==\"1\") {\n\t$Result->show(\"info\", _(\"No change\"), true);\n}\n\n# can user change ?\nif ($User->settings->{'2fa_userchange'}!=\"1\") {\n\t$Result->show(\"danger\", _(\"You are not allowed to change 2fa settings. Please contact system administrator.\"), true);\n}\n\n# init values\n$values       = [];\n$values['id'] = $User->user->id;\n\n# 2fa and 2fa_secret\nif(@$_POST['2fa']==\"1\") {\n\t$values['2fa'] = \"1\";\n\t# create\n\t$values['2fa_secret'] = $ga->createSecret($User->settings->{'2fa_length'});\n}\n# remove 2fa\nelse {\n\t$values['2fa'] = \"0\";\n\t$values['2fa_secret'] = NULL;\t// remove old 2fa secret\n}\n\n\n# update\nif(!$Admin->object_modify(\"users\", \"edit\", \"id\", $values)) \t{ $Result->show(\"danger alert-absolute\",  _(\"2fa update error\"), true); }\nelse \t\t\t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"success alert-absolute\", _(\"2fa update success\"), true); }", "patch": "@@ -20,6 +20,9 @@\n # verify that user is logged in\n $User->check_user_session();\n \n+# validate csrf cookie\n+$User->Crypto->csrf_cookie (\"validate\", \"user-menu\", $_POST['csrf_cookie']) === false ? $Result->show(\"danger\", _(\"Invalid CSRF cookie\"), true) : \"\";\n+\n # change ?\n if(@$_POST['2fa']==\"1\" && $User->user->{'2fa'}==\"1\") {\n \t$Result->show(\"info\", _(\"No change\"), true);", "file_path": "files/2022_10/1635", "file_language": "php", "file_name": "app/tools/user-menu/2fa_save.php", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/phpipam/phpipam/raw/552fbb0fc7ecb84bda4a131b4f290a3de9980040/app%2Ftools%2Fuser-menu%2Faccount.php", "code": "<script type=\"text/javascript\">\n$(document).ready(function() {\n\t/* bootstrap switch */\n\tvar switch_options = {\n\t    onColor: 'default',\n\t    offColor: 'default',\n\t    size: \"mini\"\n\t};\n\t$(\".input-switch\").bootstrapSwitch(switch_options);\n});\n</script>\n\n<?php\n\n/**\n * Usermenu - user can change password and email\n */\n\n# verify that user is logged in\n$User->check_user_session();\n\n# fetch all languages\n$langs = $User->fetch_langs();\n?>\n\n<!-- test -->\n<h4><?php print _('Account details'); ?></h4>\n<hr>\n<span class=\"info2\"><?php print _(\"Change details for your account\"); ?></span>\n<br><br>\n\n\n\n<form id=\"userModSelf\">\n<table id=\"userModSelf\" class=\"table table-condensed\">\n\n<!-- real name -->\n<tr>\n    <td><?php print _('Real name'); ?></td>\n    <td>\n        <input type=\"text\" class=\"form-control input-sm\" name=\"real_name\" value=\"<?php print $User->user->real_name; ?>\">\n    </td>\n    <td class=\"info2\"><?php print _('Display name'); ?></td>\n</tr>\n\n<!-- username -->\n<tr>\n    <td><?php print _('E-mail'); ?></td>\n    <td>\n        <input type=\"email\" class=\"form-control input-sm\"  name=\"email\" value=\"<?php print $User->user->email; ?>\" autocomplete=\"off\">\n    </td>\n    <td class=\"info2\"><?php print _('Email address'); ?></td>\n</tr>\n\n<?php\n# show pass only to local users!\nif($User->user->authMethod == 1) {\n?>\n<!-- password -->\n<tr>\n    <td><?php print _('Password'); ?></td>\n    <td>\n        <input type=\"password\" class=\"userPass form-control input-sm\" name=\"password1\">\n    </td style=\"white-space:nowrap\">\n    <td class=\"info2\"><?php print _('Password'); ?> <button id=\"randomPassSelf\" class=\"btn btn-xs btn-default\"><i class=\"fa fa-gray fa-random\"></i></button><span id=\"userRandomPass\" style=\"padding-left:15px;\"></span></td>\n</tr>\n\n<!-- password repeat -->\n<tr>\n    <td><?php print _('Password'); ?> (<?php print _('repeat'); ?>)</td>\n    <td>\n        <input type=\"password\" class=\"userPass form-control input-sm\" name=\"password2\">\n    </td>\n    <td class=\"info2\"><?php print _('Re-type password'); ?></td>\n</tr>\n<?php } ?>\n\n<!-- select theme -->\n<tr>\n\t<td><?php print _('Theme'); ?></td>\n\t<td>\n\t\t<select name=\"theme\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<option value=\"default\"><?php print _(\"Default\"); ?></option>\n\t\t\t<?php\n\t\t\tforeach($User->themes as $theme) {\n\t\t\t\tif($theme==$User->user->theme)\t{ print \"<option value='$theme' selected>$theme</option>\"; }\n\t\t\t\telse\t\t\t\t\t\t\t{ print \"<option value='$theme'\t\t    >$theme</option>\"; }\n\t\t\t}\n\t\t\t?>\n\t\t</select>\n\t</td>\n\t<td class=\"info2\"><?php print _('Select UI theme'); ?></td>\n</tr>\n\n<!-- select language -->\n<tr>\n\t<td><?php print _('Language'); ?></td>\n\t<td>\n\t\t<select name=\"lang\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<?php\n\t\t\tforeach($langs as $lang) {\n\t\t\t\tif($lang->l_id==$User->user->lang)\t{ print \"<option value='$lang->l_id' selected>$lang->l_name ($lang->l_code)</option>\"; }\n\t\t\t\telse\t\t\t\t\t\t\t\t{ print \"<option value='$lang->l_id'\t\t >$lang->l_name ($lang->l_code)</option>\"; }\n\t\t\t}\n\t\t\t?>\n\t\t</select>\n\t</td>\n\t<td class=\"info2\"><?php print _('Select language'); ?></td>\n</tr>\n\n<!-- weather to receive mails -->\n<tr>\n\t<td><?php print _('Mail notifications'); ?></td>\n\t<td>\n\t\t<select name=\"mailNotify\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<option value=\"No\"><?php print _(\"No\"); ?></option>\n\t\t\t<option value=\"Yes\" <?php if($User->user->mailNotify==\"Yes\") { print \"selected='selected'\"; } ?>><?php print _(\"Yes\"); ?></option>\n\t\t</select>\n\t</td>\n\t<?php if($User->user->role==\"Administrator\") { ?>\n\t<td class=\"info2\"><?php print _('Select yes to receive mail notification changes (IP state change, new hosts, requests)'); ?></td>\n    <?php } else { ?>\n\t<td class=\"info2\"><?php print _('Select yes to receive mail notifications for IP requests'); ?></td>\n    <?php } ?>\n</tr>\n\n<!-- weather to receive mails for changelog -->\n<tr>\n\t<td><?php print _('Mail Changelog'); ?></td>\n\t<td>\n\t\t<select name=\"mailChangelog\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<option value=\"No\"><?php print _(\"No\"); ?></option>\n\t\t\t<option value=\"Yes\" <?php if($User->user->mailChangelog==\"Yes\") { print \"selected='selected'\"; } ?>><?php print _(\"Yes\"); ?></option>\n\t\t</select>\n\t</td>\n\t<?php if($User->user->role==\"Administrator\") { ?>\n\t<td class=\"info2\"><?php print _('Select yes to receive notification change mail for changelog'); ?></td>\n    <?php } else { ?>\n\t<td class=\"info2\"><?php print _('Select yes to receive notification change mail for changelog'); ?></td>\n    <?php } ?>\n</tr>\n\n\n<!-- display settings -->\n<tr>\n\t<td colspan=\"2\"><hr></td>\n</tr>\n<!-- Display -->\n<tr class=\"settings-title\">\n\t<th colspan=\"3\"><h4><?php print _('Display settings'); ?></h4></th>\n</tr>\n\n<!-- DHCP compress -->\n<tr>\n\t<td class=\"title\"><?php print _('Override compression'); ?></td>\n\t<td>\n\t\t<input type=\"checkbox\" value=\"Uncompress\" class=\"input-switch\" name=\"compressOverride\" <?php if($User->user->compressOverride == \"Uncompress\") print 'checked'; ?>>\n\t</td>\n\t<td class=\"info2\">\n\t\t<?php print _('Uncompress address ranges if compressed'); ?>\n\t</td>\n</tr>\n\n<!-- Hide free range -->\n<tr>\n\t<td class=\"title\"><?php print _('Hide free range'); ?></td>\n\t<td>\n\t\t<input type=\"checkbox\" value=\"1\" class=\"input-switch\" name=\"hideFreeRange\" <?php if($User->user->hideFreeRange == 1) print 'checked'; ?>>\n\t</td>\n\t<td class=\"info2\">\n\t\t<?php print _('Do not display free range in IP address and subnets list'); ?>\n\t</td>\n</tr>\n\n<!-- Compress text in menu -->\n<tr>\n\t<td class=\"title\"><?php print _('Compress text in top menu'); ?></td>\n\t<td>\n\t\t<input type=\"checkbox\" value=\"1\" class=\"input-switch\" name=\"menuCompact\" <?php if($User->user->menuCompact == 1) print 'checked'; ?>>\n\t</td>\n\t<td class=\"info2\">\n\t\t<?php print _('Do not show text next to menu items in dynamic menu'); ?>\n\t</td>\n</tr>\n\n<!-- Menu type -->\n<tr>\n\t<td class=\"title\"><?php print _('Menu Type'); ?></td>\n\t<td>\n\t\t<select name=\"menuType\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<?php\n\t\t\t$opts = array(\n\t\t\t\t\"Static\"=>_(\"Static\"),\n\t\t\t\t\"Dynamic\"=>_(\"Dynamic\")\n\t\t\t);\n\t\t\tforeach($opts as $key=>$line) {\n\t\t\t\tif($User->user->menuType == $key) { print \"<option value='$key' selected>$line</option>\"; }\n\t\t\t\telse \t\t\t\t\t\t\t  { print \"<option value='$key'>$line</option>\"; }\n\t\t\t}\n\t\t\t?>\n\t\t</select>\n\t</td>\n\t<td class=\"info2\">\n\t\t<?php print _('Select menu type to display'); ?>\n\t</td>\n</tr>\n\n\n<!-- Submit and hidden values -->\n<tr class=\"th\">\n    <td></td>\n    <td class=\"submit\">\n        <input type=\"submit\" class=\"btn btn-sm btn-success pull-right\" value=\"<?php print _('Save changes'); ?>\">\n    </td>\n    <td></td>\n</tr>\n\n</table>\n<input type=\"hidden\" name=\"csrf_cookie\" value=\"<?php print $csrf; ?>\">\n</form>\n\n\n<!-- result -->\n<div class=\"userModSelfResult\" style=\"margin-bottom:90px;display:none\"></div>", "code_before": "<script type=\"text/javascript\">\n$(document).ready(function() {\n\t/* bootstrap switch */\n\tvar switch_options = {\n\t    onColor: 'default',\n\t    offColor: 'default',\n\t    size: \"mini\"\n\t};\n\t$(\".input-switch\").bootstrapSwitch(switch_options);\n});\n</script>\n\n<?php\n\n/**\n * Usermenu - user can change password and email\n */\n\n# verify that user is logged in\n$User->check_user_session();\n\n# fetch all languages\n$langs = $User->fetch_langs();\n?>\n\n<!-- test -->\n<h4><?php print _('Account details'); ?></h4>\n<hr>\n<span class=\"info2\"><?php print _(\"Change details for your account\"); ?></span>\n<br><br>\n\n\n\n<form id=\"userModSelf\">\n<table id=\"userModSelf\" class=\"table table-condensed\">\n\n<!-- real name -->\n<tr>\n    <td><?php print _('Real name'); ?></td>\n    <td>\n        <input type=\"text\" class=\"form-control input-sm\" name=\"real_name\" value=\"<?php print $User->user->real_name; ?>\">\n    </td>\n    <td class=\"info2\"><?php print _('Display name'); ?></td>\n</tr>\n\n<!-- username -->\n<tr>\n    <td><?php print _('E-mail'); ?></td>\n    <td>\n        <input type=\"email\" class=\"form-control input-sm\"  name=\"email\" value=\"<?php print $User->user->email; ?>\" autocomplete=\"off\">\n    </td>\n    <td class=\"info2\"><?php print _('Email address'); ?></td>\n</tr>\n\n<?php\n# show pass only to local users!\nif($User->user->authMethod == 1) {\n?>\n<!-- password -->\n<tr>\n    <td><?php print _('Password'); ?></td>\n    <td>\n        <input type=\"password\" class=\"userPass form-control input-sm\" name=\"password1\">\n    </td style=\"white-space:nowrap\">\n    <td class=\"info2\"><?php print _('Password'); ?> <button id=\"randomPassSelf\" class=\"btn btn-xs btn-default\"><i class=\"fa fa-gray fa-random\"></i></button><span id=\"userRandomPass\" style=\"padding-left:15px;\"></span></td>\n</tr>\n\n<!-- password repeat -->\n<tr>\n    <td><?php print _('Password'); ?> (<?php print _('repeat'); ?>)</td>\n    <td>\n        <input type=\"password\" class=\"userPass form-control input-sm\" name=\"password2\">\n    </td>\n    <td class=\"info2\"><?php print _('Re-type password'); ?></td>\n</tr>\n<?php } ?>\n\n<!-- select theme -->\n<tr>\n\t<td><?php print _('Theme'); ?></td>\n\t<td>\n\t\t<select name=\"theme\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<option value=\"default\"><?php print _(\"Default\"); ?></option>\n\t\t\t<?php\n\t\t\tforeach($User->themes as $theme) {\n\t\t\t\tif($theme==$User->user->theme)\t{ print \"<option value='$theme' selected>$theme</option>\"; }\n\t\t\t\telse\t\t\t\t\t\t\t{ print \"<option value='$theme'\t\t    >$theme</option>\"; }\n\t\t\t}\n\t\t\t?>\n\t\t</select>\n\t</td>\n\t<td class=\"info2\"><?php print _('Select UI theme'); ?></td>\n</tr>\n\n<!-- select language -->\n<tr>\n\t<td><?php print _('Language'); ?></td>\n\t<td>\n\t\t<select name=\"lang\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<?php\n\t\t\tforeach($langs as $lang) {\n\t\t\t\tif($lang->l_id==$User->user->lang)\t{ print \"<option value='$lang->l_id' selected>$lang->l_name ($lang->l_code)</option>\"; }\n\t\t\t\telse\t\t\t\t\t\t\t\t{ print \"<option value='$lang->l_id'\t\t >$lang->l_name ($lang->l_code)</option>\"; }\n\t\t\t}\n\t\t\t?>\n\t\t</select>\n\t</td>\n\t<td class=\"info2\"><?php print _('Select language'); ?></td>\n</tr>\n\n<!-- weather to receive mails -->\n<tr>\n\t<td><?php print _('Mail notifications'); ?></td>\n\t<td>\n\t\t<select name=\"mailNotify\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<option value=\"No\"><?php print _(\"No\"); ?></option>\n\t\t\t<option value=\"Yes\" <?php if($User->user->mailNotify==\"Yes\") { print \"selected='selected'\"; } ?>><?php print _(\"Yes\"); ?></option>\n\t\t</select>\n\t</td>\n\t<?php if($User->user->role==\"Administrator\") { ?>\n\t<td class=\"info2\"><?php print _('Select yes to receive mail notification changes (IP state change, new hosts, requests)'); ?></td>\n    <?php } else { ?>\n\t<td class=\"info2\"><?php print _('Select yes to receive mail notifications for IP requests'); ?></td>\n    <?php } ?>\n</tr>\n\n<!-- weather to receive mails for changelog -->\n<tr>\n\t<td><?php print _('Mail Changelog'); ?></td>\n\t<td>\n\t\t<select name=\"mailChangelog\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<option value=\"No\"><?php print _(\"No\"); ?></option>\n\t\t\t<option value=\"Yes\" <?php if($User->user->mailChangelog==\"Yes\") { print \"selected='selected'\"; } ?>><?php print _(\"Yes\"); ?></option>\n\t\t</select>\n\t</td>\n\t<?php if($User->user->role==\"Administrator\") { ?>\n\t<td class=\"info2\"><?php print _('Select yes to receive notification change mail for changelog'); ?></td>\n    <?php } else { ?>\n\t<td class=\"info2\"><?php print _('Select yes to receive notification change mail for changelog'); ?></td>\n    <?php } ?>\n</tr>\n\n\n<!-- display settings -->\n<tr>\n\t<td colspan=\"2\"><hr></td>\n</tr>\n<!-- Display -->\n<tr class=\"settings-title\">\n\t<th colspan=\"3\"><h4><?php print _('Display settings'); ?></h4></th>\n</tr>\n\n<!-- DHCP compress -->\n<tr>\n\t<td class=\"title\"><?php print _('Override compression'); ?></td>\n\t<td>\n\t\t<input type=\"checkbox\" value=\"Uncompress\" class=\"input-switch\" name=\"compressOverride\" <?php if($User->user->compressOverride == \"Uncompress\") print 'checked'; ?>>\n\t</td>\n\t<td class=\"info2\">\n\t\t<?php print _('Uncompress address ranges if compressed'); ?>\n\t</td>\n</tr>\n\n<!-- Hide free range -->\n<tr>\n\t<td class=\"title\"><?php print _('Hide free range'); ?></td>\n\t<td>\n\t\t<input type=\"checkbox\" value=\"1\" class=\"input-switch\" name=\"hideFreeRange\" <?php if($User->user->hideFreeRange == 1) print 'checked'; ?>>\n\t</td>\n\t<td class=\"info2\">\n\t\t<?php print _('Do not display free range in IP address and subnets list'); ?>\n\t</td>\n</tr>\n\n<!-- Compress text in menu -->\n<tr>\n\t<td class=\"title\"><?php print _('Compress text in top menu'); ?></td>\n\t<td>\n\t\t<input type=\"checkbox\" value=\"1\" class=\"input-switch\" name=\"menuCompact\" <?php if($User->user->menuCompact == 1) print 'checked'; ?>>\n\t</td>\n\t<td class=\"info2\">\n\t\t<?php print _('Do not show text next to menu items in dynamic menu'); ?>\n\t</td>\n</tr>\n\n<!-- Menu type -->\n<tr>\n\t<td class=\"title\"><?php print _('Menu Type'); ?></td>\n\t<td>\n\t\t<select name=\"menuType\" class=\"form-control input-sm input-w-auto\">\n\t\t\t<?php\n\t\t\t$opts = array(\n\t\t\t\t\"Static\"=>_(\"Static\"),\n\t\t\t\t\"Dynamic\"=>_(\"Dynamic\")\n\t\t\t);\n\t\t\tforeach($opts as $key=>$line) {\n\t\t\t\tif($User->user->menuType == $key) { print \"<option value='$key' selected>$line</option>\"; }\n\t\t\t\telse \t\t\t\t\t\t\t  { print \"<option value='$key'>$line</option>\"; }\n\t\t\t}\n\t\t\t?>\n\t\t</select>\n\t</td>\n\t<td class=\"info2\">\n\t\t<?php print _('Select menu type to display'); ?>\n\t</td>\n</tr>\n\n\n<!-- Submit and hidden values -->\n<tr class=\"th\">\n    <td></td>\n    <td class=\"submit\">\n        <input type=\"submit\" class=\"btn btn-sm btn-success pull-right\" value=\"<?php print _('Save changes'); ?>\">\n    </td>\n    <td></td>\n</tr>\n\n</table>\n</form>\n\n\n<!-- result -->\n<div class=\"userModSelfResult\" style=\"margin-bottom:90px;display:none\"></div>", "patch": "@@ -216,6 +216,7 @@\n </tr>\n \n </table>\n+<input type=\"hidden\" name=\"csrf_cookie\" value=\"<?php print $csrf; ?>\">\n </form>\n \n ", "file_path": "files/2022_10/1636", "file_language": "php", "file_name": "app/tools/user-menu/account.php", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/phpipam/phpipam/raw/552fbb0fc7ecb84bda4a131b4f290a3de9980040/app%2Ftools%2Fuser-menu%2Findex.php", "code": "<?php\n\n/**\n * Usermenu - user can change password and email\n */\n\n# verify that user is logged in\n$User->check_user_session();\n\n# create csrf token\n$csrf = $User->Crypto->csrf_cookie (\"create\", \"user-menu\");\n\n# fetch all languages\n$langs = $User->fetch_langs();\n\n/* print hello */\nprint \"<h4>\".$User->user->real_name.\", \"._('here you can change your account details').\":</h4>\";\nprint \"<hr><br>\";\n\n?>\n\n<ul class=\"nav nav-tabs\">\n\t<?php\n\t/* Include subpage */\n\t$subpages = [\n\t\t\"account\" => \"Account details\",\n\t\t\"widgets\" => \"Widgets\"\n\t\t];\n\n\t// module permisisons\n\t$subpages['permissions'] = \"Module permissions\";\n\n\t// 2fa\n\tif ($User->settings->{'2fa_provider'}!=='none') {\n\t$subpages['2fa'] = \"Two-factor authentication\";\n\t}\n\n\t// default tab\n\tif(!isset($_GET['subnetId'])) {\n\t\t$_GET['subnetId'] = \"account\";\n\t}\n\n\t// check\n\tif(!array_key_exists($_GET['subnetId'], $subpages)) \t{ $Result->show(\"danger\", \"Invalid request\", true); }\n\n\t// print\n\tforeach($subpages as $href=>$t) {\n\t\t$class = $_GET['subnetId']==$href ? \"class='active'\" : \"\";\n\t\tprint \"<li role='presentation' $class><a href=\".create_link(\"tools\", \"user-menu\", \"$href\").\">\". _($t).\"</a></li>\";\n\t}\n\t?>\n</ul>\n\n<div class=\"container-fluid\" style=\"margin-top: 10px;\">\n\t<?php\n\t// include\n\tinclude ($_GET['subnetId'].\".php\");\n\t?>\n</div>", "code_before": "<?php\n\n/**\n * Usermenu - user can change password and email\n */\n\n# verify that user is logged in\n$User->check_user_session();\n\n# fetch all languages\n$langs = $User->fetch_langs();\n\n/* print hello */\nprint \"<h4>\".$User->user->real_name.\", \"._('here you can change your account details').\":</h4>\";\nprint \"<hr><br>\";\n\n?>\n\n<ul class=\"nav nav-tabs\">\n\t<?php\n\t/* Include subpage */\n\t$subpages = [\n\t\t\"account\" => \"Account details\",\n\t\t\"widgets\" => \"Widgets\"\n\t\t];\n\n\t// module permisisons\n\t$subpages['permissions'] = \"Module permissions\";\n\n\t// 2fa\n\tif ($User->settings->{'2fa_provider'}!=='none') {\n\t$subpages['2fa'] = \"Two-factor authentication\";\n\t}\n\n\t// default tab\n\tif(!isset($_GET['subnetId'])) {\n\t\t$_GET['subnetId'] = \"account\";\n\t}\n\n\t// check\n\tif(!array_key_exists($_GET['subnetId'], $subpages)) \t{ $Result->show(\"danger\", \"Invalid request\", true); }\n\n\t// print\n\tforeach($subpages as $href=>$t) {\n\t\t$class = $_GET['subnetId']==$href ? \"class='active'\" : \"\";\n\t\tprint \"<li role='presentation' $class><a href=\".create_link(\"tools\", \"user-menu\", \"$href\").\">\". _($t).\"</a></li>\";\n\t}\n\t?>\n</ul>\n\n<div class=\"container-fluid\" style=\"margin-top: 10px;\">\n\t<?php\n\t// include\n\tinclude ($_GET['subnetId'].\".php\");\n\t?>\n</div>", "patch": "@@ -7,6 +7,9 @@\n # verify that user is logged in\n $User->check_user_session();\n \n+# create csrf token\n+$csrf = $User->Crypto->csrf_cookie (\"create\", \"user-menu\");\n+\n # fetch all languages\n $langs = $User->fetch_langs();\n ", "file_path": "files/2022_10/1637", "file_language": "php", "file_name": "app/tools/user-menu/index.php", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/phpipam/phpipam/raw/552fbb0fc7ecb84bda4a131b4f290a3de9980040/app%2Ftools%2Fuser-menu%2Fuser-edit.php", "code": "<?php\n\n/**\n *\n * User selfMod check end execute\n *\n */\n\nheader('Content-Type: text/html; charset=utf-8');\n\n# include required scripts\nrequire_once( dirname(__FILE__) . '/../../../functions/functions.php' );\n\n# initialize required objects\n$Database       = new Database_PDO;\n$Result         = new Result;\n$User           = new User ($Database);\n$Password_check = new Password_check ();\n\n# verify that user is logged in\n$User->check_user_session();\n\n# validate csrf cookie\n$User->Crypto->csrf_cookie (\"validate\", \"user-menu\", $_POST['csrf_cookie']) === false ? $Result->show(\"danger\", _(\"Invalid CSRF cookie\"), true) : \"\";\n\n# verify email\nif(!filter_var($_POST['email'], FILTER_VALIDATE_EMAIL))\t\t\t\t\t\t\t{ $Result->show(\"danger alert-absolute\",  _('Email not valid!'), true); }\n\n# verify lang\nif(!is_numeric($_POST['lang']))                                                 { $Result->show(\"danger alert-absolute\",  _('Invalid language!'), true); }\n\n# verify password if changed (not empty)\nif (strlen($_POST['password1']) != 0) {\n\tif ($_POST['password1'] != $_POST['password2']) \t\t\t\t\t\t\t{ $Result->show(\"danger alert-absolute\", _('Passwords do not match!'), true); }\n\t# validate pass against policy\n\t$policy = (json_decode($User->settings->passwordPolicy, true));\n\t$Password_check->set_requirements  ($policy, explode(\",\",$policy['allowedSymbols']));\n\tif (!$Password_check->validate ($_POST['password1'])) \t\t\t\t\t\t{ $Result->show(\"danger alert-danger \", _('Password validation errors').\":<br> - \".implode(\"<br> - \", $Password_check->get_errors ()), true); }\n}\n\n# Verify Theme\nif (!empty($_POST['theme'])) {\n\tif (!in_array($_POST['theme'], ['default', 'white', 'dark'])) \t\t\t\t{ $Result->show(\"danger alert-absolute\", _('Invalid theme'), true); }\n}\n\n# set override\n$_POST['compressOverride'] = @$_POST['compressOverride']==\"Uncompress\" ? \"Uncompress\" : \"default\";\n\n# Update user\nif (!$User->self_update ($_POST)) \t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"danger alert-absolute\",  _('Error updating user account!'), true); }\nelse \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"success alert-absolute\", _('Account updated successfully'), false); }\n\n# update language\n$User->update_session_language ();", "code_before": "<?php\n\n/**\n *\n * User selfMod check end execute\n *\n */\n\nheader('Content-Type: text/html; charset=utf-8');\n\n# include required scripts\nrequire_once( dirname(__FILE__) . '/../../../functions/functions.php' );\n\n# initialize required objects\n$Database       = new Database_PDO;\n$Result         = new Result;\n$User           = new User ($Database);\n$Password_check = new Password_check ();\n\n# verify that user is logged in\n$User->check_user_session();\n\n# verify email\nif(!filter_var($_POST['email'], FILTER_VALIDATE_EMAIL))\t\t\t\t\t\t\t{ $Result->show(\"danger alert-absolute\",  _('Email not valid!'), true); }\n\n# verify lang\nif(!is_numeric($_POST['lang']))                                                 { $Result->show(\"danger alert-absolute\",  _('Invalid language!'), true); }\n\n# verify password if changed (not empty)\nif (strlen($_POST['password1']) != 0) {\n\tif ($_POST['password1'] != $_POST['password2']) \t\t\t\t\t\t\t{ $Result->show(\"danger alert-absolute\", _('Passwords do not match!'), true); }\n\t# validate pass against policy\n\t$policy = (json_decode($User->settings->passwordPolicy, true));\n\t$Password_check->set_requirements  ($policy, explode(\",\",$policy['allowedSymbols']));\n\tif (!$Password_check->validate ($_POST['password1'])) \t\t\t\t\t\t{ $Result->show(\"danger alert-danger \", _('Password validation errors').\":<br> - \".implode(\"<br> - \", $Password_check->get_errors ()), true); }\n}\n\n# set override\n$_POST['compressOverride'] = @$_POST['compressOverride']==\"Uncompress\" ? \"Uncompress\" : \"default\";\n\n# Update user\nif (!$User->self_update ($_POST)) \t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"danger alert-absolute\",  _('Error updating user account!'), true); }\nelse \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"success alert-absolute\", _('Account updated successfully'), false); }\n\n# update language\n$User->update_session_language ();", "patch": "@@ -20,6 +20,9 @@\n # verify that user is logged in\n $User->check_user_session();\n \n+# validate csrf cookie\n+$User->Crypto->csrf_cookie (\"validate\", \"user-menu\", $_POST['csrf_cookie']) === false ? $Result->show(\"danger\", _(\"Invalid CSRF cookie\"), true) : \"\";\n+\n # verify email\n if(!filter_var($_POST['email'], FILTER_VALIDATE_EMAIL))\t\t\t\t\t\t\t{ $Result->show(\"danger alert-absolute\",  _('Email not valid!'), true); }\n \n@@ -35,6 +38,11 @@\n \tif (!$Password_check->validate ($_POST['password1'])) \t\t\t\t\t\t{ $Result->show(\"danger alert-danger \", _('Password validation errors').\":<br> - \".implode(\"<br> - \", $Password_check->get_errors ()), true); }\n }\n \n+# Verify Theme\n+if (!empty($_POST['theme'])) {\n+\tif (!in_array($_POST['theme'], ['default', 'white', 'dark'])) \t\t\t\t{ $Result->show(\"danger alert-absolute\", _('Invalid theme'), true); }\n+}\n+\n # set override\n $_POST['compressOverride'] = @$_POST['compressOverride']==\"Uncompress\" ? \"Uncompress\" : \"default\";\n ", "file_path": "files/2022_10/1638", "file_language": "php", "file_name": "app/tools/user-menu/user-edit.php", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/phpipam/phpipam/raw/552fbb0fc7ecb84bda4a131b4f290a3de9980040/app%2Ftools%2Fuser-menu%2Fuser-widgets-set.php", "code": "<?php\n\n/**\n *\n *set users widgets\n *\n */\n\n# include required scripts\nrequire_once( dirname(__FILE__) . '/../../../functions/functions.php' );\n\n# initialize required objects\n$Database \t= new Database_PDO;\n$Result\t\t= new Result;\n$User\t\t= new User ($Database);\n\n# verify that user is logged in\n$User->check_user_session();\n\n/* save widgets */\nif (!$User->self_update_widgets ($_POST['widgets'])) \t{ $Result->show(\"danger\", _('Error updating'),true); }\nelse \t\t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"success\", _('Widgets updated'),true); }\n?>", "code_before": "<?php\n\n/**\n *\n *set users widgets\n *\n */\n\n# include required scripts\nrequire_once( dirname(__FILE__) . '/../../../functions/functions.php' );\n\n# initialize required objects\n$Database \t= new Database_PDO;\n$Result\t\t= new Result;\n$User\t\t= new User ($Database);\n\n/* save widgets */\nif (!$User->self_update_widgets ($_POST['widgets'])) \t{ $Result->show(\"danger\", _('Error updating'),true); }\nelse \t\t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"success\", _('Widgets updated'),true); }\n?>", "patch": "@@ -14,6 +14,9 @@\n $Result\t\t= new Result;\n $User\t\t= new User ($Database);\n \n+# verify that user is logged in\n+$User->check_user_session();\n+\n /* save widgets */\n if (!$User->self_update_widgets ($_POST['widgets'])) \t{ $Result->show(\"danger\", _('Error updating'),true); }\n else \t\t\t\t\t\t\t\t\t\t\t\t\t{ $Result->show(\"success\", _('Widgets updated'),true); }", "file_path": "files/2022_10/1639", "file_language": "php", "file_name": "app/tools/user-menu/user-widgets-set.php", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 1}, {"raw_url": "https://github.com/phpipam/phpipam/raw/552fbb0fc7ecb84bda4a131b4f290a3de9980040/misc%2FCHANGELOG", "code": "== 1.4\n\n    New features:\n    ------------\n    + Configurable password policy;\n    + Sessions can be now stored in database (#516);\n    + Two-factor authenticaiton - otp (Google Authenticator);\n    + Customers module (#694);\n    + Search for free subnet inside whole section;\n\n    Enhancements, changes:\n    ----------------------------\n    + Circuits enhancements (Virtual Circuits);\n    + Dropped support for 32bit systems;\n    + PHP 5.4 is now required;\n    + Added comressed actions dropdown;\n    + Rack module enhancements (#1325):\n        + Dynamic rack sizes;\n        + Top-down / Bottom-up racks;\n        + Custom rack devices independant of devices (power, patchpanel);\n    + Customized user permissions for modules:\n        + VLAN module;\n        + VRF module;\n        + PowerDNS module;\n        + Circuits module;\n        + Customers module;\n        + Devices module;\n        + Rack module;\n        + NAT module;\n        + PSTN module;\n        + Locations module;\n    + API:\n        + New API security type - SSL with app code (static app code);\n        + New config.php option $api_allow_unsafe to allow non-SSL API queries;\n        + Added last access field to api;\n        + Add Mac Search for Addresses controller (#2005);\n\n    Bugfixes:\n    ----------------------------\n    + Fix appended \" U\" in Rack description (#2046);\n    + Fix Bandwidth calculator - 400 Bad Request. (#1807);\n    + Fix bad DNS reverse zone for /23 subnet (#666);\n    + Fix Add missing standard field (#2153);\n    + Fix Consistency of VARCHAR Size on 'owner' column across tables (#2136);\n    + API:\n        + Fix inconsistant API success value returned (#2045);\n\n    Security Fixes:\n    ----------------------------\n    + Hide SNMP community (#2197);\n    + Hide LDAP/AD/Radius username / password and secret from logs and syslog (#2006);\n    + XSS in phpipamredirect cookie (#2338);\n    + XSS in print-user.php, CSRF in user-edit.php (#2326);\n\n== 1.3.2\n\n    Enhancements, changes:\n    ----------------------------\n    + Dark theme added;\n    + Full php7.2 compatibility;\n    + url_rewrite has changed, please use new rewrite scheme (https://phpipam.net/news/new_rewrite_scheme/);\n    + Search for matching subnet in all VRFs feature enabled when importing addresses;\n    + Added new config option to show custom fields separated from standard fields when editing IP address;\n    + Added Required fields subpage to define IP address fields that must be filled in;\n    + Performance + bug fixes (#1660, #1657);\n    + MasterSubnet dropdown list is dynamically generated via AJAX call;\n    + Bandwidth calculator;\n    + Support 8U rack sizes. (#1891);\n    + API:\n        + New last_subnet API calls (#1655);\n\n    Translations:\n    ----------------------------\n    + German translation updated to verson 1.3.1;\n    + French translations updated. (#1881);\n\n    Bugfixes:\n    ----------------------------\n    + Fixed uncaught error if vlan number exceeds max permitted (#1455);\n    + Fixed Illegal string offset 'dns_name' in pingCheck.php errors (#1461);\n    + Performance fix for subnet_dropdown_print_available (#1562);\n    + Fixed logo updater for apache v2.4 (#1582);\n    + Fixed section names containing spaces are not included in exports (#1566);\n    + Allow DNS wildcard records (#1571);\n    + Fixed slow mac address vendor decoding for subnet detail view (#1658);\n    + Performance fix for detecting overlapping subnets. (#1052, #1426, #1533);\n    + Performance fix for slow mac address vendor decoding (#1658);\n    + Performance fix for subnet API first_subnet & all_subnets calls;\n    + Performance fix for delegating subnet permissions;\n    + Convert to UTF-8 encoding on import/export to preserve dialectics (#1659, #1700, #1728);\n    + Importing IPs loose Mac Addresses (#1607);\n    + Section names containing spaces are not included in exports. (#1566);\n    + Bug with section and dashboard (#1593);\n    + Fixed improper contents in plain text part of notification e-mails (#1707);\n    + Reduce size of email notifications (#1643);\n    + PHP 5.3 compatibility fixes (#1594, #1730);\n    + PHP 7.2 compatibility fixes (#1683, #1714);\n    + Fixed notification e-mails contain a broken link. (#1708);\n    + Allow dots to be used in domain names. (#1747);\n    + Use multi-byte compatible functions when shortening text. (#1753);\n    + Scan subnet reports/selects invalid php path. (#1757);\n    + Small code refactoring (#1699);\n    + Rack device start position overwritten. (#1545);\n    + Sections with folders returns no subnets using API. (#1883);\n    + Add custom_ prefix to Prefix controller custom fields. (#1836);\n    + Non-Admins missing the button to Add circuit. (#1902);\n    + Wrong field name of deviceTypes table when checking device type. (#1910);\n    + SNMPv3 improvements;\n    + Misc IPv6 fixes;\n\n    Security Fixes:\n    ----------------------------\n    + Code injection in Name field. (#1667);\n    + XSS (reflected) in SubnetID param. (#1702);\n    + CSRF enables open mail relay. (#1703);\n    + Reflected XSS requiring user interaction on search. (#1705);\n    + XSS reflected via CSRF in preview.php. (#1706);\n    + Reflected XSS via CSV upload. (#1742);\n    + Reflected XSS on 'mac' parameter. (#1903);\n\n== 1.3.1\n\n    New features:\n    ------------\n    + Circuits module (circuits, providers, map, ...) (#731);\n\n    Enhancements, changes:\n    ----------------------------\n    + Racks:\n        + Automatic location assignment when device added to rack (#1230);\n        + Rack map showing map of all racks in location;\n        + Rack back side;\n    + Compact menu layout (per-user setting, showing only icons);\n    + Network to network static nat;\n    + Selectable logo size (from config.php) (#952);\n    + Added default option for permissions propagations (#1351);\n    + API:\n        + Added Circuits controller;\n        + Encrypyted requests can now also be form-encoded (#1191);\n        + Introduce mcrypt AES compatibility (#1516);\n        + Fixed field ip not displayed when filters applied (#1529);\n    + New resolve hostnames option for subnet (#1222):\n        + Updates hostnames via pingCheck.php script (if parameter set for subnet);\n        + Updates hostnames via resolveIPaddresses.php script (if parameter set for subnet);\n        + On-the-fly empty hostname update if resolved (if parameter set for subnet and enabled globally);\n        + Added this infor to tools > scanned networks;\n    + Added custom_ prefix to custom field names to avoid duplication with custom fields (#1387);\n    + Added option to hide IP requests for unauthenticated users on login page (#1394);\n    + Performance optimizations for locations and subnet usage calculation;\n    + Added user groups custom fields;\n\n    Translations:\n    ----------------------------\n    + French translation updated to verson 1.3;\n    + German translation updated to verson 1.3;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed RACK images not displayed if not root location (#1204);\n    + Fixed import gateway ip (#1240);\n    + Fixed JSON_UNESCAPED_UNICODE for PHP 5.3 (#1135, #1245);\n    + Rename class Thread to PingThread to avoid naming conflict with pthreads Thread class (#1254);\n    + Fixed custom fields integer on subnet (#1266);\n    + Fixed Import Ip-adress doesnt update location (#1284);\n    + Fixed json_error for logo upload (#1256);\n    + Fixed CSRF error when moving orphaned addresses (#1303);\n    + Fixed VRF fetching via API by Id;\n    + Fixed map issues when quotes are in name/description (#1384);\n    + Fixed item not removed from NAT when deleted (#1378);\n    + Fixed Error when error_reporting = E_ALL about strict standards when importing IP addresses (#1372);\n    + Fixed Apostrophe errors in text custom fields (#1375);\n    + Fixed API error when creating address under folder (#1507);\n    + Fixed SNMPv3 (#1119);\n\n    Security Fixes:\n    ----------------------------\n    + Fixed XSS issues (#1403, #1521, #1500);\n\n== 1.3\n\n    New features:\n    ------------\n    + Multicast module (RFC1112, RFC2464) with IP to MAC mapping and multicast networks overview;\n    + Threshold module for subnets;\n    + Racks module (Rack drawing) for devices;\n    + Address linking by selected field;\n    + Custom logo for site and mails;\n    + PSTN number management module;\n    + SNMP module:\n        + Subnets discovery from route table (all subnets, nested subnets, add new subnet);\n        + Hosts discovery scans via ARP check/interface check;\n        + Hosts discovery scans via ARP + MAC address check (detects interface);\n        + VLAN discovery;\n        + VRF discovery;\n        + Status update scans via ARP check;\n    + NAT module\n        + Source / static / destination NAT;\n        + Linking subnet to NAT\n        + Show bindings under tools and next to IP address / subnet\n    + Locations module\n        + Map devices / racks / subnets to location;\n        + Google maps integration;\n    + SAML2 authentication (SSO)\n\n    Enhancements, changes:\n    ----------------------------\n    + Folders can now contain addresses;\n    + API:\n        - Api v1 removed;\n        + If subnet gateway defined gatewayId is returned in subnet details;\n        + Automatically added nameservers to subnet results;\n        + Added subnet usage result for each subnet in section;\n        + Added custom fields for all controllers;\n        + New subnets automatically get parent permissions;\n        + Added IP calculation to subnet;\n        + Changed all not_found when searching objects to 404 and all invalid parameters to 409 (conflict);\n        + If new item is created id will be available in response field \u201cid\u201d;\n        + New parameter $time_response in api/index.php that will return execution time in field \u201ctime\";\n        + Extensive first_free subnet calls search speedup;\n        + POST transaction locking;\n        + All first_free and first_address responses are now \"data\" instead of \"ip\" and \"subnet\" for consistency;\n        + Subnet splitting now copies over custom fields values by default (user custom_fields=no to revert);\n        + Added API option to nest custom_fields to assure correct structure;\n        + Added option to show/hide links in api by default for each app;\n        + Changed API http response codes;\n        + New methods:\n            + users:\n                GET    /user/expires/                         // returns token expiration date\n                GET    /user/token-expires/                   // returns token expiration date\n                GET    /user/users/                           // returns all users (rwa app permissions required)\n                GET    /user/admins/                          // returns all admin users (rwa app permissions required)\n            + addresses:\n                GET    /addresses/first_free/{subnetId}/      // returns first available address (subnetId can be provided with parameters)\n                GET    /addresses/{ip}/{subnetId}/            // returns IP address from subnet\n                GET    /addresses/search/{hostname}/          // Will search addresses by hostname\n                DELETE /addresses/{ip}/{subnetId}/            // deletes IP address from subnet\n                POST   /addresses/first_free/{subnetId}/      // will search for first free address in subnet, creating new address\n            + subnets:\n                GET    /subnets/{id}/addresses/{ip}/          // returns IP address from subnet\n                GET    /subnets/{id}/first_free/              // returns first free address in subnet\n                GET    /subnets/{id}/first_subnet/{mask}/     // returns first available subnets with specified mask\n                GET    /subnets/{id}/all_subnets/{mask}/      // returns all available subnets with specified mask\n                POST   /subnets/{id}/first_subnet/{mask}/     // creates first free subnet under master with specified mask\n                DELETE /subnets/{id}/permissions/             // removes permissions\n                PATCH  /subnets/{id}/permissions/             // sets subnet permissions (?grouname1=ro&groupname2=3&43=1)\n        + New controller Prefix;\n        + New controller Devices;\n        + New subcontrollers:\n            + /tools/nat/\n            + /tools/racks/\n            + /tools/locations/\n    + Widgets:\n        + New threshold widget;\n        + New inactive hosts widget;\n        + New Locations widget;\n    + PowerDNS:\n        + Default domain for PTR records (if hostname is not set);\n        + When removing IP address additional option that removes all associated PDNS records (ip and hostname);\n    + Permit normal users to manage VLANs / VRFs;\n    + Inactive (offline) hosts tools page;\n    + MAC address normalization;\n    + jQuery tables;\n    + Permission delegation now only delegates changes not whole permission set;\n    + Users with RWA permission can manage IP requests and receive IP request mails + changelog mails for subnet;\n    + IPv4 subnet link to IPv6 for dual-stack info;\n    + Removed inacessible DNS servers if timeout to prevent page load timeouts;\n    + Added option to only show supernets to limit pageload [#844 #816 #736];\n    + Added last scan info to subnet details;\n    + Added option to update address tags when address state change occurs (pingCheck) [#840];\n    + Added mantaneance mode;\n    + Added inactive addresses removal script;\n    + Subnet overlapping now checked also inside folders to prevernt duplicates;\n    + Subnet overlapping now checked also between sections if VRF defined;\n    + Added new settings directive that requires unique subnets accross sections;\n    + Added index check in verify database to detect and fix possible missing DB indexes;\n    + Added MAC address vendor display option;\n\n    Bugfixes:\n    ----------------------------\n    + PowerDNS regenerate PTR records now only updates current subnet (before whole zone);\n    + Fixed visual bug on 32-bit systems;\n    + Normal users with RWA permissions can scan subnets;\n    + Changed default timestamp from 0000-00-00 00:00:00 to 1970-01-01 00:00:01 to avoid SQL install errors if strict mode;\n    + Fixed https access on non-standard ports;\n    + Extended username to 255 chars for LDAP logins;\n    + Fixed search export invalid encoding and data may have been lost XLS file error;\n    + Fixed invalid character encoding in API responses;\n    + PowerDNS records cannot be created on slave zone;\n    + Fixed subnet resizing bug if subnet contained slaves;\n    + Added separate CSRF cookies for each address/subnet/pstn object;\n    + Deleted items are now shown and searchable from changelog;\n\n== 1.20.1\n\n    Translations:\n    ----------------------------\n    + French translation updated to verson 1.2;\n    + German translation updated to verson 1.2;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed upgrade bug that selected invalid auth method for AD/LDAP users;\n    + Fixed LDAP problems after 1.2 upgrade;\n    + Fixed PowerDNS Slave with multiple masters delimiter error;\n    + Fixed PowerDNS PTR records not being updated automatically;\n    + Fixed csrf cookie bug when editing folder;\n    + Fixed csrf cookie bug when truncationg subnet;\n    + Fixed invalid code for API crypt method;\n    + Fixed strange headings font display in Firefox;\n    + Fixed invalid proxy settings in config.dist.php;\n    + Fixed search same hostnames in db link form address table;\n    + Fixed import subnet bug caused by fw object;\n    + Fixed Subnet Import (Preview button > no action);\n\n== 1.20\n\n    New features:\n    ------------\n    + Added multiple simultaneous authentication methods (Apache, AD, LDAP, Radius, NetIQ);\n    + Added fping scanning support;\n    + Added selectable scanning type (ping/pear/fping);\n    + Added L2 domains;\n    + Added option to define address as default GW for subnet;\n    + Added customizable address tags with compressed option;\n    + Added temporary subnet / address shares;\n    + Added quick subnet masks;\n    + Added nameserver sets per subnets (jonashauge);\n    + Added optional syslog as log location;\n    + REST API:\n        + documentation: http://phpipam.net/api-documentation/\n        + API v2, old v1 support added\n        + Complete rewrite of all API calls;\n        + New security models (crypt, ssl, none);\n        + Support for custom fields;\n        + JSON / XML output\n        + Full read/write controllers (Sections, Subnets/Folders, Addresses, Vlans, Vrfs);\n    + PowerDNS integration:\n        + Automatic reverse records creation (PTR) - IPv4 and IPv6;\n        + Automatic SOA, NS record creation;\n        + DNS domain management;\n    + Added Scan agents to scan subnets remotely;\n    + Added firewall zone mappings and module;\n    + Added per-subnet DNS resolvers;\n    + Added option to mark subnet as utilized (full);\n\n    Enhancements:\n    ----------------------------\n    + All tables are now InnoDB by default;\n    + Upgraded jQuery to 2.1.3;\n    + All functions rewritten to classes/methods;\n    + Parametized all SQL queries, moved from MySQLI to PDO;\n    + Added VLAN/VRF to search and to search results export;\n    + Redesigned admin and tools menu;\n    + Added scanned/discovered subnets to tools for faster overview;\n    + Per-user display settings;\n    + New widget - tools shortcuts;\n    + New widget - IP calculator;\n    + New widget - request IP address;\n    + Clickable links for subnet fields;\n    + Custom VRF fields;\n    + Subnets can be now linked to devices;\n    + Import/export enhancements;\n    + Fast user switching for admins to impersonate user;\n    + Opened folders and subnets in tree menu are saved on page reload;\n    + RWA users can now process IP requests;\n    + Added auto-suggest for possible slave subnets;\n    + SSL option for MySQL connections;\n    + Enum custom field support;\n    + Added password reset script;\n    + Set sections to display VRF in;\n\n    Security Fixes:\n    ----------------------------\n    + Parametized all MySQL querries;\n    + Fixed plainpass being logged on user update;\n    + Fixed XSS exploit on /error/;\n    + Added CSRF protection to forms;\n\n    Translations:\n    ----------------------------\n    + Added Czech translation;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed bug with SSL/TLS smtp servers;\n    + Fixed visual subnet display issues on 32bit systems;\n    + Fixed IPv6 split subnets bug;\n    + Fixed /31 ping bug scanning out of boundaries;\n    + Fixed nested broadcast not counted to used percentage;\n    + Fixed invalid redirect after timeout;\n    + Fixed discovery script index overridden;\n    + Fixed dashboard graphs links to subnets;\n    + Fixed Invalid ID on subnet scan of large subnets;\n\n== 1.1.010\n\n    Bugfixes:\n    ----------------------------\n    + Fixed login fails with LDAP when escape characters are in password;\n    + Fixed login not working with spaces in password for AD login;\n    + Fixed Ivalid action when adding vlans from subnet popup menu;\n    + Fixed custom fields not appearing properly on IP request editing;\n    + Fixed Invalid ID error for IP address details on sorting;\n    + Fixed warnings if no VLAN search results are present;\n    + Fixed test mail not sending;\n    + Fixed unable to login if $phpsessname not defined;\n    + Fixed unable to login after upgrade;\n\n== 1.1\n\n    Enhancements:\n    ----------------------------\n    + Caching of SQL results to avoid multiple queries;\n    + Reduced number of DB queries;\n    + Added selected mail notifications to admins to be notified on IP/subnet change;\n    + Added new subnetId index to ipaddresses table that significantly improves network loading;\n    + Now using only 1 network connection towards MySQL server;\n    + Updated pagination;\n    + mod_rewrite no longer required, selectable URL structure under settings;\n    + Added option not to display free ranges;\n    + Added option to set maximum VLAN number;\n    + Selectable custom fields to be visible/hidden in tables view and updated device/VLAN view;\n    + Added additional confirmation before section, subnet, folder and IP address deletion;\n    + New script added for cron checks that discovers new hosts for selected networks;\n    + Added inactivity timeout to settings;\n    + Changed install procedure and updated install scripts;\n    + Added PEAR check for installation;\n    + Added free range disaply for VLANs;\n    + Addes SSL/TLS option for SMTP mail;\n    + API:\n        + Bugfixes;\n        + Added API admin permissions;\n        + read/delete actions for IP addresses;\n        + read/delete actions for Vlans;\n        + read/delete actions for VRFs;\n\n    Security Fixes:\n    ----------------------------\n    + Fixed known command injection vulnerabilities in the scan functions;\n    + Fixed known SQL injection vulnerabilities;\n    + Fixed known XSS vulnerabilities;\n    + Fixed known action XSS events;\n    + Moved to crypt method for storing password in database with salting;\n    + Added option to force user to change pass after first login;\n    + Admin password must be changed after installation;\n    + Added captcha code request after 5x unsuccesfull login to prevent brute-force attacks;\n\n    Translations:\n    ----------------------------\n    + Added es_ES translation;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed top 10 widgets not escaping strings;\n    + Fixed section parent can be set to self that caused section to disapear;\n    + Fixed username instead of password being sent to smtp server;\n    + Fixed IE search bug with workaround;\n    + Fixed subnet and bcast not showing on strict mode disabled;\n    + Fixed top subnets missing on dashboard for non-admin users;\n    + Fixed bug when installation was silently failing bacause pf missing _() function (missing gettext extension)\n    + Fixed device custom field not populated on adding device;\n    + Fixed XLS export silently failed when description longer than 31 characters;\n    + Fixed overlapping check not working;\n    + Fixed subnet free space calcultation;\n    + Fixed visual subnet display not showing on /31 and /32 networks;\n    + Fixed custom fields display on folder edit;\n    + Fixed unable to edit IP addresses when fields are sorted;\n    + Fixde ordering of custom fields defaults to varchar 256;\n    + Fixed IPv6 subnet / broadcast calculation bug and next subnet suggestion;\n\n== 1.0\n\n    New features:\n    ----------------------------\n    + IP address page with IP address details and IP history (Changelog);\n    + IP address changelog, subnet and section changelogs with full changelog under tools;\n    + Favourite subnets for quick access;\n    + Adding subnets from free space with automatic mask provided;\n    + Automatic database validity check after upgrading and automatic field/table fix under administration;\n    + Automatic weekly check for new phpipam version;\n\n    Enhancements:\n    ----------------------------\n    + Bootstrap 3;\n    + UI enhancements;\n    + Improved views based on browser width;\n    + Widget order can now be set;\n    + Widgets can be reordered (dragged) directly on dashboard;\n    + Subnet can now be splitted to max 256 new subnets (16 before);\n    + Scan settings are moved to Administration;\n    + Widget management has moved to administration, which allows creation of new widgets;\n    + Improved ICMP error detection;\n    + Mail settings can now be set on gui (localhost / smtp);\n    + Popup windows are now draggable;\n    + VLAN adding in the fly enhancements;\n    + Master section now shows all subnets in subsections;\n    + Tools > devices redone;\n    + DeviceTypes can now be edited/set/added;\n    + Ping subnet enhancements;\n    + Custom field types are now defineable (int/varchar/date/datetime/text/bool/set);\n    + Date and timepicker popups if type = date/datetime;\n    + For `set` and boolean custom fields dropdown is presented that users can pick;\n\n    + Favourite subnets widget;\n    + IP requests widget;\n    + Changelog widget;\n\n    Translations:\n    ----------------------------\n    + Added Brazil translation (Michel Braga Guimar\u00e3es);\n\n    Bugfixes:\n    --------\n    + UI fixes;\n    + Fixed bug where last page of IP addresses was inaccessible;\n    + IP address state change is now sent to all admins;\n    + Fixed subnet displaying as 0.0.0.0/0 in details;\n    + Fixed links to subnets form vlans and vrfs;\n    + Fixed search result showing all folders if searched item is not IP address;\n    + Fixed disapearing section when L2 section was selected as master section;\n    + Fixed device ID showing in mail notification instead of hostname;\n    + Fixed device ID showing in search results and export instead of hostname;\n    + Fixed search for subnet name returned no results;\n    + Fixed apostophe in IP address description throws SQL error for scan results and XLS import;\n    + Fixed requester email gets cut if longer than 32 chars;\n    + Fixed admin folder edit appearing as subnet;\n    + Fixed missing device/port in import;\n    + Fixed master section delete did not delete subsections and belonging subnets/ips;\n    + Fixed online status was not updated when running Ping status scans;\n    + Fixed Folder name not appearing when deleting folder;\n\n== 0.9\n\n    New features:\n    ----------------------------\n    + Support for ICMP network discovery;\n    + Cron script to check status for selected subnets/hosts with threading suport (pcntl php extension required);\n    + ICMP check IP status in demand;\n    + Compressed (grouped) DHCP IP ranges;\n    + API server version 0.1;\n    + Option to show and group subnets by VLAN in subnets list;\n    + Option to show and group subnets by VRF in subnets list;\n    + Added subsections;\n    + Added AD username search;\n    + Added folders;\n\n    Enhancements:\n    ----------------------------\n    + Added error catching/displaying for ajax-loaded php scripts;\n    + Added default language for login/requests display and new users;\n    + Added direct links to different pages in IP address table;\n    + Subnets can now be edited directly from nested subnets list;\n    + When adding nested subnets default vlan/vrf is selected from parent;\n    + Added Section ordering;\n    + Added per/section subnet ordering (overrides dafault form settings);\n    + Clicking on section now shows all subnets and belonging details;\n    + If session timeouts after re-login last requested page will be opened;\n    + Searh for IP address now returns also subnet, even if IP is not existing;\n    + Per-user selection of widgets to display;\n    + Added description and required field checkbox for custom IP/Subnet Fields;\n    + Added custom device fields;\n    + Mails are now sent through phpmailer;\n    + Admin user cannot be deleted;\n\n    Translations:\n    ----------------------------\n    + Added French translation (Denis Darr\u00e9);\n    + Added Dutch translation (Michiel Visser);\n    + Added German translation (Carsten Br\u00fcckner);\n\n    Bugfixes:\n    ----------------------------\n    + Fixed wrong VLAN display in tools;\n    + Fixed subnet/section links from VLANS if base not /;\n    + Fixed warning in apache log on subnet editing if no VRFs are configured;\n    + Fixed admin menu off-screen overflow;\n    + Fixed firefox error when selectiong rights for section/subnets was not possible;\n    + Fixed subnet description in Cyrillic problem;\n    + Fixed errors on no permissions for user;\n    + Fixed Inaccurate Free Space Calculation (and Chart);\n    + Fixed VLAN permissions where VLAN was not displayed;\n\n== 0.8\n\n    New features:\n    ----------------------------\n    + New group and permission management;\n    + Support for translations;\n    + Subnet resizing;\n    + Subnet splitting into smaller subnets;\n    + Added free space display for nested subnets;\n    + Added visual display of subnet usage per IP address;\n    + Added truncate network option that deletes all IP addresses in subnet;\n    + Added button the updates subnet with RIPE information;\n\n    Enhancements:\n    ----------------------------\n    + Added add nested subnet under subnet details to simplify master subnet selection in hierarchy;\n    + Added edit subnet link from search results;\n    + Added reverse IPv6 DNS entries to IPCalc (Vincent Boisard);\n    + Added option for plain-text emails;\n    + Added ckEditor to write instructions;\n    + StrictMode is not set globally anymore but set per section;\n    + Added custom user fields;\n    + Added option to verify that hostname is unique;\n    + Improved MySQL exception handling;\n    + Added mod_rewrite error detection on installation and upgrade;\n    + Added hostname validation;\n    + Added Hostfile dump of IP addresses;\n    + Search also searches in custom fields;\n    + jQuery updated to v 1.9.1;\n\n    Bugfixes:\n    ------------------------\n    + Fixed overlay on second popup;\n    + Fixed IE search bug;\n    + Fixed support for non-standard ports;\n    + Fixed permitting overlapping subnets if vrfs are different;\n    + Fixed dates in logging appearing in 12h format;\n    + Fixed broken subnets link in tools > subnets if installation is not at document root;\n    + Fixed error when adding new subnet if checkboxes are not selected in newer MySQL servers;\n    + Fixed bad display of multilined navigation bar;\n    + Fixed wrong output of tools > VLAN list when using Duplicate VLANs;\n    + Fixed wrong link for upgrade script;\n    + On VRF change all child subnets are updated also;\n    + Fixed wrong maximum on dashboard top10 percentage;\n    + Fixed Adding a vlan while editing a subnet resets the edit subnet form;\n    + Fixed wrong free space calculation for nested subnets;\n    + Fixed IP use statistics not cumulative up the hierarchy if subnes has slaves;\n\n== 0.7\n\n    New features:\n    ----------------------------\n    + Completely rewritten UI using twitter's bootstrap as base;\n    + Using mod_rewrite apache module to handle GET requests (new install requitements!);\n    + Unlimited number of subnetting levels;\n    + OpenLDAP authentication support;\n    + New URL structure;\n    + Sorting of IP addresses;\n    + Custom subnet fields;\n    + Custom VLAN fields and admin option to allow duplicate VLAN names (metro area VLANs);\n    + Script to automatically update IP <-> hostname, run via cron (functions/scripts/resolveIPaddresses.php);\n    + Show Subnet name instead of subnet IP address option;\n    + Strict mode option in config files that controlls overlapping checks;\n    + New subnet menu;\n    + Added printLimit feature to break IP addresses into pages;\n\n    Enhancements:\n    ----------------------------\n    + Lots of UI changes;\n    + Less Ajax usage to display websites and details;\n    + Hierarchy display under subnet details (breadcrumbs);\n    + Search results covering VLANs;\n    + Custom IP fields ordering;\n    + VLAN creation from adding/editing subnets;\n    + IP addresses can now be edited;\n    + Collapsed switch list;\n    + Removing VLANs also removes references from subnet list;\n    + Removing VRFs also removes references from subnet list;\n    + Logs for admin on dashboard;\n    + Search via GET;\n    + Support for range networks (allows use of subnet and broadcast as IP);\n    + Import of custom IP fields;\n    + Abiility to move subnets between sections;\n    + Improved display of nested subnets now shows all IP addresses from nested subnets and orphaned IPs;\n    + Hides display of custom fields in subnet if none is filled in whole subnet;\n    + Replaced Highcharts with Flot because of licencing issues;\n\n    Bugfixes:\n    ------------------------\n    + Fixed error with missing custom IP fields when adding new IP address;\n    + Fixed bug when deleteing root subnet only deleted directly nested subnets (now whole tree);\n    + Fixed checkboxes not working in various browsers;\n    + Fixed change in switch details causing IP address associations to switch to be lost;\n    + Fixed subnet description display in under subnet administration;\n    + Fixed depricated error when showing XLS files;\n    + Fixed error when custom fields were not updated on adding IP address;\n    + Fixed error when custom fields were with spaces in name were not updated;\n    + Fixed error when providing already requested IP address;\n    + Search available also to viewer user types;\n    + Fixed /127 and /128 IPv6 subnets;\n    + Fixed /31 and /32 IPv4 subnets;\n    + Significally reduced php processing for dashboard statistics;\n    + Fixed importing of if quote is present;\n\n== 0.6\n\n    New features:\n    ----------------------------\n    + Selectable IP address list display fields;\n    + Custom IP address fields;\n    + Search and replace IP fields function;\n    + Full page width theme;\n\n    Enhancements:\n    ----------------------------\n    + Independant VLAN management;\n    + Added additional level of subnet nesting;\n    + Added option to clear and export log files;\n    + Export of search results to XLS;\n    + Clickable search results;\n    + Selectable export fields when exporting subnet;\n    + Subnet can be deleted from ip address edit subnet;\n    + IP Requests for locked subnets and viewer users can be placed from ip address list;\n    + jQuery updated to v 1.7.1;\n    + HighCharts updated to v 2.2.0;\n\n    Bugfixes:\n    ------------------------\n    + Upgrade is supported only for versions 0.4 and higher;\n    + Fixed broken UTF-8 support;\n    + Fixed wrong logging when authenticating via AD;\n    + Fixed issues where external attacker might get information about internal hosts through resolvedns script;\n    + Fixed wrong subnet nesting under administration/manage subnets;\n    + Fixed editing subnet can be outside of its own root subnet;\n    + Fixed errors when adding new switch auto-adds itselt to all hosts without no switch defined;\n    + Fixed removing switch not removed in ip address list;\n    + Vlan1 can now be used;\n    + Fixed mail sending settings with missing information;\n    + Fixed errors on adding switch with no sections;\n    + Fixed version check;\n    + Removed masterSubnets from subnets available for IP requests;\n    + Fixed error when non-admin user could not open dashboard;\n    + Added how subnet list switch when list hidden;\n\n== 0.5\n\n    New features:\n    -------------\n    + Importing subnets from RIPE by AS in admin section;\n    + Added switch management and changed switch logic;\n    + Added VRF support;\n    + Added AD domain authentication;\n    + Added MAC address field to ip address;\n    + Added database table and belonging fields check under admin;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + Added DNS resolving when editing/adding IP address;\n    + Added IE compatibility meta tag and IE UI improvements for IE >= 8;\n    + Search returns also subnets and MAC searches;\n    + Added mac address and IP status to XLS import/export scripts;\n    + jQuery update from 1.6.2 to 1.7;\n    + Highcharts update from 2.1.2 to 2.1.8;\n\n    + Fixed dashboard errors if no IPv4/IPv6 subnets configured;\n    + Fixed errors with viewing / modifying IP addresses for Operator users;\n    + Fixed session cookie error on hosts;\n    + Fixed error when saving settings;\n    + Fixed instructions errors when inserting html code;\n    + Fixed first free IP address not displaying in IP request;\n\n\n== 0.4\n\n    New features:\n    -------------\n    + Massive add / edit / delete by specifying IP range (e.g. 10.10.0.1 - 10.10.0.254);\n    + Database upgrade / install from browser -> simplified installation/update procedure;\n    + New usertype viewer - can only view IP address list;\n    + Subnets can now be edited directly from IP address list;\n    + Option to lock subnet for writing to no-admin users;\n    + Device and Host list;\n    + Option to specify which subnet can have IP requests when editing / adding subnet if module is enabled;\n    + Latest version check on admin page;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + Fixed overspanning of multiple sections;\n    + Admin menu and add subnet now shown only to admins;\n    + Fixed VLAN table to show nesting and IP request option and statistics;\n    + Fixed subnet table to show nesting and IP request option;\n    + Subnet Adding shows only master subnets in section not in all sections;\n    + Tooltips and button hovers are now in separate javascript file;\n    + Graphs show only subnets with non-0 ip addresses;\n    + Various code enhancements + improved error handling;\n    + Fixed URL links not updating after few clicks;\n    + If loading slave subnet directly the subnet menu drops down and shows active slave subnet;\n    + Clicking on master shubnet shows all nested subnets and statistics;\n    + Redesigned log table;\n    + Fixed search;\n\n== 0.3\n\n    New features:\n    -------------\n    + Subnet nesting - you can now have master subnet and normal subnets belonging to it;\n    + Server settings are now moved to database and can be set under admin menu (database settings & debugging remain in config.php);\n    + Request IP module on login page with email notification;\n    + Confirm/reject IP address request from admin page with mail notification;\n    + Admin dashboard notification of new requests;\n    + Autocomplete of owner and Switch name from all available when adding/editing IP address;\n    + New settings quick access on button hover;\n    + Option to export each subnet indivudually;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + jQuery update from 1.6 to 1.6.2;\n    + VLANs are now grouped by section;\n    + Direct access to subnet from vlan table;\n    + UI enhancements;\n    + Fixed user editing bug where user update broke password;\n    + Fixed password in new account notification;\n    + Fixed percentage display on Dashboard;\n    + IPv6 calculator /64 limit fixed;\n    + Changed tooltip effect to appear instantly for smoother display;\n    + Login functions are now separate file;\n\n\n== 0.2 (First public version)\n\n    Bugfixes / enhancements:\n    ------------------------\n    + now also works with php 5.2;\n    + fixed empty fields in xls import;\n    + passwords are now stored in md5 hash;\n    + high numbers for free/used IP addresses (mainly IPv6) are now represented in k/m/G values to improve readibility;\n    + fixed log search bug;\n    + cursor not displayed as link on images and non-href links;\n    + same add image on all pages;\n    + fixed IP mail notification apperance;\n    + UI enhancements and bugfixes;\n    + Fixed some javascript bugs;\n    + Minified javascript to make loading faster;\n    + adding new ip address now automatically provides first available IP address in subnet;\n\n    New features:\n    -------------\n    + added switch / port fields to IP addresses;\n    + hide subets on request to get better view;\n    + Informational tooltips added + option to disable them in config file if someone finds them annoying;\n    + export whole IP address database to XLS file from admin menu;\n    + create MySQL database dump from admin menu;\n    + added IP instructions for users, that can be edited from admin menu;\n\n\n== 0.1 (First test version)\n", "code_before": "== 1.4\n\n    New features:\n    ------------\n    + Configurable password policy;\n    + Sessions can be now stored in database (#516);\n    + Two-factor authenticaiton - otp (Google Authenticator);\n    + Customers module (#694);\n    + Search for free subnet inside whole section;\n\n    Enhancements, changes:\n    ----------------------------\n    + Circuits enhancements (Virtual Circuits);\n    + Dropped support for 32bit systems;\n    + PHP 5.4 is now required;\n    + Added comressed actions dropdown;\n    + Rack module enhancements (#1325):\n        + Dynamic rack sizes;\n        + Top-down / Bottom-up racks;\n        + Custom rack devices independant of devices (power, patchpanel);\n    + Customized user permissions for modules:\n        + VLAN module;\n        + VRF module;\n        + PowerDNS module;\n        + Circuits module;\n        + Customers module;\n        + Devices module;\n        + Rack module;\n        + NAT module;\n        + PSTN module;\n        + Locations module;\n    + API:\n        + New API security type - SSL with app code (static app code);\n        + New config.php option $api_allow_unsafe to allow non-SSL API queries;\n        + Added last access field to api;\n        + Add Mac Search for Addresses controller (#2005);\n\n    Bugfixes:\n    ----------------------------\n    + Fix appended \" U\" in Rack description (#2046);\n    + Fix Bandwidth calculator - 400 Bad Request. (#1807);\n    + Fix bad DNS reverse zone for /23 subnet (#666);\n    + Fix Add missing standard field (#2153);\n    + Fix Consistency of VARCHAR Size on 'owner' column across tables (#2136);\n    + API:\n        + Fix inconsistant API success value returned (#2045);\n\n    Security Fixes:\n    ----------------------------\n    + Hide SNMP community (#2197);\n    + Hide LDAP/AD/Radius username / password and secret from logs and syslog (#2006);\n    + XSS in phpipamredirect cookie (#2338);\n\n== 1.3.2\n\n    Enhancements, changes:\n    ----------------------------\n    + Dark theme added;\n    + Full php7.2 compatibility;\n    + url_rewrite has changed, please use new rewrite scheme (https://phpipam.net/news/new_rewrite_scheme/);\n    + Search for matching subnet in all VRFs feature enabled when importing addresses;\n    + Added new config option to show custom fields separated from standard fields when editing IP address;\n    + Added Required fields subpage to define IP address fields that must be filled in;\n    + Performance + bug fixes (#1660, #1657);\n    + MasterSubnet dropdown list is dynamically generated via AJAX call;\n    + Bandwidth calculator;\n    + Support 8U rack sizes. (#1891);\n    + API:\n        + New last_subnet API calls (#1655);\n\n    Translations:\n    ----------------------------\n    + German translation updated to verson 1.3.1;\n    + French translations updated. (#1881);\n\n    Bugfixes:\n    ----------------------------\n    + Fixed uncaught error if vlan number exceeds max permitted (#1455);\n    + Fixed Illegal string offset 'dns_name' in pingCheck.php errors (#1461);\n    + Performance fix for subnet_dropdown_print_available (#1562);\n    + Fixed logo updater for apache v2.4 (#1582);\n    + Fixed section names containing spaces are not included in exports (#1566);\n    + Allow DNS wildcard records (#1571);\n    + Fixed slow mac address vendor decoding for subnet detail view (#1658);\n    + Performance fix for detecting overlapping subnets. (#1052, #1426, #1533);\n    + Performance fix for slow mac address vendor decoding (#1658);\n    + Performance fix for subnet API first_subnet & all_subnets calls;\n    + Performance fix for delegating subnet permissions;\n    + Convert to UTF-8 encoding on import/export to preserve dialectics (#1659, #1700, #1728);\n    + Importing IPs loose Mac Addresses (#1607);\n    + Section names containing spaces are not included in exports. (#1566);\n    + Bug with section and dashboard (#1593);\n    + Fixed improper contents in plain text part of notification e-mails (#1707);\n    + Reduce size of email notifications (#1643);\n    + PHP 5.3 compatibility fixes (#1594, #1730);\n    + PHP 7.2 compatibility fixes (#1683, #1714);\n    + Fixed notification e-mails contain a broken link. (#1708);\n    + Allow dots to be used in domain names. (#1747);\n    + Use multi-byte compatible functions when shortening text. (#1753);\n    + Scan subnet reports/selects invalid php path. (#1757);\n    + Small code refactoring (#1699);\n    + Rack device start position overwritten. (#1545);\n    + Sections with folders returns no subnets using API. (#1883);\n    + Add custom_ prefix to Prefix controller custom fields. (#1836);\n    + Non-Admins missing the button to Add circuit. (#1902);\n    + Wrong field name of deviceTypes table when checking device type. (#1910);\n    + SNMPv3 improvements;\n    + Misc IPv6 fixes;\n\n    Security Fixes:\n    ----------------------------\n    + Code injection in Name field. (#1667);\n    + XSS (reflected) in SubnetID param. (#1702);\n    + CSRF enables open mail relay. (#1703);\n    + Reflected XSS requiring user interaction on search. (#1705);\n    + XSS reflected via CSRF in preview.php. (#1706);\n    + Reflected XSS via CSV upload. (#1742);\n    + Reflected XSS on 'mac' parameter. (#1903);\n\n== 1.3.1\n\n    New features:\n    ------------\n    + Circuits module (circuits, providers, map, ...) (#731);\n\n    Enhancements, changes:\n    ----------------------------\n    + Racks:\n        + Automatic location assignment when device added to rack (#1230);\n        + Rack map showing map of all racks in location;\n        + Rack back side;\n    + Compact menu layout (per-user setting, showing only icons);\n    + Network to network static nat;\n    + Selectable logo size (from config.php) (#952);\n    + Added default option for permissions propagations (#1351);\n    + API:\n        + Added Circuits controller;\n        + Encrypyted requests can now also be form-encoded (#1191);\n        + Introduce mcrypt AES compatibility (#1516);\n        + Fixed field ip not displayed when filters applied (#1529);\n    + New resolve hostnames option for subnet (#1222):\n        + Updates hostnames via pingCheck.php script (if parameter set for subnet);\n        + Updates hostnames via resolveIPaddresses.php script (if parameter set for subnet);\n        + On-the-fly empty hostname update if resolved (if parameter set for subnet and enabled globally);\n        + Added this infor to tools > scanned networks;\n    + Added custom_ prefix to custom field names to avoid duplication with custom fields (#1387);\n    + Added option to hide IP requests for unauthenticated users on login page (#1394);\n    + Performance optimizations for locations and subnet usage calculation;\n    + Added user groups custom fields;\n\n    Translations:\n    ----------------------------\n    + French translation updated to verson 1.3;\n    + German translation updated to verson 1.3;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed RACK images not displayed if not root location (#1204);\n    + Fixed import gateway ip (#1240);\n    + Fixed JSON_UNESCAPED_UNICODE for PHP 5.3 (#1135, #1245);\n    + Rename class Thread to PingThread to avoid naming conflict with pthreads Thread class (#1254);\n    + Fixed custom fields integer on subnet (#1266);\n    + Fixed Import Ip-adress doesnt update location (#1284);\n    + Fixed json_error for logo upload (#1256);\n    + Fixed CSRF error when moving orphaned addresses (#1303);\n    + Fixed VRF fetching via API by Id;\n    + Fixed map issues when quotes are in name/description (#1384);\n    + Fixed item not removed from NAT when deleted (#1378);\n    + Fixed Error when error_reporting = E_ALL about strict standards when importing IP addresses (#1372);\n    + Fixed Apostrophe errors in text custom fields (#1375);\n    + Fixed API error when creating address under folder (#1507);\n    + Fixed SNMPv3 (#1119);\n\n    Security Fixes:\n    ----------------------------\n    + Fixed XSS issues (#1403, #1521, #1500);\n\n== 1.3\n\n    New features:\n    ------------\n    + Multicast module (RFC1112, RFC2464) with IP to MAC mapping and multicast networks overview;\n    + Threshold module for subnets;\n    + Racks module (Rack drawing) for devices;\n    + Address linking by selected field;\n    + Custom logo for site and mails;\n    + PSTN number management module;\n    + SNMP module:\n        + Subnets discovery from route table (all subnets, nested subnets, add new subnet);\n        + Hosts discovery scans via ARP check/interface check;\n        + Hosts discovery scans via ARP + MAC address check (detects interface);\n        + VLAN discovery;\n        + VRF discovery;\n        + Status update scans via ARP check;\n    + NAT module\n        + Source / static / destination NAT;\n        + Linking subnet to NAT\n        + Show bindings under tools and next to IP address / subnet\n    + Locations module\n        + Map devices / racks / subnets to location;\n        + Google maps integration;\n    + SAML2 authentication (SSO)\n\n    Enhancements, changes:\n    ----------------------------\n    + Folders can now contain addresses;\n    + API:\n        - Api v1 removed;\n        + If subnet gateway defined gatewayId is returned in subnet details;\n        + Automatically added nameservers to subnet results;\n        + Added subnet usage result for each subnet in section;\n        + Added custom fields for all controllers;\n        + New subnets automatically get parent permissions;\n        + Added IP calculation to subnet;\n        + Changed all not_found when searching objects to 404 and all invalid parameters to 409 (conflict);\n        + If new item is created id will be available in response field \u201cid\u201d;\n        + New parameter $time_response in api/index.php that will return execution time in field \u201ctime\";\n        + Extensive first_free subnet calls search speedup;\n        + POST transaction locking;\n        + All first_free and first_address responses are now \"data\" instead of \"ip\" and \"subnet\" for consistency;\n        + Subnet splitting now copies over custom fields values by default (user custom_fields=no to revert);\n        + Added API option to nest custom_fields to assure correct structure;\n        + Added option to show/hide links in api by default for each app;\n        + Changed API http response codes;\n        + New methods:\n            + users:\n                GET    /user/expires/                         // returns token expiration date\n                GET    /user/token-expires/                   // returns token expiration date\n                GET    /user/users/                           // returns all users (rwa app permissions required)\n                GET    /user/admins/                          // returns all admin users (rwa app permissions required)\n            + addresses:\n                GET    /addresses/first_free/{subnetId}/      // returns first available address (subnetId can be provided with parameters)\n                GET    /addresses/{ip}/{subnetId}/            // returns IP address from subnet\n                GET    /addresses/search/{hostname}/          // Will search addresses by hostname\n                DELETE /addresses/{ip}/{subnetId}/            // deletes IP address from subnet\n                POST   /addresses/first_free/{subnetId}/      // will search for first free address in subnet, creating new address\n            + subnets:\n                GET    /subnets/{id}/addresses/{ip}/          // returns IP address from subnet\n                GET    /subnets/{id}/first_free/              // returns first free address in subnet\n                GET    /subnets/{id}/first_subnet/{mask}/     // returns first available subnets with specified mask\n                GET    /subnets/{id}/all_subnets/{mask}/      // returns all available subnets with specified mask\n                POST   /subnets/{id}/first_subnet/{mask}/     // creates first free subnet under master with specified mask\n                DELETE /subnets/{id}/permissions/             // removes permissions\n                PATCH  /subnets/{id}/permissions/             // sets subnet permissions (?grouname1=ro&groupname2=3&43=1)\n        + New controller Prefix;\n        + New controller Devices;\n        + New subcontrollers:\n            + /tools/nat/\n            + /tools/racks/\n            + /tools/locations/\n    + Widgets:\n        + New threshold widget;\n        + New inactive hosts widget;\n        + New Locations widget;\n    + PowerDNS:\n        + Default domain for PTR records (if hostname is not set);\n        + When removing IP address additional option that removes all associated PDNS records (ip and hostname);\n    + Permit normal users to manage VLANs / VRFs;\n    + Inactive (offline) hosts tools page;\n    + MAC address normalization;\n    + jQuery tables;\n    + Permission delegation now only delegates changes not whole permission set;\n    + Users with RWA permission can manage IP requests and receive IP request mails + changelog mails for subnet;\n    + IPv4 subnet link to IPv6 for dual-stack info;\n    + Removed inacessible DNS servers if timeout to prevent page load timeouts;\n    + Added option to only show supernets to limit pageload [#844 #816 #736];\n    + Added last scan info to subnet details;\n    + Added option to update address tags when address state change occurs (pingCheck) [#840];\n    + Added mantaneance mode;\n    + Added inactive addresses removal script;\n    + Subnet overlapping now checked also inside folders to prevernt duplicates;\n    + Subnet overlapping now checked also between sections if VRF defined;\n    + Added new settings directive that requires unique subnets accross sections;\n    + Added index check in verify database to detect and fix possible missing DB indexes;\n    + Added MAC address vendor display option;\n\n    Bugfixes:\n    ----------------------------\n    + PowerDNS regenerate PTR records now only updates current subnet (before whole zone);\n    + Fixed visual bug on 32-bit systems;\n    + Normal users with RWA permissions can scan subnets;\n    + Changed default timestamp from 0000-00-00 00:00:00 to 1970-01-01 00:00:01 to avoid SQL install errors if strict mode;\n    + Fixed https access on non-standard ports;\n    + Extended username to 255 chars for LDAP logins;\n    + Fixed search export invalid encoding and data may have been lost XLS file error;\n    + Fixed invalid character encoding in API responses;\n    + PowerDNS records cannot be created on slave zone;\n    + Fixed subnet resizing bug if subnet contained slaves;\n    + Added separate CSRF cookies for each address/subnet/pstn object;\n    + Deleted items are now shown and searchable from changelog;\n\n== 1.20.1\n\n    Translations:\n    ----------------------------\n    + French translation updated to verson 1.2;\n    + German translation updated to verson 1.2;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed upgrade bug that selected invalid auth method for AD/LDAP users;\n    + Fixed LDAP problems after 1.2 upgrade;\n    + Fixed PowerDNS Slave with multiple masters delimiter error;\n    + Fixed PowerDNS PTR records not being updated automatically;\n    + Fixed csrf cookie bug when editing folder;\n    + Fixed csrf cookie bug when truncationg subnet;\n    + Fixed invalid code for API crypt method;\n    + Fixed strange headings font display in Firefox;\n    + Fixed invalid proxy settings in config.dist.php;\n    + Fixed search same hostnames in db link form address table;\n    + Fixed import subnet bug caused by fw object;\n    + Fixed Subnet Import (Preview button > no action);\n\n== 1.20\n\n    New features:\n    ------------\n    + Added multiple simultaneous authentication methods (Apache, AD, LDAP, Radius, NetIQ);\n    + Added fping scanning support;\n    + Added selectable scanning type (ping/pear/fping);\n    + Added L2 domains;\n    + Added option to define address as default GW for subnet;\n    + Added customizable address tags with compressed option;\n    + Added temporary subnet / address shares;\n    + Added quick subnet masks;\n    + Added nameserver sets per subnets (jonashauge);\n    + Added optional syslog as log location;\n    + REST API:\n        + documentation: http://phpipam.net/api-documentation/\n        + API v2, old v1 support added\n        + Complete rewrite of all API calls;\n        + New security models (crypt, ssl, none);\n        + Support for custom fields;\n        + JSON / XML output\n        + Full read/write controllers (Sections, Subnets/Folders, Addresses, Vlans, Vrfs);\n    + PowerDNS integration:\n        + Automatic reverse records creation (PTR) - IPv4 and IPv6;\n        + Automatic SOA, NS record creation;\n        + DNS domain management;\n    + Added Scan agents to scan subnets remotely;\n    + Added firewall zone mappings and module;\n    + Added per-subnet DNS resolvers;\n    + Added option to mark subnet as utilized (full);\n\n    Enhancements:\n    ----------------------------\n    + All tables are now InnoDB by default;\n    + Upgraded jQuery to 2.1.3;\n    + All functions rewritten to classes/methods;\n    + Parametized all SQL queries, moved from MySQLI to PDO;\n    + Added VLAN/VRF to search and to search results export;\n    + Redesigned admin and tools menu;\n    + Added scanned/discovered subnets to tools for faster overview;\n    + Per-user display settings;\n    + New widget - tools shortcuts;\n    + New widget - IP calculator;\n    + New widget - request IP address;\n    + Clickable links for subnet fields;\n    + Custom VRF fields;\n    + Subnets can be now linked to devices;\n    + Import/export enhancements;\n    + Fast user switching for admins to impersonate user;\n    + Opened folders and subnets in tree menu are saved on page reload;\n    + RWA users can now process IP requests;\n    + Added auto-suggest for possible slave subnets;\n    + SSL option for MySQL connections;\n    + Enum custom field support;\n    + Added password reset script;\n    + Set sections to display VRF in;\n\n    Security Fixes:\n    ----------------------------\n    + Parametized all MySQL querries;\n    + Fixed plainpass being logged on user update;\n    + Fixed XSS exploit on /error/;\n    + Added CSRF protection to forms;\n\n    Translations:\n    ----------------------------\n    + Added Czech translation;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed bug with SSL/TLS smtp servers;\n    + Fixed visual subnet display issues on 32bit systems;\n    + Fixed IPv6 split subnets bug;\n    + Fixed /31 ping bug scanning out of boundaries;\n    + Fixed nested broadcast not counted to used percentage;\n    + Fixed invalid redirect after timeout;\n    + Fixed discovery script index overridden;\n    + Fixed dashboard graphs links to subnets;\n    + Fixed Invalid ID on subnet scan of large subnets;\n\n== 1.1.010\n\n    Bugfixes:\n    ----------------------------\n    + Fixed login fails with LDAP when escape characters are in password;\n    + Fixed login not working with spaces in password for AD login;\n    + Fixed Ivalid action when adding vlans from subnet popup menu;\n    + Fixed custom fields not appearing properly on IP request editing;\n    + Fixed Invalid ID error for IP address details on sorting;\n    + Fixed warnings if no VLAN search results are present;\n    + Fixed test mail not sending;\n    + Fixed unable to login if $phpsessname not defined;\n    + Fixed unable to login after upgrade;\n\n== 1.1\n\n    Enhancements:\n    ----------------------------\n    + Caching of SQL results to avoid multiple queries;\n    + Reduced number of DB queries;\n    + Added selected mail notifications to admins to be notified on IP/subnet change;\n    + Added new subnetId index to ipaddresses table that significantly improves network loading;\n    + Now using only 1 network connection towards MySQL server;\n    + Updated pagination;\n    + mod_rewrite no longer required, selectable URL structure under settings;\n    + Added option not to display free ranges;\n    + Added option to set maximum VLAN number;\n    + Selectable custom fields to be visible/hidden in tables view and updated device/VLAN view;\n    + Added additional confirmation before section, subnet, folder and IP address deletion;\n    + New script added for cron checks that discovers new hosts for selected networks;\n    + Added inactivity timeout to settings;\n    + Changed install procedure and updated install scripts;\n    + Added PEAR check for installation;\n    + Added free range disaply for VLANs;\n    + Addes SSL/TLS option for SMTP mail;\n    + API:\n        + Bugfixes;\n        + Added API admin permissions;\n        + read/delete actions for IP addresses;\n        + read/delete actions for Vlans;\n        + read/delete actions for VRFs;\n\n    Security Fixes:\n    ----------------------------\n    + Fixed known command injection vulnerabilities in the scan functions;\n    + Fixed known SQL injection vulnerabilities;\n    + Fixed known XSS vulnerabilities;\n    + Fixed known action XSS events;\n    + Moved to crypt method for storing password in database with salting;\n    + Added option to force user to change pass after first login;\n    + Admin password must be changed after installation;\n    + Added captcha code request after 5x unsuccesfull login to prevent brute-force attacks;\n\n    Translations:\n    ----------------------------\n    + Added es_ES translation;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed top 10 widgets not escaping strings;\n    + Fixed section parent can be set to self that caused section to disapear;\n    + Fixed username instead of password being sent to smtp server;\n    + Fixed IE search bug with workaround;\n    + Fixed subnet and bcast not showing on strict mode disabled;\n    + Fixed top subnets missing on dashboard for non-admin users;\n    + Fixed bug when installation was silently failing bacause pf missing _() function (missing gettext extension)\n    + Fixed device custom field not populated on adding device;\n    + Fixed XLS export silently failed when description longer than 31 characters;\n    + Fixed overlapping check not working;\n    + Fixed subnet free space calcultation;\n    + Fixed visual subnet display not showing on /31 and /32 networks;\n    + Fixed custom fields display on folder edit;\n    + Fixed unable to edit IP addresses when fields are sorted;\n    + Fixde ordering of custom fields defaults to varchar 256;\n    + Fixed IPv6 subnet / broadcast calculation bug and next subnet suggestion;\n\n== 1.0\n\n    New features:\n    ----------------------------\n    + IP address page with IP address details and IP history (Changelog);\n    + IP address changelog, subnet and section changelogs with full changelog under tools;\n    + Favourite subnets for quick access;\n    + Adding subnets from free space with automatic mask provided;\n    + Automatic database validity check after upgrading and automatic field/table fix under administration;\n    + Automatic weekly check for new phpipam version;\n\n    Enhancements:\n    ----------------------------\n    + Bootstrap 3;\n    + UI enhancements;\n    + Improved views based on browser width;\n    + Widget order can now be set;\n    + Widgets can be reordered (dragged) directly on dashboard;\n    + Subnet can now be splitted to max 256 new subnets (16 before);\n    + Scan settings are moved to Administration;\n    + Widget management has moved to administration, which allows creation of new widgets;\n    + Improved ICMP error detection;\n    + Mail settings can now be set on gui (localhost / smtp);\n    + Popup windows are now draggable;\n    + VLAN adding in the fly enhancements;\n    + Master section now shows all subnets in subsections;\n    + Tools > devices redone;\n    + DeviceTypes can now be edited/set/added;\n    + Ping subnet enhancements;\n    + Custom field types are now defineable (int/varchar/date/datetime/text/bool/set);\n    + Date and timepicker popups if type = date/datetime;\n    + For `set` and boolean custom fields dropdown is presented that users can pick;\n\n    + Favourite subnets widget;\n    + IP requests widget;\n    + Changelog widget;\n\n    Translations:\n    ----------------------------\n    + Added Brazil translation (Michel Braga Guimar\u00e3es);\n\n    Bugfixes:\n    --------\n    + UI fixes;\n    + Fixed bug where last page of IP addresses was inaccessible;\n    + IP address state change is now sent to all admins;\n    + Fixed subnet displaying as 0.0.0.0/0 in details;\n    + Fixed links to subnets form vlans and vrfs;\n    + Fixed search result showing all folders if searched item is not IP address;\n    + Fixed disapearing section when L2 section was selected as master section;\n    + Fixed device ID showing in mail notification instead of hostname;\n    + Fixed device ID showing in search results and export instead of hostname;\n    + Fixed search for subnet name returned no results;\n    + Fixed apostophe in IP address description throws SQL error for scan results and XLS import;\n    + Fixed requester email gets cut if longer than 32 chars;\n    + Fixed admin folder edit appearing as subnet;\n    + Fixed missing device/port in import;\n    + Fixed master section delete did not delete subsections and belonging subnets/ips;\n    + Fixed online status was not updated when running Ping status scans;\n    + Fixed Folder name not appearing when deleting folder;\n\n== 0.9\n\n    New features:\n    ----------------------------\n    + Support for ICMP network discovery;\n    + Cron script to check status for selected subnets/hosts with threading suport (pcntl php extension required);\n    + ICMP check IP status in demand;\n    + Compressed (grouped) DHCP IP ranges;\n    + API server version 0.1;\n    + Option to show and group subnets by VLAN in subnets list;\n    + Option to show and group subnets by VRF in subnets list;\n    + Added subsections;\n    + Added AD username search;\n    + Added folders;\n\n    Enhancements:\n    ----------------------------\n    + Added error catching/displaying for ajax-loaded php scripts;\n    + Added default language for login/requests display and new users;\n    + Added direct links to different pages in IP address table;\n    + Subnets can now be edited directly from nested subnets list;\n    + When adding nested subnets default vlan/vrf is selected from parent;\n    + Added Section ordering;\n    + Added per/section subnet ordering (overrides dafault form settings);\n    + Clicking on section now shows all subnets and belonging details;\n    + If session timeouts after re-login last requested page will be opened;\n    + Searh for IP address now returns also subnet, even if IP is not existing;\n    + Per-user selection of widgets to display;\n    + Added description and required field checkbox for custom IP/Subnet Fields;\n    + Added custom device fields;\n    + Mails are now sent through phpmailer;\n    + Admin user cannot be deleted;\n\n    Translations:\n    ----------------------------\n    + Added French translation (Denis Darr\u00e9);\n    + Added Dutch translation (Michiel Visser);\n    + Added German translation (Carsten Br\u00fcckner);\n\n    Bugfixes:\n    ----------------------------\n    + Fixed wrong VLAN display in tools;\n    + Fixed subnet/section links from VLANS if base not /;\n    + Fixed warning in apache log on subnet editing if no VRFs are configured;\n    + Fixed admin menu off-screen overflow;\n    + Fixed firefox error when selectiong rights for section/subnets was not possible;\n    + Fixed subnet description in Cyrillic problem;\n    + Fixed errors on no permissions for user;\n    + Fixed Inaccurate Free Space Calculation (and Chart);\n    + Fixed VLAN permissions where VLAN was not displayed;\n\n== 0.8\n\n    New features:\n    ----------------------------\n    + New group and permission management;\n    + Support for translations;\n    + Subnet resizing;\n    + Subnet splitting into smaller subnets;\n    + Added free space display for nested subnets;\n    + Added visual display of subnet usage per IP address;\n    + Added truncate network option that deletes all IP addresses in subnet;\n    + Added button the updates subnet with RIPE information;\n\n    Enhancements:\n    ----------------------------\n    + Added add nested subnet under subnet details to simplify master subnet selection in hierarchy;\n    + Added edit subnet link from search results;\n    + Added reverse IPv6 DNS entries to IPCalc (Vincent Boisard);\n    + Added option for plain-text emails;\n    + Added ckEditor to write instructions;\n    + StrictMode is not set globally anymore but set per section;\n    + Added custom user fields;\n    + Added option to verify that hostname is unique;\n    + Improved MySQL exception handling;\n    + Added mod_rewrite error detection on installation and upgrade;\n    + Added hostname validation;\n    + Added Hostfile dump of IP addresses;\n    + Search also searches in custom fields;\n    + jQuery updated to v 1.9.1;\n\n    Bugfixes:\n    ------------------------\n    + Fixed overlay on second popup;\n    + Fixed IE search bug;\n    + Fixed support for non-standard ports;\n    + Fixed permitting overlapping subnets if vrfs are different;\n    + Fixed dates in logging appearing in 12h format;\n    + Fixed broken subnets link in tools > subnets if installation is not at document root;\n    + Fixed error when adding new subnet if checkboxes are not selected in newer MySQL servers;\n    + Fixed bad display of multilined navigation bar;\n    + Fixed wrong output of tools > VLAN list when using Duplicate VLANs;\n    + Fixed wrong link for upgrade script;\n    + On VRF change all child subnets are updated also;\n    + Fixed wrong maximum on dashboard top10 percentage;\n    + Fixed Adding a vlan while editing a subnet resets the edit subnet form;\n    + Fixed wrong free space calculation for nested subnets;\n    + Fixed IP use statistics not cumulative up the hierarchy if subnes has slaves;\n\n== 0.7\n\n    New features:\n    ----------------------------\n    + Completely rewritten UI using twitter's bootstrap as base;\n    + Using mod_rewrite apache module to handle GET requests (new install requitements!);\n    + Unlimited number of subnetting levels;\n    + OpenLDAP authentication support;\n    + New URL structure;\n    + Sorting of IP addresses;\n    + Custom subnet fields;\n    + Custom VLAN fields and admin option to allow duplicate VLAN names (metro area VLANs);\n    + Script to automatically update IP <-> hostname, run via cron (functions/scripts/resolveIPaddresses.php);\n    + Show Subnet name instead of subnet IP address option;\n    + Strict mode option in config files that controlls overlapping checks;\n    + New subnet menu;\n    + Added printLimit feature to break IP addresses into pages;\n\n    Enhancements:\n    ----------------------------\n    + Lots of UI changes;\n    + Less Ajax usage to display websites and details;\n    + Hierarchy display under subnet details (breadcrumbs);\n    + Search results covering VLANs;\n    + Custom IP fields ordering;\n    + VLAN creation from adding/editing subnets;\n    + IP addresses can now be edited;\n    + Collapsed switch list;\n    + Removing VLANs also removes references from subnet list;\n    + Removing VRFs also removes references from subnet list;\n    + Logs for admin on dashboard;\n    + Search via GET;\n    + Support for range networks (allows use of subnet and broadcast as IP);\n    + Import of custom IP fields;\n    + Abiility to move subnets between sections;\n    + Improved display of nested subnets now shows all IP addresses from nested subnets and orphaned IPs;\n    + Hides display of custom fields in subnet if none is filled in whole subnet;\n    + Replaced Highcharts with Flot because of licencing issues;\n\n    Bugfixes:\n    ------------------------\n    + Fixed error with missing custom IP fields when adding new IP address;\n    + Fixed bug when deleteing root subnet only deleted directly nested subnets (now whole tree);\n    + Fixed checkboxes not working in various browsers;\n    + Fixed change in switch details causing IP address associations to switch to be lost;\n    + Fixed subnet description display in under subnet administration;\n    + Fixed depricated error when showing XLS files;\n    + Fixed error when custom fields were not updated on adding IP address;\n    + Fixed error when custom fields were with spaces in name were not updated;\n    + Fixed error when providing already requested IP address;\n    + Search available also to viewer user types;\n    + Fixed /127 and /128 IPv6 subnets;\n    + Fixed /31 and /32 IPv4 subnets;\n    + Significally reduced php processing for dashboard statistics;\n    + Fixed importing of if quote is present;\n\n== 0.6\n\n    New features:\n    ----------------------------\n    + Selectable IP address list display fields;\n    + Custom IP address fields;\n    + Search and replace IP fields function;\n    + Full page width theme;\n\n    Enhancements:\n    ----------------------------\n    + Independant VLAN management;\n    + Added additional level of subnet nesting;\n    + Added option to clear and export log files;\n    + Export of search results to XLS;\n    + Clickable search results;\n    + Selectable export fields when exporting subnet;\n    + Subnet can be deleted from ip address edit subnet;\n    + IP Requests for locked subnets and viewer users can be placed from ip address list;\n    + jQuery updated to v 1.7.1;\n    + HighCharts updated to v 2.2.0;\n\n    Bugfixes:\n    ------------------------\n    + Upgrade is supported only for versions 0.4 and higher;\n    + Fixed broken UTF-8 support;\n    + Fixed wrong logging when authenticating via AD;\n    + Fixed issues where external attacker might get information about internal hosts through resolvedns script;\n    + Fixed wrong subnet nesting under administration/manage subnets;\n    + Fixed editing subnet can be outside of its own root subnet;\n    + Fixed errors when adding new switch auto-adds itselt to all hosts without no switch defined;\n    + Fixed removing switch not removed in ip address list;\n    + Vlan1 can now be used;\n    + Fixed mail sending settings with missing information;\n    + Fixed errors on adding switch with no sections;\n    + Fixed version check;\n    + Removed masterSubnets from subnets available for IP requests;\n    + Fixed error when non-admin user could not open dashboard;\n    + Added how subnet list switch when list hidden;\n\n== 0.5\n\n    New features:\n    -------------\n    + Importing subnets from RIPE by AS in admin section;\n    + Added switch management and changed switch logic;\n    + Added VRF support;\n    + Added AD domain authentication;\n    + Added MAC address field to ip address;\n    + Added database table and belonging fields check under admin;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + Added DNS resolving when editing/adding IP address;\n    + Added IE compatibility meta tag and IE UI improvements for IE >= 8;\n    + Search returns also subnets and MAC searches;\n    + Added mac address and IP status to XLS import/export scripts;\n    + jQuery update from 1.6.2 to 1.7;\n    + Highcharts update from 2.1.2 to 2.1.8;\n\n    + Fixed dashboard errors if no IPv4/IPv6 subnets configured;\n    + Fixed errors with viewing / modifying IP addresses for Operator users;\n    + Fixed session cookie error on hosts;\n    + Fixed error when saving settings;\n    + Fixed instructions errors when inserting html code;\n    + Fixed first free IP address not displaying in IP request;\n\n\n== 0.4\n\n    New features:\n    -------------\n    + Massive add / edit / delete by specifying IP range (e.g. 10.10.0.1 - 10.10.0.254);\n    + Database upgrade / install from browser -> simplified installation/update procedure;\n    + New usertype viewer - can only view IP address list;\n    + Subnets can now be edited directly from IP address list;\n    + Option to lock subnet for writing to no-admin users;\n    + Device and Host list;\n    + Option to specify which subnet can have IP requests when editing / adding subnet if module is enabled;\n    + Latest version check on admin page;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + Fixed overspanning of multiple sections;\n    + Admin menu and add subnet now shown only to admins;\n    + Fixed VLAN table to show nesting and IP request option and statistics;\n    + Fixed subnet table to show nesting and IP request option;\n    + Subnet Adding shows only master subnets in section not in all sections;\n    + Tooltips and button hovers are now in separate javascript file;\n    + Graphs show only subnets with non-0 ip addresses;\n    + Various code enhancements + improved error handling;\n    + Fixed URL links not updating after few clicks;\n    + If loading slave subnet directly the subnet menu drops down and shows active slave subnet;\n    + Clicking on master shubnet shows all nested subnets and statistics;\n    + Redesigned log table;\n    + Fixed search;\n\n== 0.3\n\n    New features:\n    -------------\n    + Subnet nesting - you can now have master subnet and normal subnets belonging to it;\n    + Server settings are now moved to database and can be set under admin menu (database settings & debugging remain in config.php);\n    + Request IP module on login page with email notification;\n    + Confirm/reject IP address request from admin page with mail notification;\n    + Admin dashboard notification of new requests;\n    + Autocomplete of owner and Switch name from all available when adding/editing IP address;\n    + New settings quick access on button hover;\n    + Option to export each subnet indivudually;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + jQuery update from 1.6 to 1.6.2;\n    + VLANs are now grouped by section;\n    + Direct access to subnet from vlan table;\n    + UI enhancements;\n    + Fixed user editing bug where user update broke password;\n    + Fixed password in new account notification;\n    + Fixed percentage display on Dashboard;\n    + IPv6 calculator /64 limit fixed;\n    + Changed tooltip effect to appear instantly for smoother display;\n    + Login functions are now separate file;\n\n\n== 0.2 (First public version)\n\n    Bugfixes / enhancements:\n    ------------------------\n    + now also works with php 5.2;\n    + fixed empty fields in xls import;\n    + passwords are now stored in md5 hash;\n    + high numbers for free/used IP addresses (mainly IPv6) are now represented in k/m/G values to improve readibility;\n    + fixed log search bug;\n    + cursor not displayed as link on images and non-href links;\n    + same add image on all pages;\n    + fixed IP mail notification apperance;\n    + UI enhancements and bugfixes;\n    + Fixed some javascript bugs;\n    + Minified javascript to make loading faster;\n    + adding new ip address now automatically provides first available IP address in subnet;\n\n    New features:\n    -------------\n    + added switch / port fields to IP addresses;\n    + hide subets on request to get better view;\n    + Informational tooltips added + option to disable them in config file if someone finds them annoying;\n    + export whole IP address database to XLS file from admin menu;\n    + create MySQL database dump from admin menu;\n    + added IP instructions for users, that can be edited from admin menu;\n\n\n== 0.1 (First test version)\n", "patch": "@@ -50,6 +50,7 @@\n     + Hide SNMP community (#2197);\n     + Hide LDAP/AD/Radius username / password and secret from logs and syslog (#2006);\n     + XSS in phpipamredirect cookie (#2338);\n+    + XSS in print-user.php, CSRF in user-edit.php (#2326);\n \n == 1.3.2\n ", "file_path": "files/2022_10/1640", "file_language": "misc/CHANGELOG", "file_name": "misc/CHANGELOG", "outdated_file_modify": 0, "outdated_file_before": 1, "outdated_file_after": 0}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
