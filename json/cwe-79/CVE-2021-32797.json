{"index": 6386, "cve_id": "CVE-2021-32797", "cwe_id": ["CWE-79"], "cve_language": "Python", "cve_description": "JupyterLab is a user interface for Project Jupyter which will eventually replace the classic Jupyter Notebook. In affected versions untrusted notebook can execute code on load. In particular JupyterLab doesn\u2019t sanitize the action attribute of html `<form>`. Using this it is possible to trigger the form validation outside of the form itself. This is a remote code execution, but requires user action to open a notebook.", "cvss": "9.6", "publish_date": "August 9, 2021", "AV": "NETWORK", "AC": "NETWORK", "PR": "NONE", "UI": "REQUIRED", "S": "CHANGED", "C": "HIGH", "I": "HIGH", "A": "HIGH", "commit_id": "504825938c0abfa2fb8ff8d529308830a5ae42ed", "commit_message": "Merge pull request from GHSA-4952-p58q-6crx\n\nRemove `form` tags' `action` attribute during sanitizing.\n\nCo-authored-by: Afshin Taylor Darian <git@darian.af>", "commit_date": "2021-08-05T16:43:20Z", "project": "jupyterlab/jupyterlab", "url": "https://api.github.com/repos/jupyterlab/jupyterlab/commits/504825938c0abfa2fb8ff8d529308830a5ae42ed", "html_url": "https://github.com/jupyterlab/jupyterlab/commit/504825938c0abfa2fb8ff8d529308830a5ae42ed", "windows_before": [{"commit_id": "cce53cd91d0c9eb642fb3196c956318833067ffa", "commit_date": "Thu Aug 5 11:42:03 2021 -0500", "commit_message": "Merge pull request from GHSA-4952-p58q-6crx", "files_name": ["packages/apputils/src/sanitizer.ts"]}, {"commit_id": "18ddba5ee54df5edb1eb0e2056f8ea425ec15a97", "commit_date": "Thu Aug 5 17:56:19 2021 +0530", "commit_message": "Add aria-label for notebook cells to improve screen-reader visibility (#10762)", "files_name": ["packages/cells/.vscode/launch.json", "packages/cells/package.json", "packages/cells/src/widget.ts", "packages/cells/tsconfig.json", "packages/cells/tsconfig.test.json", "packages/notebook/src/widget.ts", "packages/notebook/src/widgetfactory.ts"]}, {"commit_id": "dffbe882863ef3ca685d587702c8e921696c5603", "commit_date": "Thu Aug 5 08:16:53 2021 -0400", "commit_message": "forward port of #10724 (#10725)", "files_name": ["packages/apputils-extension/src/index.ts"]}, {"commit_id": "7ceeae9c25d5db987e68995d9243ab2569d02260", "commit_date": "Thu Aug 5 08:13:26 2021 -0400", "commit_message": "Document multiple commands single shortcut functionality  (#10754)", "files_name": ["docs/source/extension/extension_points.rst", "docs/source/user/interface.rst", "packages/apputils-extension/src/index.ts"]}, {"commit_id": "e3b3814b93b091a642e8bb6e296c3045438a25d2", "commit_date": "Thu Aug 5 10:04:09 2021 +0200", "commit_message": "Merge pull request #10776 from meeseeksmachine/auto-backport-of-pr-10667-on-master", "files_name": ["508e416d9e4b74f071bbce3d3ae5b2f7c6f108b7 - Thu Aug 5 08:14:33 2021 +0200 : Backport PR #10667: PR: Add preferred-dir handling", "packages/filebrowser-extension/src/index.ts"]}, {"commit_id": "34602e482f195454195a6a3430d475a383080adc", "commit_date": "Wed Aug 4 12:07:36 2021 -0500", "commit_message": "Forward port changelog entries for 3.1.1 and 3.1.2 (#10774)", "files_name": ["CHANGELOG.md"]}, {"commit_id": "42f28b3e33d92321b625cf815cdbbc79baed9a00", "commit_date": "Wed Aug 4 18:22:15 2021 +0200", "commit_message": "Markdown url resolver no longer throws for malformed URLs in isLocal check (#10773)", "files_name": ["packages/rendermime/src/registry.ts", "packages/rendermime/test/registry.spec.ts"]}, {"commit_id": "21b3fdf053701368569736bce7661ad3925236fb", "commit_date": "Wed Aug 4 13:30:38 2021 +0200", "commit_message": "Prevent undo/redo in outputs (#10756)", "files_name": ["packages/shared-models/src/ymodels.ts"]}, {"commit_id": "9d4b7623b241f9766190b744e4f014f363f6b98e", "commit_date": "Mon Aug 2 12:45:46 2021 -0700", "commit_message": "Toc: Run nested code cells directly from markdown headings (#10729)", "files_name": ["packages/toc-extension/package.json", "packages/toc-extension/src/index.ts", "packages/toc-extension/style/index.css", "packages/toc-extension/style/index.js", "packages/toc-extension/tsconfig.json", "packages/toc/src/utils/headings.ts"]}, {"commit_id": "b54c8957e8aed96a72de94f4d8f69c6adbd30e39", "commit_date": "Mon Aug 2 19:17:42 2021 +0100", "commit_message": "Yet another fix for Verdaccio publish (#10759)", "files_name": ["buildutils/src/bumpversion.ts", "buildutils/src/local-repository.ts", "buildutils/src/patch-release.ts", "buildutils/src/publish.ts"]}, {"commit_id": "e59aed79d0e61c53088f24b0e0eff8e64557690d", "commit_date": "Mon Aug 2 13:17:46 2021 +0530", "commit_message": "Added Table of contents (toc.rst) to user guide documentation (#10699)", "files_name": [".gitignore", "docs/source/index.rst", "docs/source/user/images/toc/includeOutput.gif", "docs/source/user/images/toc/numberingH1.gif", "docs/source/user/images/toc/runcell.gif", "docs/source/user/images/toc/syncCollapseState.gif", "docs/source/user/images/toc/toc.gif", "docs/source/user/toc.rst", "packages/toc/README.md"]}, {"commit_id": "758c00ce586738f4c7ba942416f4bf4762ba120e", "commit_date": "Fri Jul 30 13:08:20 2021 -0700", "commit_message": "Revert change in saveState Signal (#10741)", "files_name": ["packages/docmanager-extension/src/index.ts", "packages/docmanager/src/widgetmanager.ts", "packages/docregistry/src/context.ts", "packages/docregistry/src/registry.ts", "packages/notebook/src/default-toolbar.tsx"]}, {"commit_id": "bae0dd23d2e81cfbaaa9b7d9e67b1ac1383b8a29", "commit_date": "Fri Jul 30 21:07:20 2021 +0100", "commit_message": "Add translations for kernel statuses (#10738)", "files_name": ["packages/apputils/src/sessioncontext.tsx", "packages/apputils/src/toolbar.tsx", "packages/statusbar/package.json", "packages/statusbar/src/defaults/kernelStatus.tsx", "packages/statusbar/tsconfig.json", "packages/statusbar/tsconfig.test.json"]}, {"commit_id": "14c515cf2642b4fd50eeb9a68d2d034b41a48fd1", "commit_date": "Fri Jul 30 16:02:54 2021 +0100", "commit_message": "Another Fix to Verdaccio Publishing (#10747)", "files_name": ["buildutils/src/local-repository.ts"]}, {"commit_id": "ab688ddea7c6b3f4973bcd489071cbffcf254d82", "commit_date": "Fri Jul 30 07:30:05 2021 -0700", "commit_message": "Responsive document toolbar (#10720)", "files_name": ["packages/apputils/src/toolbar.tsx", "packages/apputils/test/toolbar.spec.ts", "packages/debugger/test/debugger.spec.ts", "packages/docregistry/test/default.spec.ts", "packages/notebook/style/toolbar.css", "packages/notebook/test/widgetfactory.spec.ts"]}, {"commit_id": "f1655cbcabc4996215734bc38fe5febf5beacbfb", "commit_date": "Fri Jul 30 13:23:10 2021 +0100", "commit_message": "Fixes for Branch Integrity (#10744)", "files_name": ["buildutils/src/ensure-repo.ts"]}, {"commit_id": "c2d46e7b5bc15b13147e383b4a6efef21708edd5", "commit_date": "Fri Jul 30 07:21:25 2021 -0500", "commit_message": "clean up release process (#10742)", "files_name": ["buildutils/src/prepare-python-release.ts", "buildutils/src/publish.ts"]}, {"commit_id": "e4447dcac162f6b374a49fbfd5291308b39b23e1", "commit_date": "Fri Jul 30 13:20:21 2021 +0100", "commit_message": "Fix Verdaccio Publish (#10743)", "files_name": ["buildutils/src/local-repository.ts"]}, {"commit_id": "357afe8b777071a4e2db5044bde108e441dfb3c8", "commit_date": "Thu Jul 29 02:42:48 2021 -0700", "commit_message": "RTC: persist rtc user color & name in state db (#10490)", "files_name": ["examples/federated/md_package/index.js", "packages/docprovider-extension/package.json", "packages/docprovider-extension/src/index.ts", "packages/docprovider-extension/tsconfig.json", "packages/docprovider/package.json", "packages/docprovider/src/yprovider.ts", "packages/docprovider/tsconfig.json", "packages/docprovider/tsconfig.test.json"]}, {"commit_id": "16be971f7a6ff24cb7f78a58ddc47f26d00628e5", "commit_date": "Thu Jul 29 11:16:54 2021 +0200", "commit_message": "Normalize domain (#10728)", "files_name": ["packages/translation/src/gettext.ts", "packages/translation/src/manager.ts", "packages/translation/src/utils.ts"]}, {"commit_id": "7aeaee7a31d407530290496fd1a876a38e9945a7", "commit_date": "Wed Jul 28 18:58:19 2021 +0100", "commit_message": "Add branch integrity handling (#10708)", "files_name": [".github/workflows/check-release.yml", ".github/workflows/linuxjs-flaky-tests.yml", ".github/workflows/linuxjs-tests.yml", ".github/workflows/linuxtests.yml", ".github/workflows/macostests.yml", ".github/workflows/ui-tests.yml", ".github/workflows/windowstests.yml", "Dockerfile", "README.md", "buildutils/src/ensure-repo.ts", "docker/jupyter_server_config.json", "docs/source/user/rtc.rst", "packages/extensionmanager/src/widget.tsx", "packages/help-extension/src/index.tsx", "packages/ui-components/docs/source/intro.rst", "setup.cfg", "ui-tests/docker/docker-compose.yml"]}, {"commit_id": "686cf178d1adedb59cc67a263469d0508a92f880", "commit_date": "Wed Jul 28 17:19:13 2021 +0200", "commit_message": "Merge pull request #10719 from loichuder/move-types-apputils-back", "files_name": ["19229c4c554db1fe1e548fc4aed8beb924f86e8c - Wed Jul 28 17:15:02 2021 +0200 : Revert move @types/react in devDependencies of apputils (2685777ef42a56ef5b955f859644f603d579fe43)", "packages/apputils/package.json"]}, {"commit_id": "e9a3c6e93d7fa598a78e7379124a98cf90d3b4f8", "commit_date": "Wed Jul 28 15:11:43 2021 +0200", "commit_message": "Merge pull request #10717 from loichuder/move-types-apputils", "files_name": ["2685777ef42a56ef5b955f859644f603d579fe43 - Wed Jul 28 14:37:55 2021 +0200 : Move @types/react in devDependencies of apputils", "jupyterlab/commands.py", "packages/apputils/package.json"]}, {"commit_id": "a843fdcec5cee365821b7e338af5a0fad836a656", "commit_date": "Wed Jul 28 16:34:32 2021 +0530", "commit_message": "Minor improvement to contributing documentation (#10713)", "files_name": ["docs/source/developer/contributing.rst"]}, {"commit_id": "86fb19803e0e2d19db60cad7f871ada1ab9469f3", "commit_date": "Tue Jul 27 17:54:38 2021 -0500", "commit_message": "Update changelog in master to reflect 3.1 final (#10710)", "files_name": ["CHANGELOG.md"]}, {"commit_id": "72db26afdf8f53c7bf25f5cc75e092d404c333c9", "commit_date": "Tue Jul 27 15:34:37 2021 -0500", "commit_message": "Publish 4.0.0a0", "files_name": ["jupyterlab/staging/package.json"]}, {"commit_id": "949a58689f3d1454a15c2e2d20708c133154d5c5", "commit_date": "Tue Jul 27 15:31:14 2021 -0500", "commit_message": "update dev mode version", "files_name": ["dev_mode/package.json"]}, {"commit_id": "0ab8e0175fcd68933661b89d64a0d74b32bf13fa", "commit_date": "Tue Jul 27 15:23:09 2021 -0500", "commit_message": "update dev mode version", "files_name": ["dev_mode/package.json", "jupyterlab/staging/package.json", "jupyterlab/staging/yarn.lock"]}, {"commit_id": "f284528624b2145e2caa5f626951213f6615dee5", "commit_date": "Tue Jul 27 15:02:42 2021 -0500", "commit_message": "update top level version", "files_name": [".bumpversion.cfg", "dev_mode/package.json", "jupyterlab/_version.py"]}, {"commit_id": "56c072ef926bba23fd0ecddca978ef904945573a", "commit_date": "Tue Jul 27 14:56:19 2021 -0500", "commit_message": "New version", "files_name": ["builder/package.json", "buildutils/package.json", "buildutils/template/package.json", "dev_mode/package.json", "examples/app/package.json", "examples/cell/package.json", "examples/console/package.json", "examples/federated/core_package/package.json", "examples/federated/md_package/package.json", "examples/federated/middle_package/package.json", "examples/federated/package.json", "examples/federated/phosphor_package/package.json", "examples/filebrowser/package.json", "examples/notebook/package.json", "examples/terminal/package.json", "jupyterlab/tests/mock_packages/extension/package.json", "jupyterlab/tests/mock_packages/interop/consumer/package.json", "jupyterlab/tests/mock_packages/interop/provider/package.json", "jupyterlab/tests/mock_packages/interop/token/package.json", "packages/application-extension/package.json", "packages/application/package.json", "packages/apputils-extension/package.json", "packages/apputils/package.json", "packages/attachments/package.json", "packages/cells/package.json", "packages/celltags-extension/package.json", "packages/celltags/package.json", "packages/codeeditor/package.json", "packages/codemirror-extension/package.json", "packages/codemirror/package.json", "packages/completer-extension/package.json", "packages/completer/package.json", "packages/console-extension/package.json", "packages/console/package.json", "packages/coreutils/package.json", "packages/csvviewer-extension/package.json", "packages/csvviewer/package.json", "packages/debugger-extension/package.json", "packages/debugger/package.json"]}], "windows_after": [{"commit_id": "358f2e55bac5bfd5b0443ca4d6929e8175e8d69d", "commit_date": "Fri Aug 6 10:01:43 2021 +0900", "commit_message": "Fix docstring of the selectionExecuted signal (#10778)", "files_name": ["packages/notebook/src/actions.tsx"]}, {"commit_id": "cb406d3ee55eedd2f0df238958b37a4473cece02", "commit_date": "Fri Aug 6 03:11:36 2021 +0200", "commit_message": "Refactor apputils widgets (#10758)", "files_name": ["docs/source/extension/notebook.rst", "docs/source/extension/virtualdom.create.tsx", "docs/source/extension/virtualdom.reactwidget.tsx", "docs/source/extension/virtualdom.rst", "docs/source/extension/virtualdom.usesignal.tsx", "examples/cell/src/index.ts", "examples/filebrowser/src/index.ts", "packages/apputils/package.json", "packages/apputils/src/commandpalette.ts", "packages/apputils/src/dialog.tsx", "packages/apputils/src/index.ts", "packages/apputils/src/inputdialog.ts", "packages/apputils/src/mainareawidget.ts", "packages/apputils/src/splash.ts", "packages/apputils/src/thememanager.ts", "packages/apputils/src/tokens.ts", "packages/apputils/src/toolbar.tsx", "packages/apputils/src/windowresolver.ts", "packages/apputils/style/base.css", "packages/apputils/test/toolbar.spec.ts", "packages/cells/src/collapser.tsx", "packages/cells/src/placeholder.tsx", "packages/codemirror/package.json", "packages/codemirror/src/syntaxstatus.tsx", "packages/codemirror/style/index.css", "packages/codemirror/style/index.js", "packages/codemirror/tsconfig.json", "packages/codemirror/tsconfig.test.json", "packages/csvviewer/package.json", "packages/csvviewer/src/toolbar.ts", "packages/csvviewer/style/index.css", "packages/csvviewer/style/index.js", "packages/csvviewer/tsconfig.json", "packages/csvviewer/tsconfig.test.json", "packages/debugger/src/handler.ts", "packages/debugger/src/panels/breakpoints/body.tsx", "packages/debugger/src/panels/breakpoints/header.ts", "packages/debugger/src/panels/breakpoints/index.ts", "packages/debugger/src/panels/callstack/body.tsx", "packages/debugger/src/panels/callstack/header.ts", "packages/debugger/src/panels/callstack/index.ts", "packages/debugger/src/panels/sources/header.tsx", "packages/debugger/src/panels/sources/index.ts", "packages/debugger/src/panels/variables/header.ts", "packages/debugger/src/panels/variables/index.ts", "packages/debugger/src/panels/variables/scope.tsx", "packages/debugger/src/panels/variables/tree.tsx", "packages/docmanager/package.json", "packages/docmanager/src/pathstatus.tsx", "packages/docmanager/src/savingstatus.tsx", "packages/docmanager/style/index.css", "packages/docmanager/style/index.js", "packages/docmanager/tsconfig.json", "packages/docmanager/tsconfig.test.json", "packages/docregistry/src/registry.ts", "packages/documentsearch/src/searchoverlay.tsx", "packages/extensionmanager/src/model.ts", "packages/extensionmanager/src/widget.tsx", "packages/filebrowser-extension/src/index.ts", "packages/filebrowser/src/browser.ts", "packages/filebrowser/src/search.tsx", "packages/filebrowser/src/upload.ts", "packages/filebrowser/src/uploadstatus.tsx", "packages/fileeditor/src/tabspacestatus.tsx", "packages/help-extension/src/index.tsx", "packages/help-extension/src/licenses.tsx", "packages/htmlviewer/src/index.tsx", "packages/launcher/src/index.tsx", "packages/logconsole-extension/src/index.tsx", "packages/logconsole-extension/src/status.tsx", "packages/notebook/src/default-toolbar.tsx", "packages/notebook/src/modestatus.tsx", "packages/notebook/src/notebooktools.ts", "packages/notebook/src/truststatus.tsx", "packages/notebook/test/panel.spec.ts", "packages/property-inspector/package.json", "packages/property-inspector/src/index.ts", "packages/property-inspector/style/index.css", "packages/property-inspector/style/index.js", "packages/property-inspector/tsconfig.json", "packages/running/src/index.tsx", "packages/settingeditor/src/raweditor.ts", "packages/statusbar/src/defaults/kernelStatus.tsx", "packages/statusbar/src/defaults/lineCol.tsx", "packages/statusbar/src/defaults/runningSessions.tsx", "packages/ui-components/package.json", "packages/ui-components/src/components/collapse.ts", "packages/ui-components/src/components/iframe.ts", "packages/ui-components/src/components/index.ts", "packages/ui-components/src/components/spinner.ts", "packages/ui-components/src/components/styling.ts", "packages/ui-components/src/components/toolbar.tsx", "packages/ui-components/src/components/vdom.ts", "packages/ui-components/style/base.css", "packages/ui-components/style/collapse.css", "packages/ui-components/style/iframe.css", "packages/ui-components/style/spinner.css", "packages/ui-components/style/styling.css", "packages/ui-components/style/toolbar.css", "packages/ui-components/test/iframe.spec.ts", "packages/ui-components/test/styling.spec.ts", "packages/ui-components/test/toolbar.spec.ts", "packages/ui-components/test/vdom.spec.ts", "packages/ui-components/tsconfig.json", "packages/ui-components/tsconfig.test.json"]}, {"commit_id": "37881c902605898d70952a923b19eeb290226ead", "commit_date": "Fri Aug 6 04:40:29 2021 -0500", "commit_message": "Automated Changelog Entry for 4.0.0a1 on master (#10780)", "files_name": ["CHANGELOG.md"]}, {"commit_id": "6a6f1839719e1b37711f017204347b92446383cc", "commit_date": "Fri Aug 6 09:44:36 2021 +0000", "commit_message": "New version", "files_name": ["builder/package.json", "buildutils/package.json", "buildutils/template/package.json", "dev_mode/package.json", "examples/app/package.json", "examples/cell/package.json", "examples/console/package.json", "examples/federated/core_package/package.json", "examples/federated/md_package/package.json", "examples/federated/middle_package/package.json", "examples/federated/package.json", "examples/federated/phosphor_package/package.json", "examples/filebrowser/package.json", "examples/notebook/package.json", "examples/terminal/package.json", "jupyterlab/tests/mock_packages/extension/package.json", "jupyterlab/tests/mock_packages/interop/consumer/package.json", "jupyterlab/tests/mock_packages/interop/provider/package.json", "jupyterlab/tests/mock_packages/interop/token/package.json", "packages/application-extension/package.json", "packages/application/package.json", "packages/apputils-extension/package.json", "packages/apputils/package.json", "packages/attachments/package.json", "packages/cells/package.json", "packages/celltags-extension/package.json", "packages/celltags/package.json", "packages/codeeditor/package.json", "packages/codemirror-extension/package.json", "packages/codemirror/package.json", "packages/completer-extension/package.json", "packages/completer/package.json", "packages/console-extension/package.json", "packages/console/package.json", "packages/coreutils/package.json", "packages/csvviewer-extension/package.json", "packages/csvviewer/package.json", "packages/debugger-extension/package.json", "packages/debugger/package.json", "packages/docmanager-extension/package.json", "packages/docmanager/package.json", "packages/docprovider-extension/package.json", "packages/docprovider/package.json", "packages/docregistry/package.json", "packages/documentsearch-extension/package.json", "packages/documentsearch/package.json", "packages/extensionmanager-extension/package.json", "packages/extensionmanager/package.json", "packages/filebrowser-extension/package.json", "packages/filebrowser/package.json", "packages/fileeditor-extension/package.json", "packages/fileeditor/package.json", "packages/help-extension/package.json", "packages/htmlviewer-extension/package.json", "packages/htmlviewer/package.json", "packages/hub-extension/package.json", "packages/imageviewer-extension/package.json", "packages/imageviewer/package.json", "packages/inspector-extension/package.json", "packages/inspector/package.json", "packages/javascript-extension/package.json", "packages/json-extension/package.json", "packages/launcher-extension/package.json", "packages/launcher/package.json", "packages/logconsole-extension/package.json", "packages/logconsole/package.json", "packages/mainmenu-extension/package.json", "packages/mainmenu/package.json", "packages/markdownviewer-extension/package.json", "packages/markdownviewer/package.json", "packages/mathjax2-extension/package.json", "packages/mathjax2/package.json", "packages/metapackage/package.json", "packages/nbconvert-css/package.json", "packages/nbformat/package.json", "packages/notebook-extension/package.json", "packages/notebook/package.json", "packages/observables/package.json", "packages/outputarea/package.json", "packages/pdf-extension/package.json", "packages/property-inspector/package.json", "packages/rendermime-extension/package.json", "packages/rendermime-interfaces/package.json", "packages/rendermime/package.json", "packages/running-extension/package.json", "packages/running/package.json"]}], "parents": [{"commit_id_before": "ccb65656e3ed9c47d3e6fedbcff2405885d0bcaa", "url_before": "https://api.github.com/repos/jupyterlab/jupyterlab/commits/ccb65656e3ed9c47d3e6fedbcff2405885d0bcaa", "html_url_before": "https://github.com/jupyterlab/jupyterlab/commit/ccb65656e3ed9c47d3e6fedbcff2405885d0bcaa"}], "details": [{"raw_url": "https://github.com/jupyterlab/jupyterlab/raw/504825938c0abfa2fb8ff8d529308830a5ae42ed/packages%2Fapputils%2Fsrc%2Fsanitizer.ts", "code": "// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// sanitize-html uses the url package, so we depend on a standalone version of\n// it which acts as a polyfill for browsers.\nimport sanitize from 'sanitize-html';\nimport { ISanitizer } from './tokens';\n\n/**\n * Helper class that contains regular expressions for inline CSS style validation.\n *\n * Which properties (and values) to allow is largely based on the Google Caja project:\n *   https://github.com/google/caja\n *\n * The regular expressions are largly based on the syntax definition found at\n * https://developer.mozilla.org/en-US/docs/Web/CSS.\n */\nclass CssProp {\n  static reg(r: string): RegExp {\n    return new RegExp('^' + r + '$', 'i');\n  }\n\n  /*\n   * Numeric base expressions used to help build more complex regular expressions\n   */\n  private static readonly N = {\n    integer: `[+-]?[0-9]+`,\n    integer_pos: `[+]?[0-9]+`,\n    integer_zero_ff: `([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])`,\n    number: `[+-]?([0-9]*[.])?[0-9]+(e-?[0-9]*)?`,\n    number_pos: `[+]?([0-9]*[.])?[0-9]+(e-?[0-9]*)?`,\n    number_zero_hundred: `[+]?(([0-9]|[1-9][0-9])([.][0-9]+)?|100)`,\n    number_zero_one: `[+]?(1([.][0]+)?|0([.][0-9]+)?)`\n  };\n\n  /*\n   * Base expressions of common CSS syntax elements\n   */\n  private static readonly B = {\n    angle: `(${CssProp.N.number}(deg|rad|grad|turn)|0)`,\n    frequency: `${CssProp.N.number}(Hz|kHz)`,\n    ident: String.raw`-?([_a-z]|[\\xA0-\\xFF]|\\\\[0-9a-f]{1,6}(\\r\\n|[ \\t\\r\\n\\f])?|\\\\[^\\r\\n\\f0-9a-f])([_a-z0-9-]|[\\xA0-\\xFF]|\\\\[0-9a-f]{1,6}(\\r\\n|[ \\t\\r\\n\\f])?|\\\\[^\\r\\n\\f0-9a-f])*`,\n    len_or_perc: `(0|${CssProp.N.number}(px|em|rem|ex|in|cm|mm|pt|pc|%))`,\n    length: `(${CssProp.N.number}(px|em|rem|ex|in|cm|mm|pt|pc)|0)`,\n    length_pos: `(${CssProp.N.number_pos}(px|em|rem|ex|in|cm|mm|pt|pc)|0)`,\n    percentage: `${CssProp.N.number}%`,\n    percentage_pos: `${CssProp.N.number_pos}%`,\n    percentage_zero_hundred: `${CssProp.N.number_zero_hundred}%`,\n    string: String.raw`(\\\"([^\\n\\r\\f\\\\\"]|\\\\\\n|\\r\\n|\\r|\\f|\\\\[0-9a-f]{1,6}(\\r\\n|[ \\t\\r\\n\\f])?|\\\\[^\\r\\n\\f0-9a-f])*\\\")|(\\'([^\\n\\r\\f\\\\']|\\\\\\n|\\r\\n|\\r|\\f|\\\\[0-9a-f]{1,6}(\\r\\n|[ \\t\\r\\n\\f])?|\\\\[^\\r\\n\\f0-9a-f])*\\')`,\n    time: `${CssProp.N.number}(s|ms)`,\n    url: `url\\\\(.*?\\\\)`,\n    z_index: `[+-]?[0-9]{1,7}`\n  };\n\n  /*\n   * Atomic (i.e. not dependant on other regular expressions) sub RegEx segments\n   */\n  private static readonly A = {\n    absolute_size: `xx-small|x-small|small|medium|large|x-large|xx-large`,\n    attachment: `scroll|fixed|local`,\n    bg_origin: `border-box|padding-box|content-box`,\n    border_style: `none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset`,\n    box: `border-box|padding-box|content-box`,\n    display_inside: `auto|block|table|flex|grid`,\n    display_outside: `block-level|inline-level|none|table-row-group|table-header-group|table-footer-group|table-row|table-cell|table-column-group|table-column|table-caption`,\n    ending_shape: `circle|ellipse`,\n    generic_family: `serif|sans-serif|cursive|fantasy|monospace`,\n    generic_voice: `male|female|child`,\n    relative_size: `smaller|larger`,\n    repeat_style: `repeat-x|repeat-y|((?:repeat|space|round|no-repeat)(?:\\\\s*(?:repeat|space|round|no-repeat))?)`,\n    side_or_corner: `(left|right)?\\\\s*(top|bottom)?`,\n    single_animation_direction: `normal|reverse|alternate|alternate-reverse`,\n    single_animation_fill_mode: `none|forwards|backwards|both`,\n    single_animation_play_state: `running|paused`\n  };\n\n  /*\n   * Color definition sub expressions\n   */\n  private static readonly _COLOR = {\n    hex: `\\\\#(0x)?[0-9a-f]+`,\n    name: `aliceblue|antiquewhite|aqua|aquamarine|azure|beige|bisque|black|blanchedalmond|blue|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgreen|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dodgerblue|firebrick|floralwhite|forestgreen|fuchsia|gainsboro|ghostwhite|gold|goldenrod|gray|green|greenyellow|honeydew|hotpink|indianred|indigo|ivory|khaki|lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgreen|lightgrey|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lightsteelblue|lightyellow|lime|limegreen|linen|magenta|maroon|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|navy|oldlace|olive|olivedrab|orange|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|purple|red|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|silver|skyblue|slateblue|slategray|snow|springgreen|steelblue|tan|teal|thistle|tomato|turquoise|transparent|violet|wheat|white|whitesmoke|yellow|yellowgreen`,\n    rgb: String.raw`rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)`,\n    rgba: String.raw`rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(${CssProp.N.integer_zero_ff}|${CssProp.N.number_zero_one}|${CssProp.B.percentage_zero_hundred})\\s*\\)`\n  };\n\n  /*\n   * Compound (i.e. dependant on other (sub) regular expressions) sub RegEx segments\n   */\n  private static readonly _C = {\n    alpha: `${CssProp.N.integer_zero_ff}|${CssProp.N.number_zero_one}|${CssProp.B.percentage_zero_hundred}`,\n    alphavalue: CssProp.N.number_zero_one,\n    bg_position: `((${CssProp.B.len_or_perc}|left|center|right|top|bottom)\\\\s*){1,4}`,\n    bg_size: `(${CssProp.B.length_pos}|${CssProp.B.percentage}|auto){1,2}|cover|contain`,\n    border_width: `thin|medium|thick|${CssProp.B.length}`,\n    bottom: `${CssProp.B.length}|auto`,\n    color: `${CssProp._COLOR.hex}|${CssProp._COLOR.rgb}|${CssProp._COLOR.rgba}|${CssProp._COLOR.name}`,\n    family_name: `${CssProp.B.string}|(${CssProp.B.ident}\\\\s*)+`,\n    image_decl: CssProp.B.url,\n    left: `${CssProp.B.length}|auto`,\n    loose_quotable_words: `(${CssProp.B.ident})+`,\n    margin_width: `${CssProp.B.len_or_perc}|auto`,\n    padding_width: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}`,\n    page_url: CssProp.B.url,\n    position: `((${CssProp.B.len_or_perc}|left|center|right|top|bottom)\\\\s*){1,4}`,\n    right: `${CssProp.B.length}|auto`,\n    shadow: '',\n    size: `closest-side|farthest-side|closest-corner|farthest-corner|${CssProp.B.length}|(${CssProp.B.len_or_perc})\\\\s+(${CssProp.B.len_or_perc})`,\n    top: `${CssProp.B.length}|auto`\n  };\n\n  private static readonly _C1 = {\n    image_list: `image\\\\(\\\\s*(${CssProp.B.url})*\\\\s*(${CssProp.B.url}|${CssProp._C.color})\\\\s*\\\\)`,\n    shadow: `((${CssProp._C.color})\\\\s+((${CssProp.B.length})\\\\s*){2,4}(\\s+inset)?)|((inset\\\\s+)?((${CssProp.B.length})\\\\s*){2,4}\\\\s*(${CssProp._C.color})?)`\n  };\n\n  private static readonly _C2 = {\n    bg_image: `(${CssProp.B.url}|${CssProp._C1.image_list})|none`,\n    image: `${CssProp.B.url}|${CssProp._C1.image_list}`,\n    shape: `rect\\\\(\\\\s*(${CssProp._C.top})\\\\s*,\\\\s*(${CssProp._C.right})\\\\s*,\\\\s*(${CssProp._C.bottom})\\\\s*,\\\\s*(${CssProp._C.left})\\\\s*\\\\)`\n  };\n\n  private static readonly C = { ...CssProp._C, ...CssProp._C1, ...CssProp._C2 };\n\n  /*\n   * Property value regular expressions not dependant on other sub expressions\n   */\n  private static readonly AP = {\n    border_collapse: `collapse|separate`,\n    box: `normal|none|contents`,\n    box_sizing: `content-box|padding-box|border-box`,\n    caption_side: `top|bottom`,\n    clear: `none|left|right|both`,\n    direction: `ltr|rtl`,\n    empty_cells: `show|hide`,\n    float: `left|right|none`,\n    font_stretch: `normal|wider|narrower|ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded`,\n    font_style: `normal|italic|oblique`,\n    font_variant: `normal|small-caps`,\n    font_weight: `normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900`,\n    list_style_position: `inside|outside`,\n    list_style_type: `disc|circle|square|decimal|decimal-leading-zero|lower-roman|upper-roman|lower-greek|lower-latin|upper-latin|armenian|georgian|lower-alpha|upper-alpha|none`,\n    overflow: `visible|hidden|scroll|auto`,\n    overflow_wrap: `normal|break-word`,\n    overflow_x: `visible|hidden|scroll|auto|no-display|no-content`,\n    page_break_after: `auto|always|avoid|left|right`,\n    page_break_before: `auto|always|avoid|left|right`,\n    page_break_inside: `avoid|auto`,\n    position: `static|relative|absolute`,\n    resize: `none|both|horizontal|vertical`,\n    speak: `normal|none|spell-out`,\n    speak_header: `once|always`,\n    speak_numeral: `digits|continuous`,\n    speak_punctuation: `code|none`,\n    table_layout: `auto|fixed`,\n    text_align: `left|right|center|justify`,\n    text_decoration: `none|((underline|overline|line-through|blink)\\\\s*)+`,\n    text_transform: `capitalize|uppercase|lowercase|none`,\n    text_wrap: `normal|unrestricted|none|suppress`,\n    unicode_bidi: `normal|embed|bidi-override`,\n    visibility: `visible|hidden|collapse`,\n    white_space: `normal|pre|nowrap|pre-wrap|pre-line`,\n    word_break: `normal|keep-all|break-all`\n  };\n\n  /*\n   * Compound propertiy value regular expressions (i.e. dependant on other sub expressions)\n   */\n  private static readonly _CP = {\n    background_attachment: `${CssProp.A.attachment}(,\\\\s*${CssProp.A.attachment})*`,\n    background_color: CssProp.C.color,\n    background_origin: `${CssProp.A.box}(,\\\\s*${CssProp.A.box})*`,\n    background_repeat: `${CssProp.A.repeat_style}(,\\\\s*${CssProp.A.repeat_style})*`,\n    border: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    border_radius: `((${CssProp.B.len_or_perc})\\\\s*){1,4}(\\\\/\\\\s*((${CssProp.B.len_or_perc})\\\\s*){1,4})?`,\n    border_spacing: `${CssProp.B.length}\\\\s*(${CssProp.B.length})?`,\n    border_top_color: CssProp.C.color,\n    border_top_style: CssProp.A.border_style,\n    border_width: `((${CssProp.C.border_width})\\\\s*){1,4}`,\n    color: CssProp.C.color,\n    cursor: `(${CssProp.B.url}(\\\\s*,\\\\s*)?)*(auto|crosshair|default|pointer|move|e-resize|ne-resize|nw-resize|n-resize|se-resize|sw-resize|s-resize|w-resize|text|wait|help|progress|all-scroll|col-resize|hand|no-drop|not-allowed|row-resize|vertical-text)`,\n    display: `inline|block|list-item|run-in|inline-list-item|inline-block|table|inline-table|table-cell|table-caption|flex|inline-flex|grid|inline-grid|${CssProp.A.display_inside}|${CssProp.A.display_outside}|inherit|inline-box|inline-stack`,\n    display_outside: CssProp.A.display_outside,\n    elevation: `${CssProp.B.angle}|below|level|above|higher|lower`,\n    font_family: `(${CssProp.C.family_name}|${CssProp.A.generic_family})(,\\\\s*(${CssProp.C.family_name}|${CssProp.A.generic_family}))*`,\n    height: `${CssProp.B.length}|${CssProp.B.percentage}|auto`,\n    letter_spacing: `normal|${CssProp.B.length}`,\n    list_style_image: `${CssProp.C.image}|none`,\n    margin_right: CssProp.C.margin_width,\n    max_height: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|none|auto`,\n    min_height: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|auto`,\n    opacity: CssProp.C.alphavalue,\n    outline_color: `${CssProp.C.color}|invert`,\n    outline_width: CssProp.C.border_width,\n    padding: `((${CssProp.C.padding_width})\\\\s*){1,4}`,\n    padding_top: CssProp.C.padding_width,\n    pitch_range: CssProp.N.number,\n    right: `${CssProp.B.length}|${CssProp.B.percentage}|auto`,\n    stress: CssProp.N.number,\n    text_indent: `${CssProp.B.length}|${CssProp.B.percentage}`,\n    text_shadow: `none|${CssProp.C.shadow}(,\\\\s*(${CssProp.C.shadow}))*`,\n    volume: `${CssProp.N.number_pos}|${CssProp.B.percentage_pos}|silent|x-soft|soft|medium|loud|x-loud`,\n    word_wrap: CssProp.AP.overflow_wrap,\n    zoom: `normal|${CssProp.N.number_pos}|${CssProp.B.percentage_pos}`,\n    backface_visibility: CssProp.AP.visibility,\n    background_clip: `${CssProp.A.box}(,\\\\s*(${CssProp.A.box}))*`,\n    background_position: `${CssProp.C.bg_position}(,\\\\s*(${CssProp.C.bg_position}))*`,\n    border_bottom_color: CssProp.C.color,\n    border_bottom_style: CssProp.A.border_style,\n    border_color: `((${CssProp.C.color})\\\\s*){1,4}`,\n    border_left_color: CssProp.C.color,\n    border_right_color: CssProp.C.color,\n    border_style: `((${CssProp.A.border_style})\\\\s*){1,4}`,\n    border_top_left_radius: `(${CssProp.B.length}|${CssProp.B.percentage})(\\\\s*(${CssProp.B.length}|${CssProp.B.percentage}))?`,\n    border_top_width: CssProp.C.border_width,\n    box_shadow: `none|${CssProp.C.shadow}(,\\\\s*(${CssProp.C.shadow}))*`,\n    clip: `${CssProp.C.shape}|auto`,\n    display_inside: CssProp.A.display_inside,\n    font_size: `${CssProp.A.absolute_size}|${CssProp.A.relative_size}|${CssProp.B.length_pos}|${CssProp.B.percentage_pos}`,\n    line_height: `normal|${CssProp.N.number_pos}|${CssProp.B.length_pos}|${CssProp.B.percentage_pos}`,\n    margin_left: CssProp.C.margin_width,\n    max_width: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|none|auto`,\n    outline_style: CssProp.A.border_style,\n    padding_bottom: CssProp.C.padding_width,\n    padding_right: CssProp.C.padding_width,\n    perspective: `none|${CssProp.B.length}`,\n    richness: CssProp.N.number,\n    text_overflow: `((clip|ellipsis|${CssProp.B.string})\\\\s*){1,2}`,\n    top: `${CssProp.B.length}|${CssProp.B.percentage}|auto`,\n    width: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|auto`,\n    z_index: `auto|${CssProp.B.z_index}`,\n    // Simplified background\n    background: `(((${CssProp.C.bg_position}\\\\s*(\\\\/\\\\s*${CssProp.C.bg_size})?)|(${CssProp.A.repeat_style})|(${CssProp.A.attachment})|(${CssProp.A.bg_origin})|(${CssProp.C.bg_image})|(${CssProp.C.color}))\\\\s*)+`,\n    background_size: `${CssProp.C.bg_size}(,\\\\s*${CssProp.C.bg_size})*`,\n    border_bottom_left_radius: `(${CssProp.B.length}|${CssProp.B.percentage})(\\\\s*(${CssProp.B.length}|${CssProp.B.percentage}))?`,\n    border_bottom_width: CssProp.C.border_width,\n    border_left_style: CssProp.A.border_style,\n    border_right_style: CssProp.A.border_style,\n    border_top: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    bottom: `${CssProp.B.len_or_perc}|auto`,\n    list_style: `((${CssProp.AP.list_style_type}|${CssProp.AP.list_style_position}|${CssProp.C.image}|none})\\\\s*){1,3}`,\n    margin_top: CssProp.C.margin_width,\n    outline: `((${CssProp.C.color}|invert|${CssProp.A.border_style}|${CssProp.C.border_width})\\\\s*){1,3}`,\n    overflow_y: CssProp.AP.overflow_x,\n    pitch: `${CssProp.B.frequency}|x-low|low|medium|high|x-high`,\n    vertical_align: `baseline|sub|super|top|text-top|middle|bottom|text-bottom|${CssProp.B.len_or_perc}`,\n    word_spacing: `normal|${CssProp.B.length}`,\n    background_image: `${CssProp.C.bg_image}(,\\\\s*${CssProp.C.bg_image})*`,\n    border_bottom_right_radius: `(${CssProp.B.length}|${CssProp.B.percentage})(\\\\s*(${CssProp.B.length}|${CssProp.B.percentage}))?`,\n    border_left_width: CssProp.C.border_width,\n    border_right_width: CssProp.C.border_width,\n    left: `${CssProp.B.len_or_perc}|auto`,\n    margin_bottom: CssProp.C.margin_width,\n    pause_after: `${CssProp.B.time}|${CssProp.B.percentage}`,\n    speech_rate: `${CssProp.N.number}|x-slow|slow|medium|fast|x-fast|faster|slower`,\n    transition_duration: `${CssProp.B.time}(,\\\\s*${CssProp.B.time})*`,\n    border_bottom: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    border_right: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    margin: `((${CssProp.C.margin_width})\\\\s*){1,4}`,\n    padding_left: CssProp.C.padding_width,\n    border_left: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    quotes: `(${CssProp.B.string}\\\\s*${CssProp.B.string})+|none`,\n    border_top_right_radius: `(${CssProp.B.length}|${CssProp.B.percentage})(\\\\s*(${CssProp.B.length}|${CssProp.B.percentage}))?`,\n    min_width: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|auto`\n  };\n\n  private static readonly _CP1 = {\n    font: `(((((${CssProp.AP.font_style}|${CssProp.AP.font_variant}|${CssProp.AP.font_weight})\\\\s*){1,3})?\\\\s*(${CssProp._CP.font_size})\\\\s*(\\\\/\\\\s*(${CssProp._CP.line_height}))?\\\\s+(${CssProp._CP.font_family}))|caption|icon|menu|message-box|small-caption|status-bar)`\n  };\n\n  private static readonly CP = { ...CssProp._CP, ...CssProp._CP1 };\n\n  // CSS Property value validation regular expressions for use with sanitize-html\n\n  static BORDER_COLLAPSE = CssProp.reg(CssProp.AP.border_collapse);\n  static BOX = CssProp.reg(CssProp.AP.box);\n  static BOX_SIZING = CssProp.reg(CssProp.AP.box_sizing);\n  static CAPTION_SIDE = CssProp.reg(CssProp.AP.caption_side);\n  static CLEAR = CssProp.reg(CssProp.AP.clear);\n  static DIRECTION = CssProp.reg(CssProp.AP.direction);\n  static EMPTY_CELLS = CssProp.reg(CssProp.AP.empty_cells);\n  static FLOAT = CssProp.reg(CssProp.AP.float);\n  static FONT_STRETCH = CssProp.reg(CssProp.AP.font_stretch);\n  static FONT_STYLE = CssProp.reg(CssProp.AP.font_style);\n  static FONT_VARIANT = CssProp.reg(CssProp.AP.font_variant);\n  static FONT_WEIGHT = CssProp.reg(CssProp.AP.font_weight);\n  static LIST_STYLE_POSITION = CssProp.reg(CssProp.AP.list_style_position);\n  static LIST_STYLE_TYPE = CssProp.reg(CssProp.AP.list_style_type);\n  static OVERFLOW = CssProp.reg(CssProp.AP.overflow);\n  static OVERFLOW_WRAP = CssProp.reg(CssProp.AP.overflow_wrap);\n  static OVERFLOW_X = CssProp.reg(CssProp.AP.overflow_x);\n  static PAGE_BREAK_AFTER = CssProp.reg(CssProp.AP.page_break_after);\n  static PAGE_BREAK_BEFORE = CssProp.reg(CssProp.AP.page_break_before);\n  static PAGE_BREAK_INSIDE = CssProp.reg(CssProp.AP.page_break_inside);\n  static POSITION = CssProp.reg(CssProp.AP.position);\n  static RESIZE = CssProp.reg(CssProp.AP.resize);\n  static SPEAK = CssProp.reg(CssProp.AP.speak);\n  static SPEAK_HEADER = CssProp.reg(CssProp.AP.speak_header);\n  static SPEAK_NUMERAL = CssProp.reg(CssProp.AP.speak_numeral);\n  static SPEAK_PUNCTUATION = CssProp.reg(CssProp.AP.speak_punctuation);\n  static TABLE_LAYOUT = CssProp.reg(CssProp.AP.table_layout);\n  static TEXT_ALIGN = CssProp.reg(CssProp.AP.text_align);\n  static TEXT_DECORATION = CssProp.reg(CssProp.AP.text_decoration);\n  static TEXT_TRANSFORM = CssProp.reg(CssProp.AP.text_transform);\n  static TEXT_WRAP = CssProp.reg(CssProp.AP.text_wrap);\n  static UNICODE_BIDI = CssProp.reg(CssProp.AP.unicode_bidi);\n  static VISIBILITY = CssProp.reg(CssProp.AP.visibility);\n  static WHITE_SPACE = CssProp.reg(CssProp.AP.white_space);\n  static WORD_BREAK = CssProp.reg(CssProp.AP.word_break);\n\n  static BACKGROUND_ATTACHMENT = CssProp.reg(CssProp.CP.background_attachment);\n  static BACKGROUND_COLOR = CssProp.reg(CssProp.CP.background_color);\n  static BACKGROUND_ORIGIN = CssProp.reg(CssProp.CP.background_origin);\n  static BACKGROUND_REPEAT = CssProp.reg(CssProp.CP.background_repeat);\n  static BORDER = CssProp.reg(CssProp.CP.border);\n  static BORDER_RADIUS = CssProp.reg(CssProp.CP.border_radius);\n  static BORDER_SPACING = CssProp.reg(CssProp.CP.border_spacing);\n  static BORDER_TOP_COLOR = CssProp.reg(CssProp.CP.border_top_color);\n  static BORDER_TOP_STYLE = CssProp.reg(CssProp.CP.border_top_style);\n  static BORDER_WIDTH = CssProp.reg(CssProp.CP.border_width);\n  static COLOR = CssProp.reg(CssProp.CP.color);\n  static CURSOR = CssProp.reg(CssProp.CP.cursor);\n  static DISPLAY = CssProp.reg(CssProp.CP.display);\n  static DISPLAY_OUTSIDE = CssProp.reg(CssProp.CP.display_outside);\n  static ELEVATION = CssProp.reg(CssProp.CP.elevation);\n  static FONT_FAMILY = CssProp.reg(CssProp.CP.font_family);\n  static HEIGHT = CssProp.reg(CssProp.CP.height);\n  static LETTER_SPACING = CssProp.reg(CssProp.CP.letter_spacing);\n  static LIST_STYLE_IMAGE = CssProp.reg(CssProp.CP.list_style_image);\n  static MARGIN_RIGHT = CssProp.reg(CssProp.CP.margin_right);\n  static MAX_HEIGHT = CssProp.reg(CssProp.CP.max_height);\n  static MIN_HEIGHT = CssProp.reg(CssProp.CP.min_height);\n  static OPACITY = CssProp.reg(CssProp.CP.opacity);\n  static OUTLINE_COLOR = CssProp.reg(CssProp.CP.outline_color);\n  static OUTLINE_WIDTH = CssProp.reg(CssProp.CP.outline_width);\n  static PADDING = CssProp.reg(CssProp.CP.padding);\n  static PADDING_TOP = CssProp.reg(CssProp.CP.padding_top);\n  static PITCH_RANGE = CssProp.reg(CssProp.CP.pitch_range);\n  static RIGHT = CssProp.reg(CssProp.CP.right);\n  static STRESS = CssProp.reg(CssProp.CP.stress);\n  static TEXT_INDENT = CssProp.reg(CssProp.CP.text_indent);\n  static TEXT_SHADOW = CssProp.reg(CssProp.CP.text_shadow);\n  static VOLUME = CssProp.reg(CssProp.CP.volume);\n  static WORD_WRAP = CssProp.reg(CssProp.CP.word_wrap);\n  static ZOOM = CssProp.reg(CssProp.CP.zoom);\n  static BACKFACE_VISIBILITY = CssProp.reg(CssProp.CP.backface_visibility);\n  static BACKGROUND_CLIP = CssProp.reg(CssProp.CP.background_clip);\n  static BACKGROUND_POSITION = CssProp.reg(CssProp.CP.background_position);\n  static BORDER_BOTTOM_COLOR = CssProp.reg(CssProp.CP.border_bottom_color);\n  static BORDER_BOTTOM_STYLE = CssProp.reg(CssProp.CP.border_bottom_style);\n  static BORDER_COLOR = CssProp.reg(CssProp.CP.border_color);\n  static BORDER_LEFT_COLOR = CssProp.reg(CssProp.CP.border_left_color);\n  static BORDER_RIGHT_COLOR = CssProp.reg(CssProp.CP.border_right_color);\n  static BORDER_STYLE = CssProp.reg(CssProp.CP.border_style);\n  static BORDER_TOP_LEFT_RADIUS = CssProp.reg(\n    CssProp.CP.border_top_left_radius\n  );\n  static BORDER_TOP_WIDTH = CssProp.reg(CssProp.CP.border_top_width);\n  static BOX_SHADOW = CssProp.reg(CssProp.CP.box_shadow);\n  static CLIP = CssProp.reg(CssProp.CP.clip);\n  static DISPLAY_INSIDE = CssProp.reg(CssProp.CP.display_inside);\n  static FONT_SIZE = CssProp.reg(CssProp.CP.font_size);\n  static LINE_HEIGHT = CssProp.reg(CssProp.CP.line_height);\n  static MARGIN_LEFT = CssProp.reg(CssProp.CP.margin_left);\n  static MAX_WIDTH = CssProp.reg(CssProp.CP.max_width);\n  static OUTLINE_STYLE = CssProp.reg(CssProp.CP.outline_style);\n  static PADDING_BOTTOM = CssProp.reg(CssProp.CP.padding_bottom);\n  static PADDING_RIGHT = CssProp.reg(CssProp.CP.padding_right);\n  static PERSPECTIVE = CssProp.reg(CssProp.CP.perspective);\n  static RICHNESS = CssProp.reg(CssProp.CP.richness);\n  static TEXT_OVERFLOW = CssProp.reg(CssProp.CP.text_overflow);\n  static TOP = CssProp.reg(CssProp.CP.top);\n  static WIDTH = CssProp.reg(CssProp.CP.width);\n  static Z_INDEX = CssProp.reg(CssProp.CP.z_index);\n  static BACKGROUND = CssProp.reg(CssProp.CP.background);\n  static BACKGROUND_SIZE = CssProp.reg(CssProp.CP.background_size);\n  static BORDER_BOTTOM_LEFT_RADIUS = CssProp.reg(\n    CssProp.CP.border_bottom_left_radius\n  );\n  static BORDER_BOTTOM_WIDTH = CssProp.reg(CssProp.CP.border_bottom_width);\n  static BORDER_LEFT_STYLE = CssProp.reg(CssProp.CP.border_left_style);\n  static BORDER_RIGHT_STYLE = CssProp.reg(CssProp.CP.border_right_style);\n  static BORDER_TOP = CssProp.reg(CssProp.CP.border_top);\n  static BOTTOM = CssProp.reg(CssProp.CP.bottom);\n  static LIST_STYLE = CssProp.reg(CssProp.CP.list_style);\n  static MARGIN_TOP = CssProp.reg(CssProp.CP.margin_top);\n  static OUTLINE = CssProp.reg(CssProp.CP.outline);\n  static OVERFLOW_Y = CssProp.reg(CssProp.CP.overflow_y);\n  static PITCH = CssProp.reg(CssProp.CP.pitch);\n  static VERTICAL_ALIGN = CssProp.reg(CssProp.CP.vertical_align);\n  static WORD_SPACING = CssProp.reg(CssProp.CP.word_spacing);\n  static BACKGROUND_IMAGE = CssProp.reg(CssProp.CP.background_image);\n  static BORDER_BOTTOM_RIGHT_RADIUS = CssProp.reg(\n    CssProp.CP.border_bottom_right_radius\n  );\n  static BORDER_LEFT_WIDTH = CssProp.reg(CssProp.CP.border_left_width);\n  static BORDER_RIGHT_WIDTH = CssProp.reg(CssProp.CP.border_right_width);\n  static LEFT = CssProp.reg(CssProp.CP.left);\n  static MARGIN_BOTTOM = CssProp.reg(CssProp.CP.margin_bottom);\n  static PAUSE_AFTER = CssProp.reg(CssProp.CP.pause_after);\n  static SPEECH_RATE = CssProp.reg(CssProp.CP.speech_rate);\n  static TRANSITION_DURATION = CssProp.reg(CssProp.CP.transition_duration);\n  static BORDER_BOTTOM = CssProp.reg(CssProp.CP.border_bottom);\n  static BORDER_RIGHT = CssProp.reg(CssProp.CP.border_right);\n  static MARGIN = CssProp.reg(CssProp.CP.margin);\n  static PADDING_LEFT = CssProp.reg(CssProp.CP.padding_left);\n  static BORDER_LEFT = CssProp.reg(CssProp.CP.border_left);\n  static FONT = CssProp.reg(CssProp.CP.font);\n  static QUOTES = CssProp.reg(CssProp.CP.quotes);\n  static BORDER_TOP_RIGHT_RADIUS = CssProp.reg(\n    CssProp.CP.border_top_right_radius\n  );\n  static MIN_WIDTH = CssProp.reg(CssProp.CP.min_width);\n}\n\n/**\n * A class to sanitize HTML strings.\n */\nexport class Sanitizer implements ISanitizer {\n  /**\n   * Sanitize an HTML string.\n   *\n   * @param dirty - The dirty text.\n   *\n   * @param options - The optional sanitization options.\n   *\n   * @returns The sanitized string.\n   */\n  sanitize(dirty: string, options?: ISanitizer.IOptions): string {\n    return sanitize(dirty, { ...this._options, ...(options || {}) });\n  }\n\n  private _options: sanitize.IOptions = {\n    // HTML tags that are allowed to be used. Tags were extracted from Google Caja\n    allowedTags: [\n      'a',\n      'abbr',\n      'acronym',\n      'address',\n      'area',\n      'article',\n      'aside',\n      'audio',\n      'b',\n      'bdi',\n      'bdo',\n      'big',\n      'blockquote',\n      'br',\n      'button',\n      'canvas',\n      'caption',\n      'center',\n      'cite',\n      'code',\n      'col',\n      'colgroup',\n      'colspan',\n      'command',\n      'data',\n      'datalist',\n      'dd',\n      'del',\n      'details',\n      'dfn',\n      'dir',\n      'div',\n      'dl',\n      'dt',\n      'em',\n      'fieldset',\n      'figcaption',\n      'figure',\n      'font',\n      'footer',\n      'form',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'header',\n      'hgroup',\n      'hr',\n      'i',\n      // 'iframe' is allowed by Google Caja, but disallowed by default by sanitize-html\n      // , 'iframe'\n      'img',\n      'input',\n      'ins',\n      'kbd',\n      'label',\n      'legend',\n      'li',\n      'map',\n      'mark',\n      'menu',\n      'meter',\n      'nav',\n      'nobr',\n      'ol',\n      'optgroup',\n      'option',\n      'output',\n      'p',\n      'pre',\n      'progress',\n      'q',\n      'rowspan',\n      's',\n      'samp',\n      'section',\n      'select',\n      'small',\n      'source',\n      'span',\n      'strike',\n      'strong',\n      'sub',\n      'summary',\n      'sup',\n      'table',\n      'tbody',\n      'td',\n      'textarea',\n      'tfoot',\n      'th',\n      'thead',\n      'time',\n      'tr',\n      'track',\n      'tt',\n      'u',\n      'ul',\n      'var',\n      'video',\n      'wbr'\n    ],\n    // Attributes that HTML tags are allowed to have, extracted from Google Caja.\n    // See https://github.com/jupyterlab/jupyterlab/issues/1812#issuecomment-285848435\n    allowedAttributes: {\n      '*': [\n        'class',\n        'dir',\n        'draggable',\n        'hidden',\n        'id',\n        'inert',\n        'itemprop',\n        'itemref',\n        'itemscope',\n        'lang',\n        'spellcheck',\n        'style',\n        'title',\n        'translate'\n      ],\n      // 'rel' and 'target' were *not* allowed by Google Caja\n      a: [\n        'accesskey',\n        'coords',\n        'href',\n        'hreflang',\n        'name',\n        'rel',\n        'shape',\n        'tabindex',\n        'target',\n        'type'\n      ],\n      area: [\n        'accesskey',\n        'alt',\n        'coords',\n        'href',\n        'nohref',\n        'shape',\n        'tabindex'\n      ],\n      // 'autoplay' was *not* allowed by Google Caja\n      audio: [\n        'autoplay',\n        'controls',\n        'loop',\n        'mediagroup',\n        'muted',\n        'preload',\n        'src'\n      ],\n      bdo: ['dir'],\n      blockquote: ['cite'],\n      br: ['clear'],\n      button: [\n        'accesskey',\n        'data-commandlinker-args',\n        'data-commandlinker-command',\n        'disabled',\n        'name',\n        'tabindex',\n        'type',\n        'value'\n      ],\n      canvas: ['height', 'width'],\n      caption: ['align'],\n      col: ['align', 'char', 'charoff', 'span', 'valign', 'width'],\n      colgroup: ['align', 'char', 'charoff', 'span', 'valign', 'width'],\n      command: [\n        'checked',\n        'command',\n        'disabled',\n        'icon',\n        'label',\n        'radiogroup',\n        'type'\n      ],\n      data: ['value'],\n      del: ['cite', 'datetime'],\n      details: ['open'],\n      dir: ['compact'],\n      div: ['align'],\n      dl: ['compact'],\n      fieldset: ['disabled'],\n      font: ['color', 'face', 'size'],\n      form: [\n        'accept',\n        'autocomplete',\n        'enctype',\n        'method',\n        'name',\n        'novalidate'\n      ],\n      h1: ['align'],\n      h2: ['align'],\n      h3: ['align'],\n      h4: ['align'],\n      h5: ['align'],\n      h6: ['align'],\n      hr: ['align', 'noshade', 'size', 'width'],\n      iframe: [\n        'align',\n        'frameborder',\n        'height',\n        'marginheight',\n        'marginwidth',\n        'width'\n      ],\n      img: [\n        'align',\n        'alt',\n        'border',\n        'height',\n        'hspace',\n        'ismap',\n        'name',\n        'src',\n        'usemap',\n        'vspace',\n        'width'\n      ],\n      input: [\n        'accept',\n        'accesskey',\n        'align',\n        'alt',\n        'autocomplete',\n        'checked',\n        'disabled',\n        'inputmode',\n        'ismap',\n        'list',\n        'max',\n        'maxlength',\n        'min',\n        'multiple',\n        'name',\n        'placeholder',\n        'readonly',\n        'required',\n        'size',\n        'src',\n        'step',\n        'tabindex',\n        'type',\n        'usemap',\n        'value'\n      ],\n      ins: ['cite', 'datetime'],\n      label: ['accesskey', 'for'],\n      legend: ['accesskey', 'align'],\n      li: ['type', 'value'],\n      map: ['name'],\n      menu: ['compact', 'label', 'type'],\n      meter: ['high', 'low', 'max', 'min', 'value'],\n      ol: ['compact', 'reversed', 'start', 'type'],\n      optgroup: ['disabled', 'label'],\n      option: ['disabled', 'label', 'selected', 'value'],\n      output: ['for', 'name'],\n      p: ['align'],\n      pre: ['width'],\n      progress: ['max', 'min', 'value'],\n      q: ['cite'],\n      select: [\n        'autocomplete',\n        'disabled',\n        'multiple',\n        'name',\n        'required',\n        'size',\n        'tabindex'\n      ],\n      source: ['type'],\n      table: [\n        'align',\n        'bgcolor',\n        'border',\n        'cellpadding',\n        'cellspacing',\n        'frame',\n        'rules',\n        'summary',\n        'width'\n      ],\n      tbody: ['align', 'char', 'charoff', 'valign'],\n      td: [\n        'abbr',\n        'align',\n        'axis',\n        'bgcolor',\n        'char',\n        'charoff',\n        'colspan',\n        'headers',\n        'height',\n        'nowrap',\n        'rowspan',\n        'scope',\n        'valign',\n        'width'\n      ],\n      textarea: [\n        'accesskey',\n        'autocomplete',\n        'cols',\n        'disabled',\n        'inputmode',\n        'name',\n        'placeholder',\n        'readonly',\n        'required',\n        'rows',\n        'tabindex',\n        'wrap'\n      ],\n      tfoot: ['align', 'char', 'charoff', 'valign'],\n      th: [\n        'abbr',\n        'align',\n        'axis',\n        'bgcolor',\n        'char',\n        'charoff',\n        'colspan',\n        'headers',\n        'height',\n        'nowrap',\n        'rowspan',\n        'scope',\n        'valign',\n        'width'\n      ],\n      thead: ['align', 'char', 'charoff', 'valign'],\n      tr: ['align', 'bgcolor', 'char', 'charoff', 'valign'],\n      track: ['default', 'kind', 'label', 'srclang'],\n      ul: ['compact', 'type'],\n      video: [\n        'autoplay',\n        'controls',\n        'height',\n        'loop',\n        'mediagroup',\n        'muted',\n        'poster',\n        'preload',\n        'src',\n        'width'\n      ]\n    },\n    // Inline CSS styles that HTML tags may have (and their allowed values)\n    allowedStyles: {\n      // To simplify the data, all styles are allowed on all tags that allow the style attribute\n      '*': {\n        'backface-visibility': [CssProp.BACKFACE_VISIBILITY],\n        background: [CssProp.BACKGROUND],\n        'background-attachment': [CssProp.BACKGROUND_ATTACHMENT],\n        'background-clip': [CssProp.BACKGROUND_CLIP],\n        'background-color': [CssProp.BACKGROUND_COLOR],\n        'background-image': [CssProp.BACKGROUND_IMAGE],\n        'background-origin': [CssProp.BACKGROUND_ORIGIN],\n        'background-position': [CssProp.BACKGROUND_POSITION],\n        'background-repeat': [CssProp.BACKGROUND_REPEAT],\n        'background-size': [CssProp.BACKGROUND_SIZE],\n        border: [CssProp.BORDER],\n        'border-bottom': [CssProp.BORDER_BOTTOM],\n        'border-bottom-color': [CssProp.BORDER_BOTTOM_COLOR],\n        'border-bottom-left-radius': [CssProp.BORDER_BOTTOM_LEFT_RADIUS],\n        'border-bottom-right-radius': [CssProp.BORDER_BOTTOM_RIGHT_RADIUS],\n        'border-bottom-style': [CssProp.BORDER_BOTTOM_STYLE],\n        'border-bottom-width': [CssProp.BORDER_BOTTOM_WIDTH],\n        'border-collapse': [CssProp.BORDER_COLLAPSE],\n        'border-color': [CssProp.BORDER_COLOR],\n        'border-left': [CssProp.BORDER_LEFT],\n        'border-left-color': [CssProp.BORDER_LEFT_COLOR],\n        'border-left-style': [CssProp.BORDER_LEFT_STYLE],\n        'border-left-width': [CssProp.BORDER_LEFT_WIDTH],\n        'border-radius': [CssProp.BORDER_RADIUS],\n        'border-right': [CssProp.BORDER_RIGHT],\n        'border-right-color': [CssProp.BORDER_RIGHT_COLOR],\n        'border-right-style': [CssProp.BORDER_RIGHT_STYLE],\n        'border-right-width': [CssProp.BORDER_RIGHT_WIDTH],\n        'border-spacing': [CssProp.BORDER_SPACING],\n        'border-style': [CssProp.BORDER_STYLE],\n        'border-top': [CssProp.BORDER_TOP],\n        'border-top-color': [CssProp.BORDER_TOP_COLOR],\n        'border-top-left-radius': [CssProp.BORDER_TOP_LEFT_RADIUS],\n        'border-top-right-radius': [CssProp.BORDER_TOP_RIGHT_RADIUS],\n        'border-top-style': [CssProp.BORDER_TOP_STYLE],\n        'border-top-width': [CssProp.BORDER_TOP_WIDTH],\n        'border-width': [CssProp.BORDER_WIDTH],\n        bottom: [CssProp.BOTTOM],\n        box: [CssProp.BOX],\n        'box-shadow': [CssProp.BOX_SHADOW],\n        'box-sizing': [CssProp.BOX_SIZING],\n        'caption-side': [CssProp.CAPTION_SIDE],\n        clear: [CssProp.CLEAR],\n        clip: [CssProp.CLIP],\n        color: [CssProp.COLOR],\n        cursor: [CssProp.CURSOR],\n        direction: [CssProp.DIRECTION],\n        display: [CssProp.DISPLAY],\n        'display-inside': [CssProp.DISPLAY_INSIDE],\n        'display-outside': [CssProp.DISPLAY_OUTSIDE],\n        elevation: [CssProp.ELEVATION],\n        'empty-cells': [CssProp.EMPTY_CELLS],\n        float: [CssProp.FLOAT],\n        font: [CssProp.FONT],\n        'font-family': [CssProp.FONT_FAMILY],\n        'font-size': [CssProp.FONT_SIZE],\n        'font-stretch': [CssProp.FONT_STRETCH],\n        'font-style': [CssProp.FONT_STYLE],\n        'font-variant': [CssProp.FONT_VARIANT],\n        'font-weight': [CssProp.FONT_WEIGHT],\n        height: [CssProp.HEIGHT],\n        left: [CssProp.LEFT],\n        'letter-spacing': [CssProp.LETTER_SPACING],\n        'line-height': [CssProp.LINE_HEIGHT],\n        'list-style': [CssProp.LIST_STYLE],\n        'list-style-image': [CssProp.LIST_STYLE_IMAGE],\n        'list-style-position': [CssProp.LIST_STYLE_POSITION],\n        'list-style-type': [CssProp.LIST_STYLE_TYPE],\n        margin: [CssProp.MARGIN],\n        'margin-bottom': [CssProp.MARGIN_BOTTOM],\n        'margin-left': [CssProp.MARGIN_LEFT],\n        'margin-right': [CssProp.MARGIN_RIGHT],\n        'margin-top': [CssProp.MARGIN_TOP],\n        'max-height': [CssProp.MAX_HEIGHT],\n        'max-width': [CssProp.MAX_WIDTH],\n        'min-height': [CssProp.MIN_HEIGHT],\n        'min-width': [CssProp.MIN_WIDTH],\n        opacity: [CssProp.OPACITY],\n        outline: [CssProp.OUTLINE],\n        'outline-color': [CssProp.OUTLINE_COLOR],\n        'outline-style': [CssProp.OUTLINE_STYLE],\n        'outline-width': [CssProp.OUTLINE_WIDTH],\n        overflow: [CssProp.OVERFLOW],\n        'overflow-wrap': [CssProp.OVERFLOW_WRAP],\n        'overflow-x': [CssProp.OVERFLOW_X],\n        'overflow-y': [CssProp.OVERFLOW_Y],\n        padding: [CssProp.PADDING],\n        'padding-bottom': [CssProp.PADDING_BOTTOM],\n        'padding-left': [CssProp.PADDING_LEFT],\n        'padding-right': [CssProp.PADDING_RIGHT],\n        'padding-top': [CssProp.PADDING_TOP],\n        'page-break-after': [CssProp.PAGE_BREAK_AFTER],\n        'page-break-before': [CssProp.PAGE_BREAK_BEFORE],\n        'page-break-inside': [CssProp.PAGE_BREAK_INSIDE],\n        'pause-after': [CssProp.PAUSE_AFTER],\n        perspective: [CssProp.PERSPECTIVE],\n        pitch: [CssProp.PITCH],\n        'pitch-range': [CssProp.PITCH_RANGE],\n        position: [CssProp.POSITION],\n        quotes: [CssProp.QUOTES],\n        resize: [CssProp.RESIZE],\n        richness: [CssProp.RICHNESS],\n        right: [CssProp.RIGHT],\n        speak: [CssProp.SPEAK],\n        'speak-header': [CssProp.SPEAK_HEADER],\n        'speak-numeral': [CssProp.SPEAK_NUMERAL],\n        'speak-punctuation': [CssProp.SPEAK_PUNCTUATION],\n        'speech-rate': [CssProp.SPEECH_RATE],\n        stress: [CssProp.STRESS],\n        'table-layout': [CssProp.TABLE_LAYOUT],\n        'text-align': [CssProp.TEXT_ALIGN],\n        'text-decoration': [CssProp.TEXT_DECORATION],\n        'text-indent': [CssProp.TEXT_INDENT],\n        'text-overflow': [CssProp.TEXT_OVERFLOW],\n        'text-shadow': [CssProp.TEXT_SHADOW],\n        'text-transform': [CssProp.TEXT_TRANSFORM],\n        'text-wrap': [CssProp.TEXT_WRAP],\n        top: [CssProp.TOP],\n        'unicode-bidi': [CssProp.UNICODE_BIDI],\n        'vertical-align': [CssProp.VERTICAL_ALIGN],\n        visibility: [CssProp.VISIBILITY],\n        volume: [CssProp.VOLUME],\n        'white-space': [CssProp.WHITE_SPACE],\n        width: [CssProp.WIDTH],\n        'word-break': [CssProp.WORD_BREAK],\n        'word-spacing': [CssProp.WORD_SPACING],\n        'word-wrap': [CssProp.WORD_WRAP],\n        'z-index': [CssProp.Z_INDEX],\n        zoom: [CssProp.ZOOM]\n      }\n    },\n    transformTags: {\n      // Set the \"rel\" attribute for <a> tags to \"nofollow\".\n      a: sanitize.simpleTransform('a', { rel: 'nofollow' }),\n      // Set the \"disabled\" attribute for <input> tags.\n      input: sanitize.simpleTransform('input', { disabled: 'disabled' })\n    },\n    allowedSchemesByTag: {\n      // Allow 'attachment:' img src (used for markdown cell attachments).\n      img: sanitize.defaults.allowedSchemes.concat(['attachment'])\n    },\n    // Override of the default option, so we can skip 'src' attribute validation.\n    // 'src' Attributes are validated to be URIs, which does not allow for embedded (image) data.\n    // Since embedded data is no longer deemed to be a threat, validation can be skipped.\n    // See https://github.com/jupyterlab/jupyterlab/issues/5183\n    allowedSchemesAppliedToAttributes: ['href', 'cite']\n  };\n}\n\n/**\n * The default instance of an `ISanitizer` meant for use by user code.\n */\nexport const defaultSanitizer: ISanitizer = new Sanitizer();\n", "code_before": "// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// sanitize-html uses the url package, so we depend on a standalone version of\n// it which acts as a polyfill for browsers.\nimport sanitize from 'sanitize-html';\nimport { ISanitizer } from './tokens';\n\n/**\n * Helper class that contains regular expressions for inline CSS style validation.\n *\n * Which properties (and values) to allow is largely based on the Google Caja project:\n *   https://github.com/google/caja\n *\n * The regular expressions are largly based on the syntax definition found at\n * https://developer.mozilla.org/en-US/docs/Web/CSS.\n */\nclass CssProp {\n  static reg(r: string): RegExp {\n    return new RegExp('^' + r + '$', 'i');\n  }\n\n  /*\n   * Numeric base expressions used to help build more complex regular expressions\n   */\n  private static readonly N = {\n    integer: `[+-]?[0-9]+`,\n    integer_pos: `[+]?[0-9]+`,\n    integer_zero_ff: `([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])`,\n    number: `[+-]?([0-9]*[.])?[0-9]+(e-?[0-9]*)?`,\n    number_pos: `[+]?([0-9]*[.])?[0-9]+(e-?[0-9]*)?`,\n    number_zero_hundred: `[+]?(([0-9]|[1-9][0-9])([.][0-9]+)?|100)`,\n    number_zero_one: `[+]?(1([.][0]+)?|0([.][0-9]+)?)`\n  };\n\n  /*\n   * Base expressions of common CSS syntax elements\n   */\n  private static readonly B = {\n    angle: `(${CssProp.N.number}(deg|rad|grad|turn)|0)`,\n    frequency: `${CssProp.N.number}(Hz|kHz)`,\n    ident: String.raw`-?([_a-z]|[\\xA0-\\xFF]|\\\\[0-9a-f]{1,6}(\\r\\n|[ \\t\\r\\n\\f])?|\\\\[^\\r\\n\\f0-9a-f])([_a-z0-9-]|[\\xA0-\\xFF]|\\\\[0-9a-f]{1,6}(\\r\\n|[ \\t\\r\\n\\f])?|\\\\[^\\r\\n\\f0-9a-f])*`,\n    len_or_perc: `(0|${CssProp.N.number}(px|em|rem|ex|in|cm|mm|pt|pc|%))`,\n    length: `(${CssProp.N.number}(px|em|rem|ex|in|cm|mm|pt|pc)|0)`,\n    length_pos: `(${CssProp.N.number_pos}(px|em|rem|ex|in|cm|mm|pt|pc)|0)`,\n    percentage: `${CssProp.N.number}%`,\n    percentage_pos: `${CssProp.N.number_pos}%`,\n    percentage_zero_hundred: `${CssProp.N.number_zero_hundred}%`,\n    string: String.raw`(\\\"([^\\n\\r\\f\\\\\"]|\\\\\\n|\\r\\n|\\r|\\f|\\\\[0-9a-f]{1,6}(\\r\\n|[ \\t\\r\\n\\f])?|\\\\[^\\r\\n\\f0-9a-f])*\\\")|(\\'([^\\n\\r\\f\\\\']|\\\\\\n|\\r\\n|\\r|\\f|\\\\[0-9a-f]{1,6}(\\r\\n|[ \\t\\r\\n\\f])?|\\\\[^\\r\\n\\f0-9a-f])*\\')`,\n    time: `${CssProp.N.number}(s|ms)`,\n    url: `url\\\\(.*?\\\\)`,\n    z_index: `[+-]?[0-9]{1,7}`\n  };\n\n  /*\n   * Atomic (i.e. not dependant on other regular expressions) sub RegEx segments\n   */\n  private static readonly A = {\n    absolute_size: `xx-small|x-small|small|medium|large|x-large|xx-large`,\n    attachment: `scroll|fixed|local`,\n    bg_origin: `border-box|padding-box|content-box`,\n    border_style: `none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset`,\n    box: `border-box|padding-box|content-box`,\n    display_inside: `auto|block|table|flex|grid`,\n    display_outside: `block-level|inline-level|none|table-row-group|table-header-group|table-footer-group|table-row|table-cell|table-column-group|table-column|table-caption`,\n    ending_shape: `circle|ellipse`,\n    generic_family: `serif|sans-serif|cursive|fantasy|monospace`,\n    generic_voice: `male|female|child`,\n    relative_size: `smaller|larger`,\n    repeat_style: `repeat-x|repeat-y|((?:repeat|space|round|no-repeat)(?:\\\\s*(?:repeat|space|round|no-repeat))?)`,\n    side_or_corner: `(left|right)?\\\\s*(top|bottom)?`,\n    single_animation_direction: `normal|reverse|alternate|alternate-reverse`,\n    single_animation_fill_mode: `none|forwards|backwards|both`,\n    single_animation_play_state: `running|paused`\n  };\n\n  /*\n   * Color definition sub expressions\n   */\n  private static readonly _COLOR = {\n    hex: `\\\\#(0x)?[0-9a-f]+`,\n    name: `aliceblue|antiquewhite|aqua|aquamarine|azure|beige|bisque|black|blanchedalmond|blue|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgreen|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dodgerblue|firebrick|floralwhite|forestgreen|fuchsia|gainsboro|ghostwhite|gold|goldenrod|gray|green|greenyellow|honeydew|hotpink|indianred|indigo|ivory|khaki|lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgreen|lightgrey|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lightsteelblue|lightyellow|lime|limegreen|linen|magenta|maroon|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|navy|oldlace|olive|olivedrab|orange|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|purple|red|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|silver|skyblue|slateblue|slategray|snow|springgreen|steelblue|tan|teal|thistle|tomato|turquoise|transparent|violet|wheat|white|whitesmoke|yellow|yellowgreen`,\n    rgb: String.raw`rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)`,\n    rgba: String.raw`rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(${CssProp.N.integer_zero_ff}|${CssProp.N.number_zero_one}|${CssProp.B.percentage_zero_hundred})\\s*\\)`\n  };\n\n  /*\n   * Compound (i.e. dependant on other (sub) regular expressions) sub RegEx segments\n   */\n  private static readonly _C = {\n    alpha: `${CssProp.N.integer_zero_ff}|${CssProp.N.number_zero_one}|${CssProp.B.percentage_zero_hundred}`,\n    alphavalue: CssProp.N.number_zero_one,\n    bg_position: `((${CssProp.B.len_or_perc}|left|center|right|top|bottom)\\\\s*){1,4}`,\n    bg_size: `(${CssProp.B.length_pos}|${CssProp.B.percentage}|auto){1,2}|cover|contain`,\n    border_width: `thin|medium|thick|${CssProp.B.length}`,\n    bottom: `${CssProp.B.length}|auto`,\n    color: `${CssProp._COLOR.hex}|${CssProp._COLOR.rgb}|${CssProp._COLOR.rgba}|${CssProp._COLOR.name}`,\n    family_name: `${CssProp.B.string}|(${CssProp.B.ident}\\\\s*)+`,\n    image_decl: CssProp.B.url,\n    left: `${CssProp.B.length}|auto`,\n    loose_quotable_words: `(${CssProp.B.ident})+`,\n    margin_width: `${CssProp.B.len_or_perc}|auto`,\n    padding_width: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}`,\n    page_url: CssProp.B.url,\n    position: `((${CssProp.B.len_or_perc}|left|center|right|top|bottom)\\\\s*){1,4}`,\n    right: `${CssProp.B.length}|auto`,\n    shadow: '',\n    size: `closest-side|farthest-side|closest-corner|farthest-corner|${CssProp.B.length}|(${CssProp.B.len_or_perc})\\\\s+(${CssProp.B.len_or_perc})`,\n    top: `${CssProp.B.length}|auto`\n  };\n\n  private static readonly _C1 = {\n    image_list: `image\\\\(\\\\s*(${CssProp.B.url})*\\\\s*(${CssProp.B.url}|${CssProp._C.color})\\\\s*\\\\)`,\n    shadow: `((${CssProp._C.color})\\\\s+((${CssProp.B.length})\\\\s*){2,4}(\\s+inset)?)|((inset\\\\s+)?((${CssProp.B.length})\\\\s*){2,4}\\\\s*(${CssProp._C.color})?)`\n  };\n\n  private static readonly _C2 = {\n    bg_image: `(${CssProp.B.url}|${CssProp._C1.image_list})|none`,\n    image: `${CssProp.B.url}|${CssProp._C1.image_list}`,\n    shape: `rect\\\\(\\\\s*(${CssProp._C.top})\\\\s*,\\\\s*(${CssProp._C.right})\\\\s*,\\\\s*(${CssProp._C.bottom})\\\\s*,\\\\s*(${CssProp._C.left})\\\\s*\\\\)`\n  };\n\n  private static readonly C = { ...CssProp._C, ...CssProp._C1, ...CssProp._C2 };\n\n  /*\n   * Property value regular expressions not dependant on other sub expressions\n   */\n  private static readonly AP = {\n    border_collapse: `collapse|separate`,\n    box: `normal|none|contents`,\n    box_sizing: `content-box|padding-box|border-box`,\n    caption_side: `top|bottom`,\n    clear: `none|left|right|both`,\n    direction: `ltr|rtl`,\n    empty_cells: `show|hide`,\n    float: `left|right|none`,\n    font_stretch: `normal|wider|narrower|ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded`,\n    font_style: `normal|italic|oblique`,\n    font_variant: `normal|small-caps`,\n    font_weight: `normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900`,\n    list_style_position: `inside|outside`,\n    list_style_type: `disc|circle|square|decimal|decimal-leading-zero|lower-roman|upper-roman|lower-greek|lower-latin|upper-latin|armenian|georgian|lower-alpha|upper-alpha|none`,\n    overflow: `visible|hidden|scroll|auto`,\n    overflow_wrap: `normal|break-word`,\n    overflow_x: `visible|hidden|scroll|auto|no-display|no-content`,\n    page_break_after: `auto|always|avoid|left|right`,\n    page_break_before: `auto|always|avoid|left|right`,\n    page_break_inside: `avoid|auto`,\n    position: `static|relative|absolute`,\n    resize: `none|both|horizontal|vertical`,\n    speak: `normal|none|spell-out`,\n    speak_header: `once|always`,\n    speak_numeral: `digits|continuous`,\n    speak_punctuation: `code|none`,\n    table_layout: `auto|fixed`,\n    text_align: `left|right|center|justify`,\n    text_decoration: `none|((underline|overline|line-through|blink)\\\\s*)+`,\n    text_transform: `capitalize|uppercase|lowercase|none`,\n    text_wrap: `normal|unrestricted|none|suppress`,\n    unicode_bidi: `normal|embed|bidi-override`,\n    visibility: `visible|hidden|collapse`,\n    white_space: `normal|pre|nowrap|pre-wrap|pre-line`,\n    word_break: `normal|keep-all|break-all`\n  };\n\n  /*\n   * Compound propertiy value regular expressions (i.e. dependant on other sub expressions)\n   */\n  private static readonly _CP = {\n    background_attachment: `${CssProp.A.attachment}(,\\\\s*${CssProp.A.attachment})*`,\n    background_color: CssProp.C.color,\n    background_origin: `${CssProp.A.box}(,\\\\s*${CssProp.A.box})*`,\n    background_repeat: `${CssProp.A.repeat_style}(,\\\\s*${CssProp.A.repeat_style})*`,\n    border: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    border_radius: `((${CssProp.B.len_or_perc})\\\\s*){1,4}(\\\\/\\\\s*((${CssProp.B.len_or_perc})\\\\s*){1,4})?`,\n    border_spacing: `${CssProp.B.length}\\\\s*(${CssProp.B.length})?`,\n    border_top_color: CssProp.C.color,\n    border_top_style: CssProp.A.border_style,\n    border_width: `((${CssProp.C.border_width})\\\\s*){1,4}`,\n    color: CssProp.C.color,\n    cursor: `(${CssProp.B.url}(\\\\s*,\\\\s*)?)*(auto|crosshair|default|pointer|move|e-resize|ne-resize|nw-resize|n-resize|se-resize|sw-resize|s-resize|w-resize|text|wait|help|progress|all-scroll|col-resize|hand|no-drop|not-allowed|row-resize|vertical-text)`,\n    display: `inline|block|list-item|run-in|inline-list-item|inline-block|table|inline-table|table-cell|table-caption|flex|inline-flex|grid|inline-grid|${CssProp.A.display_inside}|${CssProp.A.display_outside}|inherit|inline-box|inline-stack`,\n    display_outside: CssProp.A.display_outside,\n    elevation: `${CssProp.B.angle}|below|level|above|higher|lower`,\n    font_family: `(${CssProp.C.family_name}|${CssProp.A.generic_family})(,\\\\s*(${CssProp.C.family_name}|${CssProp.A.generic_family}))*`,\n    height: `${CssProp.B.length}|${CssProp.B.percentage}|auto`,\n    letter_spacing: `normal|${CssProp.B.length}`,\n    list_style_image: `${CssProp.C.image}|none`,\n    margin_right: CssProp.C.margin_width,\n    max_height: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|none|auto`,\n    min_height: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|auto`,\n    opacity: CssProp.C.alphavalue,\n    outline_color: `${CssProp.C.color}|invert`,\n    outline_width: CssProp.C.border_width,\n    padding: `((${CssProp.C.padding_width})\\\\s*){1,4}`,\n    padding_top: CssProp.C.padding_width,\n    pitch_range: CssProp.N.number,\n    right: `${CssProp.B.length}|${CssProp.B.percentage}|auto`,\n    stress: CssProp.N.number,\n    text_indent: `${CssProp.B.length}|${CssProp.B.percentage}`,\n    text_shadow: `none|${CssProp.C.shadow}(,\\\\s*(${CssProp.C.shadow}))*`,\n    volume: `${CssProp.N.number_pos}|${CssProp.B.percentage_pos}|silent|x-soft|soft|medium|loud|x-loud`,\n    word_wrap: CssProp.AP.overflow_wrap,\n    zoom: `normal|${CssProp.N.number_pos}|${CssProp.B.percentage_pos}`,\n    backface_visibility: CssProp.AP.visibility,\n    background_clip: `${CssProp.A.box}(,\\\\s*(${CssProp.A.box}))*`,\n    background_position: `${CssProp.C.bg_position}(,\\\\s*(${CssProp.C.bg_position}))*`,\n    border_bottom_color: CssProp.C.color,\n    border_bottom_style: CssProp.A.border_style,\n    border_color: `((${CssProp.C.color})\\\\s*){1,4}`,\n    border_left_color: CssProp.C.color,\n    border_right_color: CssProp.C.color,\n    border_style: `((${CssProp.A.border_style})\\\\s*){1,4}`,\n    border_top_left_radius: `(${CssProp.B.length}|${CssProp.B.percentage})(\\\\s*(${CssProp.B.length}|${CssProp.B.percentage}))?`,\n    border_top_width: CssProp.C.border_width,\n    box_shadow: `none|${CssProp.C.shadow}(,\\\\s*(${CssProp.C.shadow}))*`,\n    clip: `${CssProp.C.shape}|auto`,\n    display_inside: CssProp.A.display_inside,\n    font_size: `${CssProp.A.absolute_size}|${CssProp.A.relative_size}|${CssProp.B.length_pos}|${CssProp.B.percentage_pos}`,\n    line_height: `normal|${CssProp.N.number_pos}|${CssProp.B.length_pos}|${CssProp.B.percentage_pos}`,\n    margin_left: CssProp.C.margin_width,\n    max_width: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|none|auto`,\n    outline_style: CssProp.A.border_style,\n    padding_bottom: CssProp.C.padding_width,\n    padding_right: CssProp.C.padding_width,\n    perspective: `none|${CssProp.B.length}`,\n    richness: CssProp.N.number,\n    text_overflow: `((clip|ellipsis|${CssProp.B.string})\\\\s*){1,2}`,\n    top: `${CssProp.B.length}|${CssProp.B.percentage}|auto`,\n    width: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|auto`,\n    z_index: `auto|${CssProp.B.z_index}`,\n    // Simplified background\n    background: `(((${CssProp.C.bg_position}\\\\s*(\\\\/\\\\s*${CssProp.C.bg_size})?)|(${CssProp.A.repeat_style})|(${CssProp.A.attachment})|(${CssProp.A.bg_origin})|(${CssProp.C.bg_image})|(${CssProp.C.color}))\\\\s*)+`,\n    background_size: `${CssProp.C.bg_size}(,\\\\s*${CssProp.C.bg_size})*`,\n    border_bottom_left_radius: `(${CssProp.B.length}|${CssProp.B.percentage})(\\\\s*(${CssProp.B.length}|${CssProp.B.percentage}))?`,\n    border_bottom_width: CssProp.C.border_width,\n    border_left_style: CssProp.A.border_style,\n    border_right_style: CssProp.A.border_style,\n    border_top: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    bottom: `${CssProp.B.len_or_perc}|auto`,\n    list_style: `((${CssProp.AP.list_style_type}|${CssProp.AP.list_style_position}|${CssProp.C.image}|none})\\\\s*){1,3}`,\n    margin_top: CssProp.C.margin_width,\n    outline: `((${CssProp.C.color}|invert|${CssProp.A.border_style}|${CssProp.C.border_width})\\\\s*){1,3}`,\n    overflow_y: CssProp.AP.overflow_x,\n    pitch: `${CssProp.B.frequency}|x-low|low|medium|high|x-high`,\n    vertical_align: `baseline|sub|super|top|text-top|middle|bottom|text-bottom|${CssProp.B.len_or_perc}`,\n    word_spacing: `normal|${CssProp.B.length}`,\n    background_image: `${CssProp.C.bg_image}(,\\\\s*${CssProp.C.bg_image})*`,\n    border_bottom_right_radius: `(${CssProp.B.length}|${CssProp.B.percentage})(\\\\s*(${CssProp.B.length}|${CssProp.B.percentage}))?`,\n    border_left_width: CssProp.C.border_width,\n    border_right_width: CssProp.C.border_width,\n    left: `${CssProp.B.len_or_perc}|auto`,\n    margin_bottom: CssProp.C.margin_width,\n    pause_after: `${CssProp.B.time}|${CssProp.B.percentage}`,\n    speech_rate: `${CssProp.N.number}|x-slow|slow|medium|fast|x-fast|faster|slower`,\n    transition_duration: `${CssProp.B.time}(,\\\\s*${CssProp.B.time})*`,\n    border_bottom: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    border_right: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    margin: `((${CssProp.C.margin_width})\\\\s*){1,4}`,\n    padding_left: CssProp.C.padding_width,\n    border_left: `((${CssProp.C.border_width}|${CssProp.A.border_style}|${CssProp.C.color})\\\\s*){1,3}`,\n    quotes: `(${CssProp.B.string}\\\\s*${CssProp.B.string})+|none`,\n    border_top_right_radius: `(${CssProp.B.length}|${CssProp.B.percentage})(\\\\s*(${CssProp.B.length}|${CssProp.B.percentage}))?`,\n    min_width: `${CssProp.B.length_pos}|${CssProp.B.percentage_pos}|auto`\n  };\n\n  private static readonly _CP1 = {\n    font: `(((((${CssProp.AP.font_style}|${CssProp.AP.font_variant}|${CssProp.AP.font_weight})\\\\s*){1,3})?\\\\s*(${CssProp._CP.font_size})\\\\s*(\\\\/\\\\s*(${CssProp._CP.line_height}))?\\\\s+(${CssProp._CP.font_family}))|caption|icon|menu|message-box|small-caption|status-bar)`\n  };\n\n  private static readonly CP = { ...CssProp._CP, ...CssProp._CP1 };\n\n  // CSS Property value validation regular expressions for use with sanitize-html\n\n  static BORDER_COLLAPSE = CssProp.reg(CssProp.AP.border_collapse);\n  static BOX = CssProp.reg(CssProp.AP.box);\n  static BOX_SIZING = CssProp.reg(CssProp.AP.box_sizing);\n  static CAPTION_SIDE = CssProp.reg(CssProp.AP.caption_side);\n  static CLEAR = CssProp.reg(CssProp.AP.clear);\n  static DIRECTION = CssProp.reg(CssProp.AP.direction);\n  static EMPTY_CELLS = CssProp.reg(CssProp.AP.empty_cells);\n  static FLOAT = CssProp.reg(CssProp.AP.float);\n  static FONT_STRETCH = CssProp.reg(CssProp.AP.font_stretch);\n  static FONT_STYLE = CssProp.reg(CssProp.AP.font_style);\n  static FONT_VARIANT = CssProp.reg(CssProp.AP.font_variant);\n  static FONT_WEIGHT = CssProp.reg(CssProp.AP.font_weight);\n  static LIST_STYLE_POSITION = CssProp.reg(CssProp.AP.list_style_position);\n  static LIST_STYLE_TYPE = CssProp.reg(CssProp.AP.list_style_type);\n  static OVERFLOW = CssProp.reg(CssProp.AP.overflow);\n  static OVERFLOW_WRAP = CssProp.reg(CssProp.AP.overflow_wrap);\n  static OVERFLOW_X = CssProp.reg(CssProp.AP.overflow_x);\n  static PAGE_BREAK_AFTER = CssProp.reg(CssProp.AP.page_break_after);\n  static PAGE_BREAK_BEFORE = CssProp.reg(CssProp.AP.page_break_before);\n  static PAGE_BREAK_INSIDE = CssProp.reg(CssProp.AP.page_break_inside);\n  static POSITION = CssProp.reg(CssProp.AP.position);\n  static RESIZE = CssProp.reg(CssProp.AP.resize);\n  static SPEAK = CssProp.reg(CssProp.AP.speak);\n  static SPEAK_HEADER = CssProp.reg(CssProp.AP.speak_header);\n  static SPEAK_NUMERAL = CssProp.reg(CssProp.AP.speak_numeral);\n  static SPEAK_PUNCTUATION = CssProp.reg(CssProp.AP.speak_punctuation);\n  static TABLE_LAYOUT = CssProp.reg(CssProp.AP.table_layout);\n  static TEXT_ALIGN = CssProp.reg(CssProp.AP.text_align);\n  static TEXT_DECORATION = CssProp.reg(CssProp.AP.text_decoration);\n  static TEXT_TRANSFORM = CssProp.reg(CssProp.AP.text_transform);\n  static TEXT_WRAP = CssProp.reg(CssProp.AP.text_wrap);\n  static UNICODE_BIDI = CssProp.reg(CssProp.AP.unicode_bidi);\n  static VISIBILITY = CssProp.reg(CssProp.AP.visibility);\n  static WHITE_SPACE = CssProp.reg(CssProp.AP.white_space);\n  static WORD_BREAK = CssProp.reg(CssProp.AP.word_break);\n\n  static BACKGROUND_ATTACHMENT = CssProp.reg(CssProp.CP.background_attachment);\n  static BACKGROUND_COLOR = CssProp.reg(CssProp.CP.background_color);\n  static BACKGROUND_ORIGIN = CssProp.reg(CssProp.CP.background_origin);\n  static BACKGROUND_REPEAT = CssProp.reg(CssProp.CP.background_repeat);\n  static BORDER = CssProp.reg(CssProp.CP.border);\n  static BORDER_RADIUS = CssProp.reg(CssProp.CP.border_radius);\n  static BORDER_SPACING = CssProp.reg(CssProp.CP.border_spacing);\n  static BORDER_TOP_COLOR = CssProp.reg(CssProp.CP.border_top_color);\n  static BORDER_TOP_STYLE = CssProp.reg(CssProp.CP.border_top_style);\n  static BORDER_WIDTH = CssProp.reg(CssProp.CP.border_width);\n  static COLOR = CssProp.reg(CssProp.CP.color);\n  static CURSOR = CssProp.reg(CssProp.CP.cursor);\n  static DISPLAY = CssProp.reg(CssProp.CP.display);\n  static DISPLAY_OUTSIDE = CssProp.reg(CssProp.CP.display_outside);\n  static ELEVATION = CssProp.reg(CssProp.CP.elevation);\n  static FONT_FAMILY = CssProp.reg(CssProp.CP.font_family);\n  static HEIGHT = CssProp.reg(CssProp.CP.height);\n  static LETTER_SPACING = CssProp.reg(CssProp.CP.letter_spacing);\n  static LIST_STYLE_IMAGE = CssProp.reg(CssProp.CP.list_style_image);\n  static MARGIN_RIGHT = CssProp.reg(CssProp.CP.margin_right);\n  static MAX_HEIGHT = CssProp.reg(CssProp.CP.max_height);\n  static MIN_HEIGHT = CssProp.reg(CssProp.CP.min_height);\n  static OPACITY = CssProp.reg(CssProp.CP.opacity);\n  static OUTLINE_COLOR = CssProp.reg(CssProp.CP.outline_color);\n  static OUTLINE_WIDTH = CssProp.reg(CssProp.CP.outline_width);\n  static PADDING = CssProp.reg(CssProp.CP.padding);\n  static PADDING_TOP = CssProp.reg(CssProp.CP.padding_top);\n  static PITCH_RANGE = CssProp.reg(CssProp.CP.pitch_range);\n  static RIGHT = CssProp.reg(CssProp.CP.right);\n  static STRESS = CssProp.reg(CssProp.CP.stress);\n  static TEXT_INDENT = CssProp.reg(CssProp.CP.text_indent);\n  static TEXT_SHADOW = CssProp.reg(CssProp.CP.text_shadow);\n  static VOLUME = CssProp.reg(CssProp.CP.volume);\n  static WORD_WRAP = CssProp.reg(CssProp.CP.word_wrap);\n  static ZOOM = CssProp.reg(CssProp.CP.zoom);\n  static BACKFACE_VISIBILITY = CssProp.reg(CssProp.CP.backface_visibility);\n  static BACKGROUND_CLIP = CssProp.reg(CssProp.CP.background_clip);\n  static BACKGROUND_POSITION = CssProp.reg(CssProp.CP.background_position);\n  static BORDER_BOTTOM_COLOR = CssProp.reg(CssProp.CP.border_bottom_color);\n  static BORDER_BOTTOM_STYLE = CssProp.reg(CssProp.CP.border_bottom_style);\n  static BORDER_COLOR = CssProp.reg(CssProp.CP.border_color);\n  static BORDER_LEFT_COLOR = CssProp.reg(CssProp.CP.border_left_color);\n  static BORDER_RIGHT_COLOR = CssProp.reg(CssProp.CP.border_right_color);\n  static BORDER_STYLE = CssProp.reg(CssProp.CP.border_style);\n  static BORDER_TOP_LEFT_RADIUS = CssProp.reg(\n    CssProp.CP.border_top_left_radius\n  );\n  static BORDER_TOP_WIDTH = CssProp.reg(CssProp.CP.border_top_width);\n  static BOX_SHADOW = CssProp.reg(CssProp.CP.box_shadow);\n  static CLIP = CssProp.reg(CssProp.CP.clip);\n  static DISPLAY_INSIDE = CssProp.reg(CssProp.CP.display_inside);\n  static FONT_SIZE = CssProp.reg(CssProp.CP.font_size);\n  static LINE_HEIGHT = CssProp.reg(CssProp.CP.line_height);\n  static MARGIN_LEFT = CssProp.reg(CssProp.CP.margin_left);\n  static MAX_WIDTH = CssProp.reg(CssProp.CP.max_width);\n  static OUTLINE_STYLE = CssProp.reg(CssProp.CP.outline_style);\n  static PADDING_BOTTOM = CssProp.reg(CssProp.CP.padding_bottom);\n  static PADDING_RIGHT = CssProp.reg(CssProp.CP.padding_right);\n  static PERSPECTIVE = CssProp.reg(CssProp.CP.perspective);\n  static RICHNESS = CssProp.reg(CssProp.CP.richness);\n  static TEXT_OVERFLOW = CssProp.reg(CssProp.CP.text_overflow);\n  static TOP = CssProp.reg(CssProp.CP.top);\n  static WIDTH = CssProp.reg(CssProp.CP.width);\n  static Z_INDEX = CssProp.reg(CssProp.CP.z_index);\n  static BACKGROUND = CssProp.reg(CssProp.CP.background);\n  static BACKGROUND_SIZE = CssProp.reg(CssProp.CP.background_size);\n  static BORDER_BOTTOM_LEFT_RADIUS = CssProp.reg(\n    CssProp.CP.border_bottom_left_radius\n  );\n  static BORDER_BOTTOM_WIDTH = CssProp.reg(CssProp.CP.border_bottom_width);\n  static BORDER_LEFT_STYLE = CssProp.reg(CssProp.CP.border_left_style);\n  static BORDER_RIGHT_STYLE = CssProp.reg(CssProp.CP.border_right_style);\n  static BORDER_TOP = CssProp.reg(CssProp.CP.border_top);\n  static BOTTOM = CssProp.reg(CssProp.CP.bottom);\n  static LIST_STYLE = CssProp.reg(CssProp.CP.list_style);\n  static MARGIN_TOP = CssProp.reg(CssProp.CP.margin_top);\n  static OUTLINE = CssProp.reg(CssProp.CP.outline);\n  static OVERFLOW_Y = CssProp.reg(CssProp.CP.overflow_y);\n  static PITCH = CssProp.reg(CssProp.CP.pitch);\n  static VERTICAL_ALIGN = CssProp.reg(CssProp.CP.vertical_align);\n  static WORD_SPACING = CssProp.reg(CssProp.CP.word_spacing);\n  static BACKGROUND_IMAGE = CssProp.reg(CssProp.CP.background_image);\n  static BORDER_BOTTOM_RIGHT_RADIUS = CssProp.reg(\n    CssProp.CP.border_bottom_right_radius\n  );\n  static BORDER_LEFT_WIDTH = CssProp.reg(CssProp.CP.border_left_width);\n  static BORDER_RIGHT_WIDTH = CssProp.reg(CssProp.CP.border_right_width);\n  static LEFT = CssProp.reg(CssProp.CP.left);\n  static MARGIN_BOTTOM = CssProp.reg(CssProp.CP.margin_bottom);\n  static PAUSE_AFTER = CssProp.reg(CssProp.CP.pause_after);\n  static SPEECH_RATE = CssProp.reg(CssProp.CP.speech_rate);\n  static TRANSITION_DURATION = CssProp.reg(CssProp.CP.transition_duration);\n  static BORDER_BOTTOM = CssProp.reg(CssProp.CP.border_bottom);\n  static BORDER_RIGHT = CssProp.reg(CssProp.CP.border_right);\n  static MARGIN = CssProp.reg(CssProp.CP.margin);\n  static PADDING_LEFT = CssProp.reg(CssProp.CP.padding_left);\n  static BORDER_LEFT = CssProp.reg(CssProp.CP.border_left);\n  static FONT = CssProp.reg(CssProp.CP.font);\n  static QUOTES = CssProp.reg(CssProp.CP.quotes);\n  static BORDER_TOP_RIGHT_RADIUS = CssProp.reg(\n    CssProp.CP.border_top_right_radius\n  );\n  static MIN_WIDTH = CssProp.reg(CssProp.CP.min_width);\n}\n\n/**\n * A class to sanitize HTML strings.\n */\nexport class Sanitizer implements ISanitizer {\n  /**\n   * Sanitize an HTML string.\n   *\n   * @param dirty - The dirty text.\n   *\n   * @param options - The optional sanitization options.\n   *\n   * @returns The sanitized string.\n   */\n  sanitize(dirty: string, options?: ISanitizer.IOptions): string {\n    return sanitize(dirty, { ...this._options, ...(options || {}) });\n  }\n\n  private _options: sanitize.IOptions = {\n    // HTML tags that are allowed to be used. Tags were extracted from Google Caja\n    allowedTags: [\n      'a',\n      'abbr',\n      'acronym',\n      'address',\n      'area',\n      'article',\n      'aside',\n      'audio',\n      'b',\n      'bdi',\n      'bdo',\n      'big',\n      'blockquote',\n      'br',\n      'button',\n      'canvas',\n      'caption',\n      'center',\n      'cite',\n      'code',\n      'col',\n      'colgroup',\n      'colspan',\n      'command',\n      'data',\n      'datalist',\n      'dd',\n      'del',\n      'details',\n      'dfn',\n      'dir',\n      'div',\n      'dl',\n      'dt',\n      'em',\n      'fieldset',\n      'figcaption',\n      'figure',\n      'font',\n      'footer',\n      'form',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'header',\n      'hgroup',\n      'hr',\n      'i',\n      // 'iframe' is allowed by Google Caja, but disallowed by default by sanitize-html\n      // , 'iframe'\n      'img',\n      'input',\n      'ins',\n      'kbd',\n      'label',\n      'legend',\n      'li',\n      'map',\n      'mark',\n      'menu',\n      'meter',\n      'nav',\n      'nobr',\n      'ol',\n      'optgroup',\n      'option',\n      'output',\n      'p',\n      'pre',\n      'progress',\n      'q',\n      'rowspan',\n      's',\n      'samp',\n      'section',\n      'select',\n      'small',\n      'source',\n      'span',\n      'strike',\n      'strong',\n      'sub',\n      'summary',\n      'sup',\n      'table',\n      'tbody',\n      'td',\n      'textarea',\n      'tfoot',\n      'th',\n      'thead',\n      'time',\n      'tr',\n      'track',\n      'tt',\n      'u',\n      'ul',\n      'var',\n      'video',\n      'wbr'\n    ],\n    // Attributes that HTML tags are allowed to have, extracted from Google Caja.\n    // See https://github.com/jupyterlab/jupyterlab/issues/1812#issuecomment-285848435\n    allowedAttributes: {\n      '*': [\n        'class',\n        'dir',\n        'draggable',\n        'hidden',\n        'id',\n        'inert',\n        'itemprop',\n        'itemref',\n        'itemscope',\n        'lang',\n        'spellcheck',\n        'style',\n        'title',\n        'translate'\n      ],\n      // 'rel' and 'target' were *not* allowed by Google Caja\n      a: [\n        'accesskey',\n        'coords',\n        'href',\n        'hreflang',\n        'name',\n        'rel',\n        'shape',\n        'tabindex',\n        'target',\n        'type'\n      ],\n      area: [\n        'accesskey',\n        'alt',\n        'coords',\n        'href',\n        'nohref',\n        'shape',\n        'tabindex'\n      ],\n      // 'autoplay' was *not* allowed by Google Caja\n      audio: [\n        'autoplay',\n        'controls',\n        'loop',\n        'mediagroup',\n        'muted',\n        'preload',\n        'src'\n      ],\n      bdo: ['dir'],\n      blockquote: ['cite'],\n      br: ['clear'],\n      button: [\n        'accesskey',\n        'data-commandlinker-args',\n        'data-commandlinker-command',\n        'disabled',\n        'name',\n        'tabindex',\n        'type',\n        'value'\n      ],\n      canvas: ['height', 'width'],\n      caption: ['align'],\n      col: ['align', 'char', 'charoff', 'span', 'valign', 'width'],\n      colgroup: ['align', 'char', 'charoff', 'span', 'valign', 'width'],\n      command: [\n        'checked',\n        'command',\n        'disabled',\n        'icon',\n        'label',\n        'radiogroup',\n        'type'\n      ],\n      data: ['value'],\n      del: ['cite', 'datetime'],\n      details: ['open'],\n      dir: ['compact'],\n      div: ['align'],\n      dl: ['compact'],\n      fieldset: ['disabled'],\n      font: ['color', 'face', 'size'],\n      form: [\n        'accept',\n        'action',\n        'autocomplete',\n        'enctype',\n        'method',\n        'name',\n        'novalidate'\n      ],\n      h1: ['align'],\n      h2: ['align'],\n      h3: ['align'],\n      h4: ['align'],\n      h5: ['align'],\n      h6: ['align'],\n      hr: ['align', 'noshade', 'size', 'width'],\n      iframe: [\n        'align',\n        'frameborder',\n        'height',\n        'marginheight',\n        'marginwidth',\n        'width'\n      ],\n      img: [\n        'align',\n        'alt',\n        'border',\n        'height',\n        'hspace',\n        'ismap',\n        'name',\n        'src',\n        'usemap',\n        'vspace',\n        'width'\n      ],\n      input: [\n        'accept',\n        'accesskey',\n        'align',\n        'alt',\n        'autocomplete',\n        'checked',\n        'disabled',\n        'inputmode',\n        'ismap',\n        'list',\n        'max',\n        'maxlength',\n        'min',\n        'multiple',\n        'name',\n        'placeholder',\n        'readonly',\n        'required',\n        'size',\n        'src',\n        'step',\n        'tabindex',\n        'type',\n        'usemap',\n        'value'\n      ],\n      ins: ['cite', 'datetime'],\n      label: ['accesskey', 'for'],\n      legend: ['accesskey', 'align'],\n      li: ['type', 'value'],\n      map: ['name'],\n      menu: ['compact', 'label', 'type'],\n      meter: ['high', 'low', 'max', 'min', 'value'],\n      ol: ['compact', 'reversed', 'start', 'type'],\n      optgroup: ['disabled', 'label'],\n      option: ['disabled', 'label', 'selected', 'value'],\n      output: ['for', 'name'],\n      p: ['align'],\n      pre: ['width'],\n      progress: ['max', 'min', 'value'],\n      q: ['cite'],\n      select: [\n        'autocomplete',\n        'disabled',\n        'multiple',\n        'name',\n        'required',\n        'size',\n        'tabindex'\n      ],\n      source: ['type'],\n      table: [\n        'align',\n        'bgcolor',\n        'border',\n        'cellpadding',\n        'cellspacing',\n        'frame',\n        'rules',\n        'summary',\n        'width'\n      ],\n      tbody: ['align', 'char', 'charoff', 'valign'],\n      td: [\n        'abbr',\n        'align',\n        'axis',\n        'bgcolor',\n        'char',\n        'charoff',\n        'colspan',\n        'headers',\n        'height',\n        'nowrap',\n        'rowspan',\n        'scope',\n        'valign',\n        'width'\n      ],\n      textarea: [\n        'accesskey',\n        'autocomplete',\n        'cols',\n        'disabled',\n        'inputmode',\n        'name',\n        'placeholder',\n        'readonly',\n        'required',\n        'rows',\n        'tabindex',\n        'wrap'\n      ],\n      tfoot: ['align', 'char', 'charoff', 'valign'],\n      th: [\n        'abbr',\n        'align',\n        'axis',\n        'bgcolor',\n        'char',\n        'charoff',\n        'colspan',\n        'headers',\n        'height',\n        'nowrap',\n        'rowspan',\n        'scope',\n        'valign',\n        'width'\n      ],\n      thead: ['align', 'char', 'charoff', 'valign'],\n      tr: ['align', 'bgcolor', 'char', 'charoff', 'valign'],\n      track: ['default', 'kind', 'label', 'srclang'],\n      ul: ['compact', 'type'],\n      video: [\n        'autoplay',\n        'controls',\n        'height',\n        'loop',\n        'mediagroup',\n        'muted',\n        'poster',\n        'preload',\n        'src',\n        'width'\n      ]\n    },\n    // Inline CSS styles that HTML tags may have (and their allowed values)\n    allowedStyles: {\n      // To simplify the data, all styles are allowed on all tags that allow the style attribute\n      '*': {\n        'backface-visibility': [CssProp.BACKFACE_VISIBILITY],\n        background: [CssProp.BACKGROUND],\n        'background-attachment': [CssProp.BACKGROUND_ATTACHMENT],\n        'background-clip': [CssProp.BACKGROUND_CLIP],\n        'background-color': [CssProp.BACKGROUND_COLOR],\n        'background-image': [CssProp.BACKGROUND_IMAGE],\n        'background-origin': [CssProp.BACKGROUND_ORIGIN],\n        'background-position': [CssProp.BACKGROUND_POSITION],\n        'background-repeat': [CssProp.BACKGROUND_REPEAT],\n        'background-size': [CssProp.BACKGROUND_SIZE],\n        border: [CssProp.BORDER],\n        'border-bottom': [CssProp.BORDER_BOTTOM],\n        'border-bottom-color': [CssProp.BORDER_BOTTOM_COLOR],\n        'border-bottom-left-radius': [CssProp.BORDER_BOTTOM_LEFT_RADIUS],\n        'border-bottom-right-radius': [CssProp.BORDER_BOTTOM_RIGHT_RADIUS],\n        'border-bottom-style': [CssProp.BORDER_BOTTOM_STYLE],\n        'border-bottom-width': [CssProp.BORDER_BOTTOM_WIDTH],\n        'border-collapse': [CssProp.BORDER_COLLAPSE],\n        'border-color': [CssProp.BORDER_COLOR],\n        'border-left': [CssProp.BORDER_LEFT],\n        'border-left-color': [CssProp.BORDER_LEFT_COLOR],\n        'border-left-style': [CssProp.BORDER_LEFT_STYLE],\n        'border-left-width': [CssProp.BORDER_LEFT_WIDTH],\n        'border-radius': [CssProp.BORDER_RADIUS],\n        'border-right': [CssProp.BORDER_RIGHT],\n        'border-right-color': [CssProp.BORDER_RIGHT_COLOR],\n        'border-right-style': [CssProp.BORDER_RIGHT_STYLE],\n        'border-right-width': [CssProp.BORDER_RIGHT_WIDTH],\n        'border-spacing': [CssProp.BORDER_SPACING],\n        'border-style': [CssProp.BORDER_STYLE],\n        'border-top': [CssProp.BORDER_TOP],\n        'border-top-color': [CssProp.BORDER_TOP_COLOR],\n        'border-top-left-radius': [CssProp.BORDER_TOP_LEFT_RADIUS],\n        'border-top-right-radius': [CssProp.BORDER_TOP_RIGHT_RADIUS],\n        'border-top-style': [CssProp.BORDER_TOP_STYLE],\n        'border-top-width': [CssProp.BORDER_TOP_WIDTH],\n        'border-width': [CssProp.BORDER_WIDTH],\n        bottom: [CssProp.BOTTOM],\n        box: [CssProp.BOX],\n        'box-shadow': [CssProp.BOX_SHADOW],\n        'box-sizing': [CssProp.BOX_SIZING],\n        'caption-side': [CssProp.CAPTION_SIDE],\n        clear: [CssProp.CLEAR],\n        clip: [CssProp.CLIP],\n        color: [CssProp.COLOR],\n        cursor: [CssProp.CURSOR],\n        direction: [CssProp.DIRECTION],\n        display: [CssProp.DISPLAY],\n        'display-inside': [CssProp.DISPLAY_INSIDE],\n        'display-outside': [CssProp.DISPLAY_OUTSIDE],\n        elevation: [CssProp.ELEVATION],\n        'empty-cells': [CssProp.EMPTY_CELLS],\n        float: [CssProp.FLOAT],\n        font: [CssProp.FONT],\n        'font-family': [CssProp.FONT_FAMILY],\n        'font-size': [CssProp.FONT_SIZE],\n        'font-stretch': [CssProp.FONT_STRETCH],\n        'font-style': [CssProp.FONT_STYLE],\n        'font-variant': [CssProp.FONT_VARIANT],\n        'font-weight': [CssProp.FONT_WEIGHT],\n        height: [CssProp.HEIGHT],\n        left: [CssProp.LEFT],\n        'letter-spacing': [CssProp.LETTER_SPACING],\n        'line-height': [CssProp.LINE_HEIGHT],\n        'list-style': [CssProp.LIST_STYLE],\n        'list-style-image': [CssProp.LIST_STYLE_IMAGE],\n        'list-style-position': [CssProp.LIST_STYLE_POSITION],\n        'list-style-type': [CssProp.LIST_STYLE_TYPE],\n        margin: [CssProp.MARGIN],\n        'margin-bottom': [CssProp.MARGIN_BOTTOM],\n        'margin-left': [CssProp.MARGIN_LEFT],\n        'margin-right': [CssProp.MARGIN_RIGHT],\n        'margin-top': [CssProp.MARGIN_TOP],\n        'max-height': [CssProp.MAX_HEIGHT],\n        'max-width': [CssProp.MAX_WIDTH],\n        'min-height': [CssProp.MIN_HEIGHT],\n        'min-width': [CssProp.MIN_WIDTH],\n        opacity: [CssProp.OPACITY],\n        outline: [CssProp.OUTLINE],\n        'outline-color': [CssProp.OUTLINE_COLOR],\n        'outline-style': [CssProp.OUTLINE_STYLE],\n        'outline-width': [CssProp.OUTLINE_WIDTH],\n        overflow: [CssProp.OVERFLOW],\n        'overflow-wrap': [CssProp.OVERFLOW_WRAP],\n        'overflow-x': [CssProp.OVERFLOW_X],\n        'overflow-y': [CssProp.OVERFLOW_Y],\n        padding: [CssProp.PADDING],\n        'padding-bottom': [CssProp.PADDING_BOTTOM],\n        'padding-left': [CssProp.PADDING_LEFT],\n        'padding-right': [CssProp.PADDING_RIGHT],\n        'padding-top': [CssProp.PADDING_TOP],\n        'page-break-after': [CssProp.PAGE_BREAK_AFTER],\n        'page-break-before': [CssProp.PAGE_BREAK_BEFORE],\n        'page-break-inside': [CssProp.PAGE_BREAK_INSIDE],\n        'pause-after': [CssProp.PAUSE_AFTER],\n        perspective: [CssProp.PERSPECTIVE],\n        pitch: [CssProp.PITCH],\n        'pitch-range': [CssProp.PITCH_RANGE],\n        position: [CssProp.POSITION],\n        quotes: [CssProp.QUOTES],\n        resize: [CssProp.RESIZE],\n        richness: [CssProp.RICHNESS],\n        right: [CssProp.RIGHT],\n        speak: [CssProp.SPEAK],\n        'speak-header': [CssProp.SPEAK_HEADER],\n        'speak-numeral': [CssProp.SPEAK_NUMERAL],\n        'speak-punctuation': [CssProp.SPEAK_PUNCTUATION],\n        'speech-rate': [CssProp.SPEECH_RATE],\n        stress: [CssProp.STRESS],\n        'table-layout': [CssProp.TABLE_LAYOUT],\n        'text-align': [CssProp.TEXT_ALIGN],\n        'text-decoration': [CssProp.TEXT_DECORATION],\n        'text-indent': [CssProp.TEXT_INDENT],\n        'text-overflow': [CssProp.TEXT_OVERFLOW],\n        'text-shadow': [CssProp.TEXT_SHADOW],\n        'text-transform': [CssProp.TEXT_TRANSFORM],\n        'text-wrap': [CssProp.TEXT_WRAP],\n        top: [CssProp.TOP],\n        'unicode-bidi': [CssProp.UNICODE_BIDI],\n        'vertical-align': [CssProp.VERTICAL_ALIGN],\n        visibility: [CssProp.VISIBILITY],\n        volume: [CssProp.VOLUME],\n        'white-space': [CssProp.WHITE_SPACE],\n        width: [CssProp.WIDTH],\n        'word-break': [CssProp.WORD_BREAK],\n        'word-spacing': [CssProp.WORD_SPACING],\n        'word-wrap': [CssProp.WORD_WRAP],\n        'z-index': [CssProp.Z_INDEX],\n        zoom: [CssProp.ZOOM]\n      }\n    },\n    transformTags: {\n      // Set the \"rel\" attribute for <a> tags to \"nofollow\".\n      a: sanitize.simpleTransform('a', { rel: 'nofollow' }),\n      // Set the \"disabled\" attribute for <input> tags.\n      input: sanitize.simpleTransform('input', { disabled: 'disabled' })\n    },\n    allowedSchemesByTag: {\n      // Allow 'attachment:' img src (used for markdown cell attachments).\n      img: sanitize.defaults.allowedSchemes.concat(['attachment'])\n    },\n    // Override of the default option, so we can skip 'src' attribute validation.\n    // 'src' Attributes are validated to be URIs, which does not allow for embedded (image) data.\n    // Since embedded data is no longer deemed to be a threat, validation can be skipped.\n    // See https://github.com/jupyterlab/jupyterlab/issues/5183\n    allowedSchemesAppliedToAttributes: ['href', 'cite']\n  };\n}\n\n/**\n * The default instance of an `ISanitizer` meant for use by user code.\n */\nexport const defaultSanitizer: ISanitizer = new Sanitizer();\n", "patch": "@@ -624,7 +624,6 @@ export class Sanitizer implements ISanitizer {\n       font: ['color', 'face', 'size'],\n       form: [\n         'accept',\n-        'action',\n         'autocomplete',\n         'enctype',\n         'method',", "file_path": "files/2021_8/516", "file_language": "ts", "file_name": "packages/apputils/src/sanitizer.ts", "outdated_file_modify": 0, "outdated_file_before": 1, "outdated_file_after": 0}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
