{"index": 8536, "cve_id": "CVE-2018-25045", "cwe_id": ["CWE-79"], "cve_language": "Python", "cve_description": "Django REST framework (aka django-rest-framework) before 3.9.1 allows XSS because the default DRF Browsable API view templates disable autoescaping.", "cvss": "6.1", "publish_date": "July 22, 2022", "AV": "NETWORK", "AC": "NETWORK", "PR": "NONE", "UI": "REQUIRED", "S": "CHANGED", "C": "LOW", "I": "LOW", "A": "NONE", "commit_id": "4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8", "commit_message": "Fix XSS caused by disabled autoescaping in the default DRF Browsable API view templates (#6330)\n\n* Add test that verifies that HTML is correctly escaped in Browsable API views\r\n\r\n* Fix `urlize_quoted_links` tag to avoid double escaping in autoescape mode\r\n\r\n* Fix XSS in default DRF Browsable API template by re-enabling autoescape", "commit_date": "2019-01-16T12:36:25Z", "project": "encode/django-rest-framework", "url": "https://api.github.com/repos/encode/django-rest-framework/commits/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8", "html_url": "https://github.com/encode/django-rest-framework/commit/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8", "windows_before": [{"commit_id": "e3bd4b90488bab756694ce271a9615460783f987", "commit_date": "Tue Jan 8 14:49:47 2019 +0100", "commit_message": "Fix #1811: take limit_choices_to into account with FK (#6371)", "files_name": ["rest_framework/utils/field_mapping.py", "tests/models.py", "tests/test_relations_pk.py"]}, {"commit_id": "9c408b296b65ea14173de69139218afc97e158b3", "commit_date": "Tue Jan 8 07:47:09 2019 -0500", "commit_message": "Remove reference to deprecated drf-openapi package (#6398)", "files_name": ["docs/api-guide/schemas.md"]}, {"commit_id": "e0ae975e5c543c16f0330cc4acda9387d25fee74", "commit_date": "Tue Jan 8 04:07:00 2019 -0800", "commit_message": "Fix a badly formatted title in docs (#6089)", "files_name": ["docs/api-guide/testing.md"]}, {"commit_id": "c052a86c7b8ebc8159582dafaea3f6cf4a8c40f5", "commit_date": "Tue Jan 8 13:03:02 2019 +0100", "commit_message": "compat: (py2) urlparse = urllib.parse (py3) (#6262)", "files_name": ["rest_framework/compat.py", "rest_framework/renderers.py"]}, {"commit_id": "a49d744d5ee84ae2e89abde30ceddd2463e1f676", "commit_date": "Tue Jan 8 06:56:42 2019 -0500", "commit_message": "Fix OpenAPI links (#6382)", "files_name": ["docs/api-guide/schemas.md"]}, {"commit_id": "0860ef9eeebf77e1780b0d86b3fdf01f5aaa5cc3", "commit_date": "Tue Jan 8 06:53:51 2019 -0500", "commit_message": "Update quickstart to Django 2.0 routing syntax (#6385)", "files_name": ["docs/tutorial/quickstart.md"]}, {"commit_id": "587058e3c25aac4d871828a3ef19637eb9e8ddbd", "commit_date": "Tue Jan 8 12:39:30 2019 +0100", "commit_message": "Allow run_validators() to handle non-dict types. (#6365)", "files_name": ["rest_framework/serializers.py", "tests/test_serializer.py"]}, {"commit_id": "0cf18c41631a1e2ee6013a58c7b9bbdb9d8bd8e4", "commit_date": "Tue Jan 8 15:04:54 2019 +0330", "commit_message": "Use Default Version in URLPathVersioning if 'version' Didn't Specified by Client (#6380)", "files_name": ["rest_framework/versioning.py"]}, {"commit_id": "4863a24451e2df3f2f6b5ba24b8a161bfa95390f", "commit_date": "Tue Jan 8 12:15:53 2019 +0100", "commit_message": "Fix links 404/302/303 in docs/community (#6387)", "files_name": ["docs/community/3.0-announcement.md", "docs/community/3.1-announcement.md", "docs/community/3.2-announcement.md", "docs/community/3.4-announcement.md", "docs/community/3.5-announcement.md", "docs/community/3.6-announcement.md", "docs/community/3.7-announcement.md", "docs/community/3.8-announcement.md", "docs/community/3.9-announcement.md", "docs/community/funding.md", "docs/community/jobs.md", "docs/community/kickstarter-announcement.md"]}, {"commit_id": "7749e4e3bed56e0f3e7775b0b1158d300964f6c0", "commit_date": "Fri Jan 4 21:00:38 2019 -0500", "commit_message": "Make code snippet Python 3 compatible (#6377)", "files_name": ["docs/tutorial/4-authentication-and-permissions.md"]}, {"commit_id": "1e2fd25f545dba90872498d748eaec920268d33b", "commit_date": "Fri Jan 4 15:45:08 2019 +0100", "commit_message": "Fix #3387: Documentation - Remove leading '.' before format option (#6388)", "files_name": ["docs/api-guide/renderers.md"]}, {"commit_id": "030119c117b0ee49f20ea607840967aee055ca76", "commit_date": "Fri Dec 28 17:54:41 2018 +0100", "commit_message": "Merge pull request #6386 from philratcliffe/fix_missing_import_in_example_code", "files_name": ["1a9548db4ff102fea43c72f1bc1156336f5dba71 - Fri Dec 28 16:10:08 2018 +0000 : Fix missing import in example code", "docs/api-guide/permissions.md"]}, {"commit_id": "97a47958c0f883f19abef0181df83fcb8cb18d5a", "commit_date": "Mon Dec 24 21:24:27 2018 +0530", "commit_message": "correct grammar, remove common noun after proper noun. (#6383)", "files_name": ["docs/api-guide/parsers.md"]}, {"commit_id": "5fd12d1b16f4e01725c3e2b9c4fc1f1bf209d27e", "commit_date": "Sun Dec 23 07:46:35 2018 +0100", "commit_message": "Merge pull request #6376 from johnthagen/patch-1", "files_name": ["f0712aa78aff5ea7d143d670312a2a56ae053840 - Sat Dec 22 15:29:02 2018 -0500 : Fix example to be Python 3.x and 2.7 compatible", "docs/api-guide/relations.md"]}, {"commit_id": "86aa7768a7623e8eebacea81523f59de5cd02bd7", "commit_date": "Fri Dec 21 12:39:01 2018 +0100", "commit_message": "Update quote in relations.md (#6373)", "files_name": ["docs/api-guide/relations.md"]}, {"commit_id": "63e6bbfd367c78a38e77e5ec25081e34389c5bef", "commit_date": "Thu Dec 20 14:41:54 2018 +0100", "commit_message": "Note that only latest patches of Python & Django are supported. (#6370)", "files_name": ["README.md", "docs/index.md"]}, {"commit_id": "fa57fb8aeb93c60dcb5eb75a7f88f61afaf35fb9", "commit_date": "Wed Dec 19 19:28:03 2018 +0100", "commit_message": "Use HTTPS URL example for git clone commands. (#6134)", "files_name": ["CONTRIBUTING.md", "docs/index.md"]}, {"commit_id": "963ce306f3226ec64eb8990c4fbc094a77fabcba", "commit_date": "Wed Dec 19 22:37:52 2018 +0800", "commit_message": "Added \"allow_unicode\" to generated kwargs for ModelSerializer SlugField (#6315)", "files_name": ["rest_framework/utils/field_mapping.py", "tests/test_model_serializer.py"]}, {"commit_id": "7ad5bdb669d5b4621f64bdcfe223d9c42b93d9d5", "commit_date": "Wed Dec 19 09:25:34 2018 -0500", "commit_message": "Adjusted login template override example (#6265)", "files_name": ["docs/topics/browsable-api.md"]}, {"commit_id": "1348bdc48acf932666d4eb033b18248ca6861cc9", "commit_date": "Wed Dec 19 05:50:14 2018 -0800", "commit_message": "Fixed quickstart.md typos (#6348)", "files_name": ["docs/tutorial/quickstart.md"]}, {"commit_id": "a52087b1b81f300d2a27dd262b452689fe195229", "commit_date": "Wed Dec 19 14:34:18 2018 +0100", "commit_message": "Merge pull request #6362 from adrienbrunet/typo", "files_name": ["c4a021185fd86961f8e2d41e17facc56f4cc2691 - Tue Dec 18 13:03:03 2018 +0100 : docs: typo in permissions (double space)", "docs/api-guide/permissions.md"]}, {"commit_id": "2aecef3460340add1b12d631304acc06bcf7c64d", "commit_date": "Tue Dec 18 11:23:08 2018 +0000", "commit_message": "Update kloudless logo", "files_name": ["docs/index.md"]}, {"commit_id": "3453d65655851b6b77795f1666086990725aefa0", "commit_date": "Tue Dec 18 11:18:40 2018 +0000", "commit_message": "Update Kloudless logo", "files_name": ["docs/img/premium/kloudless-readme.png"]}, {"commit_id": "a64980232a496eb00891fc35c175c55fa41d522c", "commit_date": "Mon Dec 17 15:10:39 2018 -0500", "commit_message": "Add example of gender-neutral language in contributing guide. (#6358)", "files_name": ["CONTRIBUTING.md"]}, {"commit_id": "ef61288d770241e21b0b2749e54041e6838fe70f", "commit_date": "Thu Dec 13 21:01:10 2018 +0000", "commit_message": "Remove mention of djangorestframework-jwt (#6353)", "files_name": ["docs/community/third-party-packages.md"]}, {"commit_id": "627eeb8202e42210c176b4b4229e77eb640a3716", "commit_date": "Fri Dec 7 22:44:57 2018 +0100", "commit_message": "Add missing comma in documentation of permission composition (#6336)", "files_name": ["docs/api-guide/permissions.md"]}, {"commit_id": "facb433c89ae52a618857b50a1bdf109392c380c", "commit_date": "Thu Dec 6 08:26:40 2018 -0800", "commit_message": "Remove unmaintained digest authentication package (#6347)", "files_name": ["docs/api-guide/authentication.md"]}, {"commit_id": "b61806e3b3ebb0a9b072916df231d7e7bf920134", "commit_date": "Mon Dec 3 19:10:05 2018 +0700", "commit_message": "add \"js-tooltip\" class to \"POST\" button (#6344)", "files_name": ["rest_framework/templates/rest_framework/base.html"]}, {"commit_id": "5a54f897ec2af8ce947489686d66d2e4878473b2", "commit_date": "Wed Nov 28 13:45:27 2018 +0100", "commit_message": "FIX: openapi schema title should be a string not a tuple (#6259)", "files_name": ["rest_framework/renderers.py"]}, {"commit_id": "11edf572c5a3dec36653e7540c34c83ed7c11467", "commit_date": "Tue Nov 27 15:47:30 2018 +0100", "commit_message": "Merge pull request #6299 from encode/xordoquy/fix_composable_permissions", "files_name": ["74574217a4de871ea47cded715caa5e9876d3a6a - Thu Nov 1 20:12:34 2018 +0100 : Fix composable permissions", "rest_framework/permissions.py", "tests/test_permissions.py"]}, {"commit_id": "0f5dfe8b3cc8a635208b1e24aa27eb465d4fb5ab", "commit_date": "Tue Nov 27 03:14:59 2018 +0900", "commit_message": "Fix typo in schemas (#6332)", "files_name": ["rest_framework/schemas/generators.py", "rest_framework/schemas/inspectors.py"]}, {"commit_id": "9b7db8dd694dbaf451383890a2f79d571b97746e", "commit_date": "Tue Nov 20 23:45:04 2018 -0800", "commit_message": "Travis has released Xenial support (#6322)", "files_name": [".travis.yml"]}, {"commit_id": "2084555fbefe51df3109622c1b52f4320e4c4891", "commit_date": "Fri Nov 16 15:41:38 2018 +0000", "commit_message": "Update Lights On logo", "files_name": ["docs/img/premium/lightson-readme.png", "docs/index.md"]}, {"commit_id": "d0369b27cdabe614dfae91d1bf1d3bfd17c9a503", "commit_date": "Thu Nov 15 15:44:54 2018 +0100", "commit_message": "update docs/api-guide/serializers.md: consistency (#6320)", "files_name": ["docs/api-guide/serializers.md"]}, {"commit_id": "2c0b2bd44e26102131c6183267aca3c989175377", "commit_date": "Thu Nov 15 13:52:24 2018 +0000", "commit_message": "Add 'Lights On Software' (#6319)", "files_name": ["README.md", "docs/index.md"]}, {"commit_id": "588c6976d44487b537ee577bbdd315dd7f4db71d", "commit_date": "Thu Nov 15 12:06:47 2018 +0000", "commit_message": "Delete lightson.png", "files_name": ["docs/img/premium/lightson.png"]}, {"commit_id": "bc36cf5e2bd0e4f18e977a9b5cd82158e4a0af72", "commit_date": "Thu Nov 15 12:06:18 2018 +0000", "commit_message": "Lights On", "files_name": ["docs/img/premium/lightson-readme.png"]}, {"commit_id": "f73b4896b8e400b52721dadf682b3d326a04079e", "commit_date": "Thu Nov 15 12:04:06 2018 +0000", "commit_message": "Lights On Software", "files_name": ["docs/img/premium/lightson.png"]}, {"commit_id": "f7d2839562294e80991a4e09bbf95de47e6cce19", "commit_date": "Wed Nov 14 09:50:28 2018 +0300", "commit_message": "Typo fix in the release announcement (#6318)", "files_name": ["docs/community/3.9-announcement.md"]}, {"commit_id": "bf9533ae37affc64638c21f551250914dd5f80be", "commit_date": "Mon Nov 5 16:04:08 2018 +0000", "commit_message": "Merge pull request #6286 from markddavidoff/patch-1", "files_name": ["fae7e91728615cd321de22cab71dff21b1519e3c - Sat Nov 3 14:57:47 2018 +0000 : docs: Remove references to drf-openapi (#6272)", "docs/img/drf-openapi.png", "docs/topics/documenting-your-api.md"]}, {"commit_id": "d59a130168858afe58d6db26f76f7cfe8ccb42a7", "commit_date": "Fri Nov 2 11:48:39 2018 -0400", "commit_message": "Fixes an import statement in chapter 5 of the tutorial. (#6267)", "files_name": ["docs/tutorial/5-relationships-and-hyperlinked-apis.md"]}, {"commit_id": "40da2a21ef08f9394eb03d018d560516f940a1b2", "commit_date": "Mon Oct 29 23:43:06 2018 +0100", "commit_message": "Update authentication.md (#6291)", "files_name": ["docs/api-guide/authentication.md"]}, {"commit_id": "1f13b6f6b2adfd58fff2a11803bc660aea46f2b4", "commit_date": "Mon Oct 29 09:14:35 2018 -0700", "commit_message": "use actual user instead of fake user in permission composition test", "files_name": ["tests/test_permissions.py"]}, {"commit_id": "67e99a29b814af86c7c2544b42d83cdf9cb2d647", "commit_date": "Mon Oct 29 12:03:34 2018 -0500", "commit_message": "Fix typo in release-notes.md (#6285)", "files_name": ["docs/community/release-notes.md"]}, {"commit_id": "fc08e0189fb8af568a453c31313e4ef276d22ae5", "commit_date": "Mon Oct 29 08:26:20 2018 -0700", "commit_message": "update tests to reflect that django now returns a callable for is_authenticated", "files_name": ["tests/test_permissions.py"]}, {"commit_id": "6f2c0dbf4d9180641febdf42c3f3f0c39bcb0e5a", "commit_date": "Sun Oct 28 14:12:39 2018 -0700", "commit_message": "permissions must return a boolean", "files_name": ["rest_framework/permissions.py"]}, {"commit_id": "9d001cd84c1239d708b1528587c183ef30e38c31", "commit_date": "Thu Oct 18 19:42:52 2018 -0300", "commit_message": "Fix typo in testing.md (#6257)", "files_name": ["docs/api-guide/testing.md"]}, {"commit_id": "2c9c0f1b7f24e2fbedacbb85e6b56eb244a2353c", "commit_date": "Thu Oct 18 10:38:46 2018 +0100", "commit_message": "Version 3.9 (#6247)", "files_name": ["docs/community/3.9-announcement.md", "docs/community/release-notes.md", "mkdocs.yml", "rest_framework/__init__.py", "rest_framework/decorators.py", "rest_framework/routers.py", "rest_framework/schemas/generators.py", "tests/test_decorators.py", "tests/test_routers.py", "tests/test_schemas.py"]}, {"commit_id": "28040b3bda5651967a28c9c921dfae6afe6a0c3d", "commit_date": "Mon Oct 15 17:31:36 2018 +0100", "commit_message": "Upgrade Auklet to premium (#6244)", "files_name": ["README.md", "docs/img/premium/auklet-readme.png", "docs/index.md"]}, {"commit_id": "1c3f796219e7794306bb2db81d4910c0cb7c932a", "commit_date": "Thu Oct 11 14:48:05 2018 +0100", "commit_message": "Add kloudless as a new premium sponsor (#6241)", "files_name": ["README.md", "docs/index.md"]}, {"commit_id": "ebc5393776266e6c72f2a00bf5e633b08528f221", "commit_date": "Thu Oct 11 14:06:24 2018 +0100", "commit_message": "Add spacing around kloudless logo", "files_name": ["docs/img/premium/kloudless-readme.png"]}, {"commit_id": "317d2489e4a75b9fb108963b8b44ca266fdb0ed4", "commit_date": "Thu Oct 11 14:03:02 2018 +0100", "commit_message": "Add Kloudless logo", "files_name": ["docs/img/premium/kloudless-readme.png"]}], "windows_after": [{"commit_id": "453196e9c3a581bac3bf68eb8c9cdd7d28d2dcd6", "commit_date": "Wed Jan 16 13:27:35 2019 +0000", "commit_message": "Version 3.9.1 (#6405)", "files_name": ["docs/community/release-notes.md", "rest_framework/__init__.py", "rest_framework/static/rest_framework/css/bootstrap-theme.min.css", "rest_framework/static/rest_framework/css/bootstrap.min.css", "rest_framework/static/rest_framework/js/bootstrap.min.js"]}, {"commit_id": "c049777dc7d7f6ec36bfd3bc5b5f853c20246997", "commit_date": "Wed Jan 16 13:39:36 2019 +0000", "commit_message": "Add missing item in 3.9.1 release notes", "files_name": ["docs/community/release-notes.md"]}, {"commit_id": "822b85ac36818f0d8cb4b05f47ea5532b12a8d57", "commit_date": "Thu Jan 17 14:07:57 2019 +0100", "commit_message": "routers: invalidate _urls cache on register (#6407)", "files_name": ["rest_framework/routers.py", "tests/test_routers.py"]}, {"commit_id": "271c4c59209258efdc1ce8bfb3f075a452120893", "commit_date": "Thu Jan 17 08:58:24 2019 -0500", "commit_message": "Remove sudo from .travis.yml (#6408)", "files_name": [".travis.yml"]}, {"commit_id": "0ac20a3d8eb565f1845e2c9beeeb02b296526749", "commit_date": "Mon Jan 21 21:00:54 2019 +0100", "commit_message": "Updated filtering docs to use `filterset_fields`. (#6415)", "files_name": ["docs/api-guide/filtering.md"]}, {"commit_id": "f539c0dbd13691a32637ff67bc384c8fcef2b636", "commit_date": "Thu Jan 24 15:18:22 2019 +0100", "commit_message": "Removed incorrect DictField docstring. (#6417)", "files_name": ["rest_framework/fields.py"]}, {"commit_id": "8d20e102188455fce89e66be79fb5ebf16cb0ca0", "commit_date": "Thu Jan 24 16:01:06 2019 +0100", "commit_message": "Deferred schema renderer creation to avoid requiring pyyaml. (#6416)", "files_name": ["rest_framework/management/commands/generateschema.py"]}, {"commit_id": "4c2af759572426505d4770f0a54f15264e02aea3", "commit_date": "Thu Jan 24 16:10:11 2019 +0100", "commit_message": "Updated links to djangorestframework-api-key project. (#6414)", "files_name": ["docs/api-guide/permissions.md"]}, {"commit_id": "9ff0092061ba93fd13bdceb0d0f6d49bb02f0d9e", "commit_date": "Thu Jan 24 16:24:37 2019 +0100", "commit_message": "Added release note stub for v3.9.2.", "files_name": ["docs/community/release-notes.md"]}, {"commit_id": "87ade870c3ac46327fb969ca10e69a162786c50d", "commit_date": "Thu Jan 24 15:30:46 2019 +0000", "commit_message": "Added 'request_forms' block to base.html (#6340)", "files_name": ["rest_framework/templates/rest_framework/base.html"]}, {"commit_id": "f54a220d8f3c8649b84188c7e2a6dc2ef3be6f4c", "commit_date": "Thu Jan 31 11:36:40 2019 +0100", "commit_message": "Corrected coreapi CLI code example generation. (#6428)", "files_name": ["rest_framework/templates/rest_framework/docs/langs/shell.html", "tests/test_renderers.py"]}, {"commit_id": "bd9a799e166b1d44c9db444a95765ad0dce2aa8f", "commit_date": "Thu Jan 31 15:28:01 2019 +0100", "commit_message": "Fixed SchemaView to reset renderer on exception. (#6429)", "files_name": ["rest_framework/schemas/views.py", "tests/test_schemas.py"]}, {"commit_id": "190f6201cbbac18803479020dae922c5ae3e90f2", "commit_date": "Thu Jan 31 15:59:19 2019 +0100", "commit_message": "Update Django Guardian dependency. (#6430)", "files_name": ["requirements/requirements-optionals.txt", "rest_framework/compat.py"]}, {"commit_id": "2b62941bb4d48e27960690bdea1a343177dd5d0e", "commit_date": "Thu Jan 31 21:50:36 2019 +0600", "commit_message": "Added testing against Django 2.2a1. (#6422)", "files_name": [".travis.yml", "tox.ini"]}, {"commit_id": "63e352586b679d554e1e9ef708e153d858e7e3bf", "commit_date": "Thu Jan 31 17:16:43 2019 +0100", "commit_message": "Drop testing Python 3.5 against Django master. (#6431)", "files_name": [".travis.yml", "tox.ini"]}, {"commit_id": "7310411533873717305f08fcc5d45426cb0f01d9", "commit_date": "Fri Feb 1 18:50:27 2019 +0000", "commit_message": "Updated example models to use `__str__` in relations docs. (#6433)", "files_name": ["docs/api-guide/relations.md"]}, {"commit_id": "7c6e34c14f54f1bf0d46ff34dc9a823215987c95", "commit_date": "Sat Feb 2 05:49:58 2019 -0800", "commit_message": "Fix typo: 'what' to 'that' (#6437)", "files_name": ["docs/api-guide/requests.md"]}, {"commit_id": "3c5c61f33bd451496385aec237cb5502db8d6a6a", "commit_date": "Wed Feb 6 09:35:04 2019 +0000", "commit_message": "fix for a couple of missing words (#6444)", "files_name": ["docs/api-guide/permissions.md"]}, {"commit_id": "abf07e672e94f2ce7d42e690222f527ba918ad40", "commit_date": "Wed Feb 6 14:26:09 2019 -0600", "commit_message": "Fix throttling documentation for specifying alternate caches (#6446)", "files_name": ["docs/api-guide/throttling.md"]}, {"commit_id": "dc6b3bf42e53c6bfdb597a67de931913c8bd0255", "commit_date": "Thu Feb 7 16:10:11 2019 +0800", "commit_message": "Fix tutorial instruction to also add pyyaml (#6443)", "files_name": ["docs/tutorial/7-schemas-and-client-libraries.md"]}, {"commit_id": "9f66fc9a7ca51ad5535cb48e199cf2fbe9eecec6", "commit_date": "Wed Feb 13 19:00:16 2019 -0500", "commit_message": "Fix typo in caching docs", "files_name": ["docs/api-guide/caching.md"]}, {"commit_id": "d23ea30d26fc0e21514ef8e0bed74845feabe43e", "commit_date": "Thu Feb 14 06:47:31 2019 +0100", "commit_message": "Merge pull request #6454 from johnthagen/patch-1", "files_name": ["3b996c6dc27c95749e1c3c2028e3d6adf3993052 - Thu Feb 14 12:01:36 2019 +0100 : Correct 3rd-party-packages link in issue template.", "ISSUE_TEMPLATE.md"]}, {"commit_id": "606dd492279a856fa1eaf3487c1e66b36840a9c3", "commit_date": "Thu Feb 14 08:48:36 2019 +0100", "commit_message": "Update tox to use Django 2.2b2.", "files_name": ["tox.ini"]}, {"commit_id": "cb4cbb61f259b1fad659c714d64681d5add76c10", "commit_date": "Thu Feb 14 08:50:27 2019 +0100", "commit_message": "Fix search filter tests against Django 2.2.", "files_name": ["tests/test_filters.py"]}, {"commit_id": "481ae69df3b59d628689b03bbf18c6002d11a073", "commit_date": "Thu Feb 14 09:30:53 2019 +0100", "commit_message": "Add migration for CustomToken test model.", "files_name": ["tests/authentication/__init__.py", "tests/authentication/migrations/0001_initial.py", "tests/authentication/migrations/__init__.py", "tests/authentication/models.py", "tests/authentication/test_authentication.py", "tests/conftest.py"]}, {"commit_id": "59fcbc6dd553cbbbd60a3dd7c57fb72fde8e7f68", "commit_date": "Thu Feb 14 14:29:57 2019 +0100", "commit_message": "Add migration for generic relations Tag model.", "files_name": ["tests/conftest.py", "tests/generic_relations/__init__.py", "tests/generic_relations/migrations/0001_initial.py", "tests/generic_relations/migrations/__init__.py", "tests/generic_relations/models.py", "tests/generic_relations/test_generic_relations.py"]}, {"commit_id": "1c5466eae772212eaf1df1832870cf64b77c9dc5", "commit_date": "Thu Feb 14 15:23:15 2019 +0100", "commit_message": "Remove Django 2.2 from allowed failure.", "files_name": [".travis.yml"]}, {"commit_id": "65f5c11a5b8aca5a6aca14c7ad85293fa941c37d", "commit_date": "Thu Feb 14 15:38:21 2019 +0100", "commit_message": "Document support for Django 2.2.", "files_name": ["README.md", "docs/index.md", "setup.py"]}, {"commit_id": "e8b4bb1471b9fbd5895a63cc23b3b53ff45b3df1", "commit_date": "Thu Feb 14 17:51:10 2019 +0100", "commit_message": "Added tests for generateschema management command. (#6442)", "files_name": ["tests/test_generateschema.py"]}, {"commit_id": "de3929fb3334262bbf57980fff41d3f8c6f2b8b4", "commit_date": "Fri Feb 15 15:27:02 2019 +0530", "commit_message": "Add Python 3.7 to classifiers. (#6458)", "files_name": ["setup.py"]}, {"commit_id": "f9401f5ff0c4738d02ea5d7576435913582006ce", "commit_date": "Sat Feb 16 15:47:13 2019 +0100", "commit_message": "Fix Python 3 compat in documentation", "files_name": ["docs/api-guide/serializers.md", "docs/community/3.0-announcement.md", "docs/tutorial/1-serialization.md", "docs/tutorial/2-requests-and-responses.md"]}, {"commit_id": "1660469ed8a2afd7fd08c6087ec9fc341c30b4f9", "commit_date": "Sun Feb 17 22:16:35 2019 +0100", "commit_message": "Merge pull request #6460 from michael-k/docs-py3-compat", "files_name": ["eb3180173ed119192c57a6ab52097025c00148e3 - Tue Feb 19 03:15:03 2019 -0800 : Made templates compatible with session-based CSRF. (#6207)", "rest_framework/static/rest_framework/js/csrf.js", "rest_framework/templates/rest_framework/admin.html", "rest_framework/templates/rest_framework/base.html", "tests/test_templates.py"]}, {"commit_id": "6de33effd6d0e1cc9ad2dc3a2a4d0487583a116f", "commit_date": "Tue Feb 19 16:18:55 2019 +0100", "commit_message": "Doc\u2019d requirement to implement has_object_permission() (#6462)", "files_name": ["docs/api-guide/permissions.md"]}, {"commit_id": "1ece516d2d0d942d9de513f85d601afcccf67ebd", "commit_date": "Tue Feb 19 07:38:20 2019 -0800", "commit_message": "Adjusted field `validators` to accept iterables. (#6282)", "files_name": ["rest_framework/fields.py", "rest_framework/serializers.py", "tests/test_fields.py", "tests/test_serializer.py"]}, {"commit_id": "d110454d4c15fe6617a112e846b89e09ed6c95b2", "commit_date": "Tue Feb 19 08:18:14 2019 -0800", "commit_message": "Added SearchFilter.get_search_fields() hook. (#6279)", "files_name": ["docs/api-guide/filtering.md", "rest_framework/filters.py", "tests/test_filters.py"]}, {"commit_id": "d932baa64660012cb7e5b86ba0f985fee8d5e57c", "commit_date": "Fri Feb 22 11:11:52 2019 +0100", "commit_message": "Corrected link to ajax-form library.", "files_name": ["docs/topics/browser-enhancements.md"]}, {"commit_id": "286cf57a8d22aafd51054a40a5cf8a58edfc8226", "commit_date": "Fri Feb 22 10:58:01 2019 -0800", "commit_message": "Update filtering docs (#6467)", "files_name": ["docs/api-guide/filtering.md"]}, {"commit_id": "07c5c968ce8b06c7ebbcc91a070aa492510611b2", "commit_date": "Mon Feb 25 10:17:04 2019 +0200", "commit_message": "Fix DeprecationWarning when accessing collections.abc classes via collections (#6268)", "files_name": ["rest_framework/compat.py", "rest_framework/fields.py", "rest_framework/utils/serializer_helpers.py"]}, {"commit_id": "8a29c53226f63733775a232fea0c2c65cb50b6b0", "commit_date": "Mon Feb 25 11:49:29 2019 +0100", "commit_message": "Allowed Q objects in limit_choices_to introspection. (#6472)", "files_name": ["rest_framework/utils/field_mapping.py", "tests/models.py", "tests/test_relations_pk.py"]}, {"commit_id": "94fbfcb6fdc8f9755a9f005bd005b00be3309ff8", "commit_date": "Mon Feb 25 20:47:02 2019 +0800", "commit_message": "Added lazy evaluation to composed permissions. (#6463)", "files_name": ["rest_framework/compat.py", "rest_framework/permissions.py", "tests/test_permissions.py"]}, {"commit_id": "739b0a272a66d9beb7afb7490f201d71d7cdc910", "commit_date": "Mon Feb 25 19:52:45 2019 +0530", "commit_message": "Fix DeprecationWarning in tests when accessing collections.abc classes via collections (#6473)", "files_name": ["tests/test_renderers.py", "tests/test_serializer.py"]}, {"commit_id": "2daf6f13414f1a5d363b5bc4a2ce3ba294a7766c", "commit_date": "Mon Feb 25 15:33:40 2019 +0100", "commit_message": "Add negation ~ operator to permissions composition (#6361)", "files_name": ["docs/api-guide/permissions.md", "rest_framework/permissions.py", "tests/test_permissions.py"]}, {"commit_id": "317174b163d80aaa8be44b8d3bf073d5c50acb14", "commit_date": "Mon Feb 25 16:59:25 2019 +0100", "commit_message": "Avoided calling distinct on annotated fields in SearchFilter. (#6240)", "files_name": ["rest_framework/filters.py", "tests/test_filters.py"]}, {"commit_id": "1dc81acb4d351ef954291391b9151fa9c524ea43", "commit_date": "Thu Feb 28 15:18:58 2019 +0100", "commit_message": "Fixed a typo in pagination docs. (#6475)", "files_name": ["docs/api-guide/pagination.md"]}, {"commit_id": "31bf59708121127994bdbcd038f4f76bb28059d7", "commit_date": "Fri Mar 1 12:48:12 2019 +0100", "commit_message": "Updated note on BooleanField required kwarg generation.", "files_name": ["docs/api-guide/fields.md"]}, {"commit_id": "a216d02ce0661510d456cfd327fadc3acb9ec960", "commit_date": "Sat Mar 2 12:48:03 2019 -0800", "commit_message": "Merge multiple isinstance() calls to one (#6481)", "files_name": ["rest_framework/fields.py"]}, {"commit_id": "94593b3a503472c7d1ca97b8e191ef5c8a3c00ff", "commit_date": "Sun Mar 3 09:20:45 2019 +0100", "commit_message": "Introduce RemovedInDRF\u2026Warning classes to simplify deprecations. (#6480)", "files_name": ["docs/community/release-notes.md", "rest_framework/__init__.py", "rest_framework/decorators.py", "rest_framework/filters.py", "rest_framework/routers.py", "tests/test_decorators.py", "tests/test_permissions.py", "tests/test_routers.py"]}, {"commit_id": "7eac86688a73503c6668568ad564f6b2539049f0", "commit_date": "Sun Mar 3 10:39:08 2019 -0800", "commit_message": "Remove executable bit from static assets (#6484)", "files_name": ["docs_theme/css/bootstrap-responsive.css"]}], "parents": [{"commit_id_before": "e3bd4b90488bab756694ce271a9615460783f987", "url_before": "https://api.github.com/repos/encode/django-rest-framework/commits/e3bd4b90488bab756694ce271a9615460783f987", "html_url_before": "https://github.com/encode/django-rest-framework/commit/e3bd4b90488bab756694ce271a9615460783f987"}], "details": [{"raw_url": "https://github.com/encode/django-rest-framework/raw/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8/rest_framework%2Ftemplates%2Frest_framework%2Fbase.html", "code": "{% load static %}\n{% load i18n %}\n{% load rest_framework %}\n\n<!DOCTYPE html>\n<html>\n  <head>\n    {% block head %}\n\n      {% block meta %}\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n        <meta name=\"robots\" content=\"NONE,NOARCHIVE\" />\n      {% endblock %}\n\n      <title>{% block title %}{% if name %}{{ name }} \u2013 {% endif %}Django REST framework{% endblock %}</title>\n\n      {% block style %}\n        {% block bootstrap_theme %}\n          <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"rest_framework/css/bootstrap.min.css\" %}\"/>\n          <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"rest_framework/css/bootstrap-tweaks.css\" %}\"/>\n        {% endblock %}\n\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"rest_framework/css/prettify.css\" %}\"/>\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"rest_framework/css/default.css\" %}\"/>\n        {% if code_style %}<style>{{ code_style }}</style>{% endif %}\n      {% endblock %}\n\n    {% endblock %}\n  </head>\n\n  {% block body %}\n  <body class=\"{% block bodyclass %}{% endblock %}\">\n\n    <div class=\"wrapper\">\n      {% block navbar %}\n        <div class=\"navbar navbar-static-top {% block bootstrap_navbar_variant %}navbar-inverse{% endblock %}\"\n             role=\"navigation\" aria-label=\"{% trans \"navbar\" %}\">\n          <div class=\"container\">\n            <span>\n              {% block branding %}\n                <a class='navbar-brand' rel=\"nofollow\" href='https://www.django-rest-framework.org/'>\n                    Django REST framework\n                </a>\n              {% endblock %}\n            </span>\n            <ul class=\"nav navbar-nav pull-right\">\n              {% block userlinks %}\n                {% if user.is_authenticated %}\n                  {% optional_logout request user %}\n                {% else %}\n                  {% optional_login request %}\n                {% endif %}\n              {% endblock %}\n            </ul>\n          </div>\n        </div>\n      {% endblock %}\n\n      <div class=\"container\">\n        {% block breadcrumbs %}\n          <ul class=\"breadcrumb\">\n            {% for breadcrumb_name, breadcrumb_url in breadcrumblist %}\n              {% if forloop.last %}\n                <li class=\"active\"><a href=\"{{ breadcrumb_url }}\">{{ breadcrumb_name }}</a></li>\n              {% else %}\n                <li><a href=\"{{ breadcrumb_url }}\">{{ breadcrumb_name }}</a></li>\n              {% endif %}\n            {% empty %}\n              {% block breadcrumbs_empty %}&nbsp;{% endblock breadcrumbs_empty %}\n            {% endfor %}\n          </ul>\n        {% endblock %}\n\n        <!-- Content -->\n        <div id=\"content\" role=\"main\" aria-label=\"{% trans \"content\" %}\">\n          {% block content %}\n\n          <div class=\"region\"  aria-label=\"{% trans \"request form\" %}\">\n          {% if 'GET' in allowed_methods %}\n            <form id=\"get-form\" class=\"pull-right\">\n              <fieldset>\n                {% if api_settings.URL_FORMAT_OVERRIDE %}\n                  <div class=\"btn-group format-selection\">\n                    <a class=\"btn btn-primary js-tooltip\" href=\"{{ request.get_full_path }}\" rel=\"nofollow\" title=\"Make a GET request on the {{ name }} resource\">GET</a>\n\n                    <button class=\"btn btn-primary dropdown-toggle js-tooltip\" data-toggle=\"dropdown\" title=\"Specify a format for the GET request\">\n                      <span class=\"caret\"></span>\n                    </button>\n                    <ul class=\"dropdown-menu\">\n                      {% for format in available_formats %}\n                        <li>\n                          <a class=\"js-tooltip format-option\" href=\"{% add_query_param request api_settings.URL_FORMAT_OVERRIDE format %}\" rel=\"nofollow\" title=\"Make a GET request on the {{ name }} resource with the format set to `{{ format }}`\">{{ format }}</a>\n                        </li>\n                      {% endfor %}\n                    </ul>\n                  </div>\n                {% else %}\n                  <a class=\"btn btn-primary js-tooltip\" href=\"{{ request.get_full_path }}\" rel=\"nofollow\" title=\"Make a GET request on the {{ name }} resource\">GET</a>\n                {% endif %}\n              </fieldset>\n            </form>\n          {% endif %}\n\n          {% if options_form %}\n            <form class=\"button-form\" action=\"{{ request.get_full_path }}\" data-method=\"OPTIONS\">\n              <button class=\"btn btn-primary js-tooltip\" title=\"Make an OPTIONS request on the {{ name }} resource\">OPTIONS</button>\n            </form>\n          {% endif %}\n\n          {% if delete_form %}\n            <button class=\"btn btn-danger button-form js-tooltip\" title=\"Make a DELETE request on the {{ name }} resource\" data-toggle=\"modal\" data-target=\"#deleteModal\">DELETE</button>\n\n            <!-- Delete Modal -->\n            <div class=\"modal fade\" id=\"deleteModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\n              <div class=\"modal-dialog\">\n                <div class=\"modal-content\">\n                  <div class=\"modal-body\">\n                    <h4 class=\"text-center\">Are you sure you want to delete this {{ name }}?</h4>\n                  </div>\n                  <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancel</button>\n                    <form class=\"button-form\" action=\"{{ request.get_full_path }}\" data-method=\"DELETE\">\n                      <button class=\"btn btn-danger\">Delete</button>\n                    </form>\n                  </div>\n                </div>\n              </div>\n            </div>\n          {% endif %}\n\n          {% if extra_actions %}\n            <div class=\"dropdown\" style=\"float: right; margin-right: 10px\">\n              <button class=\"btn btn-default\" id=\"extra-actions-menu\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                {% trans \"Extra Actions\" %}\n                <span class=\"caret\"></span>\n              </button>\n              <ul class=\"dropdown-menu\" aria-labelledby=\"extra-actions-menu\">\n                {% for action_name, url in extra_actions|items %}\n                <li><a href=\"{{ url }}\">{{ action_name }}</a></li>\n                {% endfor %}\n              </ul>\n            </div>\n          {% endif %}\n\n          {% if filter_form %}\n            <button style=\"float: right; margin-right: 10px\" data-toggle=\"modal\" data-target=\"#filtersModal\" class=\"btn btn-default\">\n              <span class=\"glyphicon glyphicon-wrench\" aria-hidden=\"true\"></span>\n              {% trans \"Filters\" %}\n            </button>\n          {% endif %}\n          </div>\n\n            <div class=\"content-main\" role=\"main\"  aria-label=\"{% trans \"main content\" %}\">\n              <div class=\"page-header\">\n                <h1>{{ name }}</h1>\n              </div>\n              <div style=\"float:left\">\n                {% block description %}\n                  {{ description }}\n                {% endblock %}\n              </div>\n\n              {% if paginator %}\n                <nav style=\"float: right\">\n                  {% get_pagination_html paginator %}\n                </nav>\n              {% endif %}\n\n              <div class=\"request-info\" style=\"clear: both\" aria-label=\"{% trans \"request info\" %}\">\n                <pre class=\"prettyprint\"><b>{{ request.method }}</b> {{ request.get_full_path }}</pre>\n              </div>\n\n              <div class=\"response-info\" aria-label=\"{% trans \"response info\" %}\">\n                <pre class=\"prettyprint\"><span class=\"meta nocode\"><b>HTTP {{ response.status_code }} {{ response.status_text }}</b>{% for key, val in response_headers|items %}\n<b>{{ key }}:</b> <span class=\"lit\">{{ val|break_long_headers|urlize_quoted_links }}</span>{% endfor %}\n\n</span>{{ content|urlize_quoted_links }}</pre>\n              </div>\n            </div>\n\n            {% if display_edit_forms %}\n              {% if post_form or raw_data_post_form %}\n                <div {% if post_form %}class=\"tabbable\"{% endif %}>\n                  {% if post_form %}\n                    <ul class=\"nav nav-tabs form-switcher\">\n                      <li>\n                        <a name='html-tab' href=\"#post-object-form\" data-toggle=\"tab\">HTML form</a>\n                      </li>\n                      <li>\n                        <a name='raw-tab' href=\"#post-generic-content-form\" data-toggle=\"tab\">Raw data</a>\n                      </li>\n                    </ul>\n                  {% endif %}\n\n                  <div class=\"well tab-content\">\n                    {% if post_form %}\n                      <div class=\"tab-pane\" id=\"post-object-form\">\n                        {% with form=post_form %}\n                          <form action=\"{{ request.get_full_path }}\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-horizontal\" novalidate>\n                            <fieldset>\n                              {% csrf_token %}\n                              {{ post_form }}\n                              <div class=\"form-actions\">\n                                <button class=\"btn btn-primary js-tooltip\" title=\"Make a POST request on the {{ name }} resource\">POST</button>\n                              </div>\n                            </fieldset>\n                          </form>\n                        {% endwith %}\n                      </div>\n                    {% endif %}\n\n                    <div {% if post_form %}class=\"tab-pane\"{% endif %} id=\"post-generic-content-form\">\n                      {% with form=raw_data_post_form %}\n                        <form action=\"{{ request.get_full_path }}\" method=\"POST\" class=\"form-horizontal\">\n                          <fieldset>\n                            {% include \"rest_framework/raw_data_form.html\" %}\n                            <div class=\"form-actions\">\n                              <button class=\"btn btn-primary js-tooltip\" title=\"Make a POST request on the {{ name }} resource\">POST</button>\n                            </div>\n                          </fieldset>\n                        </form>\n                      {% endwith %}\n                    </div>\n                  </div>\n                </div>\n              {% endif %}\n\n              {% if put_form or raw_data_put_form or raw_data_patch_form %}\n                <div {% if put_form %}class=\"tabbable\"{% endif %}>\n                  {% if put_form %}\n                    <ul class=\"nav nav-tabs form-switcher\">\n                      <li>\n                        <a name='html-tab' href=\"#put-object-form\" data-toggle=\"tab\">HTML form</a>\n                      </li>\n                      <li>\n                        <a  name='raw-tab' href=\"#put-generic-content-form\" data-toggle=\"tab\">Raw data</a>\n                      </li>\n                    </ul>\n                  {% endif %}\n\n                  <div class=\"well tab-content\">\n                    {% if put_form %}\n                      <div class=\"tab-pane\" id=\"put-object-form\">\n                        <form action=\"{{ request.get_full_path }}\" data-method=\"PUT\" enctype=\"multipart/form-data\" class=\"form-horizontal\" novalidate>\n                          <fieldset>\n                            {{ put_form }}\n                            <div class=\"form-actions\">\n                              <button class=\"btn btn-primary js-tooltip\" title=\"Make a PUT request on the {{ name }} resource\">PUT</button>\n                            </div>\n                          </fieldset>\n                        </form>\n                      </div>\n                    {% endif %}\n\n                    <div {% if put_form %}class=\"tab-pane\"{% endif %} id=\"put-generic-content-form\">\n                      {% with form=raw_data_put_or_patch_form %}\n                        <form action=\"{{ request.get_full_path }}\" data-method=\"PUT\" class=\"form-horizontal\">\n                          <fieldset>\n                            {% include \"rest_framework/raw_data_form.html\" %}\n                            <div class=\"form-actions\">\n                              {% if raw_data_put_form %}\n                                <button class=\"btn btn-primary js-tooltip\" title=\"Make a PUT request on the {{ name }} resource\">PUT</button>\n                              {% endif %}\n                              {% if raw_data_patch_form %}\n                              <button data-method=\"PATCH\" class=\"btn btn-primary js-tooltip\" title=\"Make a PATCH request on the {{ name }} resource\">PATCH</button>\n                                {% endif %}\n                            </div>\n                          </fieldset>\n                        </form>\n                      {% endwith %}\n                    </div>\n                  </div>\n                </div>\n              {% endif %}\n            {% endif %}\n          {% endblock content %}\n        </div><!-- /.content -->\n      </div><!-- /.container -->\n    </div><!-- ./wrapper -->\n\n    {% if filter_form %}\n      {{ filter_form }}\n    {% endif %}\n\n    {% block script %}\n      <script>\n        window.drf = {\n          csrfHeaderName: \"{{ csrf_header_name|default:'X-CSRFToken' }}\",\n          csrfCookieName: \"{{ csrf_cookie_name|default:'csrftoken' }}\"\n        };\n      </script>\n      <script src=\"{% static \"rest_framework/js/jquery-3.3.1.min.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/ajax-form.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/csrf.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/bootstrap.min.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/prettify-min.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/default.js\" %}\"></script>\n      <script>\n        $(document).ready(function() {\n          $('form').ajaxForm();\n        });\n      </script>\n    {% endblock %}\n\n  </body>\n  {% endblock %}\n</html>\n", "code_before": "{% load static %}\n{% load i18n %}\n{% load rest_framework %}\n\n<!DOCTYPE html>\n<html>\n  <head>\n    {% block head %}\n\n      {% block meta %}\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n        <meta name=\"robots\" content=\"NONE,NOARCHIVE\" />\n      {% endblock %}\n\n      <title>{% block title %}{% if name %}{{ name }} \u2013 {% endif %}Django REST framework{% endblock %}</title>\n\n      {% block style %}\n        {% block bootstrap_theme %}\n          <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"rest_framework/css/bootstrap.min.css\" %}\"/>\n          <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"rest_framework/css/bootstrap-tweaks.css\" %}\"/>\n        {% endblock %}\n\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"rest_framework/css/prettify.css\" %}\"/>\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static \"rest_framework/css/default.css\" %}\"/>\n        {% if code_style %}<style>{{ code_style }}</style>{% endif %}\n      {% endblock %}\n\n    {% endblock %}\n  </head>\n\n  {% block body %}\n  <body class=\"{% block bodyclass %}{% endblock %}\">\n\n    <div class=\"wrapper\">\n      {% block navbar %}\n        <div class=\"navbar navbar-static-top {% block bootstrap_navbar_variant %}navbar-inverse{% endblock %}\"\n             role=\"navigation\" aria-label=\"{% trans \"navbar\" %}\">\n          <div class=\"container\">\n            <span>\n              {% block branding %}\n                <a class='navbar-brand' rel=\"nofollow\" href='https://www.django-rest-framework.org/'>\n                    Django REST framework\n                </a>\n              {% endblock %}\n            </span>\n            <ul class=\"nav navbar-nav pull-right\">\n              {% block userlinks %}\n                {% if user.is_authenticated %}\n                  {% optional_logout request user %}\n                {% else %}\n                  {% optional_login request %}\n                {% endif %}\n              {% endblock %}\n            </ul>\n          </div>\n        </div>\n      {% endblock %}\n\n      <div class=\"container\">\n        {% block breadcrumbs %}\n          <ul class=\"breadcrumb\">\n            {% for breadcrumb_name, breadcrumb_url in breadcrumblist %}\n              {% if forloop.last %}\n                <li class=\"active\"><a href=\"{{ breadcrumb_url }}\">{{ breadcrumb_name }}</a></li>\n              {% else %}\n                <li><a href=\"{{ breadcrumb_url }}\">{{ breadcrumb_name }}</a></li>\n              {% endif %}\n            {% empty %}\n              {% block breadcrumbs_empty %}&nbsp;{% endblock breadcrumbs_empty %}\n            {% endfor %}\n          </ul>\n        {% endblock %}\n\n        <!-- Content -->\n        <div id=\"content\" role=\"main\" aria-label=\"{% trans \"content\" %}\">\n          {% block content %}\n\n          <div class=\"region\"  aria-label=\"{% trans \"request form\" %}\">\n          {% if 'GET' in allowed_methods %}\n            <form id=\"get-form\" class=\"pull-right\">\n              <fieldset>\n                {% if api_settings.URL_FORMAT_OVERRIDE %}\n                  <div class=\"btn-group format-selection\">\n                    <a class=\"btn btn-primary js-tooltip\" href=\"{{ request.get_full_path }}\" rel=\"nofollow\" title=\"Make a GET request on the {{ name }} resource\">GET</a>\n\n                    <button class=\"btn btn-primary dropdown-toggle js-tooltip\" data-toggle=\"dropdown\" title=\"Specify a format for the GET request\">\n                      <span class=\"caret\"></span>\n                    </button>\n                    <ul class=\"dropdown-menu\">\n                      {% for format in available_formats %}\n                        <li>\n                          <a class=\"js-tooltip format-option\" href=\"{% add_query_param request api_settings.URL_FORMAT_OVERRIDE format %}\" rel=\"nofollow\" title=\"Make a GET request on the {{ name }} resource with the format set to `{{ format }}`\">{{ format }}</a>\n                        </li>\n                      {% endfor %}\n                    </ul>\n                  </div>\n                {% else %}\n                  <a class=\"btn btn-primary js-tooltip\" href=\"{{ request.get_full_path }}\" rel=\"nofollow\" title=\"Make a GET request on the {{ name }} resource\">GET</a>\n                {% endif %}\n              </fieldset>\n            </form>\n          {% endif %}\n\n          {% if options_form %}\n            <form class=\"button-form\" action=\"{{ request.get_full_path }}\" data-method=\"OPTIONS\">\n              <button class=\"btn btn-primary js-tooltip\" title=\"Make an OPTIONS request on the {{ name }} resource\">OPTIONS</button>\n            </form>\n          {% endif %}\n\n          {% if delete_form %}\n            <button class=\"btn btn-danger button-form js-tooltip\" title=\"Make a DELETE request on the {{ name }} resource\" data-toggle=\"modal\" data-target=\"#deleteModal\">DELETE</button>\n\n            <!-- Delete Modal -->\n            <div class=\"modal fade\" id=\"deleteModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\n              <div class=\"modal-dialog\">\n                <div class=\"modal-content\">\n                  <div class=\"modal-body\">\n                    <h4 class=\"text-center\">Are you sure you want to delete this {{ name }}?</h4>\n                  </div>\n                  <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancel</button>\n                    <form class=\"button-form\" action=\"{{ request.get_full_path }}\" data-method=\"DELETE\">\n                      <button class=\"btn btn-danger\">Delete</button>\n                    </form>\n                  </div>\n                </div>\n              </div>\n            </div>\n          {% endif %}\n\n          {% if extra_actions %}\n            <div class=\"dropdown\" style=\"float: right; margin-right: 10px\">\n              <button class=\"btn btn-default\" id=\"extra-actions-menu\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                {% trans \"Extra Actions\" %}\n                <span class=\"caret\"></span>\n              </button>\n              <ul class=\"dropdown-menu\" aria-labelledby=\"extra-actions-menu\">\n                {% for action_name, url in extra_actions|items %}\n                <li><a href=\"{{ url }}\">{{ action_name }}</a></li>\n                {% endfor %}\n              </ul>\n            </div>\n          {% endif %}\n\n          {% if filter_form %}\n            <button style=\"float: right; margin-right: 10px\" data-toggle=\"modal\" data-target=\"#filtersModal\" class=\"btn btn-default\">\n              <span class=\"glyphicon glyphicon-wrench\" aria-hidden=\"true\"></span>\n              {% trans \"Filters\" %}\n            </button>\n          {% endif %}\n          </div>\n\n            <div class=\"content-main\" role=\"main\"  aria-label=\"{% trans \"main content\" %}\">\n              <div class=\"page-header\">\n                <h1>{{ name }}</h1>\n              </div>\n              <div style=\"float:left\">\n                {% block description %}\n                  {{ description }}\n                {% endblock %}\n              </div>\n\n              {% if paginator %}\n                <nav style=\"float: right\">\n                  {% get_pagination_html paginator %}\n                </nav>\n              {% endif %}\n\n              <div class=\"request-info\" style=\"clear: both\" aria-label=\"{% trans \"request info\" %}\">\n                <pre class=\"prettyprint\"><b>{{ request.method }}</b> {{ request.get_full_path }}</pre>\n              </div>\n\n              <div class=\"response-info\" aria-label=\"{% trans \"response info\" %}\">\n                <pre class=\"prettyprint\"><span class=\"meta nocode\"><b>HTTP {{ response.status_code }} {{ response.status_text }}</b>{% autoescape off %}{% for key, val in response_headers|items %}\n<b>{{ key }}:</b> <span class=\"lit\">{{ val|break_long_headers|urlize_quoted_links }}</span>{% endfor %}\n\n</span>{{ content|urlize_quoted_links }}</pre>{% endautoescape %}\n              </div>\n            </div>\n\n            {% if display_edit_forms %}\n              {% if post_form or raw_data_post_form %}\n                <div {% if post_form %}class=\"tabbable\"{% endif %}>\n                  {% if post_form %}\n                    <ul class=\"nav nav-tabs form-switcher\">\n                      <li>\n                        <a name='html-tab' href=\"#post-object-form\" data-toggle=\"tab\">HTML form</a>\n                      </li>\n                      <li>\n                        <a name='raw-tab' href=\"#post-generic-content-form\" data-toggle=\"tab\">Raw data</a>\n                      </li>\n                    </ul>\n                  {% endif %}\n\n                  <div class=\"well tab-content\">\n                    {% if post_form %}\n                      <div class=\"tab-pane\" id=\"post-object-form\">\n                        {% with form=post_form %}\n                          <form action=\"{{ request.get_full_path }}\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-horizontal\" novalidate>\n                            <fieldset>\n                              {% csrf_token %}\n                              {{ post_form }}\n                              <div class=\"form-actions\">\n                                <button class=\"btn btn-primary js-tooltip\" title=\"Make a POST request on the {{ name }} resource\">POST</button>\n                              </div>\n                            </fieldset>\n                          </form>\n                        {% endwith %}\n                      </div>\n                    {% endif %}\n\n                    <div {% if post_form %}class=\"tab-pane\"{% endif %} id=\"post-generic-content-form\">\n                      {% with form=raw_data_post_form %}\n                        <form action=\"{{ request.get_full_path }}\" method=\"POST\" class=\"form-horizontal\">\n                          <fieldset>\n                            {% include \"rest_framework/raw_data_form.html\" %}\n                            <div class=\"form-actions\">\n                              <button class=\"btn btn-primary js-tooltip\" title=\"Make a POST request on the {{ name }} resource\">POST</button>\n                            </div>\n                          </fieldset>\n                        </form>\n                      {% endwith %}\n                    </div>\n                  </div>\n                </div>\n              {% endif %}\n\n              {% if put_form or raw_data_put_form or raw_data_patch_form %}\n                <div {% if put_form %}class=\"tabbable\"{% endif %}>\n                  {% if put_form %}\n                    <ul class=\"nav nav-tabs form-switcher\">\n                      <li>\n                        <a name='html-tab' href=\"#put-object-form\" data-toggle=\"tab\">HTML form</a>\n                      </li>\n                      <li>\n                        <a  name='raw-tab' href=\"#put-generic-content-form\" data-toggle=\"tab\">Raw data</a>\n                      </li>\n                    </ul>\n                  {% endif %}\n\n                  <div class=\"well tab-content\">\n                    {% if put_form %}\n                      <div class=\"tab-pane\" id=\"put-object-form\">\n                        <form action=\"{{ request.get_full_path }}\" data-method=\"PUT\" enctype=\"multipart/form-data\" class=\"form-horizontal\" novalidate>\n                          <fieldset>\n                            {{ put_form }}\n                            <div class=\"form-actions\">\n                              <button class=\"btn btn-primary js-tooltip\" title=\"Make a PUT request on the {{ name }} resource\">PUT</button>\n                            </div>\n                          </fieldset>\n                        </form>\n                      </div>\n                    {% endif %}\n\n                    <div {% if put_form %}class=\"tab-pane\"{% endif %} id=\"put-generic-content-form\">\n                      {% with form=raw_data_put_or_patch_form %}\n                        <form action=\"{{ request.get_full_path }}\" data-method=\"PUT\" class=\"form-horizontal\">\n                          <fieldset>\n                            {% include \"rest_framework/raw_data_form.html\" %}\n                            <div class=\"form-actions\">\n                              {% if raw_data_put_form %}\n                                <button class=\"btn btn-primary js-tooltip\" title=\"Make a PUT request on the {{ name }} resource\">PUT</button>\n                              {% endif %}\n                              {% if raw_data_patch_form %}\n                              <button data-method=\"PATCH\" class=\"btn btn-primary js-tooltip\" title=\"Make a PATCH request on the {{ name }} resource\">PATCH</button>\n                                {% endif %}\n                            </div>\n                          </fieldset>\n                        </form>\n                      {% endwith %}\n                    </div>\n                  </div>\n                </div>\n              {% endif %}\n            {% endif %}\n          {% endblock content %}\n        </div><!-- /.content -->\n      </div><!-- /.container -->\n    </div><!-- ./wrapper -->\n\n    {% if filter_form %}\n      {{ filter_form }}\n    {% endif %}\n\n    {% block script %}\n      <script>\n        window.drf = {\n          csrfHeaderName: \"{{ csrf_header_name|default:'X-CSRFToken' }}\",\n          csrfCookieName: \"{{ csrf_cookie_name|default:'csrftoken' }}\"\n        };\n      </script>\n      <script src=\"{% static \"rest_framework/js/jquery-3.3.1.min.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/ajax-form.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/csrf.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/bootstrap.min.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/prettify-min.js\" %}\"></script>\n      <script src=\"{% static \"rest_framework/js/default.js\" %}\"></script>\n      <script>\n        $(document).ready(function() {\n          $('form').ajaxForm();\n        });\n      </script>\n    {% endblock %}\n\n  </body>\n  {% endblock %}\n</html>\n", "patch": "@@ -171,10 +171,10 @@ <h1>{{ name }}</h1>\n               </div>\n \n               <div class=\"response-info\" aria-label=\"{% trans \"response info\" %}\">\n-                <pre class=\"prettyprint\"><span class=\"meta nocode\"><b>HTTP {{ response.status_code }} {{ response.status_text }}</b>{% autoescape off %}{% for key, val in response_headers|items %}\n+                <pre class=\"prettyprint\"><span class=\"meta nocode\"><b>HTTP {{ response.status_code }} {{ response.status_text }}</b>{% for key, val in response_headers|items %}\n <b>{{ key }}:</b> <span class=\"lit\">{{ val|break_long_headers|urlize_quoted_links }}</span>{% endfor %}\n \n-</span>{{ content|urlize_quoted_links }}</pre>{% endautoescape %}\n+</span>{{ content|urlize_quoted_links }}</pre>\n               </div>\n             </div>\n ", "file_path": "files/2022_7/71", "file_language": "html", "file_name": "rest_framework/templates/rest_framework/base.html", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}, {"raw_url": "https://github.com/encode/django-rest-framework/raw/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8/rest_framework%2Ftemplatetags%2Frest_framework.py", "code": "from __future__ import absolute_import, unicode_literals\n\nimport re\nfrom collections import OrderedDict\n\nfrom django import template\nfrom django.template import loader\nfrom django.urls import NoReverseMatch, reverse\nfrom django.utils import six\nfrom django.utils.encoding import force_text, iri_to_uri\nfrom django.utils.html import escape, format_html, smart_urlquote\nfrom django.utils.safestring import SafeData, mark_safe\n\nfrom rest_framework.compat import apply_markdown, pygments_highlight\nfrom rest_framework.renderers import HTMLFormRenderer\nfrom rest_framework.utils.urls import replace_query_param\n\nregister = template.Library()\n\n# Regex for adding classes to html snippets\nclass_re = re.compile(r'(?<=class=[\"\\'])(.*)(?=[\"\\'])')\n\n\n@register.tag(name='code')\ndef highlight_code(parser, token):\n    code = token.split_contents()[-1]\n    nodelist = parser.parse(('endcode',))\n    parser.delete_first_token()\n    return CodeNode(code, nodelist)\n\n\nclass CodeNode(template.Node):\n    style = 'emacs'\n\n    def __init__(self, lang, code):\n        self.lang = lang\n        self.nodelist = code\n\n    def render(self, context):\n        text = self.nodelist.render(context)\n        return pygments_highlight(text, self.lang, self.style)\n\n\n@register.filter()\ndef with_location(fields, location):\n    return [\n        field for field in fields\n        if field.location == location\n    ]\n\n\n@register.simple_tag\ndef form_for_link(link):\n    import coreschema\n    properties = OrderedDict([\n        (field.name, field.schema or coreschema.String())\n        for field in link.fields\n    ])\n    required = [\n        field.name\n        for field in link.fields\n        if field.required\n    ]\n    schema = coreschema.Object(properties=properties, required=required)\n    return mark_safe(coreschema.render_to_form(schema))\n\n\n@register.simple_tag\ndef render_markdown(markdown_text):\n    if apply_markdown is None:\n        return markdown_text\n    return mark_safe(apply_markdown(markdown_text))\n\n\n@register.simple_tag\ndef get_pagination_html(pager):\n    return pager.to_html()\n\n\n@register.simple_tag\ndef render_form(serializer, template_pack=None):\n    style = {'template_pack': template_pack} if template_pack else {}\n    renderer = HTMLFormRenderer()\n    return renderer.render(serializer.data, None, {'style': style})\n\n\n@register.simple_tag\ndef render_field(field, style):\n    renderer = style.get('renderer', HTMLFormRenderer())\n    return renderer.render_field(field, style)\n\n\n@register.simple_tag\ndef optional_login(request):\n    \"\"\"\n    Include a login snippet if REST framework's login view is in the URLconf.\n    \"\"\"\n    try:\n        login_url = reverse('rest_framework:login')\n    except NoReverseMatch:\n        return ''\n\n    snippet = \"<li><a href='{href}?next={next}'>Log in</a></li>\"\n    snippet = format_html(snippet, href=login_url, next=escape(request.path))\n\n    return mark_safe(snippet)\n\n\n@register.simple_tag\ndef optional_docs_login(request):\n    \"\"\"\n    Include a login snippet if REST framework's login view is in the URLconf.\n    \"\"\"\n    try:\n        login_url = reverse('rest_framework:login')\n    except NoReverseMatch:\n        return 'log in'\n\n    snippet = \"<a href='{href}?next={next}'>log in</a>\"\n    snippet = format_html(snippet, href=login_url, next=escape(request.path))\n\n    return mark_safe(snippet)\n\n\n@register.simple_tag\ndef optional_logout(request, user):\n    \"\"\"\n    Include a logout snippet if REST framework's logout view is in the URLconf.\n    \"\"\"\n    try:\n        logout_url = reverse('rest_framework:logout')\n    except NoReverseMatch:\n        snippet = format_html('<li class=\"navbar-text\">{user}</li>', user=escape(user))\n        return mark_safe(snippet)\n\n    snippet = \"\"\"<li class=\"dropdown\">\n        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n            {user}\n            <b class=\"caret\"></b>\n        </a>\n        <ul class=\"dropdown-menu\">\n            <li><a href='{href}?next={next}'>Log out</a></li>\n        </ul>\n    </li>\"\"\"\n    snippet = format_html(snippet, user=escape(user), href=logout_url, next=escape(request.path))\n\n    return mark_safe(snippet)\n\n\n@register.simple_tag\ndef add_query_param(request, key, val):\n    \"\"\"\n    Add a query parameter to the current request url, and return the new url.\n    \"\"\"\n    iri = request.get_full_path()\n    uri = iri_to_uri(iri)\n    return escape(replace_query_param(uri, key, val))\n\n\n@register.filter\ndef as_string(value):\n    if value is None:\n        return ''\n    return '%s' % value\n\n\n@register.filter\ndef as_list_of_strings(value):\n    return [\n        '' if (item is None) else ('%s' % item)\n        for item in value\n    ]\n\n\n@register.filter\ndef add_class(value, css_class):\n    \"\"\"\n    https://stackoverflow.com/questions/4124220/django-adding-css-classes-when-rendering-form-fields-in-a-template\n\n    Inserts classes into template variables that contain HTML tags,\n    useful for modifying forms without needing to change the Form objects.\n\n    Usage:\n\n        {{ field.label_tag|add_class:\"control-label\" }}\n\n    In the case of REST Framework, the filter is used to add Bootstrap-specific\n    classes to the forms.\n    \"\"\"\n    html = six.text_type(value)\n    match = class_re.search(html)\n    if match:\n        m = re.search(r'^%s$|^%s\\s|\\s%s\\s|\\s%s$' % (css_class, css_class,\n                                                    css_class, css_class),\n                      match.group(1))\n        if not m:\n            return mark_safe(class_re.sub(match.group(1) + \" \" + css_class,\n                                          html))\n    else:\n        return mark_safe(html.replace('>', ' class=\"%s\">' % css_class, 1))\n    return value\n\n\n@register.filter\ndef format_value(value):\n    if getattr(value, 'is_hyperlink', False):\n        name = six.text_type(value.obj)\n        return mark_safe('<a href=%s>%s</a>' % (value, escape(name)))\n    if value is None or isinstance(value, bool):\n        return mark_safe('<code>%s</code>' % {True: 'true', False: 'false', None: 'null'}[value])\n    elif isinstance(value, list):\n        if any([isinstance(item, (list, dict)) for item in value]):\n            template = loader.get_template('rest_framework/admin/list_value.html')\n        else:\n            template = loader.get_template('rest_framework/admin/simple_list_value.html')\n        context = {'value': value}\n        return template.render(context)\n    elif isinstance(value, dict):\n        template = loader.get_template('rest_framework/admin/dict_value.html')\n        context = {'value': value}\n        return template.render(context)\n    elif isinstance(value, six.string_types):\n        if (\n            (value.startswith('http:') or value.startswith('https:')) and not\n            re.search(r'\\s', value)\n        ):\n            return mark_safe('<a href=\"{value}\">{value}</a>'.format(value=escape(value)))\n        elif '@' in value and not re.search(r'\\s', value):\n            return mark_safe('<a href=\"mailto:{value}\">{value}</a>'.format(value=escape(value)))\n        elif '\\n' in value:\n            return mark_safe('<pre>%s</pre>' % escape(value))\n    return six.text_type(value)\n\n\n@register.filter\ndef items(value):\n    \"\"\"\n    Simple filter to return the items of the dict. Useful when the dict may\n    have a key 'items' which is resolved first in Django tempalte dot-notation\n    lookup.  See issue #4931\n    Also see: https://stackoverflow.com/questions/15416662/django-template-loop-over-dictionary-items-with-items-as-key\n    \"\"\"\n    if value is None:\n        # `{% for k, v in value.items %}` doesn't raise when value is None or\n        # not in the context, so neither should `{% for k, v in value|items %}`\n        return []\n    return value.items()\n\n\n@register.filter\ndef data(value):\n    \"\"\"\n    Simple filter to access `data` attribute of object,\n    specifically coreapi.Document.\n\n    As per `items` filter above, allows accessing `document.data` when\n    Document contains Link keyed-at \"data\".\n\n    See issue #5395\n    \"\"\"\n    return value.data\n\n\n@register.filter\ndef schema_links(section, sec_key=None):\n    \"\"\"\n    Recursively find every link in a schema, even nested.\n    \"\"\"\n    NESTED_FORMAT = '%s > %s'  # this format is used in docs/js/api.js:normalizeKeys\n    links = section.links\n    if section.data:\n        data = section.data.items()\n        for sub_section_key, sub_section in data:\n            new_links = schema_links(sub_section, sec_key=sub_section_key)\n            links.update(new_links)\n\n    if sec_key is not None:\n        new_links = OrderedDict()\n        for link_key, link in links.items():\n            new_key = NESTED_FORMAT % (sec_key, link_key)\n            new_links.update({new_key: link})\n        return new_links\n\n    return links\n\n\n@register.filter\ndef add_nested_class(value):\n    if isinstance(value, dict):\n        return 'class=nested'\n    if isinstance(value, list) and any([isinstance(item, (list, dict)) for item in value]):\n        return 'class=nested'\n    return ''\n\n\n# Bunch of stuff cloned from urlize\nTRAILING_PUNCTUATION = ['.', ',', ':', ';', '.)', '\"', \"']\", \"'}\", \"'\"]\nWRAPPING_PUNCTUATION = [('(', ')'), ('<', '>'), ('[', ']'), ('&lt;', '&gt;'),\n                        ('\"', '\"'), (\"'\", \"'\")]\nword_split_re = re.compile(r'(\\s+)')\nsimple_url_re = re.compile(r'^https?://\\[?\\w', re.IGNORECASE)\nsimple_url_2_re = re.compile(r'^www\\.|^(?!http)\\w[^@]+\\.(com|edu|gov|int|mil|net|org)$', re.IGNORECASE)\nsimple_email_re = re.compile(r'^\\S+@\\S+\\.\\S+$')\n\n\ndef smart_urlquote_wrapper(matched_url):\n    \"\"\"\n    Simple wrapper for smart_urlquote. ValueError(\"Invalid IPv6 URL\") can\n    be raised here, see issue #1386\n    \"\"\"\n    try:\n        return smart_urlquote(matched_url)\n    except ValueError:\n        return None\n\n\n@register.filter(needs_autoescape=True)\ndef urlize_quoted_links(text, trim_url_limit=None, nofollow=True, autoescape=True):\n    \"\"\"\n    Converts any URLs in text into clickable links.\n\n    Works on http://, https://, www. links, and also on links ending in one of\n    the original seven gTLDs (.com, .edu, .gov, .int, .mil, .net, and .org).\n    Links can have trailing punctuation (periods, commas, close-parens) and\n    leading punctuation (opening parens) and it'll still do the right thing.\n\n    If trim_url_limit is not None, the URLs in link text longer than this limit\n    will truncated to trim_url_limit-3 characters and appended with an ellipsis.\n\n    If nofollow is True, the URLs in link text will get a rel=\"nofollow\"\n    attribute.\n\n    If autoescape is True, the link text and URLs will get autoescaped.\n    \"\"\"\n    def trim_url(x, limit=trim_url_limit):\n        return limit is not None and (len(x) > limit and ('%s...' % x[:max(0, limit - 3)])) or x\n\n    safe_input = isinstance(text, SafeData)\n\n    # Unfortunately, Django built-in cannot be used here, because escaping\n    # is to be performed on words, which have been forcibly coerced to text\n    def conditional_escape(text):\n        return escape(text) if autoescape and not safe_input else text\n\n    words = word_split_re.split(force_text(text))\n    for i, word in enumerate(words):\n        if '.' in word or '@' in word or ':' in word:\n            # Deal with punctuation.\n            lead, middle, trail = '', word, ''\n            for punctuation in TRAILING_PUNCTUATION:\n                if middle.endswith(punctuation):\n                    middle = middle[:-len(punctuation)]\n                    trail = punctuation + trail\n            for opening, closing in WRAPPING_PUNCTUATION:\n                if middle.startswith(opening):\n                    middle = middle[len(opening):]\n                    lead = lead + opening\n                # Keep parentheses at the end only if they're balanced.\n                if (\n                    middle.endswith(closing) and\n                    middle.count(closing) == middle.count(opening) + 1\n                ):\n                    middle = middle[:-len(closing)]\n                    trail = closing + trail\n\n            # Make URL we want to point to.\n            url = None\n            nofollow_attr = ' rel=\"nofollow\"' if nofollow else ''\n            if simple_url_re.match(middle):\n                url = smart_urlquote_wrapper(middle)\n            elif simple_url_2_re.match(middle):\n                url = smart_urlquote_wrapper('http://%s' % middle)\n            elif ':' not in middle and simple_email_re.match(middle):\n                local, domain = middle.rsplit('@', 1)\n                try:\n                    domain = domain.encode('idna').decode('ascii')\n                except UnicodeError:\n                    continue\n                url = 'mailto:%s@%s' % (local, domain)\n                nofollow_attr = ''\n\n            # Make link.\n            if url:\n                trimmed = trim_url(middle)\n                lead, trail = conditional_escape(lead), conditional_escape(trail)\n                url, trimmed = conditional_escape(url), conditional_escape(trimmed)\n                middle = '<a href=\"%s\"%s>%s</a>' % (url, nofollow_attr, trimmed)\n                words[i] = '%s%s%s' % (lead, middle, trail)\n            else:\n                words[i] = conditional_escape(word)\n        else:\n            words[i] = conditional_escape(word)\n    return mark_safe(''.join(words))\n\n\n@register.filter\ndef break_long_headers(header):\n    \"\"\"\n    Breaks headers longer than 160 characters (~page length)\n    when possible (are comma separated)\n    \"\"\"\n    if len(header) > 160 and ',' in header:\n        header = mark_safe('<br> ' + ', <br>'.join(header.split(',')))\n    return header\n", "code_before": "from __future__ import absolute_import, unicode_literals\n\nimport re\nfrom collections import OrderedDict\n\nfrom django import template\nfrom django.template import loader\nfrom django.urls import NoReverseMatch, reverse\nfrom django.utils import six\nfrom django.utils.encoding import force_text, iri_to_uri\nfrom django.utils.html import escape, format_html, smart_urlquote\nfrom django.utils.safestring import SafeData, mark_safe\n\nfrom rest_framework.compat import apply_markdown, pygments_highlight\nfrom rest_framework.renderers import HTMLFormRenderer\nfrom rest_framework.utils.urls import replace_query_param\n\nregister = template.Library()\n\n# Regex for adding classes to html snippets\nclass_re = re.compile(r'(?<=class=[\"\\'])(.*)(?=[\"\\'])')\n\n\n@register.tag(name='code')\ndef highlight_code(parser, token):\n    code = token.split_contents()[-1]\n    nodelist = parser.parse(('endcode',))\n    parser.delete_first_token()\n    return CodeNode(code, nodelist)\n\n\nclass CodeNode(template.Node):\n    style = 'emacs'\n\n    def __init__(self, lang, code):\n        self.lang = lang\n        self.nodelist = code\n\n    def render(self, context):\n        text = self.nodelist.render(context)\n        return pygments_highlight(text, self.lang, self.style)\n\n\n@register.filter()\ndef with_location(fields, location):\n    return [\n        field for field in fields\n        if field.location == location\n    ]\n\n\n@register.simple_tag\ndef form_for_link(link):\n    import coreschema\n    properties = OrderedDict([\n        (field.name, field.schema or coreschema.String())\n        for field in link.fields\n    ])\n    required = [\n        field.name\n        for field in link.fields\n        if field.required\n    ]\n    schema = coreschema.Object(properties=properties, required=required)\n    return mark_safe(coreschema.render_to_form(schema))\n\n\n@register.simple_tag\ndef render_markdown(markdown_text):\n    if apply_markdown is None:\n        return markdown_text\n    return mark_safe(apply_markdown(markdown_text))\n\n\n@register.simple_tag\ndef get_pagination_html(pager):\n    return pager.to_html()\n\n\n@register.simple_tag\ndef render_form(serializer, template_pack=None):\n    style = {'template_pack': template_pack} if template_pack else {}\n    renderer = HTMLFormRenderer()\n    return renderer.render(serializer.data, None, {'style': style})\n\n\n@register.simple_tag\ndef render_field(field, style):\n    renderer = style.get('renderer', HTMLFormRenderer())\n    return renderer.render_field(field, style)\n\n\n@register.simple_tag\ndef optional_login(request):\n    \"\"\"\n    Include a login snippet if REST framework's login view is in the URLconf.\n    \"\"\"\n    try:\n        login_url = reverse('rest_framework:login')\n    except NoReverseMatch:\n        return ''\n\n    snippet = \"<li><a href='{href}?next={next}'>Log in</a></li>\"\n    snippet = format_html(snippet, href=login_url, next=escape(request.path))\n\n    return mark_safe(snippet)\n\n\n@register.simple_tag\ndef optional_docs_login(request):\n    \"\"\"\n    Include a login snippet if REST framework's login view is in the URLconf.\n    \"\"\"\n    try:\n        login_url = reverse('rest_framework:login')\n    except NoReverseMatch:\n        return 'log in'\n\n    snippet = \"<a href='{href}?next={next}'>log in</a>\"\n    snippet = format_html(snippet, href=login_url, next=escape(request.path))\n\n    return mark_safe(snippet)\n\n\n@register.simple_tag\ndef optional_logout(request, user):\n    \"\"\"\n    Include a logout snippet if REST framework's logout view is in the URLconf.\n    \"\"\"\n    try:\n        logout_url = reverse('rest_framework:logout')\n    except NoReverseMatch:\n        snippet = format_html('<li class=\"navbar-text\">{user}</li>', user=escape(user))\n        return mark_safe(snippet)\n\n    snippet = \"\"\"<li class=\"dropdown\">\n        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n            {user}\n            <b class=\"caret\"></b>\n        </a>\n        <ul class=\"dropdown-menu\">\n            <li><a href='{href}?next={next}'>Log out</a></li>\n        </ul>\n    </li>\"\"\"\n    snippet = format_html(snippet, user=escape(user), href=logout_url, next=escape(request.path))\n\n    return mark_safe(snippet)\n\n\n@register.simple_tag\ndef add_query_param(request, key, val):\n    \"\"\"\n    Add a query parameter to the current request url, and return the new url.\n    \"\"\"\n    iri = request.get_full_path()\n    uri = iri_to_uri(iri)\n    return escape(replace_query_param(uri, key, val))\n\n\n@register.filter\ndef as_string(value):\n    if value is None:\n        return ''\n    return '%s' % value\n\n\n@register.filter\ndef as_list_of_strings(value):\n    return [\n        '' if (item is None) else ('%s' % item)\n        for item in value\n    ]\n\n\n@register.filter\ndef add_class(value, css_class):\n    \"\"\"\n    https://stackoverflow.com/questions/4124220/django-adding-css-classes-when-rendering-form-fields-in-a-template\n\n    Inserts classes into template variables that contain HTML tags,\n    useful for modifying forms without needing to change the Form objects.\n\n    Usage:\n\n        {{ field.label_tag|add_class:\"control-label\" }}\n\n    In the case of REST Framework, the filter is used to add Bootstrap-specific\n    classes to the forms.\n    \"\"\"\n    html = six.text_type(value)\n    match = class_re.search(html)\n    if match:\n        m = re.search(r'^%s$|^%s\\s|\\s%s\\s|\\s%s$' % (css_class, css_class,\n                                                    css_class, css_class),\n                      match.group(1))\n        if not m:\n            return mark_safe(class_re.sub(match.group(1) + \" \" + css_class,\n                                          html))\n    else:\n        return mark_safe(html.replace('>', ' class=\"%s\">' % css_class, 1))\n    return value\n\n\n@register.filter\ndef format_value(value):\n    if getattr(value, 'is_hyperlink', False):\n        name = six.text_type(value.obj)\n        return mark_safe('<a href=%s>%s</a>' % (value, escape(name)))\n    if value is None or isinstance(value, bool):\n        return mark_safe('<code>%s</code>' % {True: 'true', False: 'false', None: 'null'}[value])\n    elif isinstance(value, list):\n        if any([isinstance(item, (list, dict)) for item in value]):\n            template = loader.get_template('rest_framework/admin/list_value.html')\n        else:\n            template = loader.get_template('rest_framework/admin/simple_list_value.html')\n        context = {'value': value}\n        return template.render(context)\n    elif isinstance(value, dict):\n        template = loader.get_template('rest_framework/admin/dict_value.html')\n        context = {'value': value}\n        return template.render(context)\n    elif isinstance(value, six.string_types):\n        if (\n            (value.startswith('http:') or value.startswith('https:')) and not\n            re.search(r'\\s', value)\n        ):\n            return mark_safe('<a href=\"{value}\">{value}</a>'.format(value=escape(value)))\n        elif '@' in value and not re.search(r'\\s', value):\n            return mark_safe('<a href=\"mailto:{value}\">{value}</a>'.format(value=escape(value)))\n        elif '\\n' in value:\n            return mark_safe('<pre>%s</pre>' % escape(value))\n    return six.text_type(value)\n\n\n@register.filter\ndef items(value):\n    \"\"\"\n    Simple filter to return the items of the dict. Useful when the dict may\n    have a key 'items' which is resolved first in Django tempalte dot-notation\n    lookup.  See issue #4931\n    Also see: https://stackoverflow.com/questions/15416662/django-template-loop-over-dictionary-items-with-items-as-key\n    \"\"\"\n    if value is None:\n        # `{% for k, v in value.items %}` doesn't raise when value is None or\n        # not in the context, so neither should `{% for k, v in value|items %}`\n        return []\n    return value.items()\n\n\n@register.filter\ndef data(value):\n    \"\"\"\n    Simple filter to access `data` attribute of object,\n    specifically coreapi.Document.\n\n    As per `items` filter above, allows accessing `document.data` when\n    Document contains Link keyed-at \"data\".\n\n    See issue #5395\n    \"\"\"\n    return value.data\n\n\n@register.filter\ndef schema_links(section, sec_key=None):\n    \"\"\"\n    Recursively find every link in a schema, even nested.\n    \"\"\"\n    NESTED_FORMAT = '%s > %s'  # this format is used in docs/js/api.js:normalizeKeys\n    links = section.links\n    if section.data:\n        data = section.data.items()\n        for sub_section_key, sub_section in data:\n            new_links = schema_links(sub_section, sec_key=sub_section_key)\n            links.update(new_links)\n\n    if sec_key is not None:\n        new_links = OrderedDict()\n        for link_key, link in links.items():\n            new_key = NESTED_FORMAT % (sec_key, link_key)\n            new_links.update({new_key: link})\n        return new_links\n\n    return links\n\n\n@register.filter\ndef add_nested_class(value):\n    if isinstance(value, dict):\n        return 'class=nested'\n    if isinstance(value, list) and any([isinstance(item, (list, dict)) for item in value]):\n        return 'class=nested'\n    return ''\n\n\n# Bunch of stuff cloned from urlize\nTRAILING_PUNCTUATION = ['.', ',', ':', ';', '.)', '\"', \"']\", \"'}\", \"'\"]\nWRAPPING_PUNCTUATION = [('(', ')'), ('<', '>'), ('[', ']'), ('&lt;', '&gt;'),\n                        ('\"', '\"'), (\"'\", \"'\")]\nword_split_re = re.compile(r'(\\s+)')\nsimple_url_re = re.compile(r'^https?://\\[?\\w', re.IGNORECASE)\nsimple_url_2_re = re.compile(r'^www\\.|^(?!http)\\w[^@]+\\.(com|edu|gov|int|mil|net|org)$', re.IGNORECASE)\nsimple_email_re = re.compile(r'^\\S+@\\S+\\.\\S+$')\n\n\ndef smart_urlquote_wrapper(matched_url):\n    \"\"\"\n    Simple wrapper for smart_urlquote. ValueError(\"Invalid IPv6 URL\") can\n    be raised here, see issue #1386\n    \"\"\"\n    try:\n        return smart_urlquote(matched_url)\n    except ValueError:\n        return None\n\n\n@register.filter(needs_autoescape=True)\ndef urlize_quoted_links(text, trim_url_limit=None, nofollow=True, autoescape=True):\n    \"\"\"\n    Converts any URLs in text into clickable links.\n\n    Works on http://, https://, www. links, and also on links ending in one of\n    the original seven gTLDs (.com, .edu, .gov, .int, .mil, .net, and .org).\n    Links can have trailing punctuation (periods, commas, close-parens) and\n    leading punctuation (opening parens) and it'll still do the right thing.\n\n    If trim_url_limit is not None, the URLs in link text longer than this limit\n    will truncated to trim_url_limit-3 characters and appended with an ellipsis.\n\n    If nofollow is True, the URLs in link text will get a rel=\"nofollow\"\n    attribute.\n\n    If autoescape is True, the link text and URLs will get autoescaped.\n    \"\"\"\n    def trim_url(x, limit=trim_url_limit):\n        return limit is not None and (len(x) > limit and ('%s...' % x[:max(0, limit - 3)])) or x\n\n    safe_input = isinstance(text, SafeData)\n    words = word_split_re.split(force_text(text))\n    for i, word in enumerate(words):\n        if '.' in word or '@' in word or ':' in word:\n            # Deal with punctuation.\n            lead, middle, trail = '', word, ''\n            for punctuation in TRAILING_PUNCTUATION:\n                if middle.endswith(punctuation):\n                    middle = middle[:-len(punctuation)]\n                    trail = punctuation + trail\n            for opening, closing in WRAPPING_PUNCTUATION:\n                if middle.startswith(opening):\n                    middle = middle[len(opening):]\n                    lead = lead + opening\n                # Keep parentheses at the end only if they're balanced.\n                if (\n                    middle.endswith(closing) and\n                    middle.count(closing) == middle.count(opening) + 1\n                ):\n                    middle = middle[:-len(closing)]\n                    trail = closing + trail\n\n            # Make URL we want to point to.\n            url = None\n            nofollow_attr = ' rel=\"nofollow\"' if nofollow else ''\n            if simple_url_re.match(middle):\n                url = smart_urlquote_wrapper(middle)\n            elif simple_url_2_re.match(middle):\n                url = smart_urlquote_wrapper('http://%s' % middle)\n            elif ':' not in middle and simple_email_re.match(middle):\n                local, domain = middle.rsplit('@', 1)\n                try:\n                    domain = domain.encode('idna').decode('ascii')\n                except UnicodeError:\n                    continue\n                url = 'mailto:%s@%s' % (local, domain)\n                nofollow_attr = ''\n\n            # Make link.\n            if url:\n                trimmed = trim_url(middle)\n                if autoescape and not safe_input:\n                    lead, trail = escape(lead), escape(trail)\n                    url, trimmed = escape(url), escape(trimmed)\n                middle = '<a href=\"%s\"%s>%s</a>' % (url, nofollow_attr, trimmed)\n                words[i] = mark_safe('%s%s%s' % (lead, middle, trail))\n            else:\n                if safe_input:\n                    words[i] = mark_safe(word)\n                elif autoescape:\n                    words[i] = escape(word)\n        elif safe_input:\n            words[i] = mark_safe(word)\n        elif autoescape:\n            words[i] = escape(word)\n    return ''.join(words)\n\n\n@register.filter\ndef break_long_headers(header):\n    \"\"\"\n    Breaks headers longer than 160 characters (~page length)\n    when possible (are comma separated)\n    \"\"\"\n    if len(header) > 160 and ',' in header:\n        header = mark_safe('<br> ' + ', <br>'.join(header.split(',')))\n    return header\n", "patch": "@@ -336,6 +336,12 @@ def trim_url(x, limit=trim_url_limit):\n         return limit is not None and (len(x) > limit and ('%s...' % x[:max(0, limit - 3)])) or x\n \n     safe_input = isinstance(text, SafeData)\n+\n+    # Unfortunately, Django built-in cannot be used here, because escaping\n+    # is to be performed on words, which have been forcibly coerced to text\n+    def conditional_escape(text):\n+        return escape(text) if autoescape and not safe_input else text\n+\n     words = word_split_re.split(force_text(text))\n     for i, word in enumerate(words):\n         if '.' in word or '@' in word or ':' in word:\n@@ -376,21 +382,15 @@ def trim_url(x, limit=trim_url_limit):\n             # Make link.\n             if url:\n                 trimmed = trim_url(middle)\n-                if autoescape and not safe_input:\n-                    lead, trail = escape(lead), escape(trail)\n-                    url, trimmed = escape(url), escape(trimmed)\n+                lead, trail = conditional_escape(lead), conditional_escape(trail)\n+                url, trimmed = conditional_escape(url), conditional_escape(trimmed)\n                 middle = '<a href=\"%s\"%s>%s</a>' % (url, nofollow_attr, trimmed)\n-                words[i] = mark_safe('%s%s%s' % (lead, middle, trail))\n+                words[i] = '%s%s%s' % (lead, middle, trail)\n             else:\n-                if safe_input:\n-                    words[i] = mark_safe(word)\n-                elif autoescape:\n-                    words[i] = escape(word)\n-        elif safe_input:\n-            words[i] = mark_safe(word)\n-        elif autoescape:\n-            words[i] = escape(word)\n-    return ''.join(words)\n+                words[i] = conditional_escape(word)\n+        else:\n+            words[i] = conditional_escape(word)\n+    return mark_safe(''.join(words))\n \n \n @register.filter", "file_path": "files/2022_7/72", "file_language": "py", "file_name": "rest_framework/templatetags/rest_framework.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0, "llm_check": 1, "static_check": 1, "static": {"rats": [false, []], "semgrep": [true, ["       python.django.security.audit.avoid-mark-safe.avoid-mark-safe                                   \n          'mark_safe()' is used to mark a string as \"safe\" for HTML output. This disables escaping and\n          could therefore subject the content to XSS attacks. Use 'django.utils.html.format_html()' to\n          build HTML for rendering instead.                                                           \n          Details: https://sg.run/yd0P                                                                \n\n          390\u2506 words[i] = mark_safe(word)", "       python.django.security.audit.avoid-mark-safe.avoid-mark-safe                                   \n          'mark_safe()' is used to mark a string as \"safe\" for HTML output. This disables escaping and\n          could therefore subject the content to XSS attacks. Use 'django.utils.html.format_html()' to\n          build HTML for rendering instead.                                                           \n          Details: https://sg.run/yd0P                                                                \n\n          386\u2506 words[i] = mark_safe(word)", "       python.django.security.audit.avoid-mark-safe.avoid-mark-safe                                   \n          'mark_safe()' is used to mark a string as \"safe\" for HTML output. This disables escaping and\n          could therefore subject the content to XSS attacks. Use 'django.utils.html.format_html()' to\n          build HTML for rendering instead.                                                           \n          Details: https://sg.run/yd0P                                                                \n\n          383\u2506 words[i] = mark_safe('%s%s%s' % (lead, middle, trail))"]]}, "target": 1, "function_before": [{"function": "class CodeNode(template.Node):\n    style = 'emacs'\n\n    def __init__(self, lang, code):\n        self.lang = lang\n        self.nodelist = code\n\n    def render(self, context):\n        text = self.nodelist.render(context)\n        return pygments_highlight(text, self.lang, self.style)", "target": 0}, {"function": "def smart_urlquote_wrapper(matched_url):\n    \"\"\"\n    Simple wrapper for smart_urlquote. ValueError(\"Invalid IPv6 URL\") can\n    be raised here, see issue #1386\n    \"\"\"\n    try:\n        return smart_urlquote(matched_url)\n    except ValueError:\n        return None", "target": 0}], "function_after": [{"function": "class CodeNode(template.Node):\n    style = 'emacs'\n\n    def __init__(self, lang, code):\n        self.lang = lang\n        self.nodelist = code\n\n    def render(self, context):\n        text = self.nodelist.render(context)\n        return pygments_highlight(text, self.lang, self.style)", "target": 0}, {"function": "def smart_urlquote_wrapper(matched_url):\n    \"\"\"\n    Simple wrapper for smart_urlquote. ValueError(\"Invalid IPv6 URL\") can\n    be raised here, see issue #1386\n    \"\"\"\n    try:\n        return smart_urlquote(matched_url)\n    except ValueError:\n        return None", "target": 0}]}, {"raw_url": "https://github.com/encode/django-rest-framework/raw/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8/tests%2Ftest_templatetags.py", "code": "# encoding: utf-8\nfrom __future__ import unicode_literals\n\nimport unittest\n\nfrom django.template import Context, Template\nfrom django.test import TestCase\n\nfrom rest_framework.compat import coreapi, coreschema\nfrom rest_framework.relations import Hyperlink\nfrom rest_framework.templatetags import rest_framework\nfrom rest_framework.templatetags.rest_framework import (\n    add_nested_class, add_query_param, as_string, break_long_headers,\n    format_value, get_pagination_html, schema_links, urlize_quoted_links\n)\nfrom rest_framework.test import APIRequestFactory\n\nfactory = APIRequestFactory()\n\n\ndef format_html(html):\n    \"\"\"\n    Helper function that formats HTML in order for easier comparison\n    :param html: raw HTML text to be formatted\n    :return: Cleaned HTML with no newlines or spaces\n    \"\"\"\n    return html.replace('\\n', '').replace(' ', '')\n\n\nclass TemplateTagTests(TestCase):\n\n    def test_add_query_param_with_non_latin_character(self):\n        # Ensure we don't double-escape non-latin characters\n        # that are present in the querystring.\n        # See #1314.\n        request = factory.get(\"/\", {'q': '\u67e5\u8be2'})\n        json_url = add_query_param(request, \"format\", \"json\")\n        self.assertIn(\"q=%E6%9F%A5%E8%AF%A2\", json_url)\n        self.assertIn(\"format=json\", json_url)\n\n    def test_format_value_boolean_or_none(self):\n        \"\"\"\n        Tests format_value with booleans and None\n        \"\"\"\n        self.assertEqual(format_value(True), '<code>true</code>')\n        self.assertEqual(format_value(False), '<code>false</code>')\n        self.assertEqual(format_value(None), '<code>null</code>')\n\n    def test_format_value_hyperlink(self):\n        \"\"\"\n        Tests format_value with a URL\n        \"\"\"\n        url = 'http://url.com'\n        name = 'name_of_url'\n        hyperlink = Hyperlink(url, name)\n        self.assertEqual(format_value(hyperlink), '<a href=%s>%s</a>' % (url, name))\n\n    def test_format_value_list(self):\n        \"\"\"\n        Tests format_value with a list of strings\n        \"\"\"\n        list_items = ['item1', 'item2', 'item3']\n        self.assertEqual(format_value(list_items), '\\n item1, item2, item3\\n')\n        self.assertEqual(format_value([]), '\\n\\n')\n\n    def test_format_value_dict(self):\n        \"\"\"\n        Tests format_value with a dict\n        \"\"\"\n        test_dict = {'a': 'b'}\n        expected_dict_format = \"\"\"\n        <table class=\"table table-striped\">\n            <tbody>\n                <tr>\n                    <th>a</th>\n                    <td>b</td>\n                </tr>\n            </tbody>\n        </table>\"\"\"\n        self.assertEqual(\n            format_html(format_value(test_dict)),\n            format_html(expected_dict_format)\n        )\n\n    def test_format_value_table(self):\n        \"\"\"\n        Tests format_value with a list of lists/dicts\n        \"\"\"\n        list_of_lists = [['list1'], ['list2'], ['list3']]\n        expected_list_format = \"\"\"\n        <tableclass=\"tabletable-striped\">\n            <tbody>\n               <tr>\n                  <th>0</th>\n                  <td>list1</td>\n               </tr>\n               <tr>\n                  <th>1</th>\n                  <td>list2</td>\n               </tr>\n               <tr>\n                  <th>2</th>\n                  <td>list3</td>\n               </tr>\n            </tbody>\n            </table>\"\"\"\n        self.assertEqual(\n            format_html(format_value(list_of_lists)),\n            format_html(expected_list_format)\n        )\n\n        expected_dict_format = \"\"\"\n        <tableclass=\"tabletable-striped\">\n            <tbody>\n                <tr>\n                    <th>0</th>\n                    <td>\n                        <tableclass=\"tabletable-striped\">\n                            <tbody>\n                                <tr>\n                                    <th>item1</th>\n                                    <td>value1</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n                <tr>\n                    <th>1</th>\n                    <td>\n                        <tableclass=\"tabletable-striped\">\n                            <tbody>\n                                <tr>\n                                    <th>item2</th>\n                                    <td>value2</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n                <tr>\n                    <th>2</th>\n                    <td>\n                        <tableclass=\"tabletable-striped\">\n                            <tbody>\n                                <tr>\n                                    <th>item3</th>\n                                    <td>value3</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\"\"\"\n\n        list_of_dicts = [{'item1': 'value1'}, {'item2': 'value2'}, {'item3': 'value3'}]\n        self.assertEqual(\n            format_html(format_value(list_of_dicts)),\n            format_html(expected_dict_format)\n        )\n\n    def test_format_value_simple_string(self):\n        \"\"\"\n        Tests format_value with a simple string\n        \"\"\"\n        simple_string = 'this is an example of a string'\n        self.assertEqual(format_value(simple_string), simple_string)\n\n    def test_format_value_string_hyperlink(self):\n        \"\"\"\n        Tests format_value with a url\n        \"\"\"\n        url = 'http://www.example.com'\n        self.assertEqual(format_value(url), '<a href=\"http://www.example.com\">http://www.example.com</a>')\n\n    def test_format_value_string_email(self):\n        \"\"\"\n        Tests format_value with an email address\n        \"\"\"\n        email = 'something@somewhere.com'\n        self.assertEqual(format_value(email), '<a href=\"mailto:something@somewhere.com\">something@somewhere.com</a>')\n\n    def test_format_value_string_newlines(self):\n        \"\"\"\n        Tests format_value with a string with newline characters\n        :return:\n        \"\"\"\n        text = 'Dear user, \\n this is a message \\n from,\\nsomeone'\n        self.assertEqual(format_value(text), '<pre>Dear user, \\n this is a message \\n from,\\nsomeone</pre>')\n\n    def test_format_value_object(self):\n        \"\"\"\n        Tests that format_value with a object returns the object's __str__ method\n        \"\"\"\n        obj = object()\n        self.assertEqual(format_value(obj), obj.__str__())\n\n    def test_add_nested_class(self):\n        \"\"\"\n        Tests that add_nested_class returns the proper class\n        \"\"\"\n        positive_cases = [\n            [['item']],\n            [{'item1': 'value1'}],\n            {'item1': 'value1'}\n        ]\n\n        negative_cases = [\n            ['list'],\n            '',\n            None,\n            True,\n            False\n        ]\n\n        for case in positive_cases:\n            self.assertEqual(add_nested_class(case), 'class=nested')\n\n        for case in negative_cases:\n            self.assertEqual(add_nested_class(case), '')\n\n    def test_as_string_with_none(self):\n        result = as_string(None)\n        assert result == ''\n\n    def test_get_pagination_html(self):\n        class MockPager(object):\n            def __init__(self):\n                self.called = False\n\n            def to_html(self):\n                self.called = True\n\n        pager = MockPager()\n        get_pagination_html(pager)\n        assert pager.called is True\n\n    def test_break_long_lines(self):\n        header = 'long test header,' * 20\n        expected_header = '<br> ' + ', <br>'.join(header.split(','))\n        assert break_long_headers(header) == expected_header\n\n\nclass Issue1386Tests(TestCase):\n    \"\"\"\n    Covers #1386\n    \"\"\"\n\n    def test_issue_1386(self):\n        \"\"\"\n        Test function urlize_quoted_links with different args\n        \"\"\"\n        correct_urls = [\n            \"asdf.com\",\n            \"asdf.net\",\n            \"www.as_df.org\",\n            \"as.d8f.ghj8.gov\",\n        ]\n        for i in correct_urls:\n            res = urlize_quoted_links(i)\n            self.assertNotEqual(res, i)\n            self.assertIn(i, res)\n\n        incorrect_urls = [\n            \"mailto://asdf@fdf.com\",\n            \"asdf.netnet\",\n        ]\n        for i in incorrect_urls:\n            res = urlize_quoted_links(i)\n            self.assertEqual(i, res)\n\n        # example from issue #1386, this shouldn't raise an exception\n        urlize_quoted_links(\"asdf:[/p]zxcv.com\")\n\n    def test_smart_urlquote_wrapper_handles_value_error(self):\n        def mock_smart_urlquote(url):\n            raise ValueError\n\n        old = rest_framework.smart_urlquote\n        rest_framework.smart_urlquote = mock_smart_urlquote\n        assert rest_framework.smart_urlquote_wrapper('test') is None\n        rest_framework.smart_urlquote = old\n\n\nclass URLizerTests(TestCase):\n    \"\"\"\n    Test if JSON URLs are transformed into links well\n    \"\"\"\n    def _urlize_dict_check(self, data):\n        \"\"\"\n        For all items in dict test assert that the value is urlized key\n        \"\"\"\n        for original, urlized in data.items():\n            assert urlize_quoted_links(original, nofollow=False) == urlized\n\n    def test_json_with_url(self):\n        \"\"\"\n        Test if JSON URLs are transformed into links well\n        \"\"\"\n        data = {}\n        data['\"url\": \"http://api/users/1/\", '] = \\\n            '&quot;url&quot;: &quot;<a href=\"http://api/users/1/\">http://api/users/1/</a>&quot;, '\n        data['\"foo_set\": [\\n    \"http://api/foos/1/\"\\n], '] = \\\n            '&quot;foo_set&quot;: [\\n    &quot;<a href=\"http://api/foos/1/\">http://api/foos/1/</a>&quot;\\n], '\n        self._urlize_dict_check(data)\n\n    def test_template_render_with_autoescape(self):\n        \"\"\"\n        Test that HTML is correctly escaped in Browsable API views.\n        \"\"\"\n        template = Template(\"{% load rest_framework %}{{ content|urlize_quoted_links }}\")\n        rendered = template.render(Context({'content': '<script>alert()</script> http://example.com'}))\n        assert rendered == '&lt;script&gt;alert()&lt;/script&gt;' \\\n                           ' <a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a>'\n\n    def test_template_render_with_noautoescape(self):\n        \"\"\"\n        Test if the autoescape value is getting passed to urlize_quoted_links filter.\n        \"\"\"\n        template = Template(\"{% load rest_framework %}\"\n                            \"{% autoescape off %}{{ content|urlize_quoted_links }}\"\n                            \"{% endautoescape %}\")\n        rendered = template.render(Context({'content': '<b> \"http://example.com\" </b>'}))\n        assert rendered == '<b> \"<a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a>\" </b>'\n\n\n@unittest.skipUnless(coreapi, 'coreapi is not installed')\nclass SchemaLinksTests(TestCase):\n\n    def test_schema_with_empty_links(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'list': {}\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 0\n\n    def test_single_action(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'list': coreapi.Link(\n                        url='/users/',\n                        action='get',\n                        fields=[]\n                    )\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 1\n        assert 'list' in flat_links\n\n    def test_default_actions(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'create': coreapi.Link(\n                        url='/users/',\n                        action='post',\n                        fields=[]\n                    ),\n                    'list': coreapi.Link(\n                        url='/users/',\n                        action='get',\n                        fields=[]\n                    ),\n                    'read': coreapi.Link(\n                        url='/users/{id}/',\n                        action='get',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'update': coreapi.Link(\n                        url='/users/{id}/',\n                        action='patch',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    )\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 4\n        assert 'list' in flat_links\n        assert 'create' in flat_links\n        assert 'read' in flat_links\n        assert 'update' in flat_links\n\n    def test_default_actions_and_single_custom_action(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'create': coreapi.Link(\n                        url='/users/',\n                        action='post',\n                        fields=[]\n                    ),\n                    'list': coreapi.Link(\n                        url='/users/',\n                        action='get',\n                        fields=[]\n                    ),\n                    'read': coreapi.Link(\n                        url='/users/{id}/',\n                        action='get',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'update': coreapi.Link(\n                        url='/users/{id}/',\n                        action='patch',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'friends': coreapi.Link(\n                        url='/users/{id}/friends',\n                        action='get',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    )\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 5\n        assert 'list' in flat_links\n        assert 'create' in flat_links\n        assert 'read' in flat_links\n        assert 'update' in flat_links\n        assert 'friends' in flat_links\n\n    def test_default_actions_and_single_custom_action_two_methods(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'create': coreapi.Link(\n                        url='/users/',\n                        action='post',\n                        fields=[]\n                    ),\n                    'list': coreapi.Link(\n                        url='/users/',\n                        action='get',\n                        fields=[]\n                    ),\n                    'read': coreapi.Link(\n                        url='/users/{id}/',\n                        action='get',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'update': coreapi.Link(\n                        url='/users/{id}/',\n                        action='patch',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'friends': {\n                        'list': coreapi.Link(\n                            url='/users/{id}/friends',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        ),\n                        'create': coreapi.Link(\n                            url='/users/{id}/friends',\n                            action='post',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        )\n                    }\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 6\n        assert 'list' in flat_links\n        assert 'create' in flat_links\n        assert 'read' in flat_links\n        assert 'update' in flat_links\n        assert 'friends > list' in flat_links\n        assert 'friends > create' in flat_links\n\n    def test_multiple_nested_routes(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'animals': {\n                    'dog': {\n                        'vet': {\n                            'list': coreapi.Link(\n                                url='/animals/dog/{id}/vet',\n                                action='get',\n                                fields=[\n                                    coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                                ]\n                            )\n                        },\n                        'read': coreapi.Link(\n                            url='/animals/dog/{id}',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        )\n                    },\n                    'cat': {\n                        'list': coreapi.Link(\n                            url='/animals/cat/',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        ),\n                        'create': coreapi.Link(\n                            url='/aniamls/cat',\n                            action='post',\n                            fields=[]\n                        )\n                    }\n                }\n            }\n        )\n        section = schema['animals']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 4\n        assert 'cat > create' in flat_links\n        assert 'cat > list' in flat_links\n        assert 'dog > read' in flat_links\n        assert 'dog > vet > list' in flat_links\n\n    def test_multiple_resources_with_multiple_nested_routes(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'animals': {\n                    'dog': {\n                        'vet': {\n                            'list': coreapi.Link(\n                                url='/animals/dog/{id}/vet',\n                                action='get',\n                                fields=[\n                                    coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                                ]\n                            )\n                        },\n                        'read': coreapi.Link(\n                            url='/animals/dog/{id}',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        )\n                    },\n                    'cat': {\n                        'list': coreapi.Link(\n                            url='/animals/cat/',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        ),\n                        'create': coreapi.Link(\n                            url='/aniamls/cat',\n                            action='post',\n                            fields=[]\n                        )\n                    }\n                },\n                'farmers': {\n                    'silo': {\n                        'soy': {\n                            'list': coreapi.Link(\n                                url='/farmers/silo/{id}/soy',\n                                action='get',\n                                fields=[\n                                    coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                                ]\n                            )\n                        },\n                        'list': coreapi.Link(\n                            url='/farmers/silo',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        )\n                    }\n                }\n            }\n        )\n        section = schema['animals']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 4\n        assert 'cat > create' in flat_links\n        assert 'cat > list' in flat_links\n        assert 'dog > read' in flat_links\n        assert 'dog > vet > list' in flat_links\n\n        section = schema['farmers']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 2\n        assert 'silo > list' in flat_links\n        assert 'silo > soy > list' in flat_links\n", "code_before": "# encoding: utf-8\nfrom __future__ import unicode_literals\n\nimport unittest\n\nfrom django.template import Context, Template\nfrom django.test import TestCase\n\nfrom rest_framework.compat import coreapi, coreschema\nfrom rest_framework.relations import Hyperlink\nfrom rest_framework.templatetags import rest_framework\nfrom rest_framework.templatetags.rest_framework import (\n    add_nested_class, add_query_param, as_string, break_long_headers,\n    format_value, get_pagination_html, schema_links, urlize_quoted_links\n)\nfrom rest_framework.test import APIRequestFactory\n\nfactory = APIRequestFactory()\n\n\ndef format_html(html):\n    \"\"\"\n    Helper function that formats HTML in order for easier comparison\n    :param html: raw HTML text to be formatted\n    :return: Cleaned HTML with no newlines or spaces\n    \"\"\"\n    return html.replace('\\n', '').replace(' ', '')\n\n\nclass TemplateTagTests(TestCase):\n\n    def test_add_query_param_with_non_latin_character(self):\n        # Ensure we don't double-escape non-latin characters\n        # that are present in the querystring.\n        # See #1314.\n        request = factory.get(\"/\", {'q': '\u67e5\u8be2'})\n        json_url = add_query_param(request, \"format\", \"json\")\n        self.assertIn(\"q=%E6%9F%A5%E8%AF%A2\", json_url)\n        self.assertIn(\"format=json\", json_url)\n\n    def test_format_value_boolean_or_none(self):\n        \"\"\"\n        Tests format_value with booleans and None\n        \"\"\"\n        self.assertEqual(format_value(True), '<code>true</code>')\n        self.assertEqual(format_value(False), '<code>false</code>')\n        self.assertEqual(format_value(None), '<code>null</code>')\n\n    def test_format_value_hyperlink(self):\n        \"\"\"\n        Tests format_value with a URL\n        \"\"\"\n        url = 'http://url.com'\n        name = 'name_of_url'\n        hyperlink = Hyperlink(url, name)\n        self.assertEqual(format_value(hyperlink), '<a href=%s>%s</a>' % (url, name))\n\n    def test_format_value_list(self):\n        \"\"\"\n        Tests format_value with a list of strings\n        \"\"\"\n        list_items = ['item1', 'item2', 'item3']\n        self.assertEqual(format_value(list_items), '\\n item1, item2, item3\\n')\n        self.assertEqual(format_value([]), '\\n\\n')\n\n    def test_format_value_dict(self):\n        \"\"\"\n        Tests format_value with a dict\n        \"\"\"\n        test_dict = {'a': 'b'}\n        expected_dict_format = \"\"\"\n        <table class=\"table table-striped\">\n            <tbody>\n                <tr>\n                    <th>a</th>\n                    <td>b</td>\n                </tr>\n            </tbody>\n        </table>\"\"\"\n        self.assertEqual(\n            format_html(format_value(test_dict)),\n            format_html(expected_dict_format)\n        )\n\n    def test_format_value_table(self):\n        \"\"\"\n        Tests format_value with a list of lists/dicts\n        \"\"\"\n        list_of_lists = [['list1'], ['list2'], ['list3']]\n        expected_list_format = \"\"\"\n        <tableclass=\"tabletable-striped\">\n            <tbody>\n               <tr>\n                  <th>0</th>\n                  <td>list1</td>\n               </tr>\n               <tr>\n                  <th>1</th>\n                  <td>list2</td>\n               </tr>\n               <tr>\n                  <th>2</th>\n                  <td>list3</td>\n               </tr>\n            </tbody>\n            </table>\"\"\"\n        self.assertEqual(\n            format_html(format_value(list_of_lists)),\n            format_html(expected_list_format)\n        )\n\n        expected_dict_format = \"\"\"\n        <tableclass=\"tabletable-striped\">\n            <tbody>\n                <tr>\n                    <th>0</th>\n                    <td>\n                        <tableclass=\"tabletable-striped\">\n                            <tbody>\n                                <tr>\n                                    <th>item1</th>\n                                    <td>value1</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n                <tr>\n                    <th>1</th>\n                    <td>\n                        <tableclass=\"tabletable-striped\">\n                            <tbody>\n                                <tr>\n                                    <th>item2</th>\n                                    <td>value2</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n                <tr>\n                    <th>2</th>\n                    <td>\n                        <tableclass=\"tabletable-striped\">\n                            <tbody>\n                                <tr>\n                                    <th>item3</th>\n                                    <td>value3</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\"\"\"\n\n        list_of_dicts = [{'item1': 'value1'}, {'item2': 'value2'}, {'item3': 'value3'}]\n        self.assertEqual(\n            format_html(format_value(list_of_dicts)),\n            format_html(expected_dict_format)\n        )\n\n    def test_format_value_simple_string(self):\n        \"\"\"\n        Tests format_value with a simple string\n        \"\"\"\n        simple_string = 'this is an example of a string'\n        self.assertEqual(format_value(simple_string), simple_string)\n\n    def test_format_value_string_hyperlink(self):\n        \"\"\"\n        Tests format_value with a url\n        \"\"\"\n        url = 'http://www.example.com'\n        self.assertEqual(format_value(url), '<a href=\"http://www.example.com\">http://www.example.com</a>')\n\n    def test_format_value_string_email(self):\n        \"\"\"\n        Tests format_value with an email address\n        \"\"\"\n        email = 'something@somewhere.com'\n        self.assertEqual(format_value(email), '<a href=\"mailto:something@somewhere.com\">something@somewhere.com</a>')\n\n    def test_format_value_string_newlines(self):\n        \"\"\"\n        Tests format_value with a string with newline characters\n        :return:\n        \"\"\"\n        text = 'Dear user, \\n this is a message \\n from,\\nsomeone'\n        self.assertEqual(format_value(text), '<pre>Dear user, \\n this is a message \\n from,\\nsomeone</pre>')\n\n    def test_format_value_object(self):\n        \"\"\"\n        Tests that format_value with a object returns the object's __str__ method\n        \"\"\"\n        obj = object()\n        self.assertEqual(format_value(obj), obj.__str__())\n\n    def test_add_nested_class(self):\n        \"\"\"\n        Tests that add_nested_class returns the proper class\n        \"\"\"\n        positive_cases = [\n            [['item']],\n            [{'item1': 'value1'}],\n            {'item1': 'value1'}\n        ]\n\n        negative_cases = [\n            ['list'],\n            '',\n            None,\n            True,\n            False\n        ]\n\n        for case in positive_cases:\n            self.assertEqual(add_nested_class(case), 'class=nested')\n\n        for case in negative_cases:\n            self.assertEqual(add_nested_class(case), '')\n\n    def test_as_string_with_none(self):\n        result = as_string(None)\n        assert result == ''\n\n    def test_get_pagination_html(self):\n        class MockPager(object):\n            def __init__(self):\n                self.called = False\n\n            def to_html(self):\n                self.called = True\n\n        pager = MockPager()\n        get_pagination_html(pager)\n        assert pager.called is True\n\n    def test_break_long_lines(self):\n        header = 'long test header,' * 20\n        expected_header = '<br> ' + ', <br>'.join(header.split(','))\n        assert break_long_headers(header) == expected_header\n\n\nclass Issue1386Tests(TestCase):\n    \"\"\"\n    Covers #1386\n    \"\"\"\n\n    def test_issue_1386(self):\n        \"\"\"\n        Test function urlize_quoted_links with different args\n        \"\"\"\n        correct_urls = [\n            \"asdf.com\",\n            \"asdf.net\",\n            \"www.as_df.org\",\n            \"as.d8f.ghj8.gov\",\n        ]\n        for i in correct_urls:\n            res = urlize_quoted_links(i)\n            self.assertNotEqual(res, i)\n            self.assertIn(i, res)\n\n        incorrect_urls = [\n            \"mailto://asdf@fdf.com\",\n            \"asdf.netnet\",\n        ]\n        for i in incorrect_urls:\n            res = urlize_quoted_links(i)\n            self.assertEqual(i, res)\n\n        # example from issue #1386, this shouldn't raise an exception\n        urlize_quoted_links(\"asdf:[/p]zxcv.com\")\n\n    def test_smart_urlquote_wrapper_handles_value_error(self):\n        def mock_smart_urlquote(url):\n            raise ValueError\n\n        old = rest_framework.smart_urlquote\n        rest_framework.smart_urlquote = mock_smart_urlquote\n        assert rest_framework.smart_urlquote_wrapper('test') is None\n        rest_framework.smart_urlquote = old\n\n\nclass URLizerTests(TestCase):\n    \"\"\"\n    Test if JSON URLs are transformed into links well\n    \"\"\"\n    def _urlize_dict_check(self, data):\n        \"\"\"\n        For all items in dict test assert that the value is urlized key\n        \"\"\"\n        for original, urlized in data.items():\n            assert urlize_quoted_links(original, nofollow=False) == urlized\n\n    def test_json_with_url(self):\n        \"\"\"\n        Test if JSON URLs are transformed into links well\n        \"\"\"\n        data = {}\n        data['\"url\": \"http://api/users/1/\", '] = \\\n            '&quot;url&quot;: &quot;<a href=\"http://api/users/1/\">http://api/users/1/</a>&quot;, '\n        data['\"foo_set\": [\\n    \"http://api/foos/1/\"\\n], '] = \\\n            '&quot;foo_set&quot;: [\\n    &quot;<a href=\"http://api/foos/1/\">http://api/foos/1/</a>&quot;\\n], '\n        self._urlize_dict_check(data)\n\n    def test_template_render_with_noautoescape(self):\n        \"\"\"\n        Test if the autoescape value is getting passed to urlize_quoted_links filter.\n        \"\"\"\n        template = Template(\"{% load rest_framework %}\"\n                            \"{% autoescape off %}{{ content|urlize_quoted_links }}\"\n                            \"{% endautoescape %}\")\n        rendered = template.render(Context({'content': '\"http://example.com\"'}))\n        assert rendered == '\"<a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a>\"'\n\n\n@unittest.skipUnless(coreapi, 'coreapi is not installed')\nclass SchemaLinksTests(TestCase):\n\n    def test_schema_with_empty_links(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'list': {}\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 0\n\n    def test_single_action(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'list': coreapi.Link(\n                        url='/users/',\n                        action='get',\n                        fields=[]\n                    )\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 1\n        assert 'list' in flat_links\n\n    def test_default_actions(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'create': coreapi.Link(\n                        url='/users/',\n                        action='post',\n                        fields=[]\n                    ),\n                    'list': coreapi.Link(\n                        url='/users/',\n                        action='get',\n                        fields=[]\n                    ),\n                    'read': coreapi.Link(\n                        url='/users/{id}/',\n                        action='get',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'update': coreapi.Link(\n                        url='/users/{id}/',\n                        action='patch',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    )\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 4\n        assert 'list' in flat_links\n        assert 'create' in flat_links\n        assert 'read' in flat_links\n        assert 'update' in flat_links\n\n    def test_default_actions_and_single_custom_action(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'create': coreapi.Link(\n                        url='/users/',\n                        action='post',\n                        fields=[]\n                    ),\n                    'list': coreapi.Link(\n                        url='/users/',\n                        action='get',\n                        fields=[]\n                    ),\n                    'read': coreapi.Link(\n                        url='/users/{id}/',\n                        action='get',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'update': coreapi.Link(\n                        url='/users/{id}/',\n                        action='patch',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'friends': coreapi.Link(\n                        url='/users/{id}/friends',\n                        action='get',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    )\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 5\n        assert 'list' in flat_links\n        assert 'create' in flat_links\n        assert 'read' in flat_links\n        assert 'update' in flat_links\n        assert 'friends' in flat_links\n\n    def test_default_actions_and_single_custom_action_two_methods(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'users': {\n                    'create': coreapi.Link(\n                        url='/users/',\n                        action='post',\n                        fields=[]\n                    ),\n                    'list': coreapi.Link(\n                        url='/users/',\n                        action='get',\n                        fields=[]\n                    ),\n                    'read': coreapi.Link(\n                        url='/users/{id}/',\n                        action='get',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'update': coreapi.Link(\n                        url='/users/{id}/',\n                        action='patch',\n                        fields=[\n                            coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                        ]\n                    ),\n                    'friends': {\n                        'list': coreapi.Link(\n                            url='/users/{id}/friends',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        ),\n                        'create': coreapi.Link(\n                            url='/users/{id}/friends',\n                            action='post',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        )\n                    }\n                }\n            }\n        )\n        section = schema['users']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 6\n        assert 'list' in flat_links\n        assert 'create' in flat_links\n        assert 'read' in flat_links\n        assert 'update' in flat_links\n        assert 'friends > list' in flat_links\n        assert 'friends > create' in flat_links\n\n    def test_multiple_nested_routes(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'animals': {\n                    'dog': {\n                        'vet': {\n                            'list': coreapi.Link(\n                                url='/animals/dog/{id}/vet',\n                                action='get',\n                                fields=[\n                                    coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                                ]\n                            )\n                        },\n                        'read': coreapi.Link(\n                            url='/animals/dog/{id}',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        )\n                    },\n                    'cat': {\n                        'list': coreapi.Link(\n                            url='/animals/cat/',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        ),\n                        'create': coreapi.Link(\n                            url='/aniamls/cat',\n                            action='post',\n                            fields=[]\n                        )\n                    }\n                }\n            }\n        )\n        section = schema['animals']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 4\n        assert 'cat > create' in flat_links\n        assert 'cat > list' in flat_links\n        assert 'dog > read' in flat_links\n        assert 'dog > vet > list' in flat_links\n\n    def test_multiple_resources_with_multiple_nested_routes(self):\n        schema = coreapi.Document(\n            url='',\n            title='Example API',\n            content={\n                'animals': {\n                    'dog': {\n                        'vet': {\n                            'list': coreapi.Link(\n                                url='/animals/dog/{id}/vet',\n                                action='get',\n                                fields=[\n                                    coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                                ]\n                            )\n                        },\n                        'read': coreapi.Link(\n                            url='/animals/dog/{id}',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        )\n                    },\n                    'cat': {\n                        'list': coreapi.Link(\n                            url='/animals/cat/',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        ),\n                        'create': coreapi.Link(\n                            url='/aniamls/cat',\n                            action='post',\n                            fields=[]\n                        )\n                    }\n                },\n                'farmers': {\n                    'silo': {\n                        'soy': {\n                            'list': coreapi.Link(\n                                url='/farmers/silo/{id}/soy',\n                                action='get',\n                                fields=[\n                                    coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                                ]\n                            )\n                        },\n                        'list': coreapi.Link(\n                            url='/farmers/silo',\n                            action='get',\n                            fields=[\n                                coreapi.Field('id', required=True, location='path', schema=coreschema.String())\n                            ]\n                        )\n                    }\n                }\n            }\n        )\n        section = schema['animals']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 4\n        assert 'cat > create' in flat_links\n        assert 'cat > list' in flat_links\n        assert 'dog > read' in flat_links\n        assert 'dog > vet > list' in flat_links\n\n        section = schema['farmers']\n        flat_links = schema_links(section)\n        assert len(flat_links) is 2\n        assert 'silo > list' in flat_links\n        assert 'silo > soy > list' in flat_links\n", "patch": "@@ -305,15 +305,24 @@ def test_json_with_url(self):\n             '&quot;foo_set&quot;: [\\n    &quot;<a href=\"http://api/foos/1/\">http://api/foos/1/</a>&quot;\\n], '\n         self._urlize_dict_check(data)\n \n+    def test_template_render_with_autoescape(self):\n+        \"\"\"\n+        Test that HTML is correctly escaped in Browsable API views.\n+        \"\"\"\n+        template = Template(\"{% load rest_framework %}{{ content|urlize_quoted_links }}\")\n+        rendered = template.render(Context({'content': '<script>alert()</script> http://example.com'}))\n+        assert rendered == '&lt;script&gt;alert()&lt;/script&gt;' \\\n+                           ' <a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a>'\n+\n     def test_template_render_with_noautoescape(self):\n         \"\"\"\n         Test if the autoescape value is getting passed to urlize_quoted_links filter.\n         \"\"\"\n         template = Template(\"{% load rest_framework %}\"\n                             \"{% autoescape off %}{{ content|urlize_quoted_links }}\"\n                             \"{% endautoescape %}\")\n-        rendered = template.render(Context({'content': '\"http://example.com\"'}))\n-        assert rendered == '\"<a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a>\"'\n+        rendered = template.render(Context({'content': '<b> \"http://example.com\" </b>'}))\n+        assert rendered == '<b> \"<a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a>\" </b>'\n \n \n @unittest.skipUnless(coreapi, 'coreapi is not installed')", "file_path": "files/2022_7/73", "file_language": "py", "file_name": "tests/test_templatetags.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0, "llm_check": 1, "static_check": 0, "static": {"rats": [false, []], "semgrep": [false, []]}, "target": -1, "function_before": [], "function_after": []}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
