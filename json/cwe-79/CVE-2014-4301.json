{"index": 617, "cve_id": "CVE-2014-4301", "cwe_id": ["CWE-79"], "cve_language": "Python", "cve_description": "Multiple cross-site scripting (XSS) vulnerabilities in the respond_error function in routing.py in Eugene Pankov Ajenti before 1.2.21.7 allow remote attackers to inject arbitrary web script or HTML via the PATH_INFO to (1) resources.js or (2) resources.css in ajenti:static/, related to the traceback page.", "cvss": "3.7", "publish_date": "June 18, 2014", "AV": "NETWORK", "AC": "NETWORK", "PR": "NONE", "UI": "NONE", "S": "UNCHANGED", "C": "NONE", "I": "LOW", "A": "NONE", "commit_id": "d3fc5eb142ff16d55d158afb050af18d5ff09120", "commit_message": "[http] fix traceback page xss", "commit_date": "2014-06-08T10:05:59Z", "project": "eugeny/ajenti", "url": "https://api.github.com/repos/Eugeny/ajenti/commits/d3fc5eb142ff16d55d158afb050af18d5ff09120", "html_url": "https://github.com/Eugeny/ajenti/commit/d3fc5eb142ff16d55d158afb050af18d5ff09120", "windows_before": [{"commit_id": "19b741e1001793afa5fe4feeed0930895f480b79", "commit_date": "Wed Jun 4 23:27:27 2014 +0300", "commit_message": "bump, locale update", "files_name": ["ajenti/__init__.py", "ajenti/locales/af_ZA/LC_MESSAGES/ajenti.po", "ajenti/locales/ar_SA/LC_MESSAGES/ajenti.po", "ajenti/locales/be_BY/LC_MESSAGES/ajenti.po", "ajenti/locales/ca_ES/LC_MESSAGES/ajenti.po", "ajenti/locales/cs_CZ/LC_MESSAGES/ajenti.po", "ajenti/locales/da_DK/LC_MESSAGES/ajenti.po", "ajenti/locales/de_DE/LC_MESSAGES/ajenti.po", "ajenti/locales/el_GR/LC_MESSAGES/ajenti.po", "ajenti/locales/es_ES/LC_MESSAGES/ajenti.po", "ajenti/locales/et_EE/LC_MESSAGES/ajenti.po", "ajenti/locales/fa_IR/LC_MESSAGES/ajenti.po", "ajenti/locales/fi_FI/LC_MESSAGES/ajenti.po", "ajenti/locales/fr_FR/LC_MESSAGES/ajenti.po", "ajenti/locales/he_IL/LC_MESSAGES/ajenti.po", "ajenti/locales/hr_HR/LC_MESSAGES/ajenti.po", "ajenti/locales/hu_HU/LC_MESSAGES/ajenti.po", "ajenti/locales/id_ID/LC_MESSAGES/ajenti.po", "ajenti/locales/it_IT/LC_MESSAGES/ajenti.po", "ajenti/locales/ja_JP/LC_MESSAGES/ajenti.po", "ajenti/locales/ka_GE/LC_MESSAGES/ajenti.po", "ajenti/locales/ko_KR/LC_MESSAGES/ajenti.po", "ajenti/locales/lt_LT/LC_MESSAGES/ajenti.po", "ajenti/locales/lv_LV/LC_MESSAGES/ajenti.po", "ajenti/locales/nl_NL/LC_MESSAGES/ajenti.po", "ajenti/locales/no_NO/LC_MESSAGES/ajenti.po", "ajenti/locales/pl_PL/LC_MESSAGES/ajenti.po", "ajenti/locales/pt_BR/LC_MESSAGES/ajenti.po", "ajenti/locales/pt_PT/LC_MESSAGES/ajenti.po", "ajenti/locales/ro_RO/LC_MESSAGES/ajenti.po", "ajenti/locales/ru_RU/LC_MESSAGES/ajenti.po", "ajenti/locales/sk_SK/LC_MESSAGES/ajenti.po", "ajenti/locales/sl_SI/LC_MESSAGES/ajenti.po", "ajenti/locales/sr_SP/LC_MESSAGES/ajenti.po", "ajenti/locales/sv_SE/LC_MESSAGES/ajenti.po", "ajenti/locales/sw_KE/LC_MESSAGES/ajenti.po", "ajenti/locales/th_TH/LC_MESSAGES/ajenti.po", "ajenti/locales/tr_TR/LC_MESSAGES/ajenti.po", "ajenti/locales/uk_UA/LC_MESSAGES/ajenti.po", "ajenti/locales/vi_VN/LC_MESSAGES/ajenti.po", "ajenti/locales/zh_CN/LC_MESSAGES/ajenti.po", "ajenti/locales/zh_TW/LC_MESSAGES/ajenti.po"]}, {"commit_id": "00e0a03d4eb18be2d6e2b1fa236854bb82b18829", "commit_date": "Wed Jun 4 23:26:52 2014 +0300", "commit_message": "[services] fixed dbus dep", "files_name": ["ajenti/plugins/services/__init__.py"]}, {"commit_id": "32b5b0bfba92c00f49b2755f165a6ed740bf49ad", "commit_date": "Wed Jun 4 18:24:57 2014 +0300", "commit_message": "locale update", "files_name": ["ajenti/locales/ajenti.po"]}, {"commit_id": "c332eebf83b33004a89a52d657cbab52d2aa6d6b", "commit_date": "Wed Jun 4 18:00:08 2014 +0300", "commit_message": "[fm] delete files using a task", "files_name": ["ajenti/plugins/fm/backend.py", "ajenti/plugins/fm/fm.py", "ajenti/plugins/tasks/layout/params-deletedir.xml", "ajenti/plugins/tasks/tasks.py", "config.json"]}, {"commit_id": "bd301e26b212eb60de6e97f4aca339e88aa15231", "commit_date": "Tue Jun 3 15:45:18 2014 +0300", "commit_message": "bump", "files_name": ["ajenti/__init__.py"]}, {"commit_id": "c3fb00d8c5de785d8351f5f43e5251c9d67e9b7e", "commit_date": "Tue Jun 3 15:45:09 2014 +0300", "commit_message": "locale update", "files_name": ["ajenti/locales/af_ZA/LC_MESSAGES/ajenti.po", "ajenti/locales/ajenti.po", "ajenti/locales/ar_SA/LC_MESSAGES/ajenti.po", "ajenti/locales/be_BY/LC_MESSAGES/ajenti.po", "ajenti/locales/ca_ES/LC_MESSAGES/ajenti.po", "ajenti/locales/cs_CZ/LC_MESSAGES/ajenti.po", "ajenti/locales/da_DK/LC_MESSAGES/ajenti.po", "ajenti/locales/de_DE/LC_MESSAGES/ajenti.po", "ajenti/locales/el_GR/LC_MESSAGES/ajenti.po", "ajenti/locales/es_ES/LC_MESSAGES/ajenti.po", "ajenti/locales/et_EE/LC_MESSAGES/ajenti.po", "ajenti/locales/fa_IR/LC_MESSAGES/ajenti.po", "ajenti/locales/fi_FI/LC_MESSAGES/ajenti.po", "ajenti/locales/fr_FR/LC_MESSAGES/ajenti.po", "ajenti/locales/he_IL/LC_MESSAGES/ajenti.po", "ajenti/locales/hr_HR/LC_MESSAGES/ajenti.po", "ajenti/locales/hu_HU/LC_MESSAGES/ajenti.po", "ajenti/locales/id_ID/LC_MESSAGES/ajenti.po", "ajenti/locales/it_IT/LC_MESSAGES/ajenti.po", "ajenti/locales/ja_JP/LC_MESSAGES/ajenti.po", "ajenti/locales/ka_GE/LC_MESSAGES/ajenti.po", "ajenti/locales/ko_KR/LC_MESSAGES/ajenti.po", "ajenti/locales/lt_LT/LC_MESSAGES/ajenti.po", "ajenti/locales/lv_LV/LC_MESSAGES/ajenti.po", "ajenti/locales/nl_NL/LC_MESSAGES/ajenti.po", "ajenti/locales/no_NO/LC_MESSAGES/ajenti.po", "ajenti/locales/pl_PL/LC_MESSAGES/ajenti.po", "ajenti/locales/pt_BR/LC_MESSAGES/ajenti.po", "ajenti/locales/pt_PT/LC_MESSAGES/ajenti.po", "ajenti/locales/ro_RO/LC_MESSAGES/ajenti.po", "ajenti/locales/ru_RU/LC_MESSAGES/ajenti.po", "ajenti/locales/sk_SK/LC_MESSAGES/ajenti.po", "ajenti/locales/sl_SI/LC_MESSAGES/ajenti.po", "ajenti/locales/sr_SP/LC_MESSAGES/ajenti.po", "ajenti/locales/sv_SE/LC_MESSAGES/ajenti.po", "ajenti/locales/sw_KE/LC_MESSAGES/ajenti.po", "ajenti/locales/th_TH/LC_MESSAGES/ajenti.po", "ajenti/locales/tr_TR/LC_MESSAGES/ajenti.po", "ajenti/locales/uk_UA/LC_MESSAGES/ajenti.po", "ajenti/locales/vi_VN/LC_MESSAGES/ajenti.po", "ajenti/locales/zh_CN/LC_MESSAGES/ajenti.po", "ajenti/locales/zh_TW/LC_MESSAGES/ajenti.po"]}, {"commit_id": "2d8adcf912544ad7c94817127c67c3426711de6f", "commit_date": "Tue Jun 3 14:45:38 2014 +0300", "commit_message": "[terminal] few fixes (fixed #381)", "files_name": ["ajenti/plugins/terminal/content/js/term.coffee", "ajenti/plugins/terminal/layout/main.xml"]}, {"commit_id": "d901a313a779bcbf099dbfe4ccf3ef903c2922bf", "commit_date": "Tue Jun 3 14:34:09 2014 +0300", "commit_message": "[fm] select all toggles, in table", "files_name": ["ajenti/plugins/fm/fm.py", "ajenti/plugins/fm/layout/main.xml", "ajenti/plugins/main/content/css/controls.standard.less"]}, {"commit_id": "83672a02d20bc8d0b5ad026a07bb1752be7d68b2", "commit_date": "Wed May 28 16:33:54 2014 +0300", "commit_message": "[arch] strip systemd service suffix (Eugeny/ajenti-v#76)", "files_name": ["ajenti/plugins/services/sm_systemd.py"]}, {"commit_id": "247eecb71c8baa7313be77062ed919e1904b4896", "commit_date": "Wed May 28 15:37:18 2014 +0300", "commit_message": "arch hidden debug output", "files_name": ["ajenti/plugins/services/sm_systemd.py"]}, {"commit_id": "3bbd9582f39c2616eb2abef61533171d0ad219db", "commit_date": "Wed May 28 14:44:41 2014 +0300", "commit_message": "systemd arch debug", "files_name": ["ajenti/plugins/services/sm_systemd.py"]}, {"commit_id": "40b84c801a8deaa01654cab6db3462b6b0b3d3a0", "commit_date": "Tue May 27 12:27:28 2014 +0300", "commit_message": "arch paths", "files_name": ["ajenti/plugins/main/content/static/index.html", "ajenti/plugins/nsd/main.py"]}, {"commit_id": "a9ed7b0fd1fceb35ae12a2c837c0604384f904f8", "commit_date": "Mon May 26 08:28:51 2014 +0300", "commit_message": "[nginx] reenabled for arch", "files_name": ["ajenti/plugins/nginx/main.py"]}, {"commit_id": "340bbab0557b19a54fca38f91c858152d5a98c8a", "commit_date": "Sun May 25 20:44:40 2014 +0300", "commit_message": "[services] fixed upstart custom command runner (fixes #402)", "files_name": ["ajenti/plugins/services/sm_upstart.py"]}, {"commit_id": "a7bd7f28836087ae777b43c6ed0de7989a4a1b0f", "commit_date": "Sun May 25 13:27:58 2014 +0300", "commit_message": "[ui] made persona js async", "files_name": ["ajenti/plugins/main/content/static/auth.html"]}, {"commit_id": "f8b2ed6234c75e26f75a9f8cb75e51608d7dab0d", "commit_date": "Fri May 23 13:22:34 2014 +0300", "commit_message": "[nginx] disable nginx for arch (fixes #399)", "files_name": ["ajenti/plugins/nginx/main.py"]}, {"commit_id": "d82a0a4962721cb3da29e4ac1ac4a9f42e352f82", "commit_date": "Fri May 23 13:21:16 2014 +0300", "commit_message": "locale update", "files_name": ["ajenti/locales/ajenti.po"]}, {"commit_id": "36c455653638d3d0213e681053ae7ce8e05d8db8", "commit_date": "Fri May 23 12:36:56 2014 +0300", "commit_message": "[packages] fixed #404", "files_name": ["ajenti/plugins/packages/pm_pacman.py"]}, {"commit_id": "e690e7bf5de843248a021b33ef40bfcda0e22636", "commit_date": "Thu May 22 12:46:15 2014 +0300", "commit_message": "[dash] fixed #403, fixed #365", "files_name": ["ajenti/plugins/dashboard/dash.py"]}, {"commit_id": "e15566073c6b75e2fe0c503d470a087ccd813ca6", "commit_date": "Sun May 18 10:57:19 2014 +0300", "commit_message": "[network] fixed #371", "files_name": ["ajenti/plugins/network/nc_centos.py"]}, {"commit_id": "1aedae88d5851de04c34a9b69bdcb29de108bd93", "commit_date": "Sun May 18 10:40:16 2014 +0300", "commit_message": "[core] log invalid password IPs (fixes #386)", "files_name": ["ajenti/middleware.py", "ajenti/plugins/main/main.py", "ajenti/users.py"]}, {"commit_id": "5472c658b50381f3f74a6ed05dd30d813ffc6f93", "commit_date": "Sun May 18 10:29:57 2014 +0300", "commit_message": "[fstab] real free space (fixes #391, by @pbando)", "files_name": ["ajenti/plugins/fstab/disks.py", "ajenti/plugins/fstab/widget.py"]}, {"commit_id": "d3153af2cd6f8135ff77024b114e1f4a6d8f3a2c", "commit_date": "Sun May 18 10:25:44 2014 +0300", "commit_message": "[configurator] fixed #393", "files_name": ["ajenti/plugins/configurator/configurator.py"]}, {"commit_id": "42a9dd54cf305af6c00e730b65dfc2e09066f04a", "commit_date": "Fri May 16 18:11:01 2014 +0300", "commit_message": "bump", "files_name": ["ajenti/__init__.py"]}, {"commit_id": "43b4fbb736e645f63bd717a1aaff00bbc3fd2b1a", "commit_date": "Fri May 16 18:06:19 2014 +0300", "commit_message": "[locale] update", "files_name": ["ajenti/locales/af_ZA/LC_MESSAGES/ajenti.po", "ajenti/locales/ajenti.po", "ajenti/locales/ar_SA/LC_MESSAGES/ajenti.po", "ajenti/locales/be_BY/LC_MESSAGES/ajenti.po", "ajenti/locales/ca_ES/LC_MESSAGES/ajenti.po", "ajenti/locales/cs_CZ/LC_MESSAGES/ajenti.po", "ajenti/locales/da_DK/LC_MESSAGES/ajenti.po", "ajenti/locales/de_DE/LC_MESSAGES/ajenti.po", "ajenti/locales/el_GR/LC_MESSAGES/ajenti.po", "ajenti/locales/es_ES/LC_MESSAGES/ajenti.po", "ajenti/locales/et_EE/LC_MESSAGES/ajenti.po", "ajenti/locales/fa_IR/LC_MESSAGES/ajenti.po", "ajenti/locales/fi_FI/LC_MESSAGES/ajenti.po", "ajenti/locales/fr_FR/LC_MESSAGES/ajenti.po", "ajenti/locales/he_IL/LC_MESSAGES/ajenti.po", "ajenti/locales/hr_HR/LC_MESSAGES/ajenti.po", "ajenti/locales/hu_HU/LC_MESSAGES/ajenti.po", "ajenti/locales/id_ID/LC_MESSAGES/ajenti.po", "ajenti/locales/it_IT/LC_MESSAGES/ajenti.po", "ajenti/locales/ja_JP/LC_MESSAGES/ajenti.po", "ajenti/locales/ka_GE/LC_MESSAGES/ajenti.po", "ajenti/locales/ko_KR/LC_MESSAGES/ajenti.po", "ajenti/locales/lt_LT/LC_MESSAGES/ajenti.po", "ajenti/locales/lv_LV/LC_MESSAGES/ajenti.po", "ajenti/locales/nl_NL/LC_MESSAGES/ajenti.po", "ajenti/locales/no_NO/LC_MESSAGES/ajenti.po", "ajenti/locales/pl_PL/LC_MESSAGES/ajenti.po", "ajenti/locales/pt_BR/LC_MESSAGES/ajenti.po", "ajenti/locales/pt_PT/LC_MESSAGES/ajenti.po", "ajenti/locales/ro_RO/LC_MESSAGES/ajenti.po", "ajenti/locales/ru_RU/LC_MESSAGES/ajenti.po"]}], "windows_after": [{"commit_id": "08b8643b9c038f4c236d726d03e4e913768f6c5d", "commit_date": "Sun Jun 8 13:07:26 2014 +0300", "commit_message": "bump, locale update", "files_name": ["ajenti/__init__.py", "ajenti/locales/el_GR/LC_MESSAGES/ajenti.po", "ajenti/locales/ru_RU/LC_MESSAGES/ajenti.po", "ajenti/locales/uk_UA/LC_MESSAGES/ajenti.po"]}, {"commit_id": "26567fb88ce23043dcb55486045a7d1369808b33", "commit_date": "Wed May 21 17:28:23 2014 +0300", "commit_message": "wip", "files_name": ["ajenti/plugins/main/content/css/controls.index.i.less", "ajenti/plugins/main/content/css/controls.select2.i.less", "ajenti/plugins/main/content/css/controls.standard.less", "ajenti/plugins/main/content/css/icons.i.less", "ajenti/plugins/main/content/css/lib.i.less", "ajenti/plugins/main/content/css/main.less", "ajenti/plugins/main/content/css/vars.i.less"]}, {"commit_id": "e8793a693a49541a157b6e7e00aac627da4b3618", "commit_date": "Thu May 22 12:46:07 2014 +0300", "commit_message": "wip", "files_name": ["ajenti/plugins/dashboard/content/css/controls.dashboard.less", "ajenti/plugins/hosts/layout/main.xml", "ajenti/plugins/main/content/css/controls.dialogs.i.less", "ajenti/plugins/main/content/css/controls.select2.i.less", "ajenti/plugins/main/content/css/controls.standard.less", "ajenti/plugins/main/content/css/icons.i.less", "ajenti/plugins/main/content/css/jquery.ui.i.less", "ajenti/plugins/main/content/css/main.less", "ajenti/plugins/main/content/css/vars.i.less", "ajenti/plugins/main/content/js/controls.inputs.coffee"]}, {"commit_id": "e0a20f19106467b1933ba86fa063c9c8854fe0b1", "commit_date": "Mon May 26 08:26:39 2014 +0300", "commit_message": "[ui] fixes", "files_name": ["ajenti/plugins/dashboard/content/css/controls.dashboard.less", "ajenti/plugins/main/content/css/main.less"]}, {"commit_id": "b389056a05191f394412e9367e0f5e4b32932171", "commit_date": "Thu Jun 12 18:45:06 2014 +0300", "commit_message": "design fixes", "files_name": ["ajenti/plugins/iptables/content/css/iptables.less", "ajenti/plugins/iptables/layout/main.xml", "ajenti/plugins/main/content/css/controls.standard.less", "ajenti/plugins/main/content/css/main.less"]}, {"commit_id": "dad56d152ae60b674d27ad3484cf5897ce4ac0d0", "commit_date": "Thu Jun 12 18:51:28 2014 +0300", "commit_message": "locale update", "files_name": ["ajenti/locales/af_ZA/LC_MESSAGES/ajenti.po", "ajenti/locales/ajenti.po", "ajenti/locales/ar_SA/LC_MESSAGES/ajenti.po", "ajenti/locales/be_BY/LC_MESSAGES/ajenti.po", "ajenti/locales/ca_ES/LC_MESSAGES/ajenti.po", "ajenti/locales/cs_CZ/LC_MESSAGES/ajenti.po", "ajenti/locales/da_DK/LC_MESSAGES/ajenti.po", "ajenti/locales/de_DE/LC_MESSAGES/ajenti.po", "ajenti/locales/el_GR/LC_MESSAGES/ajenti.po", "ajenti/locales/es_ES/LC_MESSAGES/ajenti.po", "ajenti/locales/et_EE/LC_MESSAGES/ajenti.po", "ajenti/locales/fa_IR/LC_MESSAGES/ajenti.po", "ajenti/locales/fi_FI/LC_MESSAGES/ajenti.po", "ajenti/locales/fr_FR/LC_MESSAGES/ajenti.po", "ajenti/locales/he_IL/LC_MESSAGES/ajenti.po", "ajenti/locales/hr_HR/LC_MESSAGES/ajenti.po", "ajenti/locales/hu_HU/LC_MESSAGES/ajenti.po", "ajenti/locales/id_ID/LC_MESSAGES/ajenti.po", "ajenti/locales/it_IT/LC_MESSAGES/ajenti.po", "ajenti/locales/ja_JP/LC_MESSAGES/ajenti.po", "ajenti/locales/ka_GE/LC_MESSAGES/ajenti.po", "ajenti/locales/ko_KR/LC_MESSAGES/ajenti.po", "ajenti/locales/lt_LT/LC_MESSAGES/ajenti.po", "ajenti/locales/lv_LV/LC_MESSAGES/ajenti.po", "ajenti/locales/nl_NL/LC_MESSAGES/ajenti.po", "ajenti/locales/no_NO/LC_MESSAGES/ajenti.po", "ajenti/locales/pl_PL/LC_MESSAGES/ajenti.po", "ajenti/locales/pt_BR/LC_MESSAGES/ajenti.po", "ajenti/locales/pt_PT/LC_MESSAGES/ajenti.po", "ajenti/locales/ro_RO/LC_MESSAGES/ajenti.po", "ajenti/locales/ru_RU/LC_MESSAGES/ajenti.po", "ajenti/locales/sk_SK/LC_MESSAGES/ajenti.po", "ajenti/locales/sl_SI/LC_MESSAGES/ajenti.po", "ajenti/locales/sr_SP/LC_MESSAGES/ajenti.po", "ajenti/locales/sv_SE/LC_MESSAGES/ajenti.po", "ajenti/locales/sw_KE/LC_MESSAGES/ajenti.po", "ajenti/locales/th_TH/LC_MESSAGES/ajenti.po", "ajenti/locales/tr_TR/LC_MESSAGES/ajenti.po", "ajenti/locales/uk_UA/LC_MESSAGES/ajenti.po", "ajenti/locales/vi_VN/LC_MESSAGES/ajenti.po", "ajenti/locales/zh_CN/LC_MESSAGES/ajenti.po", "ajenti/locales/zh_TW/LC_MESSAGES/ajenti.po"]}, {"commit_id": "b564b96496d353c1a645cba5bf2607edc167035b", "commit_date": "Thu Jun 12 18:51:35 2014 +0300", "commit_message": "handle deleted paths in file dialogs", "files_name": ["ajenti/plugins/main/controls_dialogs.py"]}, {"commit_id": "6faa85d192e0a1099cc9d120e1211994ea48ffb8", "commit_date": "Tue Feb 4 21:25:15 2014 +0100", "commit_message": "- Fixed Samba smb.conf location on FreeBSD - Replaced regular config location with proper platform_select function", "files_name": ["ajenti/plugins/samba/main.py"]}, {"commit_id": "17d24324fa259dc07806a9412a1adfcaa0ef8d0a", "commit_date": "Thu Jun 12 19:01:57 2014 +0300", "commit_message": "[samba] code style", "files_name": ["ajenti/plugins/samba/main.py"]}, {"commit_id": "8c9e4b53f4f6c0f7d22800d6b348c20c724d0fbf", "commit_date": "Sun May 11 14:48:38 2014 +0900", "commit_message": "Download ajenti-repo-1.0-1.noarch.rpm with rpm command directly", "files_name": ["scripts/install-rhel.sh"]}, {"commit_id": "affb91db297fc9e54e5b9f8b4f34bb5f878a5cf2", "commit_date": "Thu Jun 12 19:29:32 2014 +0300", "commit_message": "[services] add services from initctl (fixes #372)", "files_name": ["ajenti/plugins/services/sm_sysvinit.py"]}, {"commit_id": "8915a2e213fcae921bf5783261891a80fd71f741", "commit_date": "Thu Jun 12 19:43:44 2014 +0300", "commit_message": "[main] allow permissionless sections", "files_name": ["ajenti/plugins/main/api.py", "ajenti/plugins/main/main.py"]}, {"commit_id": "75ec1708098b25a97b1ff9c5e6ef482b18491e37", "commit_date": "Thu Jun 12 22:11:23 2014 +0300", "commit_message": "Quick fixes", "files_name": ["ajenti/core.py", "ajenti/plugins/main/main.py"]}, {"commit_id": "e19e410e5e6695f08143332df89d577a576ba43d", "commit_date": "Thu Jun 12 22:21:17 2014 +0300", "commit_message": "OSX detection", "files_name": ["ajenti/__init__.py", "ajenti/core.py"]}, {"commit_id": "bcd10c11720da1457b769a4bd9282facf6f015de", "commit_date": "Fri Jun 13 10:23:08 2014 +0300", "commit_message": "bump", "files_name": ["ajenti/__init__.py"]}, {"commit_id": "880c4f80d6baafc4082d29a57f475f146a68557f", "commit_date": "Fri Jun 13 10:25:05 2014 +0300", "commit_message": "Merge branch 'master' of github.com:Eugeny/ajenti", "files_name": ["4311ac6e1c6d82f56e9c03ecfbd18f811b711470 - Fri Jun 13 15:28:00 2014 +0300 : [osx] launchd backend", "ajenti/plugins/services/__init__.py", "ajenti/plugins/services/sm_osx.py"]}, {"commit_id": "0779de5e8f1a7d2544c20326779a2e89202c06ad", "commit_date": "Fri Jun 13 15:28:56 2014 +0300", "commit_message": "[osx] fixes", "files_name": ["ajenti/plugins/packages/main.py", "ajenti/plugins/sensors/load.py", "ajenti/plugins/users/main.py"]}, {"commit_id": "5728158fdbb620a46c9abcdb890b6d971dc82559", "commit_date": "Fri Jun 13 15:30:36 2014 +0300", "commit_message": "[osx] fix", "files_name": ["ajenti/plugins/services/sm_osx.py"]}, {"commit_id": "74446bea4104c59b199dc9846c7c1f850337cab8", "commit_date": "Fri Jun 13 15:31:55 2014 +0300", "commit_message": "Merge branch 'master' of github.com:Eugeny/ajenti", "files_name": ["5eb95c33b3699817352045f5173751bc94b1abbc - Fri Jun 13 15:31:56 2014 +0300 : [osx] fix", "ajenti/plugins/services/sm_osx.py"]}, {"commit_id": "eb15bebf3d4b56b8febfb2ef2fb00ee762d1ec7b", "commit_date": "Fri Jun 13 15:34:24 2014 +0300", "commit_message": "[osx] fix", "files_name": ["ajenti/plugins/fstab/main.py", "ajenti/plugins/services/sm_osx.py"]}, {"commit_id": "1f2e1d0e73d4f30bebfb645087c3c874703d3c86", "commit_date": "Fri Jun 13 15:38:54 2014 +0300", "commit_message": "[osx] fix", "files_name": ["ajenti/plugins/services/sm_osx.py"]}, {"commit_id": "90c124228fe264dd96e70402c8e84440aafa7121", "commit_date": "Fri Jun 13 15:40:54 2014 +0300", "commit_message": "[osx] fix", "files_name": ["ajenti/api/__init__.py", "ajenti/plugins/dashboard/updater.py"]}, {"commit_id": "aa1ee72847297f6feb46bc924aaee19e6a85c85e", "commit_date": "Fri Jun 13 15:41:50 2014 +0300", "commit_message": "fix", "files_name": ["ajenti/api/__init__.py"]}, {"commit_id": "9c0cb967440b9365f53b0b900377cc3b8b9ed571", "commit_date": "Fri Jun 13 15:45:26 2014 +0300", "commit_message": "no nginx on osx...", "files_name": ["ajenti/plugins/nginx/main.py"]}, {"commit_id": "b3a424bf5f940e7c0632daa14c1bc6db34f649af", "commit_date": "Mon Jun 16 20:03:38 2014 +0300", "commit_message": "[services] fixed #425", "files_name": ["ajenti/plugins/services/sm_sysvinit.py"]}, {"commit_id": "c2a17c2d50e64b1561e3af8a2aad8bc9bd788f28", "commit_date": "Mon Jun 16 21:05:48 2014 +0300", "commit_message": "bump, locale update", "files_name": ["ajenti/__init__.py", "ajenti/locales/de_DE/LC_MESSAGES/ajenti.po"]}, {"commit_id": "82ad3838459c5802e1d6b82b5ce0a941e2655755", "commit_date": "Tue Jun 17 13:47:41 2014 +0300", "commit_message": "licensing", "files_name": ["docs/COPYRIGHT", "docs/LICENSE", "packaging/ajenti.spec.in"]}, {"commit_id": "a9e47a3327aa8065758e3d95e585671073e28aee", "commit_date": "Tue Jun 17 13:48:20 2014 +0300", "commit_message": "bump, locale update", "files_name": ["ajenti/__init__.py", "ajenti/locales/ru_RU/LC_MESSAGES/ajenti.po"]}, {"commit_id": "57e270960555cdc381d8f1877e22a079d9c42ebe", "commit_date": "Wed Jun 18 14:51:31 2014 +0300", "commit_message": "[iptables] bootstrap rules (fixes #431)", "files_name": ["ajenti/plugins/iptables/main.py"]}, {"commit_id": "53a76c7a280cc93d7167f19dcc760383746c65dc", "commit_date": "Wed Jun 18 14:51:45 2014 +0300", "commit_message": "[binder] allow nonhashable collections", "files_name": ["ajenti/ui/binder.py"]}, {"commit_id": "1db2059e6048d86b949acb0fd7ef85459c799c04", "commit_date": "Wed Jun 18 14:54:55 2014 +0300", "commit_message": "[terminal] fixed #430", "files_name": ["ajenti/plugins/terminal/terminal.py"]}, {"commit_id": "319d4061cd9214c4244f92c33acfcb9a2a2031f1", "commit_date": "Wed Jun 18 15:06:54 2014 +0300", "commit_message": "[core] plugin descriptions", "files_name": ["ajenti/api/__init__.py", "ajenti/locales/ajenti.po", "ajenti/plugins/apache/__init__.py", "ajenti/plugins/apcups/__init__.py", "ajenti/plugins/bind9/__init__.py", "ajenti/plugins/codemirror/__init__.py", "ajenti/plugins/configurator/__init__.py", "ajenti/plugins/cron/__init__.py", "ajenti/plugins/csf/__init__.py", "ajenti/plugins/ctdb/__init__.py", "ajenti/plugins/hddtemp/__init__.py", "ajenti/plugins/hdparm/__init__.py", "ajenti/plugins/ipmi/__init__.py", "ajenti/plugins/iptables/__init__.py", "ajenti/plugins/lm_sensors/__init__.py", "ajenti/plugins/megaraid/__init__.py", "ajenti/plugins/netatalk/__init__.py", "ajenti/plugins/nsd/__init__.py", "ajenti/plugins/plugins/layout/main.xml", "ajenti/plugins/raid/__init__.py"]}, {"commit_id": "a92c9fbc18b43a46ebdb732dfd4521632a4b9809", "commit_date": "Wed Jun 18 15:12:35 2014 +0300", "commit_message": "[codemirror] make sure to fill the area", "files_name": ["ajenti/plugins/codemirror/content/css/codemirror.m.css"]}, {"commit_id": "469cc57b32295d8a26e156fda16c7ec8fe6e0ce3", "commit_date": "Wed Jun 18 15:13:34 2014 +0300", "commit_message": "bump, locale update", "files_name": ["ajenti/__init__.py"]}], "parents": [{"commit_id_before": "19b741e1001793afa5fe4feeed0930895f480b79", "url_before": "https://api.github.com/repos/Eugeny/ajenti/commits/19b741e1001793afa5fe4feeed0930895f480b79", "html_url_before": "https://github.com/Eugeny/ajenti/commit/19b741e1001793afa5fe4feeed0930895f480b79"}], "details": [{"raw_url": "https://github.com/Eugeny/ajenti/raw/d3fc5eb142ff16d55d158afb050af18d5ff09120/ajenti%2Frouting.py", "code": "import cgi\nimport socketio\nimport traceback\n\nfrom ajenti.http import HttpHandler\nfrom ajenti.api import BasePlugin, plugin, persistent, rootcontext\nfrom ajenti.api.http import HttpPlugin, SocketPlugin\nfrom ajenti.plugins import manager\nfrom ajenti.profiler import *\n\n\nclass SocketIORouteHandler (HttpHandler):\n    def __init__(self):\n        self.namespaces = {}\n        for cls in SocketPlugin.get_classes():\n            self.namespaces[cls.name] = cls\n\n    def handle(self, context):\n        return str(socketio.socketio_manage(context.env, self.namespaces, context))\n\n\nclass InvalidRouteHandler (HttpHandler):\n    def handle(self, context):\n        context.respond_not_found()\n        return 'Invalid URL'\n\n\n@plugin\n@persistent\n@rootcontext\nclass CentralDispatcher (BasePlugin, HttpHandler):\n    def __init__(self):\n        self.invalid = InvalidRouteHandler()\n        self.io = SocketIORouteHandler()\n\n    @profiled(lambda a, k: 'HTTP %s' % a[1].path)\n    def handle(self, context):\n        \"\"\"\n        Dispatch the request to every HttpPlugin\n        \"\"\"\n\n        if hasattr(context.session, 'appcontext'):\n            self.context = context.session.appcontext\n        else:\n            self.context = manager.context\n\n        if context.path.startswith('/ajenti:socket'):\n            return context.fallthrough(self.io)\n\n        if not hasattr(self.context, 'http_handlers'):\n            self.context.http_handlers = HttpPlugin.get_all()\n\n        for instance in self.context.http_handlers:\n            try:\n                output = instance.handle(context)\n            except Exception, e:\n                return [self.respond_error(context, e)]\n            if output is not None:\n                return output\n        return context.fallthrough(self.invalid)\n\n    def respond_error(self, context, exception):\n        context.respond_server_error()\n        stack = traceback.format_exc()\n        return \"\"\"\n        <html>\n            <body>\n\n                <style>\n                    body {\n                        font-family: sans-serif;\n                        color: #888;\n                        text-align: center;\n                    }\n\n                    body pre {\n                        width: 600px;\n                        text-align: left;\n                        margin: auto;\n                        font-family: monospace;\n                    }\n                </style>\n\n                <img src=\"/ajenti:static/main/error.jpeg\" />\n                <br/>\n                <p>\n                    Server error\n                </p>\n                <pre>\n%s\n                </pre>\n            </body>\n        </html>\n        \"\"\" % cgi.escape(stack)\n", "code_before": "import socketio\nimport traceback\n\nfrom ajenti.http import HttpHandler\nfrom ajenti.api import BasePlugin, plugin, persistent, rootcontext\nfrom ajenti.api.http import HttpPlugin, SocketPlugin\nfrom ajenti.plugins import manager\nfrom ajenti.profiler import *\n\n\nclass SocketIORouteHandler (HttpHandler):\n    def __init__(self):\n        self.namespaces = {}\n        for cls in SocketPlugin.get_classes():\n            self.namespaces[cls.name] = cls\n\n    def handle(self, context):\n        return str(socketio.socketio_manage(context.env, self.namespaces, context))\n\n\nclass InvalidRouteHandler (HttpHandler):\n    def handle(self, context):\n        context.respond_not_found()\n        return 'Invalid URL'\n\n\n@plugin\n@persistent\n@rootcontext\nclass CentralDispatcher (BasePlugin, HttpHandler):\n    def __init__(self):\n        self.invalid = InvalidRouteHandler()\n        self.io = SocketIORouteHandler()\n\n    @profiled(lambda a, k: 'HTTP %s' % a[1].path)\n    def handle(self, context):\n        \"\"\"\n        Dispatch the request to every HttpPlugin\n        \"\"\"\n\n        if hasattr(context.session, 'appcontext'):\n            self.context = context.session.appcontext\n        else:\n            self.context = manager.context\n\n        if context.path.startswith('/ajenti:socket'):\n            return context.fallthrough(self.io)\n\n        if not hasattr(self.context, 'http_handlers'):\n            self.context.http_handlers = HttpPlugin.get_all()\n\n        for instance in self.context.http_handlers:\n            try:\n                output = instance.handle(context)\n            except Exception, e:\n                return [self.respond_error(context, e)]\n            if output is not None:\n                return output\n        return context.fallthrough(self.invalid)\n\n    def respond_error(self, context, exception):\n        context.respond_server_error()\n        stack = traceback.format_exc()\n        return \"\"\"\n        <html>\n            <body>\n\n                <style>\n                    body {\n                        font-family: sans-serif;\n                        color: #888;\n                        text-align: center;\n                    }\n\n                    body pre {\n                        width: 600px;\n                        text-align: left;\n                        margin: auto;\n                        font-family: monospace;\n                    }\n                </style>\n\n                <img src=\"/ajenti:static/main/error.jpeg\" />\n                <br/>\n                <p>\n                    Server error\n                </p>\n                <pre>\n%s\n                </pre>\n            </body>\n        </html>\n        \"\"\" % stack\n", "patch": "@@ -1,3 +1,4 @@\n+import cgi\n import socketio\n import traceback\n \n@@ -90,4 +91,4 @@ def respond_error(self, context, exception):\n                 </pre>\n             </body>\n         </html>\n-        \"\"\" % stack\n+        \"\"\" % cgi.escape(stack)", "file_path": "files/2014_6/20", "file_language": "py", "file_name": "ajenti/routing.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0, "llm_check": 1, "static_check": 0, "static": {"rats": [false, []], "semgrep": [false, []]}, "target": -1, "function_before": [], "function_after": []}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
