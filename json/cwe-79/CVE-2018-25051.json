{"index": 9810, "cve_id": "CVE-2018-25051", "cwe_id": ["CWE-79"], "cve_language": "Python", "cve_description": "A vulnerability, which was classified as problematic, was found in JmPotato Pomash. This affects an unknown part of the file Pomash/theme/clean/templates/editor.html. The manipulation of the argument article.title/content.title/article.tag leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is be1914ef0a6808e00f51618b2de92496a3604415. It is recommended to apply a patch to fix this issue. The identifier VDB-216957 was assigned to this vulnerability.", "cvss": "6.1", "publish_date": "December 28, 2022", "AV": "NETWORK", "AC": "NETWORK", "PR": "NONE", "UI": "REQUIRED", "S": "CHANGED", "C": "LOW", "I": "LOW", "A": "NONE", "commit_id": "be1914ef0a6808e00f51618b2de92496a3604415", "commit_message": "Prevent from XSS", "commit_date": "2018-12-29T14:07:04Z", "project": "jmpotato/pomash", "url": "https://api.github.com/repos/JmPotato/Pomash/commits/be1914ef0a6808e00f51618b2de92496a3604415", "html_url": "https://github.com/JmPotato/Pomash/commit/be1914ef0a6808e00f51618b2de92496a3604415", "windows_before": [{"commit_id": "3094124addddb5c1e684877c2061419d6c67a815", "commit_date": "Sun Dec 16 21:45:40 2018 +0800", "commit_message": "Adapted for mobile", "files_name": ["Pomash/theme/clean/templates/editor.html"]}, {"commit_id": "1634acfbb08ec98286f6f86131ca4fe2591811db", "commit_date": "Sun Dec 16 17:27:13 2018 +0800", "commit_message": "Rewrite the editor", "files_name": ["Pomash/Pomash.py", "Pomash/theme/clean/static/js/marked.min.js", "Pomash/theme/clean/templates/article.html", "Pomash/theme/clean/templates/editor.html"]}, {"commit_id": "654859a2f5f2b814ed8ef6bd55286e6813736b84", "commit_date": "Thu Dec 13 18:25:45 2018 +0800", "commit_message": "Redirect 404 for pages that don't exist", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "9ab92c4215f26eac8872ffc322ab409c0a75d9d1", "commit_date": "Thu Dec 13 18:21:38 2018 +0800", "commit_message": "eevert \"break code word\"", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "67ffe129fd1d8ef5d00adb7e51b326ce9f7a0254", "commit_date": "Thu Dec 13 18:19:45 2018 +0800", "commit_message": "break code word", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "64378ba7247769b328bedc8f62a6dfaf24e6c3a3", "commit_date": "Thu Dec 13 13:12:00 2018 +0800", "commit_message": "Redirect to 404 for articles that do not exist", "files_name": ["Pomash/Pomash.py", "Pomash/theme/clean/templates/dropbox.html", "Pomash/theme/clean/templates/tag.html"]}, {"commit_id": "39df3dd8eb159c842f6a8489b6b2de4f2514d206", "commit_date": "Wed Dec 12 22:23:08 2018 +0800", "commit_message": "Adjust paging algorithm", "files_name": ["Pomash/Pomash.py", "Pomash/theme/clean/templates/home.html"]}, {"commit_id": "00d5df4a9e03e4e3d0efdcce744c19b76ed64333", "commit_date": "Wed Dec 12 14:55:12 2018 +0800", "commit_message": "Update README.md", "files_name": ["README.md"]}, {"commit_id": "2258bbbceef9d882b969c28a0308714265a182d6", "commit_date": "Wed Dec 12 13:23:49 2018 +0800", "commit_message": "Some changes for theme support", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "84d03cba175b83ceb4b0e54e9ae25ffd690c9764", "commit_date": "Tue Dec 11 23:16:07 2018 +0800", "commit_message": "typo", "files_name": ["Pomash/theme/clean/templates/layout.html"]}, {"commit_id": "89c449ae28e61403e67e5e1713a7489918fa3e7d", "commit_date": "Tue Dec 11 23:16:02 2018 +0800", "commit_message": "Add the theme \"maupassant\"", "files_name": ["README.md"]}, {"commit_id": "21e496e4e29c8045123020218745e656b2a091fc", "commit_date": "Tue Dec 11 23:14:44 2018 +0800", "commit_message": "remove markdown emphasis render for LaTeX", "files_name": ["Pomash/libs/markdown.py"]}, {"commit_id": "951cf1587a45ef05ed99e4ae79c6859a70c46c59", "commit_date": "Mon Dec 10 13:12:25 2018 +0800", "commit_message": "Update README for LaTeX things", "files_name": ["README.md"]}, {"commit_id": "397c9a775c82258eae29ac41132fd94f91de6a47", "commit_date": "Mon Dec 10 12:52:01 2018 +0800", "commit_message": "Redirect to the article after editing", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "e8d0feb709d67019b2b8ac54416df11ea9c32ee6", "commit_date": "Mon Dec 10 12:51:24 2018 +0800", "commit_message": "a Python 2 bug fix", "files_name": ["Pomash/libs/handler.py"]}, {"commit_id": "a9a522442a2093e06c630a9e41f1dbe10a9b2f67", "commit_date": "Mon Dec 10 12:51:00 2018 +0800", "commit_message": "Minified CSS/JS files", "files_name": ["Pomash/theme/clean/static/css/style.css", "Pomash/theme/clean/static/js/av-min.js"]}, {"commit_id": "f38b40a5a0a06f945678572f1f83d64f574c8ee7", "commit_date": "Mon Dec 10 12:49:44 2018 +0800", "commit_message": "Adjust layout structure", "files_name": ["Pomash/theme/clean/templates/layout.html"]}, {"commit_id": "1a0de06d1a83429821ca1826213ac76e2e58247d", "commit_date": "Mon Dec 10 12:48:56 2018 +0800", "commit_message": "Update the LaTeX option", "files_name": ["Pomash/theme/clean/templates/article.html"]}, {"commit_id": "c9cdd1d6bdc1f1709c7cf3006955addd46c4e7ca", "commit_date": "Sun Dec 9 23:57:07 2018 +0800", "commit_message": "LaTeX Support", "files_name": ["Pomash/theme/clean/templates/article.html"]}, {"commit_id": "84a6262c1b856e2b3f5aef82ccdf5a5acf8e39bf", "commit_date": "Sun Dec 9 22:21:44 2018 +0800", "commit_message": "Update Pomash.py", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "bdc8c4c92dd1cfec06c5e17177ac5f82a2385600", "commit_date": "Sun Dec 9 22:16:27 2018 +0800", "commit_message": "Update Valine.js", "files_name": ["Pomash/theme/clean/static/js/Valine.js"]}, {"commit_id": "e8528b79ac78c23e6c86f9db2cd10da34809835a", "commit_date": "Sun Dec 9 20:30:28 2018 +0800", "commit_message": "typo", "files_name": ["Pomash/theme/clean/templates/article.html"]}, {"commit_id": "7ee314a1879ed234da71ac3e318f4e986f2f4e00", "commit_date": "Sun Dec 9 20:25:51 2018 +0800", "commit_message": "Add map file", "files_name": ["Pomash/theme/clean/static/js/av-min.js.map"]}, {"commit_id": "d89c8c4e5dc4da4ab7a0940146105c10790439a1", "commit_date": "Sun Dec 9 20:25:22 2018 +0800", "commit_message": "Safari bug fix", "files_name": ["Pomash/theme/clean/static/js/Valine.js"]}, {"commit_id": "9a8a981ba00efc787e608928587cad298e7545af", "commit_date": "Sun Dec 9 19:59:08 2018 +0800", "commit_message": "Update article.html", "files_name": ["Pomash/theme/clean/templates/article.html"]}, {"commit_id": "66d2cb2d32137cfe424e489d691d5775d77fd11d", "commit_date": "Sun Dec 9 19:55:47 2018 +0800", "commit_message": "bug fix", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "6c17e4bfb665d17f36cb8fe11acb81673defb115", "commit_date": "Sun Dec 9 19:47:31 2018 +0800", "commit_message": "Bump into version 2.0", "files_name": ["Pomash/Pomash.py", "README.md", "settings.py"]}, {"commit_id": "7b46b902b68fb32b5ba6eda7282b19526aefe6c1", "commit_date": "Sun Dec 9 18:33:39 2018 +0800", "commit_message": "adjust comment style details", "files_name": ["Pomash/theme/clean/static/css/style.css", "Pomash/theme/clean/static/js/valine.js"]}, {"commit_id": "e5543375b5505120cbadf14c5b9b31a071765483", "commit_date": "Sun Dec 9 17:27:30 2018 +0800", "commit_message": "Localize js scripts", "files_name": ["Pomash/theme/clean/static/js/av-min.js", "Pomash/theme/clean/static/js/valine.js", "Pomash/theme/clean/templates/article.html"]}, {"commit_id": "9e4bc51d80c175962f97e25e3dc32acbdcdaaf75", "commit_date": "Sun Dec 9 16:59:48 2018 +0800", "commit_message": "Fix the comment style", "files_name": ["Pomash/theme/clean/static/css/style.css"]}, {"commit_id": "efb885cc8eba681c99cf7cd6fcad7e15662d1cb9", "commit_date": "Sun Dec 9 16:40:43 2018 +0800", "commit_message": "bug fix", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "5ed97aa78ae7313c69e1466ccc152a1e4e01ca43", "commit_date": "Sun Dec 9 16:30:10 2018 +0800", "commit_message": "Merge branch 'master' of https://github.com/JmPotato/Pomash", "files_name": ["069e6a4f1309cb9ca66df19d743594369c10bd32 - Sun Dec 9 16:29:59 2018 +0800 : Shift from Disqus to Valine", "Pomash/theme/clean/static/css/style.css", "Pomash/theme/clean/templates/article.html", "settings.py"]}, {"commit_id": "a65713fdbac10fb0a5500c5005c7bdf0f656035f", "commit_date": "Sun Dec 9 16:27:51 2018 +0800", "commit_message": "Remove the old default theme", "files_name": ["Pomash/theme/default/static/css/pygments_style.css", "Pomash/theme/default/static/css/style.css", "Pomash/theme/default/static/img/404.jpg", "Pomash/theme/default/static/img/Pomash.png", "Pomash/theme/default/static/img/Rope.jpg", "Pomash/theme/default/templates/404.html", "Pomash/theme/default/templates/admin.html", "Pomash/theme/default/templates/article.html", "Pomash/theme/default/templates/articles.html", "Pomash/theme/default/templates/change_pw.html", "Pomash/theme/default/templates/dropbox.html", "Pomash/theme/default/templates/editor.html", "Pomash/theme/default/templates/feed.xml", "Pomash/theme/default/templates/home.html", "Pomash/theme/default/templates/layout.html", "Pomash/theme/default/templates/login.html", "Pomash/theme/default/templates/page.html", "Pomash/theme/default/templates/tag.html", "Pomash/theme/default/templates/tags.html"]}, {"commit_id": "7543c020f29b99717a3dc3e33669c7658b527594", "commit_date": "Sun Dec 9 14:39:05 2018 +0800", "commit_message": "Ignore the HTML and CSS codes", "files_name": [".gitattributes"]}, {"commit_id": "fa516fba217bb98ac3cf6dcdab2b1b2e4dae5d98", "commit_date": "Sun Dec 9 14:34:33 2018 +0800", "commit_message": "make the theme \"clean\" as default", "files_name": ["Pomash/theme/clean/README.md", "Pomash/theme/clean/static/css/style.css", "Pomash/theme/clean/static/img/Pomash.png", "Pomash/theme/clean/templates/404.html", "Pomash/theme/clean/templates/admin.html", "Pomash/theme/clean/templates/article.html", "Pomash/theme/clean/templates/articles.html", "Pomash/theme/clean/templates/change_pw.html", "Pomash/theme/clean/templates/dropbox.html", "Pomash/theme/clean/templates/editor.html", "Pomash/theme/clean/templates/feed.xml", "Pomash/theme/clean/templates/home.html", "Pomash/theme/clean/templates/layout.html", "Pomash/theme/clean/templates/login.html", "Pomash/theme/clean/templates/page.html", "Pomash/theme/clean/templates/tag.html", "Pomash/theme/clean/templates/tags.html", "settings.py"]}, {"commit_id": "d3716d537da5142b2a041c0c6e38c7d4780ec07b", "commit_date": "Sun Dec 9 14:33:35 2018 +0800", "commit_message": "404 page bug fix", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "6077f79b8642e1a2f9cdb82b99f3be1501a47934", "commit_date": "Sun Dec 9 13:02:17 2018 +0800", "commit_message": "Python 3.7.1 env's requirements", "files_name": ["requirements.txt"]}, {"commit_id": "4984e63d5f16a778b0f913f91decd2d95bd63d37", "commit_date": "Fri Oct 26 13:49:39 2018 +0800", "commit_message": "Update README.md", "files_name": ["README.md"]}, {"commit_id": "30809fd989a370d0f2d99f2eec71a934cc1a983f", "commit_date": "Fri Oct 26 13:47:15 2018 +0800", "commit_message": "Update Google Analytics js", "files_name": ["Pomash/theme/default/templates/layout.html"]}, {"commit_id": "5e4792db775e2b3e8db57163251143a5c2be52a2", "commit_date": "Fri Oct 26 13:36:03 2018 +0800", "commit_message": "Update the Dropbox version for Python 3", "files_name": ["requirements.txt"]}, {"commit_id": "86ac3925cc5c5a434f4547908f84a08533577a70", "commit_date": "Mon Aug 27 22:01:39 2018 +0800", "commit_message": "Update for Python3", "files_name": ["Pomash/libs/utils.py"]}, {"commit_id": "0099eea845fe47d9911fd4e2a8a70792d5265921", "commit_date": "Wed Mar 28 09:38:11 2018 +0800", "commit_message": "Update to Python 3.6.4", "files_name": ["Pomash/Pomash.py", "Pomash/libs/handler.py", "Pomash/libs/models.py", "Pomash/libs/tools.py", "Pomash/libs/utils.py"]}, {"commit_id": "66569c0c566197f4c6601a00947faf0158c2ad54", "commit_date": "Sat Jul 8 12:39:25 2017 +0800", "commit_message": "\u652f\u6301\u4e2d\u6587\u6807\u7b7e", "files_name": ["Pomash/libs/handler.py"]}, {"commit_id": "433edfcd2db1617ce8c3430aeda60152f0df5820", "commit_date": "Sat Jul 8 12:26:13 2017 +0800", "commit_message": "Add urlencode for tag url", "files_name": ["Pomash/libs/handler.py", "Pomash/theme/default/templates/article.html", "Pomash/theme/default/templates/tags.html"]}, {"commit_id": "12daa2e0f2cc8772fd6ff2ee3abf6054e36e1f18", "commit_date": "Sat Jul 8 12:07:37 2017 +0800", "commit_message": "Set debug mode off as default", "files_name": ["settings.py"]}, {"commit_id": "6d76cb92800bb3ccfbdf6c64c4ed832f045cf051", "commit_date": "Sat Jul 8 02:07:26 2017 +0800", "commit_message": "app_token can be empty now", "files_name": ["Pomash/Pomash.py"]}, {"commit_id": "003f489c876aeb7108820b7b3aa9c5e6a3e9fb89", "commit_date": "Sat Jul 8 01:24:11 2017 +0800", "commit_message": "Update dropbox sdk and other libs", "files_name": []}], "windows_after": [{"commit_id": "5975619df5eb268bd4ee7caf372d2307cdabf9a3", "commit_date": "Tue Mar 5 21:00:43 2019 +0800", "commit_message": "Python 2.x bug fix", "files_name": ["init_db.py"]}, {"commit_id": "8f855d4cc54ba8f1247069cf8071ddb05498ed95", "commit_date": "Wed Jun 5 13:28:04 2019 +0800", "commit_message": "Update requirements.txt", "files_name": ["requirements.txt"]}, {"commit_id": "5dd9b5dbb365aa3d9fe856442eb6db436e7cd0c3", "commit_date": "Sat Jun 8 14:14:37 2019 +0800", "commit_message": "Rewrite the editor using React", "files_name": ["Pomash/Pomash.py", "Pomash/libs/models.py", "Pomash/theme/clean/templates/editor.html"]}, {"commit_id": "8d40bec1eb2aa061e317198284eb0db8dac4fe2b", "commit_date": "Sat Jun 8 21:19:42 2019 +0800", "commit_message": "Use compressed js files", "files_name": ["Pomash/theme/clean/templates/editor.html"]}, {"commit_id": "253827db88d99b925a2df1ae603ba6663879af85", "commit_date": "Fri Jun 14 00:10:58 2019 +0800", "commit_message": "Add Dark Mode to the default theme", "files_name": ["Pomash/theme/clean/static/css/style-dark.css", "Pomash/theme/clean/templates/layout.html"]}, {"commit_id": "0accae7eb1289531f461d9e4aaee40ca394b6403", "commit_date": "Fri Jun 14 14:11:21 2019 +0800", "commit_message": "Better Dark Mode", "files_name": ["Pomash/theme/clean/static/js/Valine-dark.js", "Pomash/theme/clean/static/js/marked.min.js", "Pomash/theme/clean/templates/article.html", "Pomash/theme/clean/templates/layout.html"]}, {"commit_id": "98c79472857de2752a89332049a930c9729aa6c5", "commit_date": "Fri Jun 14 19:44:08 2019 +0800", "commit_message": "bug fix", "files_name": ["Pomash/theme/clean/static/js/Valine-dark.js", "Pomash/theme/clean/static/js/Valine.js", "Pomash/theme/clean/templates/article.html"]}, {"commit_id": "13294e8cfae8c13943375ac83e5ac20b9bd2e1db", "commit_date": "Mon Jul 29 13:38:57 2019 +0800", "commit_message": "Layout fix", "files_name": ["Pomash/theme/clean/static/css/style-dark.css", "Pomash/theme/clean/static/css/style.css"]}, {"commit_id": "3f27afbfcb832ad5a9e32ec77edc3a68cf6f8a9f", "commit_date": "Mon Jul 29 21:57:39 2019 +0800", "commit_message": "Update style-dark.css", "files_name": ["Pomash/theme/clean/static/css/style-dark.css"]}, {"commit_id": "9b9ea7a6bd2860e32867166d167c00c97aa42763", "commit_date": "Mon Aug 12 12:24:30 2019 +0800", "commit_message": "Change the way how dark mode css is loaded", "files_name": ["Pomash/theme/clean/templates/layout.html"]}, {"commit_id": "7dea12eaf9c5854a1b60e50063a0c9d4b88575ec", "commit_date": "Mon Aug 12 12:42:12 2019 +0800", "commit_message": "xD Forgive me please", "files_name": ["Pomash/theme/clean/templates/layout.html"]}, {"commit_id": "156157745ccf6b4f7f41363c008682fa40ff2d85", "commit_date": "Sat Jan 18 21:11:31 2020 +0800", "commit_message": "Better comment systems and theme", "files_name": ["Pomash/__init__.py", "Pomash/libs/handler.py", "Pomash/libs/markdown.py", "Pomash/libs/utils.py", "Pomash/theme/clean/static/css/style-dark.css", "Pomash/theme/clean/static/css/style.css", "Pomash/theme/clean/static/js/Valine-dark.js", "Pomash/theme/clean/static/js/Valine.js", "Pomash/theme/clean/static/js/av-min.js", "Pomash/theme/clean/static/js/av-min.js.map", "Pomash/theme/clean/templates/article.html", "Pomash/theme/clean/templates/layout.html", "requirements.txt", "run.py", "settings.py"]}, {"commit_id": "0ede6cb881d6430ea0bf5cbc620d61d3ac33d7df", "commit_date": "Sat Jan 18 21:15:28 2020 +0800", "commit_message": "Release version 2.1", "files_name": ["README.md"]}, {"commit_id": "a017681cac996cf2d9cc8e837e6457cff21d3430", "commit_date": "Sat Jan 18 21:17:03 2020 +0800", "commit_message": "Update README.md", "files_name": ["README.md"]}, {"commit_id": "8b9b48860bfd9e6da35d32093d55d1ed463ef74f", "commit_date": "Sun Jan 19 06:34:17 2020 +0000", "commit_message": "word-break bug fix", "files_name": ["Pomash/theme/clean/static/css/style-dark.css", "Pomash/theme/clean/static/css/style.css"]}, {"commit_id": "c763f4594aa05b8b38577785e37aedcbf2f53e24", "commit_date": "Thu May 21 10:29:21 2020 +0800", "commit_message": "Fix the Disqus conf arguments bug", "files_name": ["Pomash/theme/clean/templates/article.html"]}, {"commit_id": "a6736b9ab6789107a6540e787ff596efda2d3598", "commit_date": "Sat Aug 1 14:48:11 2020 +0800", "commit_message": "Make login form text align center", "files_name": ["Pomash/theme/clean/static/css/style-dark.css", "Pomash/theme/clean/static/css/style.css"]}, {"commit_id": "0f4c89ad3dcdadb5fa71735acb2a4f98bec8b2b2", "commit_date": "Tue Dec 21 13:23:26 2021 +0800", "commit_message": "Support the strikethrough syntax and refine the code", "files_name": ["Pomash/Pomash.py", "Pomash/libs/handler.py", "Pomash/libs/markdown.py", "Pomash/libs/models.py", "Pomash/libs/tools.py", "Pomash/libs/utils.py", "README.md", "init_db.py", "requirements.txt", "run.py"]}, {"commit_id": "91b581e0bdb6937a3992ffb479626d94af04dabc", "commit_date": "Mon Aug 1 10:32:19 2022 +0800", "commit_message": "Bump mistune from 2.0.0 to 2.0.3 (#8)", "files_name": ["requirements.txt"]}, {"commit_id": "4bb46d6675ecd01b8336e208932a2bd662d07a45", "commit_date": "Mon Aug 1 10:41:18 2022 +0800", "commit_message": "Bump pygments from 2.4.2 to 2.7.4 (#7)", "files_name": ["requirements.txt"]}, {"commit_id": "9c72125a6430525844c702b38d37b92b8f3a0acf", "commit_date": "Mon Jan 30 15:25:26 2023 +0800", "commit_message": "Add the Dockerfile", "files_name": [".dockerignore", "Dockerfile"]}], "parents": [{"commit_id_before": "3094124addddb5c1e684877c2061419d6c67a815", "url_before": "https://api.github.com/repos/JmPotato/Pomash/commits/3094124addddb5c1e684877c2061419d6c67a815", "html_url_before": "https://github.com/JmPotato/Pomash/commit/3094124addddb5c1e684877c2061419d6c67a815"}], "details": [{"raw_url": "https://github.com/JmPotato/Pomash/raw/be1914ef0a6808e00f51618b2de92496a3604415/Pomash%2Flibs%2Fhandler.py", "code": "#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport re\nimport mistune\nimport tornado.web\n\nfrom urllib.parse import unquote, quote\n\nfrom .models import *\nfrom .markdown import *\nfrom tornado.escape import to_unicode, xhtml_escape\n\nclass BaseHandler(tornado.web.RequestHandler):\n    def get_pure_title(self, title):\n        return re.sub('''<(\"[^\"]*\"|'[^']*'|[^'\">])*>''', \"\", title).strip()\n\n    def escape_string(self, s):\n        return xhtml_escape(s)\n        \n    def description(self, text):\n        if len(text) <= 200:\n            return re.sub('(<.*?>)', '', text).replace('\\n', ' ')[:int(len(text)/2-4)] + '...'\n        elif len(text) > 200:\n            return re.sub('(<.*?>)', '', text).replace('\\n', ' ')[:195] + '...'\n\n    def md_to_html(self, text):\n        text = to_unicode(text)\n        renderer = MyRenderer()\n        md = mistune.Markdown(renderer=renderer)\n        return md.render(text)\n\n    def urlencode(self, text):\n        return quote(text.encode('utf8'))\n\n    def urldecode(self, text):\n        return unquote(text.encode('utf8'))\n\n    def get_custom_page(self):\n        return get_all_pages()\n\n    def get_current_user(self):\n        username = self.get_secure_cookie(\"username\")\n        if not username:\n            return None\n        return username\n\n    def get_error_html(self, status_code, **kwargs):\n        if status_code == 404:\n            self.render(\"404.html\",\n                title = \"404 Page Not Found\",\n                )\n        else:\n            try:\n                exception = \"%s\\n\\n%s\" % (kwargs[\"exception\"],\n                    traceback.format_exc())\n                if self.settings.get(\"debug\"):\n                    self.set_header('Content-Type', 'text/plain')\n                    for line in exception:\n                        self.write(line)\n                else:\n                    self.write(\"oOps...! I made \u200b\u200ba mistake... \")\n            except Exception:\n                return super(BaseHandler, self).get_error_html(status_code,\n                    **kwargs)", "code_before": "#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport re\nimport mistune\nimport tornado.web\n\n\nfrom urllib.parse import unquote, quote\n\nfrom .models import *\nfrom .markdown import *\nfrom tornado.escape import to_unicode\n\nclass BaseHandler(tornado.web.RequestHandler):\n    def description(self, text):\n        if len(text) <= 200:\n            return re.sub('(<.*?>)', '', text).replace('\\n', ' ')[:int(len(text)/2-4)] + '...'\n        elif len(text) > 200:\n            return re.sub('(<.*?>)', '', text).replace('\\n', ' ')[:195] + '...'\n\n    def md_to_html(self, text):\n        text = to_unicode(text)\n        renderer = MyRenderer()\n        md = mistune.Markdown(renderer=renderer)\n        return md.render(text)\n\n    def urlencode(self, text):\n        return quote(text.encode('utf8'))\n\n    def urldecode(self, text):\n        return unquote(text.encode('utf8'))\n\n    def get_custom_page(self):\n        return get_all_pages()\n\n    def get_current_user(self):\n        username = self.get_secure_cookie(\"username\")\n        if not username:\n            return None\n        return username\n\n    def get_error_html(self, status_code, **kwargs):\n        if status_code == 404:\n            self.render(\"404.html\",\n                title = \"404 Page Not Found\",\n                )\n        else:\n            try:\n                exception = \"%s\\n\\n%s\" % (kwargs[\"exception\"],\n                    traceback.format_exc())\n                if self.settings.get(\"debug\"):\n                    self.set_header('Content-Type', 'text/plain')\n                    for line in exception:\n                        self.write(line)\n                else:\n                    self.write(\"oOps...! I made \u200b\u200ba mistake... \")\n            except Exception:\n                return super(BaseHandler, self).get_error_html(status_code,\n                    **kwargs)", "patch": "@@ -5,14 +5,19 @@\n import mistune\n import tornado.web\n \n-\n from urllib.parse import unquote, quote\n \n from .models import *\n from .markdown import *\n-from tornado.escape import to_unicode\n+from tornado.escape import to_unicode, xhtml_escape\n \n class BaseHandler(tornado.web.RequestHandler):\n+    def get_pure_title(self, title):\n+        return re.sub('''<(\"[^\"]*\"|'[^']*'|[^'\">])*>''', \"\", title).strip()\n+\n+    def escape_string(self, s):\n+        return xhtml_escape(s)\n+        \n     def description(self, text):\n         if len(text) <= 200:\n             return re.sub('(<.*?>)', '', text).replace('\\n', ' ')[:int(len(text)/2-4)] + '...'", "file_path": "files/2022_12/448", "file_language": "py", "file_name": "Pomash/libs/handler.py", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0, "llm_check": 1, "static_check": 0, "static": {"rats": [false, []], "semgrep": [false, []]}, "target": -1, "function_before": [], "function_after": []}, {"raw_url": "https://github.com/JmPotato/Pomash/raw/be1914ef0a6808e00f51618b2de92496a3604415/Pomash%2Ftheme%2Fclean%2Ftemplates%2Feditor.html", "code": "{% extends 'layout.html' %}\n\n{% block title %} | Editor{% end %}\n\n{% block head %}\n<script>\n    function AutoSave(it) {\n        var _value = it.value;\n        var _LastContent = GetCookie('AutoSaveContent');\n        if (_value.length >= _LastContent.length) {\n            var expDays = 30;\n            var exp = new Date();\n            exp.setTime(exp.getTime() + (expDays * 86400000));\n            var expires = '; expires=' + exp.toGMTString();\n            document.cookie = \"AutoSaveContent=\" + escape(_value) + expires;\n        }\n    }\n\n    function AutoLoad(it) {\n        var _value = it.value;\n        if (!_value) {\n            var _LastContent = GetCookie('AutoSaveContent');\n            if (!_LastContent) return;\n            if (confirm(\"Load Last AutoSave Content?\")) {\n                it.value = _LastContent;\n                return true;\n            }\n        }\n    }\n\n    function getCookieVal(offset) {\n        var endstr = document.cookie.indexOf(\";\",offset);\n        if (endstr === -1) endstr = document.cookie.length;\n        return unescape(document.cookie.substring(offset, endstr));\n    }\n\n    function GetCookie(name) {\n        var arg = name+\"=\";\n        var alen = arg.length;\n        var clen = document.cookie.length;\n        var i = 0;\n        while (i < clen){\n            var j = i + alen;\n            if(document.cookie.substring(i,j) === arg) return getCookieVal (j);\n            i = document.cookie.indexOf(\" \",i)+1;\n            if (i === 0) break;\n        }\n        return null;\n    }\n\n    function DeleteCookie (name) {\n        var exp = new Date();\n        exp.setTime(exp.getTime() - 1);\n        var cval = GetCookie(name);\n        document.cookie = name + \"=\" + cval + \";expires=\" + exp.toGMTString();\n    }\n</script>\n{% end %}\n\n{% block content %}\n<div class=\"post\" id=\"editor\">\n    <h1 id=\"title\">Editor</h1>\n    <article>\n        <form action=\"#\" method=\"post\" id=\"article_editor\">\n            <div class=\"input\">\n                <label for=\"title\">Title</label>\n                <input id=\"title\" name=\"title\" type=\"text\" value=\"{% if not is_page and not new %}{{ handler.escape_string(article.title) }}{% elif is_page and not new %}{{ handler.escape_string(content.title) }}{% end %}\" style=\"width:100%;\">\n            </div>\n            <div v-if=\"!is_page\" class=\"input\">\n                <label for=\"tag\">Tag</label>\n                <input id=\"tag\" name=\"tag\" type=\"text\" value=\"{% if not is_page and not new %}{{ handler.escape_string(article.tag) }}{% end %}\" style=\"width:100%;\">\n            </div>\n            <div class=\"input\">\n                <label for=\"content\">Content</label>\n                <textarea :value=\"input\" @input=\"update\" rows=\"30\" id=\"content\" name=\"content\" onkeyup=\"AutoSave(this);\"  onchange=\"AutoSave(this);\"ondblclick=\"AutoLoad(this);\"></textarea>\n                <label>Tip: Double click box to load last autosave content</label>\n            <div id=\"submit\">\n                <button type=\"submit\">Post</button>\n            </div>\n        </form>\n    </article>\n    <div class=\"post\">\n        <h1 id=\"title\">Preview</h1>\n        <article id=\"preview\" v-html=\"compiledMarkdown\"></article>\n    </div>\n</div>\n<script src=\"https://cdn.jsdelivr.net/npm/vue/dist/vue.js\"></script>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css\" integrity=\"sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y\" crossorigin=\"anonymous\">\n<script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js\" integrity=\"sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx\" crossorigin=\"anonymous\"></script>\n<script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js\" integrity=\"sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe\" crossorigin=\"anonymous\"></script>\n<script src='{{ static_url(\"js/marked.min.js\") }}'></script>\n<script src=\"https://unpkg.com/lodash@4.16.0\"></script>\n<script>\n    document.addEventListener(\"wheel\", function() {\n        renderMathInElement(document.getElementById(\"preview\"), {\n            delimiters: [\n                {left: \"$$\", right: \"$$\", display: true},\n                {left: \"$\", right: \"$\", display: false}\n            ]\n        });\n    });\n    document.addEventListener(\"touchmove\", function() {\n        renderMathInElement(document.getElementById(\"preview\"), {\n            delimiters: [\n                {left: \"$$\", right: \"$$\", display: true},\n                {left: \"$\", right: \"$\", display: false}\n            ]\n        });\n    });\n    var editor = new Vue({\n        el: '#editor',\n        data: {\n            {% if new %}\n            is_new: true,\n            input: '',\n            {% if is_page %}\n            is_page: true,\n            {% else %}\n            is_page: false,\n            {% end %}\n            {% else %}\n            is_new: false,\n            {% if is_page %}\n            is_page: true,\n            input: {{ json_encode(content.content) }}\n            {% else %}\n            is_page: false,\n            input: {{ json_encode(article.content) }}\n            {% end %}\n            {% end %}\n        },\n        computed: {\n            compiledMarkdown: function () {\n                return marked(this.input, { sanitize: true })\n            }\n        },\n        methods: {\n            update: _.debounce(function (e) {\n                this.input = e.target.value\n            }, 300)\n        }\n    });\n</script>\n{% end %}", "code_before": "{% extends 'layout.html' %}\n\n{% block title %} | Editor{% end %}\n\n{% block head %}\n<script>\n    function AutoSave(it) {\n        var _value = it.value;\n        var _LastContent = GetCookie('AutoSaveContent');\n        if (_value.length >= _LastContent.length) {\n            var expDays = 30;\n            var exp = new Date();\n            exp.setTime(exp.getTime() + (expDays * 86400000));\n            var expires = '; expires=' + exp.toGMTString();\n            document.cookie = \"AutoSaveContent=\" + escape(_value) + expires;\n        }\n    }\n\n    function AutoLoad(it) {\n        var _value = it.value;\n        if (!_value) {\n            var _LastContent = GetCookie('AutoSaveContent');\n            if (!_LastContent) return;\n            if (confirm(\"Load Last AutoSave Content?\")) {\n                it.value = _LastContent;\n                return true;\n            }\n        }\n    }\n\n    function getCookieVal(offset) {\n        var endstr = document.cookie.indexOf(\";\",offset);\n        if (endstr === -1) endstr = document.cookie.length;\n        return unescape(document.cookie.substring(offset, endstr));\n    }\n\n    function GetCookie(name) {\n        var arg = name+\"=\";\n        var alen = arg.length;\n        var clen = document.cookie.length;\n        var i = 0;\n        while (i < clen){\n            var j = i + alen;\n            if(document.cookie.substring(i,j) === arg) return getCookieVal (j);\n            i = document.cookie.indexOf(\" \",i)+1;\n            if (i === 0) break;\n        }\n        return null;\n    }\n\n    function DeleteCookie (name) {\n        var exp = new Date();\n        exp.setTime(exp.getTime() - 1);\n        var cval = GetCookie(name);\n        document.cookie = name + \"=\" + cval + \";expires=\" + exp.toGMTString();\n    }\n</script>\n{% end %}\n\n{% block content %}\n<div class=\"post\" id=\"editor\">\n    <h1 id=\"title\">Editor</h1>\n    <article>\n        <form action=\"#\" method=\"post\" id=\"article_editor\">\n            <div class=\"input\">\n                <label for=\"title\">Title</label>\n                <input id=\"title\" name=\"title\" type=\"text\" value=\"{% if not is_page and not new %}{{ article.title }}{% elif is_page and not new %}{{ content.title }}{% end %}\" style=\"width:100%;\">\n            </div>\n            <div v-if=\"!is_page\" class=\"input\">\n                <label for=\"tag\">Tag</label>\n                <input id=\"tag\" name=\"tag\" type=\"text\" value=\"{% if not is_page and not new %}{{ article.tag }}{% end %}\" style=\"width:100%;\">\n            </div>\n            <div class=\"input\">\n                <label for=\"content\">Content</label>\n                <textarea :value=\"input\" @input=\"update\" rows=\"30\" id=\"content\" name=\"content\" onkeyup=\"AutoSave(this);\"  onchange=\"AutoSave(this);\"ondblclick=\"AutoLoad(this);\"></textarea>\n                <label>Tip: Double click box to load last autosave content</label>\n            <div id=\"submit\">\n                <button type=\"submit\">Post</button>\n            </div>\n        </form>\n    </article>\n    <div class=\"post\">\n        <h1 id=\"title\">Preview</h1>\n        <article id=\"preview\" v-html=\"compiledMarkdown\"></article>\n    </div>\n</div>\n<script src=\"https://cdn.jsdelivr.net/npm/vue/dist/vue.js\"></script>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css\" integrity=\"sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y\" crossorigin=\"anonymous\">\n<script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js\" integrity=\"sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx\" crossorigin=\"anonymous\"></script>\n<script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js\" integrity=\"sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe\" crossorigin=\"anonymous\"></script>\n<script src='{{ static_url(\"js/marked.min.js\") }}'></script>\n<script src=\"https://unpkg.com/lodash@4.16.0\"></script>\n<script>\n    document.addEventListener(\"wheel\", function() {\n        renderMathInElement(document.getElementById(\"preview\"), {\n            delimiters: [\n                {left: \"$$\", right: \"$$\", display: true},\n                {left: \"$\", right: \"$\", display: false}\n            ]\n        });\n    });\n    document.addEventListener(\"touchmove\", function() {\n        renderMathInElement(document.getElementById(\"preview\"), {\n            delimiters: [\n                {left: \"$$\", right: \"$$\", display: true},\n                {left: \"$\", right: \"$\", display: false}\n            ]\n        });\n    });\n    var editor = new Vue({\n        el: '#editor',\n        data: {\n            {% if new %}\n            is_new: true,\n            input: '',\n            {% if is_page %}\n            is_page: true,\n            {% else %}\n            is_page: false,\n            {% end %}\n            {% else %}\n            is_new: false,\n            {% if is_page %}\n            is_page: true,\n            input: {{ json_encode(content.content) }}\n            {% else %}\n            is_page: false,\n            input: {{ json_encode(article.content) }}\n            {% end %}\n            {% end %}\n        },\n        computed: {\n            compiledMarkdown: function () {\n                return marked(this.input, { sanitize: true })\n            }\n        },\n        methods: {\n            update: _.debounce(function (e) {\n                this.input = e.target.value\n            }, 300)\n        }\n    });\n</script>\n{% end %}", "patch": "@@ -64,11 +64,11 @@ <h1 id=\"title\">Editor</h1>\n         <form action=\"#\" method=\"post\" id=\"article_editor\">\n             <div class=\"input\">\n                 <label for=\"title\">Title</label>\n-                <input id=\"title\" name=\"title\" type=\"text\" value=\"{% if not is_page and not new %}{{ article.title }}{% elif is_page and not new %}{{ content.title }}{% end %}\" style=\"width:100%;\">\n+                <input id=\"title\" name=\"title\" type=\"text\" value=\"{% if not is_page and not new %}{{ handler.escape_string(article.title) }}{% elif is_page and not new %}{{ handler.escape_string(content.title) }}{% end %}\" style=\"width:100%;\">\n             </div>\n             <div v-if=\"!is_page\" class=\"input\">\n                 <label for=\"tag\">Tag</label>\n-                <input id=\"tag\" name=\"tag\" type=\"text\" value=\"{% if not is_page and not new %}{{ article.tag }}{% end %}\" style=\"width:100%;\">\n+                <input id=\"tag\" name=\"tag\" type=\"text\" value=\"{% if not is_page and not new %}{{ handler.escape_string(article.tag) }}{% end %}\" style=\"width:100%;\">\n             </div>\n             <div class=\"input\">\n                 <label for=\"content\">Content</label>", "file_path": "files/2022_12/449", "file_language": "html", "file_name": "Pomash/theme/clean/templates/editor.html", "outdated_file_modify": 0, "outdated_file_before": 1, "outdated_file_after": 0}, {"raw_url": "https://github.com/JmPotato/Pomash/raw/be1914ef0a6808e00f51618b2de92496a3604415/Pomash%2Ftheme%2Fclean%2Ftemplates%2Fpage.html", "code": "{% extends 'layout.html' %}\n\n{% block title %} | {{ handler.get_pure_title(article.title) }}{% end %}\n\n{% block head %}\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css\" integrity=\"sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y\" crossorigin=\"anonymous\">\n    <script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js\" integrity=\"sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx\" crossorigin=\"anonymous\"></script>\n    <script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js\" integrity=\"sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe\" crossorigin=\"anonymous\"></script>\n    <script>\n        document.addEventListener(\"DOMContentLoaded\", function() {\n            renderMathInElement(document.getElementById(\"article\"), {\n                delimiters: [\n                    {left: \"$$\", right: \"$$\", display: true},\n                    {left: \"$\", right: \"$\", display: false}\n                ]\n            });\n        });\n    </script>\n{% end %}\n\n{% block content %}\n<div class=\"post\">\n    <h1 id=\"title\">{{ article.title }}</h1>\n    <article>\n    {{ handler.md_to_html(article.content) }}\n    </article>\n</div>\n{% end %}", "code_before": "{% extends 'layout.html' %}\n\n{% block title %} | {{ article.title }}{% end %}\n\n{% block content %}\n<div class=\"post\">\n    <h1 id=\"title\">{{ article.title }}</h1>\n    <article>\n    {{ handler.md_to_html(article.content) }}\n    </article>\n</div>\n{% end %}", "patch": "@@ -1,6 +1,22 @@\n {% extends 'layout.html' %}\n \n-{% block title %} | {{ article.title }}{% end %}\n+{% block title %} | {{ handler.get_pure_title(article.title) }}{% end %}\n+\n+{% block head %}\n+    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css\" integrity=\"sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y\" crossorigin=\"anonymous\">\n+    <script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js\" integrity=\"sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx\" crossorigin=\"anonymous\"></script>\n+    <script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js\" integrity=\"sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe\" crossorigin=\"anonymous\"></script>\n+    <script>\n+        document.addEventListener(\"DOMContentLoaded\", function() {\n+            renderMathInElement(document.getElementById(\"article\"), {\n+                delimiters: [\n+                    {left: \"$$\", right: \"$$\", display: true},\n+                    {left: \"$\", right: \"$\", display: false}\n+                ]\n+            });\n+        });\n+    </script>\n+{% end %}\n \n {% block content %}\n <div class=\"post\">", "file_path": "files/2022_12/450", "file_language": "html", "file_name": "Pomash/theme/clean/templates/page.html", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}
